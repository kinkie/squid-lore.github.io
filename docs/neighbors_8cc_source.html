<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squid Web Cache: squid/src/neighbors.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Squid Web Cache<span id="projectnumber">&#160;v8/master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('neighbors_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">neighbors.cc</div></div>
</div><!--header-->
<div class="contents">
<a href="neighbors_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * Copyright (C) 1996-2025 The Squid Software Foundation and contributors</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * Squid software is distributed under GPLv2+ license and includes</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * contributions from numerous individuals and organizations.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * Please see the COPYING and CONTRIBUTORS files for details.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> */</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">/* DEBUG: section 15    Neighbor Routines */</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;<a class="code" href="squid_8h.html">squid.h</a>&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="FilledChecklist_8h.html">acl/FilledChecklist.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="PortCfg_8h.html">anyp/PortCfg.h</a>&quot;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;<a class="code" href="EnumIterator_8h.html">base/EnumIterator.h</a>&quot;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="IoManip_8h.html">base/IoManip.h</a>&quot;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="PackableStream_8h.html">base/PackableStream.h</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="PrecomputedCodeContext_8h.html">base/PrecomputedCodeContext.h</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="CacheDigest_8h.html">CacheDigest.h</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="CachePeer_8h.html">CachePeer.h</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="CachePeers_8h.html">CachePeers.h</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="Connection_8h.html">comm/Connection.h</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="ConnOpener_8h.html">comm/ConnOpener.h</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="netdb_8h.html">compat/netdb.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="debug_2Messages_8h.html">debug/Messages.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="event_8h.html">event.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="FwdState_8h.html">FwdState.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="globals_8h.html">globals.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="htcp_8h.html">htcp.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="HttpRequest_8h.html">HttpRequest.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="net__db_8h.html">icmp/net_db.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="ICP_8h.html">ICP.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="int_8h.html">int.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="ip_2Address_8h.html">ip/Address.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="ip_2tools_8h.html">ip/tools.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="ipcache_8h.html">ipcache.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="MemObject_8h.html">MemObject.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;<a class="code" href="Registration_8h.html">mgr/Registration.h</a>&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;<a class="code" href="multicast_8h.html">multicast.h</a>&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;<a class="code" href="neighbors_8h.html">neighbors.h</a>&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;<a class="code" href="NeighborTypeDomainList_8h.html">NeighborTypeDomainList.h</a>&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;<a class="code" href="pconn_8h.html">pconn.h</a>&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &quot;<a class="code" href="PeerDigest_8h.html">PeerDigest.h</a>&quot;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;<a class="code" href="PeerPoolMgr_8h.html">PeerPoolMgr.h</a>&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &quot;<a class="code" href="PeerSelectState_8h.html">PeerSelectState.h</a>&quot;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &quot;<a class="code" href="RequestFlags_8h.html">RequestFlags.h</a>&quot;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &quot;<a class="code" href="SquidConfig_8h.html">SquidConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &quot;<a class="code" href="SquidMath_8h.html">SquidMath.h</a>&quot;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &quot;<a class="code" href="stat_8h.html">stat.h</a>&quot;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &quot;<a class="code" href="Store_8h.html">Store.h</a>&quot;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;<a class="code" href="store__key__md5_8h.html">store_key_md5.h</a>&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;<a class="code" href="tools_8h.html">tools.h</a>&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">/* count mcast group peers every 15 minutes */</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#aad025aebc8aa3df1d1eee52819686336">   54</a></span><span class="preprocessor">#define MCAST_COUNT_RATE 900</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="keywordtype">bool</span> <a class="code hl_function" href="neighbors_8cc.html#a7552c902985ade500b9f9c1c4c7b54a2">peerAllowedToUse</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *, <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *);</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_function" href="neighbors_8cc.html#a24fed2aabf197388b6c52b39cdd478d6">peerWouldBePinged</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *, <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *);</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#a9f2a764443af2685e1e71af8e474bc83">neighborAlive</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *, <span class="keyword">const</span> <a class="code hl_class" href="classMemObject.html">MemObject</a> *, <span class="keyword">const</span> <a class="code hl_class" href="classicp__common__t.html">icp_common_t</a> *);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#a2959da26b2b78dcef9887f71e725aa15">neighborAliveHtcp</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *, <span class="keyword">const</span> <a class="code hl_class" href="classMemObject.html">MemObject</a> *, <span class="keyword">const</span> <a class="code hl_class" href="classHtcpReplyData.html">HtcpReplyData</a> *);</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#afcb5d6c5cf86ca011f9574afb353d061">peerDnsRefreshCheck</a>(<span class="keywordtype">void</span> *);</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#a7fdb5c5dd15618d30a7a2cfc23a4ffdc">peerDnsRefreshStart</a>();</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a3269559f810fd86a0d91ffe9f24ef758">   65</a></span><span class="keyword">static</span> <a class="code hl_typedef" href="ipcache_8h.html#ab4f16a3f392afd628bd4b38661e25d0a">IPH</a> <a class="code hl_variable" href="neighbors_8cc.html#a3269559f810fd86a0d91ffe9f24ef758">peerDNSConfigure</a>;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#aef96ae2795b76fe6db1eb6ed4201cda5">peerProbeConnect</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *, <span class="keyword">const</span> <span class="keywordtype">bool</span> reprobeIfBusy = <span class="keyword">false</span>);</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a4a27f36856d050c4cbc4adf4041febd0">   67</a></span><span class="keyword">static</span> <a class="code hl_typedef" href="CommCalls_8h.html#aafdebdf0576f8621014d6e8e9f245e8e">CNCB</a> <a class="code hl_variable" href="neighbors_8cc.html#a4a27f36856d050c4cbc4adf4041febd0">peerProbeConnectDone</a>;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#a118fc9cfb76ca751cc3758457edc5a01">peerCountMcastPeersDone</a>(<span class="keywordtype">void</span> *data);</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#afc217053539cabc9b792dbdb5b077611">peerCountMcastPeersStart</a>(<span class="keywordtype">void</span> *data);</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#a2c5c2cb4d8baeb8345a3665462708336">peerCountMcastPeersSchedule</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, time_t when);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#a6132f21ce167ad8753fdd6af168abaf5">peerCountMcastPeersAbort</a>(<a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *);</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#a3e2752d95ce98c8cfaf10516e4517d48">peerCountMcastPeersCreateAndSend</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a956def714ac0ed251dad6f60ff91abfd">   73</a></span><span class="keyword">static</span> <a class="code hl_typedef" href="typedefs_8h.html#a553228e11bbd528f7f0bf2d11b54b0fa">IRCB</a> <a class="code hl_variable" href="neighbors_8cc.html#a956def714ac0ed251dad6f60ff91abfd">peerCountHandleIcpReply</a>;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#ac4b350a9f6eac0a4bf823ec15126bb66">neighborIgnoreNonPeer</a>(<span class="keyword">const</span> <a class="code hl_class" href="classIp_1_1Address.html">Ip::Address</a> &amp;, <a class="code hl_enumeration" href="group__ServerProtocolICPAPI.html#ga6d172cc0273c7eb44afd1351198704c6">icp_opcode</a>);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a4f2ef0cb3a2344aab8ecd924faf291a5">   76</a></span><span class="keyword">static</span> <a class="code hl_typedef" href="mgr_2forward_8h.html#a8c23ffe1f8e3bdc1d0bc4924111a8c2f">OBJH</a> <a class="code hl_variable" href="neighbors_8cc.html#a4f2ef0cb3a2344aab8ecd924faf291a5">neighborDumpPeers</a>;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="neighbors_8cc.html#a03640b5e6e91173327f269d4b4275479">dump_peers</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *, <a class="code hl_class" href="classCachePeers.html">CachePeers</a> *);</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a9b08654d548438ab5cf806d4d605ab6e">   79</a></span><span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code hl_variable" href="neighbors_8cc.html#a9b08654d548438ab5cf806d4d605ab6e">echo_port</a>;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a7d9b8b2006eddbf1058f8cd894f28798">   81</a></span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="neighbors_8cc.html#a7d9b8b2006eddbf1058f8cd894f28798">NLateReplies</a> = 0;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span><span class="keyword">const</span> <span class="keywordtype">char</span> *</div>
<div class="foldopen" id="foldopen00084" data-start="{" data-end="}">
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a7271928a2f26b9c331bd057c813e9865">   84</a></span><a class="code hl_function" href="neighbors_8cc.html#a7271928a2f26b9c331bd057c813e9865">neighborTypeStr</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p)</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>{</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463ad0a923afe5d043e0b2cebf2bc50400aa">PEER_NONE</a>)</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Non-Peer&quot;</span>;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463a4c68e42a267dc3266e07c1afdeac933a">PEER_SIBLING</a>)</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Sibling&quot;</span>;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a>)</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Multicast Group&quot;</span>;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Parent&quot;</span>;</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>}</div>
</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><a class="code hl_class" href="classCachePeer.html">CachePeer</a> *</div>
<div class="foldopen" id="foldopen00099" data-start="{" data-end="}">
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a35194ab936916470ce011e25834b6572">   99</a></span><a class="code hl_function" href="neighbors_8cc.html#a35194ab936916470ce011e25834b6572">whichPeer</a>(<span class="keyword">const</span> <a class="code hl_class" href="classIp_1_1Address.html">Ip::Address</a> &amp;from)</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>{</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="keywordtype">int</span> j;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;whichPeer: from &quot;</span> &lt;&lt; from);</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;p: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        <span class="keywordflow">for</span> (j = 0; j &lt; p-&gt;n_addresses; ++j) {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            <span class="keywordflow">if</span> (from == p-&gt;addresses[j] &amp;&amp; from.<a class="code hl_function" href="classIp_1_1Address.html#aeea3c669850f18acd2efcd336fcf2438">port</a>() == p-&gt;icp.port) {</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                <span class="keywordflow">return</span> p.get();</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>            }</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>        }</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    }</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span> </div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>}</div>
</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><a class="code hl_enumeration" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463">peer_t</a></div>
<div class="foldopen" id="foldopen00117" data-start="{" data-end="}">
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">  117</a></span><a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <span class="keyword">const</span> <a class="code hl_class" href="classAnyP_1_1Uri.html">AnyP::Uri</a> &amp;url)</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>{</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="keyword">const</span> <a class="code hl_class" href="classNeighborTypeDomainList.html">NeighborTypeDomainList</a> *d = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    <span class="keywordflow">for</span> (d = p-&gt;<a class="code hl_variable" href="classCachePeer.html#a28e677328934360f043df4f59a50e170">typelist</a>; d; d = d-&gt;<a class="code hl_variable" href="classNeighborTypeDomainList.html#a0adbdf895bddcea9295c5ac583c3de75">next</a>) {</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>        <span class="keywordflow">if</span> (0 == <a class="code hl_function" href="Uri_8cc.html#a7b3d400c54dd0ce685ac6c136ae73fe3">matchDomainName</a>(url.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>(), d-&gt;<a class="code hl_variable" href="classNeighborTypeDomainList.html#a81fcb8ff55e7cf638faa0495732fe1c8">domain</a>))</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>            <span class="keywordflow">if</span> (d-&gt;<a class="code hl_variable" href="classNeighborTypeDomainList.html#a61474a3a24696d016422c6aceb71e986">type</a> != <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463ad0a923afe5d043e0b2cebf2bc50400aa">PEER_NONE</a>)</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                <span class="keywordflow">return</span> d-&gt;<a class="code hl_variable" href="classNeighborTypeDomainList.html#a61474a3a24696d016422c6aceb71e986">type</a>;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    }</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a> &amp;&amp; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a4e78fd5911048b90b98d31b280d07584">mcast_siblings</a>)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463a4c68e42a267dc3266e07c1afdeac933a">PEER_SIBLING</a>;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="keywordflow">return</span> p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a>;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>}</div>
</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00138" data-start="{" data-end="}">
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a7552c902985ade500b9f9c1c4c7b54a2">  138</a></span><a class="code hl_function" href="neighbors_8cc.html#a7552c902985ade500b9f9c1c4c7b54a2">peerAllowedToUse</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> * ps)</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>{</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(ps);</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">request</a>;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(request != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>) == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463a4c68e42a267dc3266e07c1afdeac933a">PEER_SIBLING</a>) {</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a> &amp;&amp; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a4e78fd5911048b90b98d31b280d07584">mcast_siblings</a> &amp;&amp;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>                (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a452db2a617d946222557c73d97888918">noCache</a> || request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8f900e1c576cb7ea9b979d7001540025">refresh</a> || request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">loopDetected</a> || request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a0247d4ae2646e09402e31bc09c7ff4c6">needValidation</a>))</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 2, <span class="stringliteral">&quot;multicast-siblings optimization match for &quot;</span> &lt;&lt; *p &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a2c86b2285f5a7f86cd1862e8d7b8fe48">authority</a>());</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a452db2a617d946222557c73d97888918">noCache</a>)</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a8f900e1c576cb7ea9b979d7001540025">refresh</a>)</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>        <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">loopDetected</a>)</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a0247d4ae2646e09402e31bc09c7ff4c6">needValidation</a>)</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    }</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="comment">// CONNECT requests are proxy requests. Not to be forwarded to origin servers.</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="comment">// Unless the destination port matches, in which case we MAY perform a &#39;DIRECT&#39; to this CachePeer.</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a2ba3d3e239dfe40eeeaa71e0c1aaf474">originserver</a> &amp;&amp; request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7">Http::METHOD_CONNECT</a> &amp;&amp; request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">port</a>() != p-&gt;<a class="code hl_variable" href="classCachePeer.html#a40813ba2a7cf12d12260d2dfeb3b1314">http_port</a>)</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a03b69eae2546205189dca431108df849">access</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <a class="code hl_class" href="classACLFilledChecklist.html">ACLFilledChecklist</a> checklist(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a03b69eae2546205189dca431108df849">access</a>, request);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    checklist.<a class="code hl_function" href="classACLFilledChecklist.html#a53bba78d7127a7707cb956a87ff5914f">updateAle</a>(ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a5719e63197c98cac3c0683d664af3b38">al</a>);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    checklist.<a class="code hl_function" href="classACLFilledChecklist.html#ae77611904901fa5f796cdd54ff5be235">syncAle</a>(request, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    <span class="keywordflow">return</span> checklist.<a class="code hl_function" href="classACLChecklist.html#a51ae541a90994e7ed5d11f2b242ac689">fastCheck</a>().<a class="code hl_function" href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">allowed</a>();</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>}</div>
</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span><span class="comment">/* Return TRUE if it is okay to send an ICP request to this CachePeer.   */</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen00178" data-start="{" data-end="}">
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a24fed2aabf197388b6c52b39cdd478d6">  178</a></span><a class="code hl_function" href="neighbors_8cc.html#a24fed2aabf197388b6c52b39cdd478d6">peerWouldBePinged</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> * ps)</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>{</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(ps);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">request</a>;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa21b8498cfb83397082d3891eefa3c60">icp</a>.<a class="code hl_variable" href="structCachePeer_1_1icp__.html#a0fd3ca844136a22d04ad79b3d53b7cb5">port</a> == 0)</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a2070482adb78ba4350ebf0d440ce0320">no_query</a>)</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#af0657aea0b49b487f865790989219873">mcast_responder</a>)</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a> == 0)</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a2fe608047662f759eaf97b7a508af398">background_ping</a> &amp;&amp; (<a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a5efd94cd1a9a2172b65b722e5a301930">last_query</a> &lt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ade552a1fb91b50004f0d1b89a14935f9">backgroundPingRate</a>))</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="comment">/* the case below seems strange, but can happen if the</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span><span class="comment">     * URL host is on the other side of a firewall */</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463a4c68e42a267dc3266e07c1afdeac933a">PEER_SIBLING</a>)</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af8a2c52a07a38ceb366a512eab1d854b">hierarchical</a>)</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a7552c902985ade500b9f9c1c4c7b54a2">peerAllowedToUse</a>(p, ps))</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <span class="comment">/* Ping dead peers every timeout interval */</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a5efd94cd1a9a2172b65b722e5a301930">last_query</a> &gt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#a1bd0123600a9c5ad8828e0fb0747d4c3">deadPeer</a>)</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a6204ffb9f5e7d51413c2514de20d68cd">neighborUp</a>(p))</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>}</div>
</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00218" data-start="{" data-end="}">
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a7cc63794439adcb1426b0954ce936e6c">  218</a></span><a class="code hl_function" href="neighbors_8cc.html#a7cc63794439adcb1426b0954ce936e6c">peerCanOpenMore</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>{</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> effectiveLimit = p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa7370aac507d880d83b9870f7a55808e">max_conn</a> &lt;= 0 ? <a class="code hl_variable" href="globals_8h.html#a85fb5b16080caacaaf9ca40e713fccb9">Squid_MaxFD</a> : p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa7370aac507d880d83b9870f7a55808e">max_conn</a>;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> remaining = effectiveLimit - p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#acb0282c434b70a1c78b2a5f9ea5c4c7e">conn_open</a>;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 7, remaining &lt;&lt; <span class="charliteral">&#39;=&#39;</span> &lt;&lt; effectiveLimit &lt;&lt; <span class="charliteral">&#39;-&#39;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#acb0282c434b70a1c78b2a5f9ea5c4c7e">conn_open</a>);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="keywordflow">return</span> remaining &gt; 0;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>}</div>
</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00227" data-start="{" data-end="}">
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a54bd3bb8e4b86c206fb06f1ff2441428">  227</a></span><a class="code hl_function" href="neighbors_8cc.html#a54bd3bb8e4b86c206fb06f1ff2441428">peerHasConnAvailable</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p)</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>{</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <span class="comment">// Standby connections can be used without opening new connections.</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> standbys = p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a83c6b7cce16925d938d57390147f14d1">pool</a> ? p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a83c6b7cce16925d938d57390147f14d1">pool</a>-&gt;<a class="code hl_function" href="classPconnPool.html#ab2690752a2c7d7083cbe05e62929be6a">count</a>() : 0;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <span class="comment">// XXX: Some idle pconns can be used without opening new connections.</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <span class="comment">// Complication: Idle pconns cannot be reused for some requests.</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> usableIdles = 0;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> available = standbys + usableIdles;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 7, available &lt;&lt; <span class="charliteral">&#39;=&#39;</span> &lt;&lt; standbys &lt;&lt; <span class="charliteral">&#39;+&#39;</span> &lt;&lt; usableIdles);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="keywordflow">return</span> available &gt; 0;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>}</div>
</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00242" data-start="{" data-end="}">
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#abbc058016c442c715870cd2939531481">  242</a></span><a class="code hl_function" href="neighbors_8cc.html#abbc058016c442c715870cd2939531481">peerConnClosed</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p)</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>{</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    --p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#acb0282c434b70a1c78b2a5f9ea5c4c7e">conn_open</a>;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a864f1c60136138c295027c5e66e7b856">waitingForClose</a> &amp;&amp; <a class="code hl_function" href="neighbors_8cc.html#a7cc63794439adcb1426b0954ce936e6c">peerCanOpenMore</a>(p)) {</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a864f1c60136138c295027c5e66e7b856">waitingForClose</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <a class="code hl_function" href="classPeerPoolMgr.html#a9c260a8493349ce76cab309db15cc6e1">PeerPoolMgr::Checkpoint</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a036f9c7fbaa3a6349e9dd9907e1be493">mgr</a>, <span class="stringliteral">&quot;conn closed&quot;</span>);</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    }</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>}</div>
</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="comment">/* Return TRUE if it is okay to send an HTTP request to this CachePeer. */</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen00253" data-start="{" data-end="}">
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">  253</a></span><a class="code hl_function" href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">peerHTTPOkay</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> * ps)</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>{</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a7cc63794439adcb1426b0954ce936e6c">peerCanOpenMore</a>(p) &amp;&amp; !<a class="code hl_function" href="neighbors_8cc.html#a54bd3bb8e4b86c206fb06f1ff2441428">peerHasConnAvailable</a>(p))</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a7552c902985ade500b9f9c1c4c7b54a2">peerAllowedToUse</a>(p, ps))</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a6204ffb9f5e7d51413c2514de20d68cd">neighborUp</a>(p))</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>}</div>
</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen00268" data-start="{" data-end="}">
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a586a59168fdff3449465f60a45eb85a5">  268</a></span><a class="code hl_function" href="neighbors_8cc.html#a586a59168fdff3449465f60a45eb85a5">neighborsCount</a>(<a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *ps)</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>{</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;p: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>())</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a24fed2aabf197388b6c52b39cdd478d6">peerWouldBePinged</a>(p.get(), ps))</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>            ++count;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;neighborsCount: &quot;</span> &lt;&lt; count);</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="keywordflow">return</span> count;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>}</div>
</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span><a class="code hl_class" href="classCachePeer.html">CachePeer</a> *</div>
<div class="foldopen" id="foldopen00282" data-start="{" data-end="}">
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a30f50fd22e7ec7415db78fad8ccb32ee">  282</a></span><a class="code hl_function" href="neighbors_8cc.html#a30f50fd22e7ec7415db78fad8ccb32ee">getFirstUpParent</a>(<a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *ps)</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>{</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(ps);</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">request</a>;</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;peer: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        <span class="keyword">const</span> <span class="keyword">auto</span> p = peer.get();</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a6204ffb9f5e7d51413c2514de20d68cd">neighborUp</a>(p))</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>) != <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463aba32b04d1912b06357198f4603dcdb12">PEER_PARENT</a>)</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">peerHTTPOkay</a>(p, ps))</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;returning &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>        <span class="keywordflow">return</span> p;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    }</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;none found&quot;</span>);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>}</div>
</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span> </div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span><a class="code hl_class" href="classCachePeer.html">CachePeer</a> *</div>
<div class="foldopen" id="foldopen00308" data-start="{" data-end="}">
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a6f432abad2de5f1a61015440c1e39bfc">  308</a></span><a class="code hl_function" href="neighbors_8cc.html#a6f432abad2de5f1a61015440c1e39bfc">getRoundRobinParent</a>(<a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *ps)</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>{</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(ps);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">request</a>;</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span> </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *q = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span> </div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;peer: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        <span class="keyword">const</span> <span class="keyword">auto</span> p = peer.get();</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        <span class="keywordflow">if</span> (!p-&gt;options.roundrobin)</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>) != <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463aba32b04d1912b06357198f4603dcdb12">PEER_PARENT</a>)</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">peerHTTPOkay</a>(p, ps))</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>        <span class="keywordflow">if</span> (p-&gt;weight == 0)</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        <span class="keywordflow">if</span> (q) {</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            <span class="keywordflow">if</span> (p-&gt;weight == q-&gt;<a class="code hl_variable" href="classCachePeer.html#a1104787b07b92c5729f1a19612442774">weight</a>) {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>                <span class="keywordflow">if</span> (q-&gt;<a class="code hl_variable" href="classCachePeer.html#a83cee9f4da7e45b1ada1e06ea80bab97">rr_count</a> &lt; p-&gt;rr_count)</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ((<span class="keywordtype">double</span>) q-&gt;<a class="code hl_variable" href="classCachePeer.html#a83cee9f4da7e45b1ada1e06ea80bab97">rr_count</a> / q-&gt;<a class="code hl_variable" href="classCachePeer.html#a1104787b07b92c5729f1a19612442774">weight</a>) &lt; ((<a class="code hl_variable" href="stub__event_8cc.html#a0c9547f061079f5587b085091da968bc">double</a>) p-&gt;rr_count / p-&gt;weight)) {</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>            }</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>        }</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        q = p;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    }</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    <span class="keywordflow">if</span> (q)</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        ++ q-&gt;<a class="code hl_variable" href="classCachePeer.html#a83cee9f4da7e45b1ada1e06ea80bab97">rr_count</a>;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;returning &quot;</span> &lt;&lt; <a class="code hl_function" href="IoManip_8h.html#afb10fe715d55bc0f31985b3de7269ce0">RawPointer</a>(q).orNil());</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    <span class="keywordflow">return</span> q;</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>}</div>
</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><a class="code hl_class" href="classCachePeer.html">CachePeer</a> *</div>
<div class="foldopen" id="foldopen00350" data-start="{" data-end="}">
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#af4286c6576d68b7a48ad7733947113cb">  350</a></span><a class="code hl_function" href="neighbors_8cc.html#af4286c6576d68b7a48ad7733947113cb">getWeightedRoundRobinParent</a>(<a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *ps)</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>{</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(ps);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">request</a>;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *q = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="keywordtype">int</span> weighted_rtt;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;peer: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        <span class="keyword">const</span> <span class="keyword">auto</span> p = peer.get();</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span> </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        <span class="keywordflow">if</span> (!p-&gt;options.weighted_roundrobin)</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>) != <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463aba32b04d1912b06357198f4603dcdb12">PEER_PARENT</a>)</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">peerHTTPOkay</a>(p, ps))</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        <span class="keywordflow">if</span> (q &amp;&amp; q-&gt;<a class="code hl_variable" href="classCachePeer.html#a83cee9f4da7e45b1ada1e06ea80bab97">rr_count</a> &lt; p-&gt;rr_count)</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        q = p;</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    }</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="keywordflow">if</span> (q &amp;&amp; q-&gt;<a class="code hl_variable" href="classCachePeer.html#a83cee9f4da7e45b1ada1e06ea80bab97">rr_count</a> &gt; 1000000)</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;p: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>            <span class="keywordflow">if</span> (!p-&gt;options.weighted_roundrobin)</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p.get(), request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>) != <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463aba32b04d1912b06357198f4603dcdb12">PEER_PARENT</a>)</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span> </div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>            p-&gt;<a class="code hl_variable" href="classCachePeer.html#a83cee9f4da7e45b1ada1e06ea80bab97">rr_count</a> = 0;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>        }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="keywordflow">if</span> (q) {</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        weighted_rtt = (q-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a7461a008582b379b87e748d77cab0f48">rtt</a> - q-&gt;<a class="code hl_variable" href="classCachePeer.html#a2af7df2cefe385a8be7166043c13e428">basetime</a>) / q-&gt;<a class="code hl_variable" href="classCachePeer.html#a1104787b07b92c5729f1a19612442774">weight</a>;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span> </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        <span class="keywordflow">if</span> (weighted_rtt &lt; 1)</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>            weighted_rtt = 1;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        q-&gt;<a class="code hl_variable" href="classCachePeer.html#a83cee9f4da7e45b1ada1e06ea80bab97">rr_count</a> += weighted_rtt;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;getWeightedRoundRobinParent: weighted_rtt &quot;</span> &lt;&lt; weighted_rtt);</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    }</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;returning &quot;</span> &lt;&lt; <a class="code hl_function" href="IoManip_8h.html#afb10fe715d55bc0f31985b3de7269ce0">RawPointer</a>(q).orNil());</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <span class="keywordflow">return</span> q;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>}</div>
</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00414" data-start="{" data-end="}">
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a0d9b13418092a0d4cde2826ab37911c9">  414</a></span><a class="code hl_function" href="neighbors_8cc.html#a0d9b13418092a0d4cde2826ab37911c9">peerClearRRLoop</a>(<span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>{</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <a class="code hl_function" href="neighbors_8cc.html#a4c86a5e936aa3100d594a5b3d896d076">peerClearRR</a>();</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    <a class="code hl_function" href="event_8cc.html#afbfd8e1e91d5ad60e6124aea52a5f006">eventAdd</a>(<span class="stringliteral">&quot;peerClearRR&quot;</span>, <a class="code hl_function" href="neighbors_8cc.html#a0d9b13418092a0d4cde2826ab37911c9">peerClearRRLoop</a>, data, 5 * 60.0, 0);</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>}</div>
</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00426" data-start="{" data-end="}">
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a7be43fba026f388788f344cfea3e65b2">  426</a></span><a class="code hl_function" href="neighbors_8cc.html#a7be43fba026f388788f344cfea3e65b2">peerClearRRStart</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>{</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <span class="keyword">static</span> <span class="keywordtype">bool</span> event_added = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <span class="keywordflow">if</span> (!event_added) {</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        <a class="code hl_function" href="neighbors_8cc.html#a0d9b13418092a0d4cde2826ab37911c9">peerClearRRLoop</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        event_added=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    }</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>}</div>
</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00443" data-start="{" data-end="}">
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a4c86a5e936aa3100d594a5b3d896d076">  443</a></span><a class="code hl_function" href="neighbors_8cc.html#a4c86a5e936aa3100d594a5b3d896d076">peerClearRR</a>()</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>{</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;p: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>())</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        p-&gt;rr_count = 1;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>}</div>
</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00450" data-start="{" data-end="}">
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a4b7e15e120b5911f84b09d8828ea5530">  450</a></span><a class="code hl_function" href="neighbors_8cc.html#a4b7e15e120b5911f84b09d8828ea5530">peerAlive</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p)</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>{</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a42b7b744d0dc0f53bceefa656cd3db2f">logged_state</a> == <a class="code hl_define" href="defines_8h.html#ab95d04f2bc1e1888b8024635971997a9">PEER_DEAD</a> &amp;&amp; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a6ed7962606a135352c6da45b8f2e15b0">tcp_up</a>) {</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;Detected REVIVED &quot;</span> &lt;&lt; <a class="code hl_function" href="neighbors_8cc.html#a7271928a2f26b9c331bd057c813e9865">neighborTypeStr</a>(p) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>        p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a42b7b744d0dc0f53bceefa656cd3db2f">logged_state</a> = <a class="code hl_define" href="defines_8h.html#a9c62a1d0b8cba00b16026a20553ebb8a">PEER_ALIVE</a>;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>        <a class="code hl_function" href="neighbors_8cc.html#a4c86a5e936aa3100d594a5b3d896d076">peerClearRR</a>();</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a036f9c7fbaa3a6349e9dd9907e1be493">mgr</a>.<a class="code hl_function" href="classCbcPointer.html#a2125df76c0d5eb45bdb8b18e88a71258">valid</a>())</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>            <a class="code hl_function" href="classPeerPoolMgr.html#a9c260a8493349ce76cab309db15cc6e1">PeerPoolMgr::Checkpoint</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a036f9c7fbaa3a6349e9dd9907e1be493">mgr</a>, <span class="stringliteral">&quot;revived peer&quot;</span>);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    }</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#aa5a02f29a28c869be32f108b9efd4e9b">last_reply</a> = <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>;</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a2d8d88c51d813d6007883a30bbe1e3bd">probe_start</a> = 0;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <span class="comment">// TODO: Remove or explain how we could detect an alive peer without IP addresses</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <span class="keywordflow">if</span> (!p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a>)</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        <a class="code hl_function" href="group__IPCacheAPI.html#gae327ee2f13a395e7caeff7cbd783c765">ipcache_nbgethostbyname</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4814933194c07f6802ea7ed1d4ed5333">host</a>, <a class="code hl_variable" href="neighbors_8cc.html#a3269559f810fd86a0d91ffe9f24ef758">peerDNSConfigure</a>, p);</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>}</div>
</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span> </div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span><a class="code hl_class" href="classCachePeer.html">CachePeer</a> *</div>
<div class="foldopen" id="foldopen00469" data-start="{" data-end="}">
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a6dceaa9d65cf631100011d688bc2dcd4">  469</a></span><a class="code hl_function" href="neighbors_8cc.html#a6dceaa9d65cf631100011d688bc2dcd4">getDefaultParent</a>(<a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *ps)</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>{</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(ps);</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">request</a>;</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span> </div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;peer: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <span class="keyword">const</span> <span class="keyword">auto</span> p = peer.get();</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>) != <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463aba32b04d1912b06357198f4603dcdb12">PEER_PARENT</a>)</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span> </div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>        <span class="keywordflow">if</span> (!p-&gt;options.default_parent)</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">peerHTTPOkay</a>(p, ps))</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span> </div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;returning &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span> </div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        <span class="keywordflow">return</span> p;</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    }</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    <span class="comment">// TODO: Refactor similar get*() functions to use our return/reporting style</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;none found&quot;</span>);</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>}</div>
</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00497" data-start="{" data-end="}">
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a776a970d39e7c5550a097dff61df0c14">  497</a></span><a class="code hl_function" href="neighbors_8cc.html#a776a970d39e7c5550a097dff61df0c14">neighborsRegisterWithCacheManager</a>()</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>{</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    <a class="code hl_function" href="namespaceMgr.html#af75bac55ce6610d5102ca58f8d1c1ecf">Mgr::RegisterAction</a>(<span class="stringliteral">&quot;server_list&quot;</span>,</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>                        <span class="stringliteral">&quot;Peer Cache Statistics&quot;</span>,</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>                        <a class="code hl_variable" href="neighbors_8cc.html#a4f2ef0cb3a2344aab8ecd924faf291a5">neighborDumpPeers</a>, 0, 1);</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>}</div>
</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00505" data-start="{" data-end="}">
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a4e9c73e9e7ec8a90679bed5d18b593a7">  505</a></span><a class="code hl_function" href="neighbors_8cc.html#a4e9c73e9e7ec8a90679bed5d18b593a7">neighbors_init</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>{</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *me = <a class="code hl_function" href="tools_8cc.html#a2d24834d9959fb3fa7d4789d055c1768">getMyHostname</a>();</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    <a class="code hl_function" href="neighbors_8cc.html#a776a970d39e7c5550a097dff61df0c14">neighborsRegisterWithCacheManager</a>();</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(<a class="code hl_variable" href="group__ServerProtocolICPInternal2.html#ga670a12c55edf7e7173c4f97c777ec36b">icpIncomingConn</a>)) {</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        <a class="code hl_typedef" href="CachePeers_8h.html#a4af61df3bd9cfba950e8ed1552b9339d">RawCachePeers</a> peersToRemove;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span> </div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;thisPeer: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>            <span class="keywordflow">if</span> (0 != strcmp(thisPeer-&gt;host, me))</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>            <span class="keywordflow">for</span> (<a class="code hl_class" href="classRefCount.html">AnyP::PortCfgPointer</a> s = <a class="code hl_variable" href="PortCfg_8cc.html#ab5fc0d5e05159674db133b2f17786721">HttpPortList</a>; s != <span class="keyword">nullptr</span>; s = s-&gt;next) {</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>                <span class="keywordflow">if</span> (thisPeer-&gt;http_port != s-&gt;s.port())</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;WARNING: Peer looks like this host.&quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>                       <a class="code hl_function" href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a> &lt;&lt; <span class="stringliteral">&quot;Ignoring cache_peer &quot;</span> &lt;&lt; *thisPeer);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>                peersToRemove.push_back(thisPeer.get());</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>                <span class="keywordflow">break</span>; <span class="comment">// avoid warning about (and removing) the same CachePeer twice</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>            }</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        }</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span> </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <span class="keywordflow">while</span> (peersToRemove.size()) {</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>            <span class="keyword">const</span> <span class="keyword">auto</span> p = peersToRemove.back();</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            peersToRemove.pop_back();</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            <a class="code hl_function" href="CachePeers_8cc.html#ad48a5c1aea87248a83eabeea3e43f4e4">DeleteConfigured</a>(p);</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        }</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    }</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    <a class="code hl_function" href="neighbors_8cc.html#a7fdb5c5dd15618d30a7a2cfc23a4ffdc">peerDnsRefreshStart</a>();</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span> </div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    <span class="keyword">const</span> <span class="keyword">auto</span> sep = <a class="code hl_function" href="netdb_8h.html#aef683974bf7dcd4810e4d5ecfe915ff8">xgetservbyname</a>(<span class="stringliteral">&quot;echo&quot;</span>, <span class="stringliteral">&quot;udp&quot;</span>);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    <a class="code hl_variable" href="neighbors_8cc.html#a9b08654d548438ab5cf806d4d605ab6e">echo_port</a> = sep ? ntohs((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>) sep-&gt;s_port) : 7;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>}</div>
</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span> </div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen00544" data-start="{" data-end="}">
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a8327463934cc694a0754ec058fda849b">  544</a></span><a class="code hl_function" href="neighbors_8cc.html#a8327463934cc694a0754ec058fda849b">neighborsUdpPing</a>(<a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> * request,</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>                 <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> * entry,</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>                 <a class="code hl_typedef" href="typedefs_8h.html#a553228e11bbd528f7f0bf2d11b54b0fa">IRCB</a> * callback,</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                 <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *ps,</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>                 <span class="keywordtype">int</span> *exprep,</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>                 <span class="keywordtype">int</span> *timeout)</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>{</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *url = entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a3835284a1cb3623987d557c9754e5ffc">url</a>();</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    <a class="code hl_class" href="classMemObject.html">MemObject</a> *mem = entry-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    <span class="keywordtype">int</span> reqnum = 0;</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    <span class="keywordtype">int</span> flags;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    <span class="keywordtype">int</span> peers_pinged = 0;</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    <span class="keywordtype">int</span> parent_timeout = 0, parent_exprep = 0;</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <span class="keywordtype">int</span> sibling_timeout = 0, sibling_exprep = 0;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <span class="keywordtype">int</span> mcast_timeout = 0, mcast_exprep = 0;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a859f8be49d92d04469051dd6f304e9a8">peers</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a4b622f050f56a5d977471cbdd41fe869">hasDisk</a>());</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    mem-&gt;<a class="code hl_variable" href="classMemObject.html#a8f812f26bacafb538c67d2bf1157ad1b">start_ping</a> = <a class="code hl_variable" href="time_2gadgets_8cc.html#a502612b4a32c5902726b120d713d7952">current_time</a>;</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> </div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    mem-&gt;<a class="code hl_variable" href="classMemObject.html#a18e110d4e91e0ea0c7a8e827dc670935">ping_reply_callback</a> = callback;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a> = ps;</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span> </div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    reqnum = <a class="code hl_function" href="group__ServerProtocolICPAPI.html#ga4d210ff125985b55f52278cc17868ad1">icpSetCacheKey</a>((<span class="keyword">const</span> <a class="code hl_typedef" href="store_2forward_8h.html#ab1424e1b13666cc28f4c5cb05f8c8305">cache_key</a> *)entry-&gt;<a class="code hl_variable" href="classhash__link.html#ae8c6b512f09a15a32ce953deb2e58ffb">key</a>);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    <span class="keyword">const</span> <span class="keyword">auto</span> savedContext = <a class="code hl_function" href="classCodeContext.html#a13251c00d03b5a9cb9f3b164f0154969">CodeContext::Current</a>();</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a859f8be49d92d04469051dd6f304e9a8">peers</a>-&gt;<a class="code hl_function" href="classCachePeers.html#ab43ed6e7a0d89c588f80629dda0fd700">size</a>(); ++i) {</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>        <span class="keyword">const</span> <span class="keyword">auto</span> p = &amp;<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a859f8be49d92d04469051dd6f304e9a8">peers</a>-&gt;<a class="code hl_function" href="classCachePeers.html#a670f2a5d2223e467937af6feaff1ea81">nextPeerToPing</a>(i);</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        <a class="code hl_function" href="classCodeContext.html#aeed1567dd2fb1c97eb3fa3f10df4622e">CodeContext::Reset</a>(p-&gt;probeCodeContext);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;candidate: &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a24fed2aabf197388b6c52b39cdd478d6">peerWouldBePinged</a>(p, ps))</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>            <span class="keywordflow">continue</span>;       <span class="comment">/* next CachePeer */</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        ++peers_pinged;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span> </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 4, <span class="stringliteral">&quot;pinging cache_peer &quot;</span> &lt;&lt; *p &lt;&lt; <span class="stringliteral">&quot; for &#39;&quot;</span> &lt;&lt; url &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span> </div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;neighborsUdpPing: key = &#39;&quot;</span> &lt;&lt; entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a88e8fcd41e9d2d0c24ea68daa9a4eb57">getMD5Text</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span> </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;neighborsUdpPing: reqnum = &quot;</span> &lt;&lt; reqnum);</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>        <span class="keywordflow">if</span> (p-&gt;options.htcp &amp;&amp; !p-&gt;options.htcp_only_clr) {</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f4e2240c8dc2d56abe34caef997beb">Port</a>.<a class="code hl_variable" href="classSquidConfig.html#ae4b11be553f50f26ce088bc4ab7d0c84">htcp</a> &lt;= 0) {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: HTCP is disabled! Cannot send HTCP request to peer.&quot;</span>);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            }</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span> </div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;neighborsUdpPing: sending HTCP query&quot;</span>);</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="htcp_8cc.html#a34bd9e78778bc1a1a2bf78895d3d0e43">htcpQuery</a>(entry, request, p) &lt;= 0)</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>                <span class="keywordflow">continue</span>; <span class="comment">// unable to send.</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f4e2240c8dc2d56abe34caef997beb">Port</a>.<a class="code hl_variable" href="classSquidConfig.html#aa11776521bdbbd1348221ea9d7237907">icp</a> &lt;= 0 || !<a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(<a class="code hl_variable" href="group__ServerProtocolICPInternal2.html#ga27833f39d27c05bc1f06c4bcf25ef9fc">icpOutgoingConn</a>)) {</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: ICP is disabled! Cannot send ICP request to peer.&quot;</span>);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>                <span class="keywordflow">if</span> (p-&gt;type == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a>)</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>                    <a class="code hl_function" href="multicast_8cc.html#aae50610fcb12fde0d35ae39cfd73a7e1">mcastSetTtl</a>(<a class="code hl_variable" href="group__ServerProtocolICPInternal2.html#ga27833f39d27c05bc1f06c4bcf25ef9fc">icpOutgoingConn</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">fd</a>, p-&gt;mcast.ttl);</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>                <span class="keywordflow">if</span> (p-&gt;icp.port == <a class="code hl_variable" href="neighbors_8cc.html#a9b08654d548438ab5cf806d4d605ab6e">echo_port</a>) {</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>                    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 4, <span class="stringliteral">&quot;neighborsUdpPing: Looks like a dumb cache, send DECHO ping&quot;</span>);</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>                    <span class="comment">// TODO: Get ALE from callback_data if possible.</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>                    <a class="code hl_function" href="group__ServerProtocolICPAPI.html#ga53e8fe6736b5dfae15ba459a4e8c3376">icpCreateAndSend</a>(<a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a16755cd560859f4b80fc3268d86f1377">ICP_DECHO</a>, 0, url, reqnum, 0,</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>                                     <a class="code hl_variable" href="group__ServerProtocolICPInternal2.html#ga27833f39d27c05bc1f06c4bcf25ef9fc">icpOutgoingConn</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">fd</a>, p-&gt;in_addr, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>                    flags = 0;</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a9cd83a8e2feaa63684c1b820821d5093">query_icmp</a>)</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                        <span class="keywordflow">if</span> (p-&gt;icp.version == <a class="code hl_define" href="defines_8h.html#abe101f3231226dd50b7e5db7852191e0">ICP_VERSION_2</a>)</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>                            flags |= <a class="code hl_define" href="defines_8h.html#a7cc174d6a17cf73325615e9cae5751c6">ICP_FLAG_SRC_RTT</a>;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>                    <span class="comment">// TODO: Get ALE from callback_data if possible.</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>                    <a class="code hl_function" href="group__ServerProtocolICPAPI.html#ga53e8fe6736b5dfae15ba459a4e8c3376">icpCreateAndSend</a>(<a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a5c6250115ccf383ec8ad97bc82abd5de">ICP_QUERY</a>, flags, url, reqnum, 0,</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                                     <a class="code hl_variable" href="group__ServerProtocolICPInternal2.html#ga27833f39d27c05bc1f06c4bcf25ef9fc">icpOutgoingConn</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">fd</a>, p-&gt;in_addr, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                }</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>            }</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        }</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        ++ p-&gt;stats.pings_sent;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        <span class="keywordflow">if</span> (p-&gt;type == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a>) {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>            mcast_exprep += p-&gt;mcast.n_replies_expected;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>            mcast_timeout += (p-&gt;stats.rtt * p-&gt;mcast.n_replies_expected);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a6204ffb9f5e7d51413c2514de20d68cd">neighborUp</a>(p)) {</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>            <span class="comment">/* its alive, expect a reply from it */</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p, request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>) == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463aba32b04d1912b06357198f4603dcdb12">PEER_PARENT</a>) {</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>                ++parent_exprep;</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>                parent_timeout += p-&gt;stats.rtt;</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>                ++sibling_exprep;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>                sibling_timeout += p-&gt;stats.rtt;</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>            }</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>            <span class="comment">/* Neighbor is dead; ping it anyway, but don&#39;t expect a reply */</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>            <span class="comment">/* log it once at the threshold */</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>            <span class="keywordflow">if</span> (p-&gt;stats.logged_state == <a class="code hl_define" href="defines_8h.html#a9c62a1d0b8cba00b16026a20553ebb8a">PEER_ALIVE</a>) {</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;Detected DEAD &quot;</span> &lt;&lt; <a class="code hl_function" href="neighbors_8cc.html#a7271928a2f26b9c331bd057c813e9865">neighborTypeStr</a>(p) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>                p-&gt;stats.logged_state = <a class="code hl_define" href="defines_8h.html#ab95d04f2bc1e1888b8024635971997a9">PEER_DEAD</a>;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>            }</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>        }</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span> </div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>        p-&gt;stats.last_query = <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span> </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span><span class="comment">         * keep probe_start == 0 for a multicast CachePeer,</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span><span class="comment">         * so neighborUp() never says this CachePeer is dead.</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span><span class="comment">         */</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span> </div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>        <span class="keywordflow">if</span> ((p-&gt;type != <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a>) &amp;&amp; (p-&gt;stats.probe_start == 0))</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>            p-&gt;stats.probe_start = <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>;</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    }</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>    <a class="code hl_function" href="classCodeContext.html#aeed1567dd2fb1c97eb3fa3f10df4622e">CodeContext::Reset</a>(savedContext);</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span> </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="comment">     * How many replies to expect?</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="comment">     */</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>    *exprep = parent_exprep + sibling_exprep + mcast_exprep;</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span> </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span><span class="comment">     * If there is a configured timeout, use it</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span><span class="comment">     */</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#ad7192b1392b8c86408ef2ed76ea18bc6">icp_query</a>)</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        *timeout = <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#ad7192b1392b8c86408ef2ed76ea18bc6">icp_query</a>;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        <span class="keywordflow">if</span> (*exprep &gt; 0) {</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>            <span class="keywordflow">if</span> (parent_exprep)</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>                *timeout = 2 * parent_timeout / parent_exprep;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mcast_exprep)</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>                *timeout = 2 * mcast_timeout / mcast_exprep;</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>                *timeout = 2 * sibling_timeout / sibling_exprep;</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>        } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>            *timeout = 2000;    <span class="comment">/* 2 seconds */</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#a837a34c05e214cee3ef0a2c17285b82a">icp_query_max</a>)</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>            <span class="keywordflow">if</span> (*timeout &gt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#a837a34c05e214cee3ef0a2c17285b82a">icp_query_max</a>)</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                *timeout = <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#a837a34c05e214cee3ef0a2c17285b82a">icp_query_max</a>;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>        <span class="keywordflow">if</span> (*timeout &lt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#a929d4ff2de22582634f37e2523f73d20">icp_query_min</a>)</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>            *timeout = <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#a929d4ff2de22582634f37e2523f73d20">icp_query_min</a>;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>    }</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span> </div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <span class="keywordflow">return</span> peers_pinged;</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>}</div>
</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span><span class="comment">/* lookup the digest of a given CachePeer */</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span><a class="code hl_enumeration" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45">lookup_t</a></div>
<div class="foldopen" id="foldopen00703" data-start="{" data-end="}">
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#aa684bf58dc62515bea74168b567213fb">  703</a></span><a class="code hl_function" href="neighbors_8cc.html#aa684bf58dc62515bea74168b567213fb">peerDigestLookup</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> * ps)</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>{</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span><span class="preprocessor">#if USE_CACHE_DIGESTS</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(ps);</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">request</a>;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(request);</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(p);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;cache_peer &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <span class="comment">/* does the peeer have a valid digest? */</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    <span class="keywordflow">if</span> (!p-&gt;<a class="code hl_variable" href="classCachePeer.html#a64e1e876fa08746da1b79e86c2d6d813">digest</a>) {</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;peerDigestLookup: gone!&quot;</span>);</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e">LOOKUP_NONE</a>;</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_function" href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">peerHTTPOkay</a>(p, ps)) {</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;peerDigestLookup: !peerHTTPOkay&quot;</span>);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e">LOOKUP_NONE</a>;</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!p-&gt;<a class="code hl_variable" href="classCachePeer.html#a64e1e876fa08746da1b79e86c2d6d813">digest</a>-&gt;<a class="code hl_variable" href="classPeerDigest.html#ad2f08cb6eb573ad26f71187d597af2e9">flags</a>.<a class="code hl_variable" href="classPeerDigest.html#aa9a3df5f91ebee81d092046902dab9df">needed</a>) {</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;peerDigestLookup: note need&quot;</span>);</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>        <a class="code hl_function" href="peer__digest_8cc.html#ac02c7896e61987e7f1482f789ae81d09">peerDigestNeeded</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a64e1e876fa08746da1b79e86c2d6d813">digest</a>);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e">LOOKUP_NONE</a>;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!p-&gt;<a class="code hl_variable" href="classCachePeer.html#a64e1e876fa08746da1b79e86c2d6d813">digest</a>-&gt;<a class="code hl_variable" href="classPeerDigest.html#ad2f08cb6eb573ad26f71187d597af2e9">flags</a>.<a class="code hl_variable" href="classPeerDigest.html#a59a4907a5a66f391b1659694673251bc">usable</a>) {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;peerDigestLookup: !ready &amp;&amp; &quot;</span> &lt;&lt; (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a64e1e876fa08746da1b79e86c2d6d813">digest</a>-&gt;<a class="code hl_variable" href="classPeerDigest.html#ad2f08cb6eb573ad26f71187d597af2e9">flags</a>.<a class="code hl_variable" href="classPeerDigest.html#a425fece3a08f57e0f794cf006b1c9112">requested</a> ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;!&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;requested&quot;</span>);</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e">LOOKUP_NONE</a>;</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    }</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;OK to lookup cache_peer &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a64e1e876fa08746da1b79e86c2d6d813">digest</a>-&gt;<a class="code hl_variable" href="classPeerDigest.html#ad4120741fa9efb6fa9584d0ff2c402de">cd</a>);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    <span class="comment">/* does digest predict a hit? */</span></div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>    <span class="keywordflow">if</span> (!p-&gt;<a class="code hl_variable" href="classCachePeer.html#a64e1e876fa08746da1b79e86c2d6d813">digest</a>-&gt;<a class="code hl_variable" href="classPeerDigest.html#ad4120741fa9efb6fa9584d0ff2c402de">cd</a>-&gt;<a class="code hl_function" href="classCacheDigest.html#ac90e2c408e8506147161e55be8034196">contains</a>(<a class="code hl_function" href="store__key__md5_8cc.html#a26af53797f468930492b0d33f993feac">storeKeyPublicByRequest</a>(request)))</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45a63a9bb33f90ed77a78376604d01020e5">LOOKUP_MISS</a>;</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span> </div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;HIT for cache_peer &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span> </div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45a8dc1a097130703bb4c1487b03935585d">LOOKUP_HIT</a>;</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    (void)p;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    (void)ps;</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span> </div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e">LOOKUP_NONE</a>;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>}</div>
</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span> </div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="comment">/* select best CachePeer based on cache digests */</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span><a class="code hl_class" href="classCachePeer.html">CachePeer</a> *</div>
<div class="foldopen" id="foldopen00749" data-start="{" data-end="}">
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a83e6621723b8edf8ca244558fa453d19">  749</a></span><a class="code hl_function" href="neighbors_8cc.html#a83e6621723b8edf8ca244558fa453d19">neighborsDigestSelect</a>(<a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> *ps)</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>{</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *best_p = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span><span class="preprocessor">#if USE_CACHE_DIGESTS</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(ps);</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = ps-&gt;<a class="code hl_variable" href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">request</a>;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>    <span class="keywordtype">int</span> best_rtt = 0;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    <span class="keywordtype">int</span> choice_count = 0;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    <span class="keywordtype">int</span> ichoice_count = 0;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>    <span class="keywordtype">int</span> p_rtt;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span> </div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a859f8be49d92d04469051dd6f304e9a8">peers</a>)</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span> </div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af8a2c52a07a38ceb366a512eab1d854b">hierarchical</a>)</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <a class="code hl_function" href="store__key__md5_8cc.html#a26af53797f468930492b0d33f993feac">storeKeyPublicByRequest</a>(request);</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span> </div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a859f8be49d92d04469051dd6f304e9a8">peers</a>-&gt;<a class="code hl_function" href="classCachePeers.html#ab43ed6e7a0d89c588f80629dda0fd700">size</a>(); ++i) {</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>        <span class="keyword">const</span> <span class="keyword">auto</span> p = &amp;<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a859f8be49d92d04469051dd6f304e9a8">peers</a>-&gt;<a class="code hl_function" href="classCachePeers.html#a670f2a5d2223e467937af6feaff1ea81">nextPeerToPing</a>(i);</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>        <span class="keyword">const</span> <span class="keyword">auto</span> lookup = <a class="code hl_function" href="neighbors_8cc.html#aa684bf58dc62515bea74168b567213fb">peerDigestLookup</a>(p, ps);</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span> </div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>        <span class="keywordflow">if</span> (lookup == <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e">LOOKUP_NONE</a>)</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        ++choice_count;</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>        <span class="keywordflow">if</span> (lookup == <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45a63a9bb33f90ed77a78376604d01020e5">LOOKUP_MISS</a>)</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span> </div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>        p_rtt = <a class="code hl_function" href="net__db_8cc.html#a36bf2a8653a5872a61579b0943a7045d">netdbHostRtt</a>(p-&gt;host);</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span> </div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 5, <span class="stringliteral">&quot;cache_peer &quot;</span> &lt;&lt; *p &lt;&lt; <span class="stringliteral">&quot; rtt: &quot;</span> &lt;&lt; p_rtt);</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span> </div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>        <span class="comment">/* is this CachePeer better than others in terms of rtt ? */</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>        <span class="keywordflow">if</span> (!best_p || (p_rtt &amp;&amp; p_rtt &lt; best_rtt)) {</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            best_p = p;</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>            best_rtt = p_rtt;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span> </div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>            <span class="keywordflow">if</span> (p_rtt)      <span class="comment">/* informative choice (aka educated guess) */</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>                ++ichoice_count;</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span> </div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 4, <span class="stringliteral">&quot;cache_peer &quot;</span> &lt;&lt; *p &lt;&lt; <span class="stringliteral">&quot; leads with rtt &quot;</span> &lt;&lt; best_rtt);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        }</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 4, <span class="stringliteral">&quot;neighborsDigestSelect: choices: &quot;</span> &lt;&lt; choice_count &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; ichoice_count &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    <a class="code hl_function" href="neighbors_8cc.html#a1e411bf651fa9fdc3e4b0a97de8fe143">peerNoteDigestLookup</a>(request, best_p,</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>                         best_p ? <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45a8dc1a097130703bb4c1487b03935585d">LOOKUP_HIT</a> : (choice_count ? <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45a63a9bb33f90ed77a78376604d01020e5">LOOKUP_MISS</a> : <a class="code hl_enumvalue" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e">LOOKUP_NONE</a>));</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#a86cabf331cbdd5a5e70245013241adf9">n_choices</a> = choice_count;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#a1b3cc298994ca401fef84bda02daff4a">n_ichoices</a> = ichoice_count;</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    (void)ps;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span> </div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>    <span class="keywordflow">return</span> best_p;</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>}</div>
</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span> </div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00811" data-start="{" data-end="}">
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a1e411bf651fa9fdc3e4b0a97de8fe143">  811</a></span><a class="code hl_function" href="neighbors_8cc.html#a1e411bf651fa9fdc3e4b0a97de8fe143">peerNoteDigestLookup</a>(<a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> * request, <a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <a class="code hl_enumeration" href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45">lookup_t</a> lookup)</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>{</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span><span class="preprocessor">#if USE_CACHE_DIGESTS</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>    <span class="keywordflow">if</span> (p)</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>        strncpy(request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#a9fb0537096678e05f7dc8aac3ba45712">cd_host</a>, p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4814933194c07f6802ea7ed1d4ed5333">host</a>, <span class="keyword">sizeof</span>(request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#a9fb0537096678e05f7dc8aac3ba45712">cd_host</a>)-1);</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        *request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#a9fb0537096678e05f7dc8aac3ba45712">cd_host</a> = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#a8b87db00f544adccbd5ccca6f3909a0a">cd_lookup</a> = lookup;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 4, <span class="stringliteral">&quot;cache_peer &quot;</span> &lt;&lt; <a class="code hl_function" href="IoManip_8h.html#afb10fe715d55bc0f31985b3de7269ce0">RawPointer</a>(p).orNil() &lt;&lt; <span class="stringliteral">&quot;, lookup: &quot;</span> &lt;&lt; <a class="code hl_variable" href="lookup__t_8h.html#a5b9bbc54b0caf77e33da07034f9fca8b">lookup_t_str</a>[lookup]);</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    (void)request;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    (void)p;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>    (void)lookup;</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>}</div>
</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span> </div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00829" data-start="{" data-end="}">
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a9f2a764443af2685e1e71af8e474bc83">  829</a></span><a class="code hl_function" href="neighbors_8cc.html#a9f2a764443af2685e1e71af8e474bc83">neighborAlive</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <span class="keyword">const</span> <a class="code hl_class" href="classMemObject.html">MemObject</a> *, <span class="keyword">const</span> <a class="code hl_class" href="classicp__common__t.html">icp_common_t</a> * header)</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>{</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>    <a class="code hl_function" href="neighbors_8cc.html#a4b7e15e120b5911f84b09d8828ea5530">peerAlive</a>(p);</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>    ++ p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#aa61d3169817932801f3ed763d01cd1a1">pings_acked</a>;</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span> </div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>    <span class="keywordflow">if</span> ((<a class="code hl_enumeration" href="group__ServerProtocolICPAPI.html#ga6d172cc0273c7eb44afd1351198704c6">icp_opcode</a>) header-&gt;<a class="code hl_variable" href="classicp__common__t.html#aafb31bceebb70d4463d29aa9866b6b15">opcode</a> &lt;= <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a6b90e3137805b84a36b36fa9016b0a37">ICP_END</a>)</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        ++ p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa21b8498cfb83397082d3891eefa3c60">icp</a>.<a class="code hl_variable" href="structCachePeer_1_1icp__.html#a780ce4f235b5682ab958fb897dadd14a">counts</a>[header-&gt;<a class="code hl_variable" href="classicp__common__t.html#aafb31bceebb70d4463d29aa9866b6b15">opcode</a>];</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span> </div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa21b8498cfb83397082d3891eefa3c60">icp</a>.<a class="code hl_variable" href="structCachePeer_1_1icp__.html#a60ce43773ae66cf79adbffe0f0e02221">version</a> = (<a class="code hl_variable" href="stub__fd_8cc.html#a35fed7109d24712d6b86b6134537c7bd">int</a>) header-&gt;<a class="code hl_variable" href="classicp__common__t.html#a30e6fde4cdb580e70b438508311a9f9e">version</a>;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>}</div>
</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span> </div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00841" data-start="{" data-end="}">
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a4706bdd6d749bb72a80d49021c62d99f">  841</a></span><a class="code hl_function" href="neighbors_8cc.html#a4706bdd6d749bb72a80d49021c62d99f">neighborUpdateRtt</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <a class="code hl_class" href="classMemObject.html">MemObject</a> * mem)</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>{</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    <span class="keywordtype">int</span> rtt, rtt_av_factor;</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    <span class="keywordflow">if</span> (!mem)</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span> </div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    <span class="keywordflow">if</span> (!mem-&gt;<a class="code hl_variable" href="classMemObject.html#a8f812f26bacafb538c67d2bf1157ad1b">start_ping</a>.tv_sec)</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span> </div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>    rtt = <a class="code hl_function" href="time_2gadgets_8cc.html#af7a3c9de59180267762f047ffd42e503">tvSubMsec</a>(mem-&gt;<a class="code hl_variable" href="classMemObject.html#a8f812f26bacafb538c67d2bf1157ad1b">start_ping</a>, <a class="code hl_variable" href="time_2gadgets_8cc.html#a502612b4a32c5902726b120d713d7952">current_time</a>);</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span> </div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    <span class="keywordflow">if</span> (rtt &lt; 1 || rtt &gt; 10000)</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span> </div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    rtt_av_factor = <a class="code hl_define" href="defines_8h.html#adb5ef0088b5947951fab1bd4ca7c7652">RTT_AV_FACTOR</a>;</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span> </div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#af2cf8e8f51c4eba604ec3385a62ea59f">weighted_roundrobin</a>)</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>        rtt_av_factor = <a class="code hl_define" href="defines_8h.html#a11b068a3943fb56b10a37b25d8cdb2c8">RTT_BACKGROUND_AV_FACTOR</a>;</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span> </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a7461a008582b379b87e748d77cab0f48">rtt</a> = <a class="code hl_function" href="namespaceMath.html#ae00e8f5a2d22e3eb488bfa26d5848a7c">Math::intAverage</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a7461a008582b379b87e748d77cab0f48">rtt</a>, rtt, p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#aa61d3169817932801f3ed763d01cd1a1">pings_acked</a>, rtt_av_factor);</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>}</div>
</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span> </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00866" data-start="{" data-end="}">
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a2959da26b2b78dcef9887f71e725aa15">  866</a></span><a class="code hl_function" href="neighbors_8cc.html#a2959da26b2b78dcef9887f71e725aa15">neighborAliveHtcp</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <span class="keyword">const</span> <a class="code hl_class" href="classMemObject.html">MemObject</a> *, <span class="keyword">const</span> <a class="code hl_class" href="classHtcpReplyData.html">HtcpReplyData</a> * htcp)</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>{</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>    <a class="code hl_function" href="neighbors_8cc.html#a4b7e15e120b5911f84b09d8828ea5530">peerAlive</a>(p);</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    ++ p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#aa61d3169817932801f3ed763d01cd1a1">pings_acked</a>;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    ++ p-&gt;<a class="code hl_variable" href="classCachePeer.html#ab6c74c1f4da3944782c5bdfa8f83537a">htcp</a>.<a class="code hl_variable" href="classCachePeer.html#abbedb65b25cbc4601b52d2cb5816bc54">counts</a>[htcp-&gt;<a class="code hl_variable" href="classHtcpReplyData.html#a5f0eec0d7628cc265518e80c6a23b2ac">hit</a> ? 1 : 0];</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#ab6c74c1f4da3944782c5bdfa8f83537a">htcp</a>.<a class="code hl_variable" href="classCachePeer.html#ae976c3cef591d0264017bef17953fbb4">version</a> = htcp-&gt;<a class="code hl_variable" href="classHtcpReplyData.html#a38d8834c72b5f3055df08a522f4133f4">version</a>;</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>}</div>
</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span> </div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span> </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00877" data-start="{" data-end="}">
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">  877</a></span><a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p)</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>{</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>    <span class="keywordflow">if</span> (p == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span> </div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>    ++ p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#adefabca74b91fafd268b85890e7bdf70">ignored_replies</a>;</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span> </div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>    ++<a class="code hl_variable" href="neighbors_8cc.html#a7d9b8b2006eddbf1058f8cd894f28798">NLateReplies</a>;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>}</div>
</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span> </div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00888" data-start="{" data-end="}">
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#ac4b350a9f6eac0a4bf823ec15126bb66">  888</a></span><a class="code hl_function" href="neighbors_8cc.html#ac4b350a9f6eac0a4bf823ec15126bb66">neighborIgnoreNonPeer</a>(<span class="keyword">const</span> <a class="code hl_class" href="classIp_1_1Address.html">Ip::Address</a> &amp;from, <a class="code hl_enumeration" href="group__ServerProtocolICPAPI.html#ga6d172cc0273c7eb44afd1351198704c6">icp_opcode</a> opcode)</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>{</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>    <span class="keyword">static</span> uint64_t ignoredReplies = 0;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="int_8cc.html#a447b20e752a00e512f1ead308f55db38">isPowTen</a>(++ignoredReplies)) {</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;WARNING: Ignored &quot;</span> &lt;&lt; ignoredReplies &lt;&lt; <span class="stringliteral">&quot; ICP replies from non-peers&quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>               <a class="code hl_function" href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a> &lt;&lt; <span class="stringliteral">&quot;last seen non-peer source address: &quot;</span> &lt;&lt; from &lt;&lt;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>               <a class="code hl_function" href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a> &lt;&lt; <span class="stringliteral">&quot;last seen ICP reply opcode: &quot;</span> &lt;&lt; <a class="code hl_variable" href="icp__opcode_8h.html#ac1431af6f906aacf2b4af78e1474d619">icp_opcode_str</a>[opcode]);</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    }</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>}</div>
</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span> </div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span><span class="comment">/* ignoreMulticastReply</span></div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span><span class="comment"> *</span></div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span><span class="comment"> * * We want to ignore replies from multicast peers if the</span></div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span><span class="comment"> * * cache_host_domain rules would normally prevent the CachePeer</span></div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span><span class="comment"> * * from being used</span></div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span><span class="comment"> */</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen00905" data-start="{" data-end="}">
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#ac9518f7ddccf53e35d2e2f6adfc403f1">  905</a></span><a class="code hl_function" href="neighbors_8cc.html#ac9518f7ddccf53e35d2e2f6adfc403f1">ignoreMulticastReply</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> * ps)</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>{</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    <span class="keywordflow">if</span> (p == <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span> </div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    <span class="keywordflow">if</span> (!p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#af0657aea0b49b487f865790989219873">mcast_responder</a>)</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">peerHTTPOkay</a>(p, ps))</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span> </div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>}</div>
</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span> </div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00927" data-start="{" data-end="}">
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#ad3b48714a55e560882a1d417c1153c36">  927</a></span><a class="code hl_function" href="neighbors_8cc.html#ad3b48714a55e560882a1d417c1153c36">neighborsUdpAck</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="store_2forward_8h.html#ab1424e1b13666cc28f4c5cb05f8c8305">cache_key</a> * key, <a class="code hl_class" href="classicp__common__t.html">icp_common_t</a> * header, <span class="keyword">const</span> <a class="code hl_class" href="classIp_1_1Address.html">Ip::Address</a> &amp;from)</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>{</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>    <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *entry;</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>    <a class="code hl_class" href="classMemObject.html">MemObject</a> *mem = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>    <a class="code hl_enumeration" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463">peer_t</a> ntype = <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463ad0a923afe5d043e0b2cebf2bc50400aa">PEER_NONE</a>;</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>    <a class="code hl_enumeration" href="group__ServerProtocolICPAPI.html#ga6d172cc0273c7eb44afd1351198704c6">icp_opcode</a> opcode = (<a class="code hl_enumeration" href="group__ServerProtocolICPAPI.html#ga6d172cc0273c7eb44afd1351198704c6">icp_opcode</a>) header-&gt;<a class="code hl_variable" href="classicp__common__t.html#aafb31bceebb70d4463d29aa9866b6b15">opcode</a>;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span> </div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 6, <span class="stringliteral">&quot;neighborsUdpAck: opcode &quot;</span> &lt;&lt; opcode &lt;&lt; <span class="stringliteral">&quot; &#39;&quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span> </div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>    <span class="keywordflow">if</span> ((entry = <a class="code hl_function" href="namespaceStore.html#a0151d620409db8bd3af40e3570a18f8c">Store::Root</a>().findCallbackXXX(key)))</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>        mem = entry-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>;</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span> </div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>    <span class="keywordflow">if</span> ((p = <a class="code hl_function" href="neighbors_8cc.html#a35194ab936916470ce011e25834b6572">whichPeer</a>(from)))</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>        <a class="code hl_function" href="neighbors_8cc.html#a9f2a764443af2685e1e71af8e474bc83">neighborAlive</a>(p, mem, header);</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span> </div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>    <span class="keywordflow">if</span> (opcode &gt; <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a6b90e3137805b84a36b36fa9016b0a37">ICP_END</a>)</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span> </div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *opcode_d = <a class="code hl_variable" href="icp__opcode_8h.html#ac1431af6f906aacf2b4af78e1474d619">icp_opcode_str</a>[opcode];</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span> </div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    <span class="keywordflow">if</span> (p)</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        <a class="code hl_function" href="neighbors_8cc.html#a4706bdd6d749bb72a80d49021c62d99f">neighborUpdateRtt</a>(p, mem);</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span> </div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>    <span class="comment">/* Does the entry exist? */</span></div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordflow">if</span> (<span class="keyword">nullptr</span> == entry) {</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(12, 3, <span class="stringliteral">&quot;neighborsUdpAck: Cache key &#39;&quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot;&#39; not found&quot;</span>);</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>    }</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>    <span class="comment">/* check if someone is already fetching it */</span></div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(entry-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462ae584c58365523cce1a435dd86165d7a8">ENTRY_DISPATCHED</a>)) {</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;neighborsUdpAck: &#39;&quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot;&#39; already being fetched.&quot;</span>);</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    }</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span> </div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    <span class="keywordflow">if</span> (mem == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 2, <span class="stringliteral">&quot;Ignoring &quot;</span> &lt;&lt; opcode_d &lt;&lt; <span class="stringliteral">&quot; for missing mem_obj: &quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key));</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    }</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span> </div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>    <span class="keywordflow">if</span> (entry-&gt;<a class="code hl_variable" href="classStoreEntry.html#abc675c0ac6ddb7ddd97d2159439d74ac">ping_status</a> != <a class="code hl_enumvalue" href="enums_8h.html#a4bd207d3fdbf20f48de074b84f74563ea15e97486bd90d641808bbc2eb177cf94">PING_WAITING</a>) {</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 2, <span class="stringliteral">&quot;neighborsUdpAck: Late &quot;</span> &lt;&lt; opcode_d &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key));</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    }</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span> </div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    <span class="keywordflow">if</span> (!entry-&gt;<a class="code hl_function" href="classStoreEntry.html#a28ae41d1feaa7e59d3714b98fe8fdab1">locked</a>()) {</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>        <span class="comment">// TODO: many entries are unlocked; why is this reported at level 1?</span></div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(12, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;neighborsUdpAck: &#39;&quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot;&#39; has no locks&quot;</span>);</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>    }</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span> </div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>    <span class="keywordflow">if</span> (!mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>) {</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(12, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: Squid BUG: missing ICP callback data for &quot;</span> &lt;&lt; *entry);</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>    }</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, opcode_d &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot; from &quot;</span> &lt;&lt; <a class="code hl_function" href="IoManip_8h.html#afb10fe715d55bc0f31985b3de7269ce0">RawPointer</a>(p).orNil(<span class="stringliteral">&quot;source&quot;</span>));</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span> </div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    <span class="keywordflow">if</span> (p) {</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>        ntype = <a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p, mem-&gt;<a class="code hl_variable" href="classMemObject.html#a38fde17e9fa64949670b7a25e0735e64">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>);</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    }</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span> </div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#ac9518f7ddccf53e35d2e2f6adfc403f1">ignoreMulticastReply</a>(p, mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>)) {</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6abef39c1952136e11de121425150e3f8d">ICP_MISS</a>) {</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>        <span class="keywordflow">if</span> (p == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>            <a class="code hl_function" href="neighbors_8cc.html#ac4b350a9f6eac0a4bf823ec15126bb66">neighborIgnoreNonPeer</a>(from, opcode);</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>            mem-&gt;<a class="code hl_variable" href="classMemObject.html#a18e110d4e91e0ea0c7a8e827dc670935">ping_reply_callback</a>(p, ntype, <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7accacc70e659b8153a808b7c0da5de0428ea">AnyP::PROTO_ICP</a>, header, mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>);</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>        }</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6ae976d3e0d00dd042e09fc832b7d2c5df">ICP_HIT</a>) {</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>        <span class="keywordflow">if</span> (p == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>            <a class="code hl_function" href="neighbors_8cc.html#ac4b350a9f6eac0a4bf823ec15126bb66">neighborIgnoreNonPeer</a>(from, opcode);</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>            header-&gt;<a class="code hl_variable" href="classicp__common__t.html#aafb31bceebb70d4463d29aa9866b6b15">opcode</a> = <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6ae976d3e0d00dd042e09fc832b7d2c5df">ICP_HIT</a>;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>            mem-&gt;<a class="code hl_variable" href="classMemObject.html#a18e110d4e91e0ea0c7a8e827dc670935">ping_reply_callback</a>(p, ntype, <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7accacc70e659b8153a808b7c0da5de0428ea">AnyP::PROTO_ICP</a>, header, mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>);</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>        }</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a16755cd560859f4b80fc3268d86f1377">ICP_DECHO</a>) {</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>        <span class="keywordflow">if</span> (p == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>            <a class="code hl_function" href="neighbors_8cc.html#ac4b350a9f6eac0a4bf823ec15126bb66">neighborIgnoreNonPeer</a>(from, opcode);</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ntype == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463a4c68e42a267dc3266e07c1afdeac933a">PEER_SIBLING</a>) {</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>            <a class="code hl_function" href="tools_8cc.html#abf17a12ab2f03f92a22edeca4be36e19">debug_trap</a>(<span class="stringliteral">&quot;neighborsUdpAck: Found non-ICP cache as SIBLING\n&quot;</span>);</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>            <a class="code hl_function" href="tools_8cc.html#abf17a12ab2f03f92a22edeca4be36e19">debug_trap</a>(<span class="stringliteral">&quot;neighborsUdpAck: non-ICP neighbors must be a PARENT\n&quot;</span>);</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>            mem-&gt;<a class="code hl_variable" href="classMemObject.html#a18e110d4e91e0ea0c7a8e827dc670935">ping_reply_callback</a>(p, ntype, <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7accacc70e659b8153a808b7c0da5de0428ea">AnyP::PROTO_ICP</a>, header, mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>);</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>        }</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a9d41e5c7ef15fb29ac27e3d282ef322e">ICP_SECHO</a>) {</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>        <span class="keywordflow">if</span> (p) {</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;Ignoring SECHO from neighbor &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>            <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;Unsolicited SECHO from &quot;</span> &lt;&lt; from);</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>        }</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a6d0200c4d928ab973233042d75e192c1">ICP_DENIED</a>) {</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>        <span class="keywordflow">if</span> (p == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>            <a class="code hl_function" href="neighbors_8cc.html#ac4b350a9f6eac0a4bf823ec15126bb66">neighborIgnoreNonPeer</a>(from, opcode);</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#aa61d3169817932801f3ed763d01cd1a1">pings_acked</a> &gt; 100) {</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>            <span class="keywordflow">if</span> (100 * p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa21b8498cfb83397082d3891eefa3c60">icp</a>.<a class="code hl_variable" href="structCachePeer_1_1icp__.html#a780ce4f235b5682ab958fb897dadd14a">counts</a>[<a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a6d0200c4d928ab973233042d75e192c1">ICP_DENIED</a>] / p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#aa61d3169817932801f3ed763d01cd1a1">pings_acked</a> &gt; 95) {</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;Disabling cache_peer &quot;</span> &lt;&lt; *p &lt;&lt;</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>                       <span class="stringliteral">&quot; because over 95% of its replies are UDP_DENIED&quot;</span>);</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>                <a class="code hl_function" href="CachePeers_8cc.html#ad48a5c1aea87248a83eabeea3e43f4e4">DeleteConfigured</a>(p);</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>                p = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>                <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>            }</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>        }</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opcode == <a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a6363622dfdc43141e3df39a81425176f">ICP_MISS_NOFETCH</a>) {</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>        mem-&gt;<a class="code hl_variable" href="classMemObject.html#a18e110d4e91e0ea0c7a8e827dc670935">ping_reply_callback</a>(p, ntype, <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7accacc70e659b8153a808b7c0da5de0428ea">AnyP::PROTO_ICP</a>, header, mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>);</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: neighborsUdpAck: Unexpected ICP reply: &quot;</span> &lt;&lt; opcode_d);</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>    }</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>}</div>
</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span> </div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span><a class="code hl_class" href="classCachePeer.html">CachePeer</a> *</div>
<div class="foldopen" id="foldopen01048" data-start="{" data-end="}">
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a311d35bea078e41fe82162df782311f0"> 1048</a></span><a class="code hl_function" href="neighbors_8cc.html#a311d35bea078e41fe82162df782311f0">findCachePeerByName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> name)</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>{</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;p: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>        <span class="keywordflow">if</span> (!strcasecmp(name, p-&gt;name))</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>            <span class="keywordflow">return</span> p.get();</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    }</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>}</div>
</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span> </div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span><span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen01058" data-start="{" data-end="}">
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a6204ffb9f5e7d51413c2514de20d68cd"> 1058</a></span><a class="code hl_function" href="neighbors_8cc.html#a6204ffb9f5e7d51413c2514de20d68cd">neighborUp</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p)</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>{</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>    <span class="keywordflow">if</span> (!p-&gt;<a class="code hl_variable" href="classCachePeer.html#a6ed7962606a135352c6da45b8f2e15b0">tcp_up</a>) {</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>        <a class="code hl_function" href="CodeContext_8h.html#a6c9e0a7564c7a5974969252c8f953ad0">CallService</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a79513f2c22539a00977a378a76c0b785">probeCodeContext</a>, [&amp;] {</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>            peerProbeConnect(const_cast&lt;CachePeer*&gt;(p));</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>        });</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>    }</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span> </div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span><span class="comment">     * The CachePeer can not be UP if we don&#39;t have any IP addresses</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span><span class="comment">     * for it.</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span><span class="comment">     */</span></div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>    <span class="keywordflow">if</span> (0 == p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a>) {</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 8, <span class="stringliteral">&quot;DOWN (no-ip): &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    }</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span> </div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a2070482adb78ba4350ebf0d440ce0320">no_query</a>) {</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 8, <span class="stringliteral">&quot;UP (no-query): &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>    }</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span> </div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a2d8d88c51d813d6007883a30bbe1e3bd">probe_start</a> != 0 &amp;&amp;</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>            <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a2d8d88c51d813d6007883a30bbe1e3bd">probe_start</a> &gt; <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#a1bd0123600a9c5ad8828e0fb0747d4c3">deadPeer</a>) {</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 8, <span class="stringliteral">&quot;DOWN (dead): &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>    }</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span> </div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 8, <span class="stringliteral">&quot;UP: &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>}</div>
</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span> </div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>time_t</div>
<div class="foldopen" id="foldopen01092" data-start="{" data-end="}">
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a752438ef7dd82516762385a1e4f1b41c"> 1092</a></span><a class="code hl_function" href="neighbors_8cc.html#a752438ef7dd82516762385a1e4f1b41c">positiveTimeout</a>(<span class="keyword">const</span> time_t timeout)</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>{</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="compat__shared_8h.html#a3d8cde9338394cf0f0f324862cd78533">max</a>(<span class="keyword">static_cast&lt;</span>time_t<span class="keyword">&gt;</span>(1), timeout);</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>}</div>
</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span> </div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01098" data-start="{" data-end="}">
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a4cf512acd4132ee81a2b81f649ee2d6b"> 1098</a></span><a class="code hl_variable" href="neighbors_8cc.html#a3269559f810fd86a0d91ffe9f24ef758">peerDNSConfigure</a>(<span class="keyword">const</span> <a class="code hl_class" href="classDns_1_1CachedIps.html">ipcache_addrs</a> *ia, <span class="keyword">const</span> <a class="code hl_class" href="classDns_1_1LookupDetails.html">Dns::LookupDetails</a> &amp;, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>{</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>    <span class="comment">// TODO: connections to no-longer valid IP addresses should be</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>    <span class="comment">// closed when we can detect such IP addresses.</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span> </div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>    <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p = (<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *)data;</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span> </div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a> == 0) {</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Messages_8h.html#a3627f132658efd674ba366496239d303">Important</a>(29), <span class="stringliteral">&quot;Configuring &quot;</span> &lt;&lt; <a class="code hl_function" href="neighbors_8cc.html#a7271928a2f26b9c331bd057c813e9865">neighborTypeStr</a>(p) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; *p);</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span> </div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a>)</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;    Multicast TTL = &quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a099da3c06991015bbd06783a6e0edf5d">ttl</a>);</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>    }</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span> </div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a> = 0;</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span> </div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>    <span class="keywordflow">if</span> (ia == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(0, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;WARNING: DNS lookup for &#39;&quot;</span> &lt;&lt; *p &lt;&lt; <span class="stringliteral">&quot;&#39; failed!&quot;</span>);</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>    }</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span> </div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>    <span class="keywordflow">if</span> (ia-&gt;<a class="code hl_function" href="classDns_1_1CachedIps.html#af66593cb074c88d14d6f9d825578b80c">empty</a>()) {</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(0, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;WARNING: No IP address found for &#39;&quot;</span> &lt;&lt; *p &lt;&lt; <span class="stringliteral">&quot;&#39;!&quot;</span>);</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>    }</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span> </div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;ip: ia-&gt;<a class="code hl_function" href="classDns_1_1CachedIps.html#aa75731a5995b1ad85792a426e072f8d4">goodAndBad</a>()) { <span class="comment">// TODO: Consider using just good().</span></div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a> &lt; <a class="code hl_define" href="defines_8h.html#a6f57fb93c40248c437a2ccc0b9f8b04d">PEER_MAX_ADDRESSES</a>) {</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>            <span class="keyword">const</span> <span class="keyword">auto</span> idx = p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a>++;</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>            p-&gt;<a class="code hl_variable" href="classCachePeer.html#ac3cb464ce25d44b4feb5fc5bd9ed3bf8">addresses</a>[idx] = ip;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 2, <span class="stringliteral">&quot;--&gt; IP address #&quot;</span> &lt;&lt; idx &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#ac3cb464ce25d44b4feb5fc5bd9ed3bf8">addresses</a>[idx]);</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;ignoring remaining &quot;</span> &lt;&lt; (ia-&gt;<a class="code hl_function" href="classDns_1_1CachedIps.html#a93ed5f38618ad8eab791d9b061564f2a">size</a>() - p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a>) &lt;&lt; <span class="stringliteral">&quot; ips&quot;</span>);</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>        }</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>    }</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span> </div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a7e893e0d2562bd9b0d07b1165930fa7a">in_addr</a>.<a class="code hl_function" href="classIp_1_1Address.html#a09eb8f9dd1beaf5e4f1b32069489991c">setEmpty</a>();</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a7e893e0d2562bd9b0d07b1165930fa7a">in_addr</a> = p-&gt;<a class="code hl_variable" href="classCachePeer.html#ac3cb464ce25d44b4feb5fc5bd9ed3bf8">addresses</a>[0];</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a7e893e0d2562bd9b0d07b1165930fa7a">in_addr</a>.<a class="code hl_function" href="classIp_1_1Address.html#aeea3c669850f18acd2efcd336fcf2438">port</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa21b8498cfb83397082d3891eefa3c60">icp</a>.<a class="code hl_variable" href="structCachePeer_1_1icp__.html#a0fd3ca844136a22d04ad79b3d53b7cb5">port</a>);</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span> </div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    <a class="code hl_function" href="neighbors_8cc.html#aef96ae2795b76fe6db1eb6ed4201cda5">peerProbeConnect</a>(p, <span class="keyword">true</span>); <span class="comment">// detect any died or revived peers ASAP</span></div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span> </div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a>)</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>        <a class="code hl_function" href="neighbors_8cc.html#a2c5c2cb4d8baeb8345a3665462708336">peerCountMcastPeersSchedule</a>(p, 10);</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span> </div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span><span class="preprocessor">#if USE_ICMP</span></div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> != <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a> &amp;&amp; <a class="code hl_function" href="stub__tools_8cc.html#a2a195065f59151742dac1bc54c3ef1e9">IamWorkerProcess</a>())</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>        <span class="keywordflow">if</span> (!p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#aa734ccb87a40743dbb6875d8111e5028">no_netdb_exchange</a>)</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>            <a class="code hl_function" href="event_8cc.html#a529afc9a0fa97418d6349e8ebbaf1e8f">eventAddIsh</a>(<span class="stringliteral">&quot;netdbExchangeStart&quot;</span>, <a class="code hl_function" href="net__db_8cc.html#af862f29fc9234a7dc7ea8015f511bcc1">netdbExchangeStart</a>, p, 30.0, 1);</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span> </div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a036f9c7fbaa3a6349e9dd9907e1be493">mgr</a>.<a class="code hl_function" href="classCbcPointer.html#a2125df76c0d5eb45bdb8b18e88a71258">valid</a>())</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>        <a class="code hl_function" href="classPeerPoolMgr.html#a9c260a8493349ce76cab309db15cc6e1">PeerPoolMgr::Checkpoint</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a036f9c7fbaa3a6349e9dd9907e1be493">mgr</a>, <span class="stringliteral">&quot;resolved peer&quot;</span>);</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>}</div>
</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span> </div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01155" data-start="{" data-end="}">
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a1014ea8daa499be8fc82b3efb4d13d4d"> 1155</a></span><a class="code hl_function" href="neighbors_8cc.html#a1014ea8daa499be8fc82b3efb4d13d4d">peerScheduleDnsRefreshCheck</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> delayInSeconds)</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>{</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="event_8cc.html#a5e368c7b2d3b8bc0e1667ece2c440944">eventFind</a>(<a class="code hl_function" href="neighbors_8cc.html#afcb5d6c5cf86ca011f9574afb353d061">peerDnsRefreshCheck</a>, <span class="keyword">nullptr</span>))</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>        <a class="code hl_function" href="event_8cc.html#ae111818525827ae123def674b61b7770">eventDelete</a>(<a class="code hl_function" href="neighbors_8cc.html#afcb5d6c5cf86ca011f9574afb353d061">peerDnsRefreshCheck</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>    <a class="code hl_function" href="event_8cc.html#a529afc9a0fa97418d6349e8ebbaf1e8f">eventAddIsh</a>(<span class="stringliteral">&quot;peerDnsRefreshCheck&quot;</span>, <a class="code hl_function" href="neighbors_8cc.html#afcb5d6c5cf86ca011f9574afb353d061">peerDnsRefreshCheck</a>, <span class="keyword">nullptr</span>, delayInSeconds, 1);</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>}</div>
</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span> </div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01163" data-start="{" data-end="}">
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#afcb5d6c5cf86ca011f9574afb353d061"> 1163</a></span><a class="code hl_function" href="neighbors_8cc.html#afcb5d6c5cf86ca011f9574afb353d061">peerDnsRefreshCheck</a>(<span class="keywordtype">void</span> *)</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>{</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="stat_8cc.html#ac0d551a1aab3545af90f4a8b40691ce2">statSawRecentRequests</a>()) {</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>        <span class="comment">/* no recent client traffic, wait a bit */</span></div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>        <a class="code hl_function" href="neighbors_8cc.html#a1014ea8daa499be8fc82b3efb4d13d4d">peerScheduleDnsRefreshCheck</a>(180.0);</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    }</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span> </div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>    <a class="code hl_function" href="neighbors_8cc.html#a7fdb5c5dd15618d30a7a2cfc23a4ffdc">peerDnsRefreshStart</a>();</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>}</div>
</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span> </div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01175" data-start="{" data-end="}">
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a7fdb5c5dd15618d30a7a2cfc23a4ffdc"> 1175</a></span><a class="code hl_function" href="neighbors_8cc.html#a7fdb5c5dd15618d30a7a2cfc23a4ffdc">peerDnsRefreshStart</a>()</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>{</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>    <span class="keyword">const</span> <span class="keyword">auto</span> savedContext = <a class="code hl_function" href="classCodeContext.html#a13251c00d03b5a9cb9f3b164f0154969">CodeContext::Current</a>();</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;p: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>        <a class="code hl_function" href="classCodeContext.html#aeed1567dd2fb1c97eb3fa3f10df4622e">CodeContext::Reset</a>(p-&gt;probeCodeContext);</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>        <a class="code hl_function" href="group__IPCacheAPI.html#gae327ee2f13a395e7caeff7cbd783c765">ipcache_nbgethostbyname</a>(p-&gt;host, <a class="code hl_variable" href="neighbors_8cc.html#a3269559f810fd86a0d91ffe9f24ef758">peerDNSConfigure</a>, p.get());</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>    }</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    <a class="code hl_function" href="classCodeContext.html#aeed1567dd2fb1c97eb3fa3f10df4622e">CodeContext::Reset</a>(savedContext);</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span> </div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    <a class="code hl_function" href="neighbors_8cc.html#a1014ea8daa499be8fc82b3efb4d13d4d">peerScheduleDnsRefreshCheck</a>(3600.0);</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>}</div>
</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span> </div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span><span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen01189" data-start="{" data-end="}">
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a63febaac1744f757453991f3e32f15f6"> 1189</a></span><a class="code hl_function" href="neighbors_8cc.html#a63febaac1744f757453991f3e32f15f6">peerProbeIsBusy</a>(<span class="keyword">const</span> <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p)</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>{</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#acc18bde012c717d1126ea1c81ce5c917">testing_now</a> &gt; 0) {</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 8, <span class="stringliteral">&quot;yes, probing &quot;</span> &lt;&lt; p);</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    }</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a467df38358a093c2802f4566d66031c5">last_connect_probe</a> == 0) {</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 8, <span class="stringliteral">&quot;yes, just probed &quot;</span> &lt;&lt; p);</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>    }</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>}</div>
</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span><span class="comment">/*</span></div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span><span class="comment">* peerProbeConnect will be called on dead peers by neighborUp</span></div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span><span class="comment">*/</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01205" data-start="{" data-end="}">
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#aef96ae2795b76fe6db1eb6ed4201cda5"> 1205</a></span><a class="code hl_function" href="neighbors_8cc.html#aef96ae2795b76fe6db1eb6ed4201cda5">peerProbeConnect</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p, <span class="keyword">const</span> <span class="keywordtype">bool</span> reprobeIfBusy)</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>{</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#a63febaac1744f757453991f3e32f15f6">peerProbeIsBusy</a>(p)) {</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>        p-&gt;<a class="code hl_variable" href="classCachePeer.html#ad5e828e3ab98fbb77222218d3d729538">reprobe</a> = reprobeIfBusy;</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>    }</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#ad5e828e3ab98fbb77222218d3d729538">reprobe</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span> </div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>    <span class="keyword">const</span> <span class="keyword">auto</span> ctimeout = p-&gt;<a class="code hl_function" href="classCachePeer.html#ab1a1dfaf669fc25152c2be16a946f2fd">connectTimeout</a>();</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    <span class="comment">/* for each IP address of this CachePeer. find one that we can connect to and probe it. */</span></div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">n_addresses</a>; ++i) {</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>        <a class="code hl_class" href="classRefCount.html">Comm::ConnectionPointer</a> conn = <span class="keyword">new</span> <a class="code hl_class" href="classComm_1_1Connection.html">Comm::Connection</a>;</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>        conn-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a60e1b863400f49a2ed17054982561f17">remote</a> = p-&gt;<a class="code hl_variable" href="classCachePeer.html#ac3cb464ce25d44b4feb5fc5bd9ed3bf8">addresses</a>[i];</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>        conn-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a60e1b863400f49a2ed17054982561f17">remote</a>.<a class="code hl_function" href="classIp_1_1Address.html#aeea3c669850f18acd2efcd336fcf2438">port</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a40813ba2a7cf12d12260d2dfeb3b1314">http_port</a>);</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>        conn-&gt;<a class="code hl_function" href="classComm_1_1Connection.html#aec3a3c580255b361496f5ac226b52662">setPeer</a>(p);</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>        <a class="code hl_function" href="FwdState_8cc.html#a6de4cf90dc6698fccdb2ab106db67e53">getOutgoingAddress</a>(<span class="keyword">nullptr</span>, conn);</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span> </div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>        ++ p-&gt;<a class="code hl_variable" href="classCachePeer.html#acc18bde012c717d1126ea1c81ce5c917">testing_now</a>;</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span> </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>        <a class="code hl_class" href="classRefCount.html">AsyncCall::Pointer</a> call = <a class="code hl_function" href="CommCalls_8h.html#a7e143fa246c3e54c90fa8d20b390b88d">commCbCall</a>(15,3, <span class="stringliteral">&quot;peerProbeConnectDone&quot;</span>, <a class="code hl_class" href="classCommConnectCbPtrFun.html">CommConnectCbPtrFun</a>(<a class="code hl_variable" href="neighbors_8cc.html#a4a27f36856d050c4cbc4adf4041febd0">peerProbeConnectDone</a>, p));</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>        <a class="code hl_class" href="classComm_1_1ConnOpener.html">Comm::ConnOpener</a> *cs = <span class="keyword">new</span> <a class="code hl_class" href="classComm_1_1ConnOpener.html">Comm::ConnOpener</a>(conn, call, ctimeout);</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>        cs-&gt;<a class="code hl_function" href="classComm_1_1ConnOpener.html#a544daa6afdf9190a2611f6d4d3bc6858">setHost</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4814933194c07f6802ea7ed1d4ed5333">host</a>);</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>        <a class="code hl_function" href="classAsyncJob.html#a1dd42e9842d751193268966d4e0de2fa">AsyncJob::Start</a>(cs);</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>    }</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span> </div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a467df38358a093c2802f4566d66031c5">last_connect_probe</a> = <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>;</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>}</div>
</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span> </div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01234" data-start="{" data-end="}">
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#aa23e735b47bbdd2b21821a3e928b5249"> 1234</a></span><a class="code hl_variable" href="neighbors_8cc.html#a4a27f36856d050c4cbc4adf4041febd0">peerProbeConnectDone</a>(<span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">Comm::ConnectionPointer</a> &amp;conn, <a class="code hl_enumeration" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050">Comm::Flag</a> status, <span class="keywordtype">int</span>, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>{</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>    <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p = (<a class="code hl_class" href="classCachePeer.html">CachePeer</a>*)data;</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span> </div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>    <span class="keywordflow">if</span> (status == <a class="code hl_enumvalue" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050a2d02cf4ed31f765e18f4d8474ede4e24">Comm::OK</a>)</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>        p-&gt;<a class="code hl_function" href="classCachePeer.html#a19120e578ee688ab17dda05e53910b79">noteSuccess</a>();</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>        p-&gt;<a class="code hl_function" href="classCachePeer.html#ab8a85494c94d76cc97d8a9e0adf8b211">noteFailure</a>();</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span> </div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    -- p-&gt;<a class="code hl_variable" href="classCachePeer.html#acc18bde012c717d1126ea1c81ce5c917">testing_now</a>;</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>    conn-&gt;<a class="code hl_function" href="classComm_1_1Connection.html#a32253e90999f679dc032e19ad50d03ab">close</a>();</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>    <span class="comment">// TODO: log this traffic.</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span> </div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#ad5e828e3ab98fbb77222218d3d729538">reprobe</a>)</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>        <a class="code hl_function" href="neighbors_8cc.html#aef96ae2795b76fe6db1eb6ed4201cda5">peerProbeConnect</a>(p);</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>}</div>
</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span> </div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01252" data-start="{" data-end="}">
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a2c5c2cb4d8baeb8345a3665462708336"> 1252</a></span><a class="code hl_function" href="neighbors_8cc.html#a2c5c2cb4d8baeb8345a3665462708336">peerCountMcastPeersSchedule</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, time_t when)</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>{</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a0ee59f5508602bcdedea5da21ff637b9">flags</a>.<a class="code hl_variable" href="classCachePeer.html#ac0716cdb0843618bc9d5b5c9974064b3">count_event_pending</a>)</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span> </div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>    <a class="code hl_function" href="event_8cc.html#afbfd8e1e91d5ad60e6124aea52a5f006">eventAdd</a>(<span class="stringliteral">&quot;peerCountMcastPeersStart&quot;</span>,</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>             <a class="code hl_function" href="neighbors_8cc.html#afc217053539cabc9b792dbdb5b077611">peerCountMcastPeersStart</a>,</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>             p,</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>             (<span class="keywordtype">double</span>) when, 1);</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span> </div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a0ee59f5508602bcdedea5da21ff637b9">flags</a>.<a class="code hl_variable" href="classCachePeer.html#ac0716cdb0843618bc9d5b5c9974064b3">count_event_pending</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>}</div>
</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span> </div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01266" data-start="{" data-end="}">
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#afc217053539cabc9b792dbdb5b077611"> 1266</a></span><a class="code hl_function" href="neighbors_8cc.html#afc217053539cabc9b792dbdb5b077611">peerCountMcastPeersStart</a>(<span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>{</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>    <span class="keyword">const</span> <span class="keyword">auto</span> peer = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classCachePeer.html">CachePeer</a>*<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>    <a class="code hl_function" href="CodeContext_8h.html#a2117aeec5e8428af6ea46de4f55fd9f4">CallContextCreator</a>([peer] {</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>        <a class="code hl_function" href="neighbors_8cc.html#a3e2752d95ce98c8cfaf10516e4517d48">peerCountMcastPeersCreateAndSend</a>(peer);</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>    });</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>    <a class="code hl_function" href="neighbors_8cc.html#a2c5c2cb4d8baeb8345a3665462708336">peerCountMcastPeersSchedule</a>(peer, <a class="code hl_define" href="neighbors_8cc.html#aad025aebc8aa3df1d1eee52819686336">MCAST_COUNT_RATE</a>);</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>}</div>
</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span> </div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01277" data-start="{" data-end="}">
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a3e2752d95ce98c8cfaf10516e4517d48"> 1277</a></span><a class="code hl_function" href="neighbors_8cc.html#a3e2752d95ce98c8cfaf10516e4517d48">peerCountMcastPeersCreateAndSend</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * <span class="keyword">const</span> p)</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>{</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>    <span class="comment">// XXX: Do not create lots of complex fake objects (while abusing their</span></div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>    <span class="comment">// APIs) to pass around a few basic data points like start_ping and ping!</span></div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    <a class="code hl_class" href="classMemObject.html">MemObject</a> *mem;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>    <span class="keywordtype">int</span> reqnum;</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>    <span class="comment">// TODO: use class AnyP::Uri instead of constructing and re-parsing a string</span></div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    <a class="code hl_define" href="squid_8h.html#a9b17dd86bdde2e8cb89abe153a0f4f23">LOCAL_ARRAY</a>(<span class="keywordtype">char</span>, url, <a class="code hl_define" href="defines_8h.html#afcbf7727d6416354930cd43f1c1e480c">MAX_URL</a>);</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">type</a> == <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a>);</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a0ee59f5508602bcdedea5da21ff637b9">flags</a>.<a class="code hl_variable" href="classCachePeer.html#ac0716cdb0843618bc9d5b5c9974064b3">count_event_pending</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>    snprintf(url, <a class="code hl_define" href="defines_8h.html#afcbf7727d6416354930cd43f1c1e480c">MAX_URL</a>, <span class="stringliteral">&quot;http://&quot;</span>);</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a7e893e0d2562bd9b0d07b1165930fa7a">in_addr</a>.<a class="code hl_function" href="classIp_1_1Address.html#ac22c561fa1b3873a204feb18dd9a16b1">toUrl</a>(url+7, <a class="code hl_define" href="defines_8h.html#afcbf7727d6416354930cd43f1c1e480c">MAX_URL</a> -8 );</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>    strcat(url, <span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>    <span class="keyword">const</span> <span class="keyword">auto</span> mx = MasterXaction::MakePortless&lt;XactionInitiator::initPeerMcast&gt;();</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>    <span class="keyword">auto</span> *req = <a class="code hl_function" href="classHttpRequest.html#a3738e100587f43de4a040b3f0463e21d">HttpRequest::FromUrlXXX</a>(url, mx);</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(req != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>    <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">AccessLogEntry::Pointer</a> ale = <span class="keyword">new</span> <a class="code hl_class" href="classAccessLogEntry.html">AccessLogEntry</a>;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    ale-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a92312350a82deb4331b171bdea7ff3d5">request</a> = req;</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    <a class="code hl_function" href="classCodeContext.html#aeed1567dd2fb1c97eb3fa3f10df4622e">CodeContext::Reset</a>(ale);</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *fake = <a class="code hl_function" href="store_8cc.html#a872157d7a8c43bb5facb072ce03c4d48">storeCreateEntry</a>(url, url, <a class="code hl_class" href="classRequestFlags.html">RequestFlags</a>(), <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a>);</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>    <span class="keyword">const</span> <span class="keyword">auto</span> psstate = <span class="keyword">new</span> <a class="code hl_class" href="classPeerSelector.html">PeerSelector</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>    psstate-&gt;request = req;</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>    <a class="code hl_function" href="http_2Message_8h.html#afbf13ecd1cc5c007367ae094c1aa19a9">HTTPMSGLOCK</a>(psstate-&gt;request);</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>    psstate-&gt;entry = fake;</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>    psstate-&gt;peerCountMcastPeerXXX = <a class="code hl_define" href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a>(p);</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>    psstate-&gt;ping.start = <a class="code hl_variable" href="time_2gadgets_8cc.html#a502612b4a32c5902726b120d713d7952">current_time</a>;</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>    psstate-&gt;al = ale;</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>    mem = fake-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>;</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>    mem-&gt;<a class="code hl_variable" href="classMemObject.html#a38fde17e9fa64949670b7a25e0735e64">request</a> = psstate-&gt;request;</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>    mem-&gt;<a class="code hl_variable" href="classMemObject.html#a8f812f26bacafb538c67d2bf1157ad1b">start_ping</a> = <a class="code hl_variable" href="time_2gadgets_8cc.html#a502612b4a32c5902726b120d713d7952">current_time</a>;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>    mem-&gt;<a class="code hl_variable" href="classMemObject.html#a18e110d4e91e0ea0c7a8e827dc670935">ping_reply_callback</a> = <a class="code hl_variable" href="neighbors_8cc.html#a956def714ac0ed251dad6f60ff91abfd">peerCountHandleIcpReply</a>;</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>    mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a> = psstate;</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>    <a class="code hl_function" href="multicast_8cc.html#aae50610fcb12fde0d35ae39cfd73a7e1">mcastSetTtl</a>(<a class="code hl_variable" href="group__ServerProtocolICPInternal2.html#ga27833f39d27c05bc1f06c4bcf25ef9fc">icpOutgoingConn</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">fd</a>, p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a099da3c06991015bbd06783a6e0edf5d">ttl</a>);</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#abc87932b395973128c0cd70bbd07e44e">id</a> = mem-&gt;<a class="code hl_variable" href="classMemObject.html#a3ca25b28a215cbe414f7cd1426e27492">id</a>;</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>    reqnum = <a class="code hl_function" href="group__ServerProtocolICPAPI.html#ga4d210ff125985b55f52278cc17868ad1">icpSetCacheKey</a>((<span class="keyword">const</span> <a class="code hl_typedef" href="store_2forward_8h.html#ab1424e1b13666cc28f4c5cb05f8c8305">cache_key</a> *)fake-&gt;<a class="code hl_variable" href="classhash__link.html#ae8c6b512f09a15a32ce953deb2e58ffb">key</a>);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    <a class="code hl_function" href="group__ServerProtocolICPAPI.html#ga53e8fe6736b5dfae15ba459a4e8c3376">icpCreateAndSend</a>(<a class="code hl_enumvalue" href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a5c6250115ccf383ec8ad97bc82abd5de">ICP_QUERY</a>, 0, url, reqnum, 0,</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>                     <a class="code hl_variable" href="group__ServerProtocolICPInternal2.html#ga27833f39d27c05bc1f06c4bcf25ef9fc">icpOutgoingConn</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">fd</a>, p-&gt;<a class="code hl_variable" href="classCachePeer.html#a7e893e0d2562bd9b0d07b1165930fa7a">in_addr</a>, psstate-&gt;al);</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>    fake-&gt;<a class="code hl_variable" href="classStoreEntry.html#abc675c0ac6ddb7ddd97d2159439d74ac">ping_status</a> = <a class="code hl_enumvalue" href="enums_8h.html#a4bd207d3fdbf20f48de074b84f74563ea15e97486bd90d641808bbc2eb177cf94">PING_WAITING</a>; <span class="comment">// TODO: refactor to use PeerSelector::startPingWaiting()</span></div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>    <a class="code hl_function" href="event_8cc.html#afbfd8e1e91d5ad60e6124aea52a5f006">eventAdd</a>(<span class="stringliteral">&quot;peerCountMcastPeersDone&quot;</span>,</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>             <a class="code hl_function" href="neighbors_8cc.html#a118fc9cfb76ca751cc3758457edc5a01">peerCountMcastPeersDone</a>,</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>             psstate,</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>             <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">Timeout</a>.<a class="code hl_variable" href="classSquidConfig.html#a44fd4482861466a6562be245352771cb">mcast_icp_query</a> / 1000.0, 1);</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a0ee59f5508602bcdedea5da21ff637b9">flags</a>.<a class="code hl_variable" href="classCachePeer.html#a6f38fbfcc6346d512046509354cc1593">counting</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>}</div>
</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span> </div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01323" data-start="{" data-end="}">
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a118fc9cfb76ca751cc3758457edc5a01"> 1323</a></span><a class="code hl_function" href="neighbors_8cc.html#a118fc9cfb76ca751cc3758457edc5a01">peerCountMcastPeersDone</a>(<span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>{</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>    <span class="keyword">const</span> <span class="keyword">auto</span> psstate = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classPeerSelector.html">PeerSelector</a>*<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    <a class="code hl_function" href="CodeContext_8h.html#ab89d6e6afe80c6e6e92e25761a96db02">CallBack</a>(psstate-&gt;al, [psstate] {</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>        peerCountMcastPeersAbort(psstate);</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>        delete psstate;</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>    });</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>}</div>
</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span> </div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01335" data-start="{" data-end="}">
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a6132f21ce167ad8753fdd6af168abaf5"> 1335</a></span><a class="code hl_function" href="neighbors_8cc.html#a6132f21ce167ad8753fdd6af168abaf5">peerCountMcastPeersAbort</a>(<a class="code hl_class" href="classPeerSelector.html">PeerSelector</a> * <span class="keyword">const</span> psstate)</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>{</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *fake = psstate-&gt;<a class="code hl_variable" href="classPeerSelector.html#aa2b7ac619cd597540412221172ac4634">entry</a>;</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span> </div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a>(psstate-&gt;<a class="code hl_variable" href="classPeerSelector.html#a725d048b0004bb792306dedbf856e0a6">peerCountMcastPeerXXX</a>)) {</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>        <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p = (<a class="code hl_class" href="classCachePeer.html">CachePeer</a> *)psstate-&gt;<a class="code hl_variable" href="classPeerSelector.html#a725d048b0004bb792306dedbf856e0a6">peerCountMcastPeerXXX</a>;</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>        p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a0ee59f5508602bcdedea5da21ff637b9">flags</a>.<a class="code hl_variable" href="classCachePeer.html#a6f38fbfcc6346d512046509354cc1593">counting</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>        p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a9abeb6df63f1be6e0fd8a103e9f3c4dc">avg_n_members</a> = <a class="code hl_function" href="namespaceMath.html#a5dfbfabfb22aa352e6730f6cb3b8d6f8">Math::doubleAverage</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a9abeb6df63f1be6e0fd8a103e9f3c4dc">avg_n_members</a>, (<span class="keywordtype">double</span>) psstate-&gt;<a class="code hl_variable" href="classPeerSelector.html#a778bd6b42f0a49a14067908dcf8f080f">ping</a>.<a class="code hl_variable" href="classping__data.html#a49e745664d82b1960bbc3a0332e1c33f">n_recv</a>, ++p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a9da4b46136652731cf1e3ff0385df71c">n_times_counted</a>, 10);</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;Group &quot;</span> &lt;&lt; *p  &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; psstate-&gt;<a class="code hl_variable" href="classPeerSelector.html#a778bd6b42f0a49a14067908dcf8f080f">ping</a>.<a class="code hl_variable" href="classping__data.html#a49e745664d82b1960bbc3a0332e1c33f">n_recv</a>  &lt;&lt;</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>               <span class="stringliteral">&quot; replies, &quot;</span>&lt;&lt; std::setw(4)&lt;&lt; std::setprecision(2) &lt;&lt;</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>               p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a9abeb6df63f1be6e0fd8a103e9f3c4dc">avg_n_members</a> &lt;&lt;<span class="stringliteral">&quot; average, RTT &quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a7461a008582b379b87e748d77cab0f48">rtt</a>);</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>        p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a6591206c520bac20de02b72f676a6f63">n_replies_expected</a> = (<a class="code hl_variable" href="stub__fd_8cc.html#a35fed7109d24712d6b86b6134537c7bd">int</a>) p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a9abeb6df63f1be6e0fd8a103e9f3c4dc">avg_n_members</a>;</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>    }</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span> </div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>    <a class="code hl_define" href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a>(psstate-&gt;<a class="code hl_variable" href="classPeerSelector.html#a725d048b0004bb792306dedbf856e0a6">peerCountMcastPeerXXX</a>);</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span> </div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>    fake-&gt;<a class="code hl_function" href="classStoreEntry.html#ace7147cc8e2b3795b763329829954795">abort</a>(); <span class="comment">// sets ENTRY_ABORTED and initiates related cleanup</span></div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>    fake-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>-&gt;<a class="code hl_variable" href="classMemObject.html#a38fde17e9fa64949670b7a25e0735e64">request</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>    fake-&gt;<a class="code hl_function" href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">unlock</a>(<span class="stringliteral">&quot;peerCountMcastPeersDone&quot;</span>);</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>}</div>
</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span> </div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01357" data-start="{" data-end="}">
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#aaabfc6bbabc797964532209243231525"> 1357</a></span><a class="code hl_variable" href="neighbors_8cc.html#a956def714ac0ed251dad6f60ff91abfd">peerCountHandleIcpReply</a>(<a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p, <a class="code hl_enumeration" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463">peer_t</a>, <a class="code hl_enumeration" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acc">AnyP::ProtocolType</a> proto, <span class="keywordtype">void</span> *, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>{</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>    <span class="keyword">const</span> <span class="keyword">auto</span> psstate = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classPeerSelector.html">PeerSelector</a>*<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *fake = psstate-&gt;entry;</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(fake);</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>    <a class="code hl_class" href="classMemObject.html">MemObject</a> *mem = fake-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>;</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(mem);</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>    <span class="keywordtype">int</span> rtt = <a class="code hl_function" href="time_2gadgets_8cc.html#af7a3c9de59180267762f047ffd42e503">tvSubMsec</a>(mem-&gt;<a class="code hl_variable" href="classMemObject.html#a8f812f26bacafb538c67d2bf1157ad1b">start_ping</a>, <a class="code hl_variable" href="time_2gadgets_8cc.html#a502612b4a32c5902726b120d713d7952">current_time</a>);</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(proto == <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7accacc70e659b8153a808b7c0da5de0428ea">AnyP::PROTO_ICP</a>);</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>    ++ psstate-&gt;ping.n_recv;</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>    <span class="keywordtype">int</span> rtt_av_factor = <a class="code hl_define" href="defines_8h.html#adb5ef0088b5947951fab1bd4ca7c7652">RTT_AV_FACTOR</a>;</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span> </div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#af2cf8e8f51c4eba604ec3385a62ea59f">weighted_roundrobin</a>)</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>        rtt_av_factor = <a class="code hl_define" href="defines_8h.html#a11b068a3943fb56b10a37b25d8cdb2c8">RTT_BACKGROUND_AV_FACTOR</a>;</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span> </div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a7461a008582b379b87e748d77cab0f48">rtt</a> = <a class="code hl_function" href="namespaceMath.html#ae00e8f5a2d22e3eb488bfa26d5848a7c">Math::intAverage</a>(p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">stats</a>.<a class="code hl_variable" href="classCachePeer.html#a7461a008582b379b87e748d77cab0f48">rtt</a>, rtt, psstate-&gt;ping.n_recv, rtt_av_factor);</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>}</div>
</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span> </div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01376" data-start="{" data-end="}">
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#afbba90dbcb23e80119be41f05ee29ba6"> 1376</a></span><a class="code hl_variable" href="neighbors_8cc.html#a4f2ef0cb3a2344aab8ecd924faf291a5">neighborDumpPeers</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> * sentry)</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>{</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>    <a class="code hl_function" href="neighbors_8cc.html#a03640b5e6e91173327f269d4b4275479">dump_peers</a>(sentry, <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a859f8be49d92d04469051dd6f304e9a8">peers</a>);</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>}</div>
</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span> </div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01382" data-start="{" data-end="}">
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a616e3d85ea457a8b22ad8ee588d47e55"> 1382</a></span><a class="code hl_function" href="neighbors_8cc.html#a616e3d85ea457a8b22ad8ee588d47e55">dump_peer_options</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> * sentry, <a class="code hl_class" href="classCachePeer.html">CachePeer</a> * p)</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>{</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>    <a class="code hl_class" href="classPackableStream.html">PackableStream</a> os(*sentry);</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span> </div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a410f45c12710f7113f514995e01818d5">proxy_only</a>)</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>        os &lt;&lt; <span class="stringliteral">&quot; proxy-only&quot;</span>;</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span> </div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a2070482adb78ba4350ebf0d440ce0320">no_query</a>)</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>        os &lt;&lt; <span class="stringliteral">&quot; no-query&quot;</span>;</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span> </div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a2fe608047662f759eaf97b7a508af398">background_ping</a>)</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>        os &lt;&lt; <span class="stringliteral">&quot; background-ping&quot;</span>;</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span> </div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a76bfddd22641f1e14e86ddbcc2554fb5">no_digest</a>)</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>        os &lt;&lt; <span class="stringliteral">&quot; no-digest&quot;</span>;</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span> </div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#ad18ff2989e40a004e6e1d73ed2e870de">default_parent</a>)</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>        os &lt;&lt; <span class="stringliteral">&quot; default&quot;</span>;</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span> </div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a384937a844027d00648fda6d36daec49">roundrobin</a>)</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>        os &lt;&lt; <span class="stringliteral">&quot; round-robin&quot;</span>;</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span> </div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#ad39e6933dfe2d7a99c3d02e8960be2f5">carp</a>)</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>        os &lt;&lt; <span class="stringliteral">&quot; carp&quot;</span>;</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span> </div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#ac7b7ecf1985ea57a3efcfcd9a8e18ed0">userhash</a>)</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>        os &lt;&lt; <span class="stringliteral">&quot; userhash&quot;</span>;</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span> </div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a8667e92e95ae67f517fb8eea1ec10c71">sourcehash</a>)</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>        os &lt;&lt; <span class="stringliteral">&quot; sourcehash&quot;</span>;</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span> </div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#af2cf8e8f51c4eba604ec3385a62ea59f">weighted_roundrobin</a>)</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>        os &lt;&lt; <span class="stringliteral">&quot; weighted-round-robin&quot;</span>;</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span> </div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#af0657aea0b49b487f865790989219873">mcast_responder</a>)</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>        os &lt;&lt; <span class="stringliteral">&quot; multicast-responder&quot;</span>;</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span> </div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a4e78fd5911048b90b98d31b280d07584">mcast_siblings</a>)</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>        os &lt;&lt; <span class="stringliteral">&quot; multicast-siblings&quot;</span>;</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span> </div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a1104787b07b92c5729f1a19612442774">weight</a> != 1)</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>        os &lt;&lt; <span class="stringliteral">&quot; weight=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a1104787b07b92c5729f1a19612442774">weight</a>;</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span> </div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a08c1fc1ca2060d8bdcc81d76986d8ec9">closest_only</a>)</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>        os &lt;&lt; <span class="stringliteral">&quot; closest-only&quot;</span>;</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#ab6c74c1f4da3944782c5bdfa8f83537a">htcp</a>) {</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>        os &lt;&lt; <span class="stringliteral">&quot; htcp&quot;</span>;</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>        std::vector&lt;const char *, PoolingAllocator&lt;const char *&gt; &gt; opts;</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a1c804690c3eb3bfec5bb48f843aaec50">htcp_oldsquid</a>)</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>            opts.push_back(<span class="stringliteral">&quot;oldsquid&quot;</span>);</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#afe36faa4e2091e8f191098f29706f711">htcp_no_clr</a>)</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>            opts.push_back(<span class="stringliteral">&quot;no-clr&quot;</span>);</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a47a9d8c6643a0db61a021da00e46b4d6">htcp_no_purge_clr</a>)</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>            opts.push_back(<span class="stringliteral">&quot;no-purge-clr&quot;</span>);</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#aafaf87cf3eafe51ba094e15cfb8658c4">htcp_only_clr</a>)</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>            opts.push_back(<span class="stringliteral">&quot;only-clr&quot;</span>);</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>        <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a79c8e800cf69519ad047397ab6ad654a">htcp_forward_clr</a>)</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>            opts.push_back(<span class="stringliteral">&quot;forward-clr&quot;</span>);</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>        os &lt;&lt; <a class="code hl_class" href="classAsList.html">AsList</a>(opts).<a class="code hl_function" href="classAsList.html#a055e350d6c5943cdee06c81fd9c0f2ee">prefixedBy</a>(<span class="stringliteral">&quot;=&quot;</span>).delimitedBy(<span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>    }</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span> </div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#aa734ccb87a40743dbb6875d8111e5028">no_netdb_exchange</a>)</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>        os &lt;&lt; <span class="stringliteral">&quot; no-netdb-exchange&quot;</span>;</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span> </div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span><span class="preprocessor">#if USE_DELAY_POOLS</span></div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#affc00eb35ee322cc4a79bcd4d0813004">no_delay</a>)</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>        os &lt;&lt; <span class="stringliteral">&quot; no-delay&quot;</span>;</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span> </div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a45c8c94c5eae33e78bed43d1e72392f7">login</a>)</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>        os &lt;&lt; <span class="stringliteral">&quot; login=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a45c8c94c5eae33e78bed43d1e72392f7">login</a>;</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span> </div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a099da3c06991015bbd06783a6e0edf5d">ttl</a> &gt; 0)</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>        os &lt;&lt; <span class="stringliteral">&quot; ttl=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">mcast</a>.<a class="code hl_variable" href="classCachePeer.html#a099da3c06991015bbd06783a6e0edf5d">ttl</a>;</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span> </div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4a27174fc92bdc5c030843fce011b510">connect_timeout_raw</a> &gt; 0)</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>        os &lt;&lt; <span class="stringliteral">&quot; connect-timeout=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4a27174fc92bdc5c030843fce011b510">connect_timeout_raw</a>;</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span> </div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a97f0b5a40c44f62e522f5655af0e3a52">connect_fail_limit</a> != <a class="code hl_define" href="defines_8h.html#a1412a7dae9a055a047258c2fc26e6d4a">PEER_TCP_MAGIC_COUNT</a>)</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>        os &lt;&lt; <span class="stringliteral">&quot; connect-fail-limit=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a97f0b5a40c44f62e522f5655af0e3a52">connect_fail_limit</a>;</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span> </div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span><span class="preprocessor">#if USE_CACHE_DIGESTS</span></div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span> </div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#ad8ea2a3d2732c898cd79ad7135e70042">digest_url</a>)</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>        os &lt;&lt; <span class="stringliteral">&quot; digest-url=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#ad8ea2a3d2732c898cd79ad7135e70042">digest_url</a>;</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span> </div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span> </div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#ad77395380adaae2134c229c467560fe2">allow_miss</a>)</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>        os &lt;&lt; <span class="stringliteral">&quot; allow-miss&quot;</span>;</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span> </div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a18adce57e82d63f531a1960c27008de9">no_tproxy</a>)</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>        os &lt;&lt; <span class="stringliteral">&quot; no-tproxy&quot;</span>;</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span> </div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa7370aac507d880d83b9870f7a55808e">max_conn</a> &gt; 0)</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>        os &lt;&lt; <span class="stringliteral">&quot; max-conn=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#aa7370aac507d880d83b9870f7a55808e">max_conn</a>;</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span> </div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a599290c15fe0b49f68c3eef688b1f2c1">limit</a> &gt; 0)</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>        os &lt;&lt; <span class="stringliteral">&quot; standby=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">standby</a>.<a class="code hl_variable" href="classCachePeer.html#a599290c15fe0b49f68c3eef688b1f2c1">limit</a>;</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span> </div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">options</a>.<a class="code hl_variable" href="classCachePeer.html#a2ba3d3e239dfe40eeeaa71e0c1aaf474">originserver</a>)</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>        os &lt;&lt; <span class="stringliteral">&quot; originserver&quot;</span>;</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span> </div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4fba08f4a9726af8550cec1f1c882929">domain</a>)</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>        os &lt;&lt; <span class="stringliteral">&quot; forceddomain=&quot;</span> &lt;&lt; p-&gt;<a class="code hl_variable" href="classCachePeer.html#a4fba08f4a9726af8550cec1f1c882929">domain</a>;</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span> </div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>    <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39f5acb9d66f637c8d27be9f1f823166">connection_auth</a> == 0)</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>        os &lt;&lt; <span class="stringliteral">&quot; connection-auth=off&quot;</span>;</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39f5acb9d66f637c8d27be9f1f823166">connection_auth</a> == 1)</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>        os &lt;&lt; <span class="stringliteral">&quot; connection-auth=on&quot;</span>;</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="classCachePeer.html#a39f5acb9d66f637c8d27be9f1f823166">connection_auth</a> == 2)</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>        os &lt;&lt; <span class="stringliteral">&quot; connection-auth=auto&quot;</span>;</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span> </div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>    p-&gt;<a class="code hl_variable" href="classCachePeer.html#a49218ccd1ad47df72504d20ce05708fb">secure</a>.<a class="code hl_function" href="classSecurity_1_1PeerOptions.html#ab4b2b3c3282aee37218bb28d5884a803">dumpCfg</a>(os, <span class="stringliteral">&quot;tls-&quot;</span>);</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>}</div>
</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span> </div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01505" data-start="{" data-end="}">
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a03640b5e6e91173327f269d4b4275479"> 1505</a></span><a class="code hl_function" href="neighbors_8cc.html#a03640b5e6e91173327f269d4b4275479">dump_peers</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *sentry, <a class="code hl_class" href="classCachePeers.html">CachePeers</a> *peers)</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>{</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>    <span class="keywordtype">char</span> ntoabuf[<a class="code hl_define" href="ip_2forward_8h.html#a28806a9f06b4d32dab73b27053f10494">MAX_IPSTRLEN</a>];</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>    <span class="keywordflow">if</span> (!peers) {</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;There are no neighbors installed.\n&quot;</span>);</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>    }</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span> </div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;peer: *peers) {</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>        <span class="keyword">const</span> <span class="keyword">auto</span> e = peer.get();</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(e-&gt;host != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;\n%-11.11s: %s\n&quot;</span>,</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>                          <a class="code hl_function" href="neighbors_8cc.html#a7271928a2f26b9c331bd057c813e9865">neighborTypeStr</a>(e),</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>                          e-&gt;name);</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;Host       : %s/%d/%d\n&quot;</span>,</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>                          e-&gt;host,</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>                          e-&gt;http_port,</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>                          e-&gt;icp.port);</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;Flags      :&quot;</span>);</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>        <a class="code hl_function" href="neighbors_8cc.html#a616e3d85ea457a8b22ad8ee588d47e55">dump_peer_options</a>(sentry, e);</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span> </div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>        <span class="keywordflow">for</span> (i = 0; i &lt; e-&gt;n_addresses; ++i) {</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>            <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;Address[%d] : %s\n&quot;</span>, i,</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>                              e-&gt;addresses[i].toStr(ntoabuf,<a class="code hl_define" href="ip_2forward_8h.html#a28806a9f06b4d32dab73b27053f10494">MAX_IPSTRLEN</a>) );</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        }</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span> </div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;Status     : %s\n&quot;</span>,</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>                          <a class="code hl_function" href="neighbors_8cc.html#a6204ffb9f5e7d51413c2514de20d68cd">neighborUp</a>(e) ? <span class="stringliteral">&quot;Up&quot;</span> : <span class="stringliteral">&quot;Down&quot;</span>);</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;FETCHES    : %d\n&quot;</span>, e-&gt;stats.fetches);</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;OPEN CONNS : %d\n&quot;</span>, e-&gt;stats.conn_open);</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;AVG RTT    : %d msec\n&quot;</span>, e-&gt;stats.rtt);</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span> </div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>        <span class="keywordflow">if</span> (!e-&gt;options.no_query) {</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>            <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;LAST QUERY : %8d seconds ago\n&quot;</span>,</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>                              (<span class="keywordtype">int</span>) (<a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - e-&gt;stats.last_query));</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span> </div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>            <span class="keywordflow">if</span> (e-&gt;stats.last_reply &gt; 0)</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>                <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;LAST REPLY : %8d seconds ago\n&quot;</span>,</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>                                  (<span class="keywordtype">int</span>) (<a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> - e-&gt;stats.last_reply));</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>                <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;LAST REPLY : none received\n&quot;</span>);</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span> </div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>            <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;PINGS SENT : %8d\n&quot;</span>, e-&gt;stats.pings_sent);</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span> </div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>            <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;PINGS ACKED: %8d %3d%%\n&quot;</span>,</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>                              e-&gt;stats.pings_acked,</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>                              <a class="code hl_function" href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a>(e-&gt;stats.pings_acked, e-&gt;stats.pings_sent));</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>        }</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span> </div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;IGNORED    : %8d %3d%%\n&quot;</span>, e-&gt;stats.ignored_replies, <a class="code hl_function" href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a>(e-&gt;stats.ignored_replies, e-&gt;stats.pings_acked));</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span> </div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>        <span class="keywordflow">if</span> (!e-&gt;options.no_query) {</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>            <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;Histogram of PINGS ACKED:\n&quot;</span>);</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span> </div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>            <span class="keywordflow">if</span> (e-&gt;options.htcp) {</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>                <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;\tMisses\t%8d %3d%%\n&quot;</span>,</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>                                  e-&gt;htcp.counts[0],</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>                                  <a class="code hl_function" href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a>(e-&gt;htcp.counts[0], e-&gt;stats.pings_acked));</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>                <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;\tHits\t%8d %3d%%\n&quot;</span>,</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>                                  e-&gt;htcp.counts[1],</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>                                  <a class="code hl_function" href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a>(e-&gt;htcp.counts[1], e-&gt;stats.pings_acked));</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span> </div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> op : <a class="code hl_class" href="classWholeEnum.html">WholeEnum&lt;icp_opcode&gt;</a>()) {</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>                    <span class="keywordflow">if</span> (e-&gt;icp.counts[op] == 0)</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span> </div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>                    <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;    %12.12s : %8d %3d%%\n&quot;</span>,</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>                                      <a class="code hl_variable" href="icp__opcode_8h.html#ac1431af6f906aacf2b4af78e1474d619">icp_opcode_str</a>[op],</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>                                      e-&gt;icp.counts[op],</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>                                      <a class="code hl_function" href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a>(e-&gt;icp.counts[op], e-&gt;stats.pings_acked));</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>                }</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span> </div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span> </div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>            }</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span> </div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span> </div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>        }</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span> </div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>        <span class="keywordflow">if</span> (e-&gt;stats.last_connect_failure) {</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>            <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;Last failed connect() at: %s\n&quot;</span>,</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>                              <a class="code hl_function" href="namespaceTime.html#a9eae609ba8ed49e159c091173b47edc0">Time::FormatHttpd</a>(e-&gt;stats.last_connect_failure));</div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>        }</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span> </div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>        <a class="code hl_function" href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a>(sentry, <span class="stringliteral">&quot;keep-alive ratio: %d%%\n&quot;</span>, <a class="code hl_function" href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a>(e-&gt;stats.n_keepalives_recv, e-&gt;stats.n_keepalives_sent));</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>    }</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>}</div>
</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span> </div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span><span class="preprocessor">#if USE_HTCP</span></div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01601" data-start="{" data-end="}">
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"><a class="line" href="htcp_8h.html#aaa9eecbeee567215e059605461424f5a"> 1601</a></span><a class="code hl_function" href="neighbors_8cc.html#a4013e86a2af31337f8b6f1ad5cf77a1f">neighborsHtcpReply</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="store_2forward_8h.html#ab1424e1b13666cc28f4c5cb05f8c8305">cache_key</a> * key, <a class="code hl_class" href="classHtcpReplyData.html">HtcpReplyData</a> * htcp, <span class="keyword">const</span> <a class="code hl_class" href="classIp_1_1Address.html">Ip::Address</a> &amp;from)</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>{</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>    <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *e = <a class="code hl_function" href="namespaceStore.html#a0151d620409db8bd3af40e3570a18f8c">Store::Root</a>().<a class="code hl_function" href="classStore_1_1Controller.html#a16c6b4a12f5f01bee84ee04f2f2353a0">findCallbackXXX</a>(key);</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>    <a class="code hl_class" href="classMemObject.html">MemObject</a> *mem = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>    <a class="code hl_class" href="classCachePeer.html">CachePeer</a> *p;</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>    <a class="code hl_enumeration" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463">peer_t</a> ntype = <a class="code hl_enumvalue" href="enums_8h.html#addda50b75bf05b054b12d6edc2690463ad0a923afe5d043e0b2cebf2bc50400aa">PEER_NONE</a>;</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 6, <span class="stringliteral">&quot;neighborsHtcpReply: &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>           (htcp-&gt;<a class="code hl_variable" href="classHtcpReplyData.html#a5f0eec0d7628cc265518e80c6a23b2ac">hit</a> ? <span class="stringliteral">&quot;HIT&quot;</span> : <span class="stringliteral">&quot;MISS&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>           <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key)  );</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span> </div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>    <span class="keywordflow">if</span> (<span class="keyword">nullptr</span> != e)</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>        mem = e-&gt;<a class="code hl_variable" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">mem_obj</a>;</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span> </div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>    <span class="keywordflow">if</span> ((p = <a class="code hl_function" href="neighbors_8cc.html#a35194ab936916470ce011e25834b6572">whichPeer</a>(from)))</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>        <a class="code hl_function" href="neighbors_8cc.html#a2959da26b2b78dcef9887f71e725aa15">neighborAliveHtcp</a>(p, mem, htcp);</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span> </div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>    <span class="comment">/* Does the entry exist? */</span></div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>    <span class="keywordflow">if</span> (<span class="keyword">nullptr</span> == e) {</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(12, 3, <span class="stringliteral">&quot;neighyborsHtcpReply: Cache key &#39;&quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot;&#39; not found&quot;</span>);</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>    }</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span> </div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>    <span class="comment">/* check if someone is already fetching it */</span></div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>(e-&gt;<a class="code hl_variable" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">flags</a>, <a class="code hl_enumvalue" href="enums_8h.html#a16685eea158879e41b101ca3634de462ae584c58365523cce1a435dd86165d7a8">ENTRY_DISPATCHED</a>)) {</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;neighborsUdpAck: &#39;&quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot;&#39; already being fetched.&quot;</span>);</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>    }</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span> </div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>    <span class="keywordflow">if</span> (mem == <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 2, <span class="stringliteral">&quot;Ignoring reply for missing mem_obj: &quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key));</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>    }</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span> </div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>    <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="classStoreEntry.html#abc675c0ac6ddb7ddd97d2159439d74ac">ping_status</a> != <a class="code hl_enumvalue" href="enums_8h.html#a4bd207d3fdbf20f48de074b84f74563ea15e97486bd90d641808bbc2eb177cf94">PING_WAITING</a>) {</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 2, <span class="stringliteral">&quot;neighborsUdpAck: Entry &quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot; is not PING_WAITING&quot;</span>);</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>    }</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span> </div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>    <span class="keywordflow">if</span> (!e-&gt;<a class="code hl_function" href="classStoreEntry.html#a28ae41d1feaa7e59d3714b98fe8fdab1">locked</a>()) {</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>        <span class="comment">// TODO: many entries are unlocked; why is this reported at level 1?</span></div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(12, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;neighborsUdpAck: &#39;&quot;</span> &lt;&lt; <a class="code hl_function" href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a>(key) &lt;&lt; <span class="stringliteral">&quot;&#39; has no locks&quot;</span>);</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>    }</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span> </div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>    <span class="keywordflow">if</span> (!mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>) {</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(12, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: Squid BUG: missing HTCP callback data for &quot;</span> &lt;&lt; *e);</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>    }</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span> </div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>    <span class="keywordflow">if</span> (p) {</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>        ntype = <a class="code hl_function" href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a>(p, mem-&gt;<a class="code hl_variable" href="classMemObject.html#a38fde17e9fa64949670b7a25e0735e64">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>);</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>        <a class="code hl_function" href="neighbors_8cc.html#a4706bdd6d749bb72a80d49021c62d99f">neighborUpdateRtt</a>(p, mem);</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>    }</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span> </div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="neighbors_8cc.html#ac9518f7ddccf53e35d2e2f6adfc403f1">ignoreMulticastReply</a>(p, mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>)) {</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>        <a class="code hl_function" href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a>(p);</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>    }</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span> </div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;neighborsHtcpReply: e = &quot;</span> &lt;&lt; e);</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>    <span class="comment">// TODO: Refactor (ping_reply_callback,ircb_data) to add CodeContext.</span></div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>    mem-&gt;<a class="code hl_variable" href="classMemObject.html#a18e110d4e91e0ea0c7a8e827dc670935">ping_reply_callback</a>(p, ntype, <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca277a0d7571dfa3828d42713b4cc0dc2f">AnyP::PROTO_HTCP</a>, htcp, mem-&gt;<a class="code hl_variable" href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">ircb_data</a>);</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>}</div>
</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span> </div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span><span class="comment">/*</span></div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span><span class="comment"> * Send HTCP CLR messages to all peers configured to receive them.</span></div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span><span class="comment"> */</span></div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01675" data-start="{" data-end="}">
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"><a class="line" href="neighbors_8cc.html#a2f4988cdd50e3844d829a7c363dcce5c"> 1675</a></span><a class="code hl_function" href="neighbors_8cc.html#a2f4988cdd50e3844d829a7c363dcce5c">neighborsHtcpClear</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> * e, <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> * req, <span class="keyword">const</span> <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a> &amp;method, <a class="code hl_enumeration" href="enums_8h.html#a53f367a6c6ec6520d99a817d002ad400">htcp_clr_reason</a> reason)</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>{</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>    <span class="keywordtype">char</span> buf[128];</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span> </div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;p: <a class="code hl_function" href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a>()) {</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>        <span class="keywordflow">if</span> (!p-&gt;options.htcp) {</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>        }</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>        <span class="keywordflow">if</span> (p-&gt;options.htcp_no_clr) {</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>        }</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>        <span class="keywordflow">if</span> (p-&gt;options.htcp_no_purge_clr &amp;&amp; reason == <a class="code hl_enumvalue" href="enums_8h.html#a53f367a6c6ec6520d99a817d002ad400aa19c85f7acec13d3daa407a93c92f508">HTCP_CLR_PURGE</a>) {</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>        }</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(15, 3, <span class="stringliteral">&quot;neighborsHtcpClear: sending CLR to &quot;</span> &lt;&lt; p-&gt;in_addr.toUrl(buf, 128));</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>        <a class="code hl_function" href="htcp_8cc.html#a943b217cb6299040d1e73ce075ff792a">htcpClear</a>(e, req, method, p.get(), reason);</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>    }</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>}</div>
</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span> </div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span> </div>
<div class="ttc" id="aCacheDigest_8h_html"><div class="ttname"><a href="CacheDigest_8h.html">CacheDigest.h</a></div></div>
<div class="ttc" id="aCachePeer_8h_html"><div class="ttname"><a href="CachePeer_8h.html">CachePeer.h</a></div></div>
<div class="ttc" id="aCachePeers_8cc_html_a4a4382a6fc0e36e2d9863e9c12b96166"><div class="ttname"><a href="CachePeers_8cc.html#a4a4382a6fc0e36e2d9863e9c12b96166">CurrentCachePeers</a></div><div class="ttdeci">const CachePeers &amp; CurrentCachePeers()</div><div class="ttdef"><b>Definition</b> <a href="CachePeers_8cc_source.html#l00043">CachePeers.cc:43</a></div></div>
<div class="ttc" id="aCachePeers_8cc_html_ad48a5c1aea87248a83eabeea3e43f4e4"><div class="ttname"><a href="CachePeers_8cc.html#ad48a5c1aea87248a83eabeea3e43f4e4">DeleteConfigured</a></div><div class="ttdeci">void DeleteConfigured(CachePeer *const peer)</div><div class="ttdoc">destroys the given peer after removing it from the set of configured peers</div><div class="ttdef"><b>Definition</b> <a href="CachePeers_8cc_source.html#l00053">CachePeers.cc:53</a></div></div>
<div class="ttc" id="aCachePeers_8h_html"><div class="ttname"><a href="CachePeers_8h.html">CachePeers.h</a></div></div>
<div class="ttc" id="aCachePeers_8h_html_a4af61df3bd9cfba950e8ed1552b9339d"><div class="ttname"><a href="CachePeers_8h.html#a4af61df3bd9cfba950e8ed1552b9339d">RawCachePeers</a></div><div class="ttdeci">std::vector&lt; CachePeer *, PoolingAllocator&lt; CachePeer * &gt; &gt; RawCachePeers</div><div class="ttdoc">Temporary, local storage of raw pointers to zero or more Config.peers.</div><div class="ttdef"><b>Definition</b> <a href="CachePeers_8h_source.html#l00066">CachePeers.h:66</a></div></div>
<div class="ttc" id="aCodeContext_8h_html_a2117aeec5e8428af6ea46de4f55fd9f4"><div class="ttname"><a href="CodeContext_8h.html#a2117aeec5e8428af6ea46de4f55fd9f4">CallContextCreator</a></div><div class="ttdeci">void CallContextCreator(Fun &amp;&amp;creator)</div><div class="ttdef"><b>Definition</b> <a href="CodeContext_8h_source.html#l00166">CodeContext.h:166</a></div></div>
<div class="ttc" id="aCodeContext_8h_html_a6c9e0a7564c7a5974969252c8f953ad0"><div class="ttname"><a href="CodeContext_8h.html#a6c9e0a7564c7a5974969252c8f953ad0">CallService</a></div><div class="ttdeci">void CallService(const CodeContext::Pointer &amp;serviceContext, Fun &amp;&amp;service)</div><div class="ttdef"><b>Definition</b> <a href="CodeContext_8h_source.html#l00151">CodeContext.h:151</a></div></div>
<div class="ttc" id="aCodeContext_8h_html_ab89d6e6afe80c6e6e92e25761a96db02"><div class="ttname"><a href="CodeContext_8h.html#ab89d6e6afe80c6e6e92e25761a96db02">CallBack</a></div><div class="ttdeci">void CallBack(const CodeContext::Pointer &amp;callbackContext, Fun &amp;&amp;callback)</div><div class="ttdef"><b>Definition</b> <a href="CodeContext_8h_source.html#l00126">CodeContext.h:126</a></div></div>
<div class="ttc" id="aCommCalls_8h_html_a7e143fa246c3e54c90fa8d20b390b88d"><div class="ttname"><a href="CommCalls_8h.html#a7e143fa246c3e54c90fa8d20b390b88d">commCbCall</a></div><div class="ttdeci">CommCbFunPtrCallT&lt; Dialer &gt; * commCbCall(int debugSection, int debugLevel, const char *callName, const Dialer &amp;dialer)</div><div class="ttdef"><b>Definition</b> <a href="CommCalls_8h_source.html#l00312">CommCalls.h:312</a></div></div>
<div class="ttc" id="aCommCalls_8h_html_aafdebdf0576f8621014d6e8e9f245e8e"><div class="ttname"><a href="CommCalls_8h.html#aafdebdf0576f8621014d6e8e9f245e8e">CNCB</a></div><div class="ttdeci">void CNCB(const Comm::ConnectionPointer &amp;conn, Comm::Flag status, int xerrno, void *data)</div><div class="ttdef"><b>Definition</b> <a href="CommCalls_8h_source.html#l00033">CommCalls.h:33</a></div></div>
<div class="ttc" id="aConnOpener_8h_html"><div class="ttname"><a href="ConnOpener_8h.html">ConnOpener.h</a></div></div>
<div class="ttc" id="aConnection_8h_html"><div class="ttname"><a href="Connection_8h.html">Connection.h</a></div></div>
<div class="ttc" id="aEnumIterator_8h_html"><div class="ttname"><a href="EnumIterator_8h.html">EnumIterator.h</a></div></div>
<div class="ttc" id="aFilledChecklist_8h_html"><div class="ttname"><a href="FilledChecklist_8h.html">FilledChecklist.h</a></div></div>
<div class="ttc" id="aFwdState_8cc_html_a6de4cf90dc6698fccdb2ab106db67e53"><div class="ttname"><a href="FwdState_8cc.html#a6de4cf90dc6698fccdb2ab106db67e53">getOutgoingAddress</a></div><div class="ttdeci">void getOutgoingAddress(HttpRequest *request, const Comm::ConnectionPointer &amp;conn)</div><div class="ttdef"><b>Definition</b> <a href="FwdState_8cc_source.html#l01481">FwdState.cc:1481</a></div></div>
<div class="ttc" id="aFwdState_8h_html"><div class="ttname"><a href="FwdState_8h.html">FwdState.h</a></div></div>
<div class="ttc" id="aHttpRequest_8h_html"><div class="ttname"><a href="HttpRequest_8h.html">HttpRequest.h</a></div></div>
<div class="ttc" id="aICP_8h_html"><div class="ttname"><a href="ICP_8h.html">ICP.h</a></div></div>
<div class="ttc" id="aIoManip_8h_html"><div class="ttname"><a href="IoManip_8h.html">IoManip.h</a></div></div>
<div class="ttc" id="aIoManip_8h_html_afb10fe715d55bc0f31985b3de7269ce0"><div class="ttname"><a href="IoManip_8h.html#afb10fe715d55bc0f31985b3de7269ce0">RawPointer</a></div><div class="ttdeci">RawPointerT&lt; Pointer &gt; RawPointer(const char *label, const Pointer &amp;ptr)</div><div class="ttdoc">convenience wrapper for creating RawPointerT&lt;&gt; objects</div><div class="ttdef"><b>Definition</b> <a href="IoManip_8h_source.html#l00073">IoManip.h:73</a></div></div>
<div class="ttc" id="aMemObject_8h_html"><div class="ttname"><a href="MemObject_8h.html">MemObject.h</a></div></div>
<div class="ttc" id="aNeighborTypeDomainList_8h_html"><div class="ttname"><a href="NeighborTypeDomainList_8h.html">NeighborTypeDomainList.h</a></div></div>
<div class="ttc" id="aPackableStream_8h_html"><div class="ttname"><a href="PackableStream_8h.html">PackableStream.h</a></div></div>
<div class="ttc" id="aPeerDigest_8h_html"><div class="ttname"><a href="PeerDigest_8h.html">PeerDigest.h</a></div></div>
<div class="ttc" id="aPeerPoolMgr_8h_html"><div class="ttname"><a href="PeerPoolMgr_8h.html">PeerPoolMgr.h</a></div></div>
<div class="ttc" id="aPeerSelectState_8h_html"><div class="ttname"><a href="PeerSelectState_8h.html">PeerSelectState.h</a></div></div>
<div class="ttc" id="aPool_8cc_html_a161e26ef0307ccb4300ad3ea54bf9fd4"><div class="ttname"><a href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a></div><div class="ttdeci">time_t squid_curtime</div><div class="ttdef"><b>Definition</b> <a href="stub__libtime_8cc_source.html#l00020">stub_libtime.cc:20</a></div></div>
<div class="ttc" id="aPortCfg_8cc_html_ab5fc0d5e05159674db133b2f17786721"><div class="ttname"><a href="PortCfg_8cc.html#ab5fc0d5e05159674db133b2f17786721">HttpPortList</a></div><div class="ttdeci">AnyP::PortCfgPointer HttpPortList</div><div class="ttdoc">list of Squid http(s)_port configured</div><div class="ttdef"><b>Definition</b> <a href="PortCfg_8cc_source.html#l00022">PortCfg.cc:22</a></div></div>
<div class="ttc" id="aPortCfg_8h_html"><div class="ttname"><a href="PortCfg_8h.html">PortCfg.h</a></div></div>
<div class="ttc" id="aPrecomputedCodeContext_8h_html"><div class="ttname"><a href="PrecomputedCodeContext_8h.html">PrecomputedCodeContext.h</a></div></div>
<div class="ttc" id="aRegistration_8h_html"><div class="ttname"><a href="Registration_8h.html">Registration.h</a></div></div>
<div class="ttc" id="aRequestFlags_8h_html"><div class="ttname"><a href="RequestFlags_8h.html">RequestFlags.h</a></div></div>
<div class="ttc" id="aSquidConfig_8cc_html_a75b136e6a1eef61424d84596a404aafe"><div class="ttname"><a href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a></div><div class="ttdeci">class SquidConfig Config</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8cc_source.html#l00012">SquidConfig.cc:12</a></div></div>
<div class="ttc" id="aSquidConfig_8h_html"><div class="ttname"><a href="SquidConfig_8h.html">SquidConfig.h</a></div></div>
<div class="ttc" id="aSquidMath_8h_html"><div class="ttname"><a href="SquidMath_8h.html">SquidMath.h</a></div></div>
<div class="ttc" id="aStore_8h_html"><div class="ttname"><a href="Store_8h.html">Store.h</a></div></div>
<div class="ttc" id="aUri_8cc_html_a7b3d400c54dd0ce685ac6c136ae73fe3"><div class="ttname"><a href="Uri_8cc.html#a7b3d400c54dd0ce685ac6c136ae73fe3">matchDomainName</a></div><div class="ttdeci">int matchDomainName(const char *h, const char *d, MatchDomainNameFlags flags)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00903">Uri.cc:903</a></div></div>
<div class="ttc" id="aassert_8h_html_a33fa45e42155e69ce8d0da0fd978b351"><div class="ttname"><a href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a></div><div class="ttdeci">#define assert(EX)</div><div class="ttdef"><b>Definition</b> <a href="assert_8h_source.html#l00017">assert.h:17</a></div></div>
<div class="ttc" id="acbdata_8cc_html_aa6ed5c53b844c6f8f3e7c39daa051835"><div class="ttname"><a href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a></div><div class="ttdeci">int cbdataReferenceValid(const void *p)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8cc_source.html#l00270">cbdata.cc:270</a></div></div>
<div class="ttc" id="acbdata_8h_html_a178af3acec8011dd955016f69e307037"><div class="ttname"><a href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a></div><div class="ttdeci">#define cbdataReferenceDone(var)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8h_source.html#l00357">cbdata.h:357</a></div></div>
<div class="ttc" id="acbdata_8h_html_a23338dbb451f460facd39a8a249bab46"><div class="ttname"><a href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a></div><div class="ttdeci">#define cbdataReference(var)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8h_source.html#l00348">cbdata.h:348</a></div></div>
<div class="ttc" id="aclassACLChecklist_html_a51ae541a90994e7ed5d11f2b242ac689"><div class="ttname"><a href="classACLChecklist.html#a51ae541a90994e7ed5d11f2b242ac689">ACLChecklist::fastCheck</a></div><div class="ttdeci">Acl::Answer const &amp; fastCheck()</div><div class="ttdef"><b>Definition</b> <a href="Checklist_8cc_source.html#l00298">Checklist.cc:298</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html"><div class="ttname"><a href="classACLFilledChecklist.html">ACLFilledChecklist</a></div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8h_source.html#l00033">FilledChecklist.h:34</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_a53bba78d7127a7707cb956a87ff5914f"><div class="ttname"><a href="classACLFilledChecklist.html#a53bba78d7127a7707cb956a87ff5914f">ACLFilledChecklist::updateAle</a></div><div class="ttdeci">void updateAle(const AccessLogEntry::Pointer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8cc_source.html#l00242">FilledChecklist.cc:242</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_ae77611904901fa5f796cdd54ff5be235"><div class="ttname"><a href="classACLFilledChecklist.html#ae77611904901fa5f796cdd54ff5be235">ACLFilledChecklist::syncAle</a></div><div class="ttdeci">void syncAle(HttpRequest *adaptedRequest, const char *logUri) const override</div><div class="ttdoc">assigns uninitialized adapted_request and url ALE components</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8cc_source.html#l00110">FilledChecklist.cc:110</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html"><div class="ttname"><a href="classAccessLogEntry.html">AccessLogEntry</a></div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00040">AccessLogEntry.h:41</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a92312350a82deb4331b171bdea7ff3d5"><div class="ttname"><a href="classAccessLogEntry.html#a92312350a82deb4331b171bdea7ff3d5">AccessLogEntry::request</a></div><div class="ttdeci">HttpRequest * request</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00192">AccessLogEntry.h:192</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_af1a1444d19654eb50f7a4323b225f845"><div class="ttname"><a href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">Acl::Answer::allowed</a></div><div class="ttdeci">bool allowed() const</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00082">Acl.h:82</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html"><div class="ttname"><a href="classAnyP_1_1Uri.html">AnyP::Uri</a></div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00031">Uri.h:32</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_a2c86b2285f5a7f86cd1862e8d7b8fe48"><div class="ttname"><a href="classAnyP_1_1Uri.html#a2c86b2285f5a7f86cd1862e8d7b8fe48">AnyP::Uri::authority</a></div><div class="ttdeci">SBuf &amp; authority(bool requirePort=false) const</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00721">Uri.cc:721</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_aa09ef977328523ec48e7440c83d728d3"><div class="ttname"><a href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">AnyP::Uri::port</a></div><div class="ttdeci">void port(const Port p)</div><div class="ttdoc">reset authority port subcomponent</div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00090">Uri.h:90</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_aab379cecc273683d9744197a8a2efe3f"><div class="ttname"><a href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">AnyP::Uri::host</a></div><div class="ttdeci">void host(const char *src)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00142">Uri.cc:142</a></div></div>
<div class="ttc" id="aclassAsList_html"><div class="ttname"><a href="classAsList.html">AsList</a></div><div class="ttdoc">std::ostream manipulator to print containers as flat lists</div><div class="ttdef"><b>Definition</b> <a href="IoManip_8h_source.html#l00176">IoManip.h:177</a></div></div>
<div class="ttc" id="aclassAsList_html_a055e350d6c5943cdee06c81fd9c0f2ee"><div class="ttname"><a href="classAsList.html#a055e350d6c5943cdee06c81fd9c0f2ee">AsList::prefixedBy</a></div><div class="ttdeci">auto &amp; prefixedBy(const char *const p)</div><div class="ttdoc">a c-string to print before the first item (if any). Caller must ensure lifetime.</div><div class="ttdef"><b>Definition</b> <a href="IoManip_8h_source.html#l00182">IoManip.h:182</a></div></div>
<div class="ttc" id="aclassAsyncJob_html_a1dd42e9842d751193268966d4e0de2fa"><div class="ttname"><a href="classAsyncJob.html#a1dd42e9842d751193268966d4e0de2fa">AsyncJob::Start</a></div><div class="ttdeci">static void Start(const Pointer &amp;job)</div><div class="ttdef"><b>Definition</b> <a href="AsyncJob_8cc_source.html#l00037">AsyncJob.cc:37</a></div></div>
<div class="ttc" id="aclassCacheDigest_html_ac90e2c408e8506147161e55be8034196"><div class="ttname"><a href="classCacheDigest.html#ac90e2c408e8506147161e55be8034196">CacheDigest::contains</a></div><div class="ttdeci">bool contains(const cache_key *key) const</div><div class="ttdef"><b>Definition</b> <a href="CacheDigest_8cc_source.html#l00093">CacheDigest.cc:93</a></div></div>
<div class="ttc" id="aclassCachePeer_html"><div class="ttname"><a href="classCachePeer.html">CachePeer</a></div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00028">CachePeer.h:29</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a036f9c7fbaa3a6349e9dd9907e1be493"><div class="ttname"><a href="classCachePeer.html#a036f9c7fbaa3a6349e9dd9907e1be493">CachePeer::mgr</a></div><div class="ttdeci">CbcPointer&lt; PeerPoolMgr &gt; mgr</div><div class="ttdoc">pool manager</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00210">CachePeer.h:210</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a03b69eae2546205189dca431108df849"><div class="ttname"><a href="classCachePeer.html#a03b69eae2546205189dca431108df849">CachePeer::access</a></div><div class="ttdeci">acl_access * access</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00106">CachePeer.h:106</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a08c1fc1ca2060d8bdcc81d76986d8ec9"><div class="ttname"><a href="classCachePeer.html#a08c1fc1ca2060d8bdcc81d76986d8ec9">CachePeer::closest_only</a></div><div class="ttdeci">bool closest_only</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00117">CachePeer.h:117</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a099da3c06991015bbd06783a6e0edf5d"><div class="ttname"><a href="classCachePeer.html#a099da3c06991015bbd06783a6e0edf5d">CachePeer::ttl</a></div><div class="ttdeci">int ttl</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00157">CachePeer.h:157</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a0ee59f5508602bcdedea5da21ff637b9"><div class="ttname"><a href="classCachePeer.html#a0ee59f5508602bcdedea5da21ff637b9">CachePeer::flags</a></div><div class="ttdeci">struct CachePeer::@21::@27 flags</div></div>
<div class="ttc" id="aclassCachePeer_html_a1104787b07b92c5729f1a19612442774"><div class="ttname"><a href="classCachePeer.html#a1104787b07b92c5729f1a19612442774">CachePeer::weight</a></div><div class="ttdeci">int weight</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00150">CachePeer.h:150</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a18adce57e82d63f531a1960c27008de9"><div class="ttname"><a href="classCachePeer.html#a18adce57e82d63f531a1960c27008de9">CachePeer::no_tproxy</a></div><div class="ttdeci">bool no_tproxy</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00145">CachePeer.h:145</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a19120e578ee688ab17dda05e53910b79"><div class="ttname"><a href="classCachePeer.html#a19120e578ee688ab17dda05e53910b79">CachePeer::noteSuccess</a></div><div class="ttdeci">void noteSuccess()</div><div class="ttdoc">reacts to a successful establishment of a connection to this cache_peer</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8cc_source.html#l00071">CachePeer.cc:71</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a1c804690c3eb3bfec5bb48f843aaec50"><div class="ttname"><a href="classCachePeer.html#a1c804690c3eb3bfec5bb48f843aaec50">CachePeer::htcp_oldsquid</a></div><div class="ttdeci">bool htcp_oldsquid</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00120">CachePeer.h:120</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a2070482adb78ba4350ebf0d440ce0320"><div class="ttname"><a href="classCachePeer.html#a2070482adb78ba4350ebf0d440ce0320">CachePeer::no_query</a></div><div class="ttdeci">bool no_query</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00110">CachePeer.h:110</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a28e677328934360f043df4f59a50e170"><div class="ttname"><a href="classCachePeer.html#a28e677328934360f043df4f59a50e170">CachePeer::typelist</a></div><div class="ttdeci">NeighborTypeDomainList * typelist</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00105">CachePeer.h:105</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a2af7df2cefe385a8be7166043c13e428"><div class="ttname"><a href="classCachePeer.html#a2af7df2cefe385a8be7166043c13e428">CachePeer::basetime</a></div><div class="ttdeci">int basetime</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00151">CachePeer.h:151</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a2ba3d3e239dfe40eeeaa71e0c1aaf474"><div class="ttname"><a href="classCachePeer.html#a2ba3d3e239dfe40eeeaa71e0c1aaf474">CachePeer::originserver</a></div><div class="ttdeci">bool originserver</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00144">CachePeer.h:144</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a2d8d88c51d813d6007883a30bbe1e3bd"><div class="ttname"><a href="classCachePeer.html#a2d8d88c51d813d6007883a30bbe1e3bd">CachePeer::probe_start</a></div><div class="ttdeci">time_t probe_start</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00080">CachePeer.h:80</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a2fe608047662f759eaf97b7a508af398"><div class="ttname"><a href="classCachePeer.html#a2fe608047662f759eaf97b7a508af398">CachePeer::background_ping</a></div><div class="ttdeci">bool background_ping</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00111">CachePeer.h:111</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a2ffcaeb2d17288fee2a81fd172768e77"><div class="ttname"><a href="classCachePeer.html#a2ffcaeb2d17288fee2a81fd172768e77">CachePeer::type</a></div><div class="ttdeci">peer_t type</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00068">CachePeer.h:68</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a384937a844027d00648fda6d36daec49"><div class="ttname"><a href="classCachePeer.html#a384937a844027d00648fda6d36daec49">CachePeer::roundrobin</a></div><div class="ttdeci">bool roundrobin</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00114">CachePeer.h:114</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a39dd2792e239fd1ecc6d27f5fc8f6835"><div class="ttname"><a href="classCachePeer.html#a39dd2792e239fd1ecc6d27f5fc8f6835">CachePeer::n_addresses</a></div><div class="ttdeci">int n_addresses</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00180">CachePeer.h:180</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a39f5acb9d66f637c8d27be9f1f823166"><div class="ttname"><a href="classCachePeer.html#a39f5acb9d66f637c8d27be9f1f823166">CachePeer::connection_auth</a></div><div class="ttdeci">int connection_auth</div><div class="ttdoc">0 - off, 1 - on, 2 - auto</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00226">CachePeer.h:226</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a3dc02dbd17b636da58479328568a2418"><div class="ttname"><a href="classCachePeer.html#a3dc02dbd17b636da58479328568a2418">CachePeer::options</a></div><div class="ttdeci">struct CachePeer::@20 options</div></div>
<div class="ttc" id="aclassCachePeer_html_a40813ba2a7cf12d12260d2dfeb3b1314"><div class="ttname"><a href="classCachePeer.html#a40813ba2a7cf12d12260d2dfeb3b1314">CachePeer::http_port</a></div><div class="ttdeci">unsigned short http_port</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00104">CachePeer.h:104</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a410f45c12710f7113f514995e01818d5"><div class="ttname"><a href="classCachePeer.html#a410f45c12710f7113f514995e01818d5">CachePeer::proxy_only</a></div><div class="ttdeci">bool proxy_only</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00109">CachePeer.h:109</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a42b7b744d0dc0f53bceefa656cd3db2f"><div class="ttname"><a href="classCachePeer.html#a42b7b744d0dc0f53bceefa656cd3db2f">CachePeer::logged_state</a></div><div class="ttdeci">int logged_state</div><div class="ttdoc">so we can print dead/revived msgs</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00085">CachePeer.h:85</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a45c8c94c5eae33e78bed43d1e72392f7"><div class="ttname"><a href="classCachePeer.html#a45c8c94c5eae33e78bed43d1e72392f7">CachePeer::login</a></div><div class="ttdeci">char * login</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00202">CachePeer.h:202</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a467df38358a093c2802f4566d66031c5"><div class="ttname"><a href="classCachePeer.html#a467df38358a093c2802f4566d66031c5">CachePeer::last_connect_probe</a></div><div class="ttdeci">time_t last_connect_probe</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00084">CachePeer.h:84</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a47a9d8c6643a0db61a021da00e46b4d6"><div class="ttname"><a href="classCachePeer.html#a47a9d8c6643a0db61a021da00e46b4d6">CachePeer::htcp_no_purge_clr</a></div><div class="ttdeci">bool htcp_no_purge_clr</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00122">CachePeer.h:122</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a4814933194c07f6802ea7ed1d4ed5333"><div class="ttname"><a href="classCachePeer.html#a4814933194c07f6802ea7ed1d4ed5333">CachePeer::host</a></div><div class="ttdeci">char * host</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00066">CachePeer.h:66</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a49218ccd1ad47df72504d20ce05708fb"><div class="ttname"><a href="classCachePeer.html#a49218ccd1ad47df72504d20ce05708fb">CachePeer::secure</a></div><div class="ttdeci">Security::PeerOptions secure</div><div class="ttdoc">security settings for peer connection</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00219">CachePeer.h:219</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a4a27174fc92bdc5c030843fce011b510"><div class="ttname"><a href="classCachePeer.html#a4a27174fc92bdc5c030843fce011b510">CachePeer::connect_timeout_raw</a></div><div class="ttdeci">time_t connect_timeout_raw</div><div class="ttdoc">connect_timeout; use connectTimeout() instead!</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00203">CachePeer.h:203</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a4d52949f4e7b5a66fde23eb77db0ba2f"><div class="ttname"><a href="classCachePeer.html#a4d52949f4e7b5a66fde23eb77db0ba2f">CachePeer::stats</a></div><div class="ttdeci">struct CachePeer::@18 stats</div></div>
<div class="ttc" id="aclassCachePeer_html_a4e78fd5911048b90b98d31b280d07584"><div class="ttname"><a href="classCachePeer.html#a4e78fd5911048b90b98d31b280d07584">CachePeer::mcast_siblings</a></div><div class="ttdeci">bool mcast_siblings</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00146">CachePeer.h:146</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a4ea5d017e23eca60a1bfea169d1fa65f"><div class="ttname"><a href="classCachePeer.html#a4ea5d017e23eca60a1bfea169d1fa65f">CachePeer::mcast</a></div><div class="ttdeci">struct CachePeer::@21 mcast</div></div>
<div class="ttc" id="aclassCachePeer_html_a4fba08f4a9726af8550cec1f1c882929"><div class="ttname"><a href="classCachePeer.html#a4fba08f4a9726af8550cec1f1c882929">CachePeer::domain</a></div><div class="ttdeci">char * domain</div><div class="ttdoc">Forced domain.</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00215">CachePeer.h:215</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a599290c15fe0b49f68c3eef688b1f2c1"><div class="ttname"><a href="classCachePeer.html#a599290c15fe0b49f68c3eef688b1f2c1">CachePeer::limit</a></div><div class="ttdeci">int limit</div><div class="ttdoc">the limit itself</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00211">CachePeer.h:211</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a5efd94cd1a9a2172b65b722e5a301930"><div class="ttname"><a href="classCachePeer.html#a5efd94cd1a9a2172b65b722e5a301930">CachePeer::last_query</a></div><div class="ttdeci">time_t last_query</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00081">CachePeer.h:81</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a64e1e876fa08746da1b79e86c2d6d813"><div class="ttname"><a href="classCachePeer.html#a64e1e876fa08746da1b79e86c2d6d813">CachePeer::digest</a></div><div class="ttdeci">PeerDigest * digest</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00167">CachePeer.h:167</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a6591206c520bac20de02b72f676a6f63"><div class="ttname"><a href="classCachePeer.html#a6591206c520bac20de02b72f676a6f63">CachePeer::n_replies_expected</a></div><div class="ttdeci">int n_replies_expected</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00156">CachePeer.h:156</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a681001ee29c539d8a69da90e02bb1bd3"><div class="ttname"><a href="classCachePeer.html#a681001ee29c539d8a69da90e02bb1bd3">CachePeer::standby</a></div><div class="ttdeci">struct CachePeer::@25 standby</div><div class="ttdoc">optional &quot;cache_peer standby=limit&quot; feature</div></div>
<div class="ttc" id="aclassCachePeer_html_a6ed7962606a135352c6da45b8f2e15b0"><div class="ttname"><a href="classCachePeer.html#a6ed7962606a135352c6da45b8f2e15b0">CachePeer::tcp_up</a></div><div class="ttdeci">int tcp_up</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00174">CachePeer.h:174</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a6f38fbfcc6346d512046509354cc1593"><div class="ttname"><a href="classCachePeer.html#a6f38fbfcc6346d512046509354cc1593">CachePeer::counting</a></div><div class="ttdeci">bool counting</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00162">CachePeer.h:162</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a7461a008582b379b87e748d77cab0f48"><div class="ttname"><a href="classCachePeer.html#a7461a008582b379b87e748d77cab0f48">CachePeer::rtt</a></div><div class="ttdeci">int rtt</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00076">CachePeer.h:76</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a76bfddd22641f1e14e86ddbcc2554fb5"><div class="ttname"><a href="classCachePeer.html#a76bfddd22641f1e14e86ddbcc2554fb5">CachePeer::no_digest</a></div><div class="ttdeci">bool no_digest</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00112">CachePeer.h:112</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a79513f2c22539a00977a378a76c0b785"><div class="ttname"><a href="classCachePeer.html#a79513f2c22539a00977a378a76c0b785">CachePeer::probeCodeContext</a></div><div class="ttdeci">PrecomputedCodeContextPointer probeCodeContext</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00228">CachePeer.h:228</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a79c8e800cf69519ad047397ab6ad654a"><div class="ttname"><a href="classCachePeer.html#a79c8e800cf69519ad047397ab6ad654a">CachePeer::htcp_forward_clr</a></div><div class="ttdeci">bool htcp_forward_clr</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00124">CachePeer.h:124</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a7e893e0d2562bd9b0d07b1165930fa7a"><div class="ttname"><a href="classCachePeer.html#a7e893e0d2562bd9b0d07b1165930fa7a">CachePeer::in_addr</a></div><div class="ttdeci">Ip::Address in_addr</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00070">CachePeer.h:70</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a83c6b7cce16925d938d57390147f14d1"><div class="ttname"><a href="classCachePeer.html#a83c6b7cce16925d938d57390147f14d1">CachePeer::pool</a></div><div class="ttdeci">PconnPool * pool</div><div class="ttdoc">idle connection pool for this peer</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00209">CachePeer.h:209</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a83cee9f4da7e45b1ada1e06ea80bab97"><div class="ttname"><a href="classCachePeer.html#a83cee9f4da7e45b1ada1e06ea80bab97">CachePeer::rr_count</a></div><div class="ttdeci">int rr_count</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00181">CachePeer.h:181</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a864f1c60136138c295027c5e66e7b856"><div class="ttname"><a href="classCachePeer.html#a864f1c60136138c295027c5e66e7b856">CachePeer::waitingForClose</a></div><div class="ttdeci">bool waitingForClose</div><div class="ttdoc">a conn must close before we open a standby conn</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00212">CachePeer.h:212</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a8667e92e95ae67f517fb8eea1ec10c71"><div class="ttname"><a href="classCachePeer.html#a8667e92e95ae67f517fb8eea1ec10c71">CachePeer::sourcehash</a></div><div class="ttdeci">bool sourcehash</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00143">CachePeer.h:143</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a97f0b5a40c44f62e522f5655af0e3a52"><div class="ttname"><a href="classCachePeer.html#a97f0b5a40c44f62e522f5655af0e3a52">CachePeer::connect_fail_limit</a></div><div class="ttdeci">int connect_fail_limit</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00204">CachePeer.h:204</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a9abeb6df63f1be6e0fd8a103e9f3c4dc"><div class="ttname"><a href="classCachePeer.html#a9abeb6df63f1be6e0fd8a103e9f3c4dc">CachePeer::avg_n_members</a></div><div class="ttdeci">double avg_n_members</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00154">CachePeer.h:154</a></div></div>
<div class="ttc" id="aclassCachePeer_html_a9da4b46136652731cf1e3ff0385df71c"><div class="ttname"><a href="classCachePeer.html#a9da4b46136652731cf1e3ff0385df71c">CachePeer::n_times_counted</a></div><div class="ttdeci">int n_times_counted</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00155">CachePeer.h:155</a></div></div>
<div class="ttc" id="aclassCachePeer_html_aa21b8498cfb83397082d3891eefa3c60"><div class="ttname"><a href="classCachePeer.html#aa21b8498cfb83397082d3891eefa3c60">CachePeer::icp</a></div><div class="ttdeci">struct CachePeer::icp_ icp</div></div>
<div class="ttc" id="aclassCachePeer_html_aa5a02f29a28c869be32f108b9efd4e9b"><div class="ttname"><a href="classCachePeer.html#aa5a02f29a28c869be32f108b9efd4e9b">CachePeer::last_reply</a></div><div class="ttdeci">time_t last_reply</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00082">CachePeer.h:82</a></div></div>
<div class="ttc" id="aclassCachePeer_html_aa61d3169817932801f3ed763d01cd1a1"><div class="ttname"><a href="classCachePeer.html#aa61d3169817932801f3ed763d01cd1a1">CachePeer::pings_acked</a></div><div class="ttdeci">int pings_acked</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00074">CachePeer.h:74</a></div></div>
<div class="ttc" id="aclassCachePeer_html_aa734ccb87a40743dbb6875d8111e5028"><div class="ttname"><a href="classCachePeer.html#aa734ccb87a40743dbb6875d8111e5028">CachePeer::no_netdb_exchange</a></div><div class="ttdeci">bool no_netdb_exchange</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00126">CachePeer.h:126</a></div></div>
<div class="ttc" id="aclassCachePeer_html_aa7370aac507d880d83b9870f7a55808e"><div class="ttname"><a href="classCachePeer.html#aa7370aac507d880d83b9870f7a55808e">CachePeer::max_conn</a></div><div class="ttdeci">int max_conn</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00205">CachePeer.h:205</a></div></div>
<div class="ttc" id="aclassCachePeer_html_aafaf87cf3eafe51ba094e15cfb8658c4"><div class="ttname"><a href="classCachePeer.html#aafaf87cf3eafe51ba094e15cfb8658c4">CachePeer::htcp_only_clr</a></div><div class="ttdeci">bool htcp_only_clr</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00123">CachePeer.h:123</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ab1a1dfaf669fc25152c2be16a946f2fd"><div class="ttname"><a href="classCachePeer.html#ab1a1dfaf669fc25152c2be16a946f2fd">CachePeer::connectTimeout</a></div><div class="ttdeci">time_t connectTimeout() const</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8cc_source.html#l00120">CachePeer.cc:120</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ab6c74c1f4da3944782c5bdfa8f83537a"><div class="ttname"><a href="classCachePeer.html#ab6c74c1f4da3944782c5bdfa8f83537a">CachePeer::htcp</a></div><div class="ttdeci">struct CachePeer::@19 htcp</div></div>
<div class="ttc" id="aclassCachePeer_html_ab8a85494c94d76cc97d8a9e0adf8b211"><div class="ttname"><a href="classCachePeer.html#ab8a85494c94d76cc97d8a9e0adf8b211">CachePeer::noteFailure</a></div><div class="ttdeci">void noteFailure()</div><div class="ttdoc">reacts to a failed attempt to establish a connection to this cache_peer</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8cc_source.html#l00086">CachePeer.cc:86</a></div></div>
<div class="ttc" id="aclassCachePeer_html_abbedb65b25cbc4601b52d2cb5816bc54"><div class="ttname"><a href="classCachePeer.html#abbedb65b25cbc4601b52d2cb5816bc54">CachePeer::counts</a></div><div class="ttdeci">int counts[2]</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00099">CachePeer.h:99</a></div></div>
<div class="ttc" id="aclassCachePeer_html_abc87932b395973128c0cd70bbd07e44e"><div class="ttname"><a href="classCachePeer.html#abc87932b395973128c0cd70bbd07e44e">CachePeer::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00158">CachePeer.h:158</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ac0716cdb0843618bc9d5b5c9974064b3"><div class="ttname"><a href="classCachePeer.html#ac0716cdb0843618bc9d5b5c9974064b3">CachePeer::count_event_pending</a></div><div class="ttdeci">bool count_event_pending</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00161">CachePeer.h:161</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ac3cb464ce25d44b4feb5fc5bd9ed3bf8"><div class="ttname"><a href="classCachePeer.html#ac3cb464ce25d44b4feb5fc5bd9ed3bf8">CachePeer::addresses</a></div><div class="ttdeci">Ip::Address addresses[10]</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00179">CachePeer.h:179</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ac7b7ecf1985ea57a3efcfcd9a8e18ed0"><div class="ttname"><a href="classCachePeer.html#ac7b7ecf1985ea57a3efcfcd9a8e18ed0">CachePeer::userhash</a></div><div class="ttdeci">bool userhash</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00141">CachePeer.h:141</a></div></div>
<div class="ttc" id="aclassCachePeer_html_acb0282c434b70a1c78b2a5f9ea5c4c7e"><div class="ttname"><a href="classCachePeer.html#acb0282c434b70a1c78b2a5f9ea5c4c7e">CachePeer::conn_open</a></div><div class="ttdeci">int conn_open</div><div class="ttdoc">current opened connections</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00086">CachePeer.h:86</a></div></div>
<div class="ttc" id="aclassCachePeer_html_acc18bde012c717d1126ea1c81ce5c917"><div class="ttname"><a href="classCachePeer.html#acc18bde012c717d1126ea1c81ce5c917">CachePeer::testing_now</a></div><div class="ttdeci">int testing_now</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00182">CachePeer.h:182</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ad18ff2989e40a004e6e1d73ed2e870de"><div class="ttname"><a href="classCachePeer.html#ad18ff2989e40a004e6e1d73ed2e870de">CachePeer::default_parent</a></div><div class="ttdeci">bool default_parent</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00113">CachePeer.h:113</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ad39e6933dfe2d7a99c3d02e8960be2f5"><div class="ttname"><a href="classCachePeer.html#ad39e6933dfe2d7a99c3d02e8960be2f5">CachePeer::carp</a></div><div class="ttdeci">bool carp</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00131">CachePeer.h:131</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ad5e828e3ab98fbb77222218d3d729538"><div class="ttname"><a href="classCachePeer.html#ad5e828e3ab98fbb77222218d3d729538">CachePeer::reprobe</a></div><div class="ttdeci">bool reprobe</div><div class="ttdoc">whether to do another TCP probe after current TCP probes</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00177">CachePeer.h:177</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ad77395380adaae2134c229c467560fe2"><div class="ttname"><a href="classCachePeer.html#ad77395380adaae2134c229c467560fe2">CachePeer::allow_miss</a></div><div class="ttdeci">bool allow_miss</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00130">CachePeer.h:130</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ad8ea2a3d2732c898cd79ad7135e70042"><div class="ttname"><a href="classCachePeer.html#ad8ea2a3d2732c898cd79ad7135e70042">CachePeer::digest_url</a></div><div class="ttdeci">char * digest_url</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00168">CachePeer.h:168</a></div></div>
<div class="ttc" id="aclassCachePeer_html_adefabca74b91fafd268b85890e7bdf70"><div class="ttname"><a href="classCachePeer.html#adefabca74b91fafd268b85890e7bdf70">CachePeer::ignored_replies</a></div><div class="ttdeci">int ignored_replies</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00077">CachePeer.h:77</a></div></div>
<div class="ttc" id="aclassCachePeer_html_ae976c3cef591d0264017bef17953fbb4"><div class="ttname"><a href="classCachePeer.html#ae976c3cef591d0264017bef17953fbb4">CachePeer::version</a></div><div class="ttdeci">double version</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00098">CachePeer.h:98</a></div></div>
<div class="ttc" id="aclassCachePeer_html_af0657aea0b49b487f865790989219873"><div class="ttname"><a href="classCachePeer.html#af0657aea0b49b487f865790989219873">CachePeer::mcast_responder</a></div><div class="ttdeci">bool mcast_responder</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00116">CachePeer.h:116</a></div></div>
<div class="ttc" id="aclassCachePeer_html_af2cf8e8f51c4eba604ec3385a62ea59f"><div class="ttname"><a href="classCachePeer.html#af2cf8e8f51c4eba604ec3385a62ea59f">CachePeer::weighted_roundrobin</a></div><div class="ttdeci">bool weighted_roundrobin</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00115">CachePeer.h:115</a></div></div>
<div class="ttc" id="aclassCachePeer_html_afe36faa4e2091e8f191098f29706f711"><div class="ttname"><a href="classCachePeer.html#afe36faa4e2091e8f191098f29706f711">CachePeer::htcp_no_clr</a></div><div class="ttdeci">bool htcp_no_clr</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00121">CachePeer.h:121</a></div></div>
<div class="ttc" id="aclassCachePeer_html_affc00eb35ee322cc4a79bcd4d0813004"><div class="ttname"><a href="classCachePeer.html#affc00eb35ee322cc4a79bcd4d0813004">CachePeer::no_delay</a></div><div class="ttdeci">bool no_delay</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00128">CachePeer.h:128</a></div></div>
<div class="ttc" id="aclassCachePeers_html"><div class="ttname"><a href="classCachePeers.html">CachePeers</a></div><div class="ttdoc">cache_peer configuration storage</div><div class="ttdef"><b>Definition</b> <a href="CachePeers_8h_source.html#l00020">CachePeers.h:21</a></div></div>
<div class="ttc" id="aclassCachePeers_html_a670f2a5d2223e467937af6feaff1ea81"><div class="ttname"><a href="classCachePeers.html#a670f2a5d2223e467937af6feaff1ea81">CachePeers::nextPeerToPing</a></div><div class="ttdeci">CachePeer &amp; nextPeerToPing(size_t iteration)</div><div class="ttdef"><b>Definition</b> <a href="CachePeers_8cc_source.html#l00016">CachePeers.cc:16</a></div></div>
<div class="ttc" id="aclassCachePeers_html_ab43ed6e7a0d89c588f80629dda0fd700"><div class="ttname"><a href="classCachePeers.html#ab43ed6e7a0d89c588f80629dda0fd700">CachePeers::size</a></div><div class="ttdeci">auto size() const</div><div class="ttdoc">the number of currently stored (i.e. added and not removed) cache_peers</div><div class="ttdef"><b>Definition</b> <a href="CachePeers_8h_source.html#l00033">CachePeers.h:33</a></div></div>
<div class="ttc" id="aclassCbcPointer_html_a2125df76c0d5eb45bdb8b18e88a71258"><div class="ttname"><a href="classCbcPointer.html#a2125df76c0d5eb45bdb8b18e88a71258">CbcPointer::valid</a></div><div class="ttdeci">Cbc * valid() const</div><div class="ttdoc">was set and is valid</div><div class="ttdef"><b>Definition</b> <a href="CbcPointer_8h_source.html#l00041">CbcPointer.h:41</a></div></div>
<div class="ttc" id="aclassCodeContext_html_a13251c00d03b5a9cb9f3b164f0154969"><div class="ttname"><a href="classCodeContext.html#a13251c00d03b5a9cb9f3b164f0154969">CodeContext::Current</a></div><div class="ttdeci">static const Pointer &amp; Current()</div><div class="ttdef"><b>Definition</b> <a href="CodeContext_8cc_source.html#l00033">CodeContext.cc:33</a></div></div>
<div class="ttc" id="aclassCodeContext_html_aeed1567dd2fb1c97eb3fa3f10df4622e"><div class="ttname"><a href="classCodeContext.html#aeed1567dd2fb1c97eb3fa3f10df4622e">CodeContext::Reset</a></div><div class="ttdeci">static void Reset()</div><div class="ttdoc">forgets the current context, setting it to nil/unknown</div><div class="ttdef"><b>Definition</b> <a href="CodeContext_8cc_source.html#l00077">CodeContext.cc:77</a></div></div>
<div class="ttc" id="aclassCommConnectCbPtrFun_html"><div class="ttname"><a href="classCommConnectCbPtrFun.html">CommConnectCbPtrFun</a></div><div class="ttdef"><b>Definition</b> <a href="CommCalls_8h_source.html#l00213">CommCalls.h:215</a></div></div>
<div class="ttc" id="aclassComm_1_1ConnOpener_html"><div class="ttname"><a href="classComm_1_1ConnOpener.html">Comm::ConnOpener</a></div><div class="ttdef"><b>Definition</b> <a href="ConnOpener_8h_source.html#l00024">ConnOpener.h:25</a></div></div>
<div class="ttc" id="aclassComm_1_1ConnOpener_html_a544daa6afdf9190a2611f6d4d3bc6858"><div class="ttname"><a href="classComm_1_1ConnOpener.html#a544daa6afdf9190a2611f6d4d3bc6858">Comm::ConnOpener::setHost</a></div><div class="ttdeci">void setHost(const char *)</div><div class="ttdoc">set the hostname note for this connection</div><div class="ttdef"><b>Definition</b> <a href="ConnOpener_8cc_source.html#l00101">ConnOpener.cc:101</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html"><div class="ttname"><a href="classComm_1_1Connection.html">Comm::Connection</a></div><div class="ttdef"><b>Definition</b> <a href="Connection_8h_source.html#l00072">Connection.h:73</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_a32253e90999f679dc032e19ad50d03ab"><div class="ttname"><a href="classComm_1_1Connection.html#a32253e90999f679dc032e19ad50d03ab">Comm::Connection::close</a></div><div class="ttdeci">void close()</div><div class="ttdef"><b>Definition</b> <a href="Connection_8cc_source.html#l00091">Connection.cc:91</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_a60e1b863400f49a2ed17054982561f17"><div class="ttname"><a href="classComm_1_1Connection.html#a60e1b863400f49a2ed17054982561f17">Comm::Connection::remote</a></div><div class="ttdeci">Ip::Address remote</div><div class="ttdef"><b>Definition</b> <a href="Connection_8h_source.html#l00152">Connection.h:152</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_a8e53f4d6fd38545947a5aac6efb98fca"><div class="ttname"><a href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">Comm::Connection::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition</b> <a href="Connection_8h_source.html#l00158">Connection.h:158</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_aec3a3c580255b361496f5ac226b52662"><div class="ttname"><a href="classComm_1_1Connection.html#aec3a3c580255b361496f5ac226b52662">Comm::Connection::setPeer</a></div><div class="ttdeci">void setPeer(CachePeer *p)</div><div class="ttdef"><b>Definition</b> <a href="Connection_8cc_source.html#l00119">Connection.cc:119</a></div></div>
<div class="ttc" id="aclassDebug_html_a469eccf6573cacd9bc0682d3fc0eaf11"><div class="ttname"><a href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a></div><div class="ttdeci">static std::ostream &amp; Extra(std::ostream &amp;)</div><div class="ttdef"><b>Definition</b> <a href="src_2debug_2debug_8cc_source.html#l01316">debug.cc:1316</a></div></div>
<div class="ttc" id="aclassDns_1_1CachedIps_html"><div class="ttname"><a href="classDns_1_1CachedIps.html">Dns::CachedIps</a></div><div class="ttdef"><b>Definition</b> <a href="ipcache_8h_source.html#l00050">ipcache.h:51</a></div></div>
<div class="ttc" id="aclassDns_1_1CachedIps_html_a93ed5f38618ad8eab791d9b061564f2a"><div class="ttname"><a href="classDns_1_1CachedIps.html#a93ed5f38618ad8eab791d9b061564f2a">Dns::CachedIps::size</a></div><div class="ttdeci">size_t size() const noexcept</div><div class="ttdoc">all cached IPs</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8h_source.html#l00062">ipcache.h:62</a></div></div>
<div class="ttc" id="aclassDns_1_1CachedIps_html_aa75731a5995b1ad85792a426e072f8d4"><div class="ttname"><a href="classDns_1_1CachedIps.html#aa75731a5995b1ad85792a426e072f8d4">Dns::CachedIps::goodAndBad</a></div><div class="ttdeci">IpsSelector&lt; IpsIterator &gt; goodAndBad() const</div><div class="ttdoc">all IPs</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8h_source.html#l00249">ipcache.h:249</a></div></div>
<div class="ttc" id="aclassDns_1_1CachedIps_html_af66593cb074c88d14d6f9d825578b80c"><div class="ttname"><a href="classDns_1_1CachedIps.html#af66593cb074c88d14d6f9d825578b80c">Dns::CachedIps::empty</a></div><div class="ttdeci">bool empty() const noexcept</div><div class="ttdoc">whether we cached no IPs at all</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8h_source.html#l00061">ipcache.h:61</a></div></div>
<div class="ttc" id="aclassDns_1_1LookupDetails_html"><div class="ttname"><a href="classDns_1_1LookupDetails.html">Dns::LookupDetails</a></div><div class="ttdoc">encapsulates DNS lookup results</div><div class="ttdef"><b>Definition</b> <a href="LookupDetails_8h_source.html#l00022">LookupDetails.h:23</a></div></div>
<div class="ttc" id="aclassHierarchyLogEntry_html_a1b3cc298994ca401fef84bda02daff4a"><div class="ttname"><a href="classHierarchyLogEntry.html#a1b3cc298994ca401fef84bda02daff4a">HierarchyLogEntry::n_ichoices</a></div><div class="ttdeci">int n_ichoices</div><div class="ttdef"><b>Definition</b> <a href="HierarchyLogEntry_8h_source.html#l00052">HierarchyLogEntry.h:52</a></div></div>
<div class="ttc" id="aclassHierarchyLogEntry_html_a86cabf331cbdd5a5e70245013241adf9"><div class="ttname"><a href="classHierarchyLogEntry.html#a86cabf331cbdd5a5e70245013241adf9">HierarchyLogEntry::n_choices</a></div><div class="ttdeci">int n_choices</div><div class="ttdef"><b>Definition</b> <a href="HierarchyLogEntry_8h_source.html#l00051">HierarchyLogEntry.h:51</a></div></div>
<div class="ttc" id="aclassHierarchyLogEntry_html_a8b87db00f544adccbd5ccca6f3909a0a"><div class="ttname"><a href="classHierarchyLogEntry.html#a8b87db00f544adccbd5ccca6f3909a0a">HierarchyLogEntry::cd_lookup</a></div><div class="ttdeci">lookup_t cd_lookup</div><div class="ttdef"><b>Definition</b> <a href="HierarchyLogEntry_8h_source.html#l00050">HierarchyLogEntry.h:50</a></div></div>
<div class="ttc" id="aclassHierarchyLogEntry_html_a9fb0537096678e05f7dc8aac3ba45712"><div class="ttname"><a href="classHierarchyLogEntry.html#a9fb0537096678e05f7dc8aac3ba45712">HierarchyLogEntry::cd_host</a></div><div class="ttdeci">char cd_host[SQUIDHOSTNAMELEN]</div><div class="ttdef"><b>Definition</b> <a href="HierarchyLogEntry_8h_source.html#l00049">HierarchyLogEntry.h:49</a></div></div>
<div class="ttc" id="aclassHtcpReplyData_html"><div class="ttname"><a href="classHtcpReplyData.html">HtcpReplyData</a></div><div class="ttdef"><b>Definition</b> <a href="htcp_8h_source.html#l00021">htcp.h:22</a></div></div>
<div class="ttc" id="aclassHtcpReplyData_html_a38d8834c72b5f3055df08a522f4133f4"><div class="ttname"><a href="classHtcpReplyData.html#a38d8834c72b5f3055df08a522f4133f4">HtcpReplyData::version</a></div><div class="ttdeci">double version</div><div class="ttdef"><b>Definition</b> <a href="htcp_8h_source.html#l00033">htcp.h:33</a></div></div>
<div class="ttc" id="aclassHtcpReplyData_html_a5f0eec0d7628cc265518e80c6a23b2ac"><div class="ttname"><a href="classHtcpReplyData.html#a5f0eec0d7628cc265518e80c6a23b2ac">HtcpReplyData::hit</a></div><div class="ttdeci">int hit</div><div class="ttdef"><b>Definition</b> <a href="htcp_8h_source.html#l00030">htcp.h:30</a></div></div>
<div class="ttc" id="aclassHttpRequestMethod_html"><div class="ttname"><a href="classHttpRequestMethod.html">HttpRequestMethod</a></div><div class="ttdef"><b>Definition</b> <a href="RequestMethod_8h_source.html#l00026">RequestMethod.h:27</a></div></div>
<div class="ttc" id="aclassHttpRequest_html"><div class="ttname"><a href="classHttpRequest.html">HttpRequest</a></div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00048">HttpRequest.h:49</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a1f0af82ff15e9a29d15319fc3cf05a54"><div class="ttname"><a href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">HttpRequest::method</a></div><div class="ttdeci">HttpRequestMethod method</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00114">HttpRequest.h:114</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a3738e100587f43de4a040b3f0463e21d"><div class="ttname"><a href="classHttpRequest.html#a3738e100587f43de4a040b3f0463e21d">HttpRequest::FromUrlXXX</a></div><div class="ttdeci">static HttpRequest * FromUrlXXX(const char *url, const MasterXaction::Pointer &amp;, const HttpRequestMethod &amp;method=Http::METHOD_GET)</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00525">HttpRequest.cc:525</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a5c031f584be4a77277cccd49b0d4cea1"><div class="ttname"><a href="classHttpRequest.html#a5c031f584be4a77277cccd49b0d4cea1">HttpRequest::hier</a></div><div class="ttdeci">HierarchyLogEntry hier</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00157">HttpRequest.h:157</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a76422841293a4230a1a76479e6964c04"><div class="ttname"><a href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">HttpRequest::flags</a></div><div class="ttdeci">RequestFlags flags</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00141">HttpRequest.h:141</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_af191362e7cf9b99f7f15dd20a0076e89"><div class="ttname"><a href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">HttpRequest::url</a></div><div class="ttdeci">AnyP::Uri url</div><div class="ttdoc">the request URI</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00115">HttpRequest.h:115</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html"><div class="ttname"><a href="classIp_1_1Address.html">Ip::Address</a></div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8h_source.html#l00042">Address.h:43</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html_a09eb8f9dd1beaf5e4f1b32069489991c"><div class="ttname"><a href="classIp_1_1Address.html#a09eb8f9dd1beaf5e4f1b32069489991c">Ip::Address::setEmpty</a></div><div class="ttdeci">void setEmpty()</div><div class="ttdoc">Fast reset of the stored content to what would be after default constructor.</div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8cc_source.html#l00204">Address.cc:204</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html_ac22c561fa1b3873a204feb18dd9a16b1"><div class="ttname"><a href="classIp_1_1Address.html#ac22c561fa1b3873a204feb18dd9a16b1">Ip::Address::toUrl</a></div><div class="ttdeci">char * toUrl(char *buf, unsigned int len) const</div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8cc_source.html#l00886">Address.cc:886</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html_aeea3c669850f18acd2efcd336fcf2438"><div class="ttname"><a href="classIp_1_1Address.html#aeea3c669850f18acd2efcd336fcf2438">Ip::Address::port</a></div><div class="ttdeci">unsigned short port() const</div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8cc_source.html#l00790">Address.cc:790</a></div></div>
<div class="ttc" id="aclassMemObject_html"><div class="ttname"><a href="classMemObject.html">MemObject</a></div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00033">MemObject.h:34</a></div></div>
<div class="ttc" id="aclassMemObject_html_a18e110d4e91e0ea0c7a8e827dc670935"><div class="ttname"><a href="classMemObject.html#a18e110d4e91e0ea0c7a8e827dc670935">MemObject::ping_reply_callback</a></div><div class="ttdeci">IRCB * ping_reply_callback</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00208">MemObject.h:208</a></div></div>
<div class="ttc" id="aclassMemObject_html_a38fde17e9fa64949670b7a25e0735e64"><div class="ttname"><a href="classMemObject.html#a38fde17e9fa64949670b7a25e0735e64">MemObject::request</a></div><div class="ttdeci">HttpRequestPointer request</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00205">MemObject.h:205</a></div></div>
<div class="ttc" id="aclassMemObject_html_a3ca25b28a215cbe414f7cd1426e27492"><div class="ttname"><a href="classMemObject.html#a3ca25b28a215cbe414f7cd1426e27492">MemObject::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00214">MemObject.h:214</a></div></div>
<div class="ttc" id="aclassMemObject_html_a8f812f26bacafb538c67d2bf1157ad1b"><div class="ttname"><a href="classMemObject.html#a8f812f26bacafb538c67d2bf1157ad1b">MemObject::start_ping</a></div><div class="ttdeci">struct timeval start_ping</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00207">MemObject.h:207</a></div></div>
<div class="ttc" id="aclassMemObject_html_aef0b7a8c5b3530d263e02ff1a52a7d12"><div class="ttname"><a href="classMemObject.html#aef0b7a8c5b3530d263e02ff1a52a7d12">MemObject::ircb_data</a></div><div class="ttdeci">PeerSelector * ircb_data</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00209">MemObject.h:209</a></div></div>
<div class="ttc" id="aclassNeighborTypeDomainList_html"><div class="ttname"><a href="classNeighborTypeDomainList.html">NeighborTypeDomainList</a></div><div class="ttdoc">representation of a neighbor_type_domain configuration directive. A POD</div><div class="ttdef"><b>Definition</b> <a href="NeighborTypeDomainList_8h_source.html#l00015">NeighborTypeDomainList.h:16</a></div></div>
<div class="ttc" id="aclassNeighborTypeDomainList_html_a0adbdf895bddcea9295c5ac583c3de75"><div class="ttname"><a href="classNeighborTypeDomainList.html#a0adbdf895bddcea9295c5ac583c3de75">NeighborTypeDomainList::next</a></div><div class="ttdeci">NeighborTypeDomainList * next</div><div class="ttdef"><b>Definition</b> <a href="NeighborTypeDomainList_8h_source.html#l00020">NeighborTypeDomainList.h:20</a></div></div>
<div class="ttc" id="aclassNeighborTypeDomainList_html_a61474a3a24696d016422c6aceb71e986"><div class="ttname"><a href="classNeighborTypeDomainList.html#a61474a3a24696d016422c6aceb71e986">NeighborTypeDomainList::type</a></div><div class="ttdeci">peer_t type</div><div class="ttdef"><b>Definition</b> <a href="NeighborTypeDomainList_8h_source.html#l00019">NeighborTypeDomainList.h:19</a></div></div>
<div class="ttc" id="aclassNeighborTypeDomainList_html_a81fcb8ff55e7cf638faa0495732fe1c8"><div class="ttname"><a href="classNeighborTypeDomainList.html#a81fcb8ff55e7cf638faa0495732fe1c8">NeighborTypeDomainList::domain</a></div><div class="ttdeci">char * domain</div><div class="ttdef"><b>Definition</b> <a href="NeighborTypeDomainList_8h_source.html#l00018">NeighborTypeDomainList.h:18</a></div></div>
<div class="ttc" id="aclassPackableStream_html"><div class="ttname"><a href="classPackableStream.html">PackableStream</a></div><div class="ttdef"><b>Definition</b> <a href="PackableStream_8h_source.html#l00075">PackableStream.h:76</a></div></div>
<div class="ttc" id="aclassPconnPool_html_ab2690752a2c7d7083cbe05e62929be6a"><div class="ttname"><a href="classPconnPool.html#ab2690752a2c7d7083cbe05e62929be6a">PconnPool::count</a></div><div class="ttdeci">void count(int uses)</div></div>
<div class="ttc" id="aclassPeerDigest_html_a425fece3a08f57e0f794cf006b1c9112"><div class="ttname"><a href="classPeerDigest.html#a425fece3a08f57e0f794cf006b1c9112">PeerDigest::requested</a></div><div class="ttdeci">bool requested</div><div class="ttdef"><b>Definition</b> <a href="PeerDigest_8h_source.html#l00094">PeerDigest.h:94</a></div></div>
<div class="ttc" id="aclassPeerDigest_html_a59a4907a5a66f391b1659694673251bc"><div class="ttname"><a href="classPeerDigest.html#a59a4907a5a66f391b1659694673251bc">PeerDigest::usable</a></div><div class="ttdeci">bool usable</div><div class="ttdef"><b>Definition</b> <a href="PeerDigest_8h_source.html#l00093">PeerDigest.h:93</a></div></div>
<div class="ttc" id="aclassPeerDigest_html_aa9a3df5f91ebee81d092046902dab9df"><div class="ttname"><a href="classPeerDigest.html#aa9a3df5f91ebee81d092046902dab9df">PeerDigest::needed</a></div><div class="ttdeci">bool needed</div><div class="ttdef"><b>Definition</b> <a href="PeerDigest_8h_source.html#l00092">PeerDigest.h:92</a></div></div>
<div class="ttc" id="aclassPeerDigest_html_ad2f08cb6eb573ad26f71187d597af2e9"><div class="ttname"><a href="classPeerDigest.html#ad2f08cb6eb573ad26f71187d597af2e9">PeerDigest::flags</a></div><div class="ttdeci">struct PeerDigest::@67 flags</div></div>
<div class="ttc" id="aclassPeerDigest_html_ad4120741fa9efb6fa9584d0ff2c402de"><div class="ttname"><a href="classPeerDigest.html#ad4120741fa9efb6fa9584d0ff2c402de">PeerDigest::cd</a></div><div class="ttdeci">CacheDigest * cd</div><div class="ttdef"><b>Definition</b> <a href="PeerDigest_8h_source.html#l00087">PeerDigest.h:87</a></div></div>
<div class="ttc" id="aclassPeerPoolMgr_html_a9c260a8493349ce76cab309db15cc6e1"><div class="ttname"><a href="classPeerPoolMgr.html#a9c260a8493349ce76cab309db15cc6e1">PeerPoolMgr::Checkpoint</a></div><div class="ttdeci">static void Checkpoint(const Pointer &amp;mgr, const char *reason)</div><div class="ttdef"><b>Definition</b> <a href="PeerPoolMgr_8cc_source.html#l00232">PeerPoolMgr.cc:232</a></div></div>
<div class="ttc" id="aclassPeerSelector_html"><div class="ttname"><a href="classPeerSelector.html">PeerSelector</a></div><div class="ttdef"><b>Definition</b> <a href="PeerSelectState_8h_source.html#l00059">PeerSelectState.h:60</a></div></div>
<div class="ttc" id="aclassPeerSelector_html_a1760014f1b1de222593d20382247182b"><div class="ttname"><a href="classPeerSelector.html#a1760014f1b1de222593d20382247182b">PeerSelector::request</a></div><div class="ttdeci">HttpRequest * request</div><div class="ttdef"><b>Definition</b> <a href="PeerSelectState_8h_source.html#l00097">PeerSelectState.h:97</a></div></div>
<div class="ttc" id="aclassPeerSelector_html_a5719e63197c98cac3c0683d664af3b38"><div class="ttname"><a href="classPeerSelector.html#a5719e63197c98cac3c0683d664af3b38">PeerSelector::al</a></div><div class="ttdeci">AccessLogEntry::Pointer al</div><div class="ttdoc">info for the future access.log entry</div><div class="ttdef"><b>Definition</b> <a href="PeerSelectState_8h_source.html#l00098">PeerSelectState.h:98</a></div></div>
<div class="ttc" id="aclassPeerSelector_html_a725d048b0004bb792306dedbf856e0a6"><div class="ttname"><a href="classPeerSelector.html#a725d048b0004bb792306dedbf856e0a6">PeerSelector::peerCountMcastPeerXXX</a></div><div class="ttdeci">void * peerCountMcastPeerXXX</div><div class="ttdoc">a hack to help peerCountMcastPeersStart()</div><div class="ttdef"><b>Definition</b> <a href="PeerSelectState_8h_source.html#l00101">PeerSelectState.h:101</a></div></div>
<div class="ttc" id="aclassPeerSelector_html_a778bd6b42f0a49a14067908dcf8f080f"><div class="ttname"><a href="classPeerSelector.html#a778bd6b42f0a49a14067908dcf8f080f">PeerSelector::ping</a></div><div class="ttdeci">ping_data ping</div><div class="ttdef"><b>Definition</b> <a href="PeerSelectState_8h_source.html#l00103">PeerSelectState.h:103</a></div></div>
<div class="ttc" id="aclassPeerSelector_html_aa2b7ac619cd597540412221172ac4634"><div class="ttname"><a href="classPeerSelector.html#aa2b7ac619cd597540412221172ac4634">PeerSelector::entry</a></div><div class="ttdeci">StoreEntry * entry</div><div class="ttdef"><b>Definition</b> <a href="PeerSelectState_8h_source.html#l00099">PeerSelectState.h:99</a></div></div>
<div class="ttc" id="aclassRefCount_html"><div class="ttname"><a href="classRefCount.html">RefCount&lt; PortCfg &gt;</a></div></div>
<div class="ttc" id="aclassRequestFlags_html"><div class="ttname"><a href="classRequestFlags.html">RequestFlags</a></div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00022">RequestFlags.h:23</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a0247d4ae2646e09402e31bc09c7ff4c6"><div class="ttname"><a href="classRequestFlags.html#a0247d4ae2646e09402e31bc09c7ff4c6">RequestFlags::needValidation</a></div><div class="ttdeci">bool needValidation</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00050">RequestFlags.h:50</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a452db2a617d946222557c73d97888918"><div class="ttname"><a href="classRequestFlags.html#a452db2a617d946222557c73d97888918">RequestFlags::noCache</a></div><div class="ttdeci">bool noCache</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00026">RequestFlags.h:26</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a8f900e1c576cb7ea9b979d7001540025"><div class="ttname"><a href="classRequestFlags.html#a8f900e1c576cb7ea9b979d7001540025">RequestFlags::refresh</a></div><div class="ttdeci">bool refresh</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00044">RequestFlags.h:44</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_ace4ab3e57a3fa9e3197ce200ecdf653a"><div class="ttname"><a href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">RequestFlags::loopDetected</a></div><div class="ttdeci">bool loopDetected</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00040">RequestFlags.h:40</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_af8a2c52a07a38ceb366a512eab1d854b"><div class="ttname"><a href="classRequestFlags.html#af8a2c52a07a38ceb366a512eab1d854b">RequestFlags::hierarchical</a></div><div class="ttdeci">bool hierarchical</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00038">RequestFlags.h:38</a></div></div>
<div class="ttc" id="aclassSecurity_1_1PeerOptions_html_ab4b2b3c3282aee37218bb28d5884a803"><div class="ttname"><a href="classSecurity_1_1PeerOptions.html#ab4b2b3c3282aee37218bb28d5884a803">Security::PeerOptions::dumpCfg</a></div><div class="ttdeci">virtual void dumpCfg(std::ostream &amp;, const char *pfx) const</div><div class="ttdoc">output squid.conf syntax with 'pfx' prefix on parameters for the stored settings</div><div class="ttdef"><b>Definition</b> <a href="PeerOptions_8cc_source.html#l00110">PeerOptions.cc:110</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a1bd0123600a9c5ad8828e0fb0747d4c3"><div class="ttname"><a href="classSquidConfig.html#a1bd0123600a9c5ad8828e0fb0747d4c3">SquidConfig::deadPeer</a></div><div class="ttdeci">time_t deadPeer</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00124">SquidConfig.h:124</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a44fd4482861466a6562be245352771cb"><div class="ttname"><a href="classSquidConfig.html#a44fd4482861466a6562be245352771cb">SquidConfig::mcast_icp_query</a></div><div class="ttdeci">int mcast_icp_query</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00129">SquidConfig.h:129</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a616f6fb80c58175d607c035c74744b17"><div class="ttname"><a href="classSquidConfig.html#a616f6fb80c58175d607c035c74744b17">SquidConfig::Timeout</a></div><div class="ttdeci">struct SquidConfig::@77 Timeout</div></div>
<div class="ttc" id="aclassSquidConfig_html_a837a34c05e214cee3ef0a2c17285b82a"><div class="ttname"><a href="classSquidConfig.html#a837a34c05e214cee3ef0a2c17285b82a">SquidConfig::icp_query_max</a></div><div class="ttdeci">int icp_query_max</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00127">SquidConfig.h:127</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a859f8be49d92d04469051dd6f304e9a8"><div class="ttname"><a href="classSquidConfig.html#a859f8be49d92d04469051dd6f304e9a8">SquidConfig::peers</a></div><div class="ttdeci">CachePeers * peers</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00247">SquidConfig.h:247</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a89bec7bc02d66eb2ab65c74c3f6b13ac"><div class="ttname"><a href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">SquidConfig::onoff</a></div><div class="ttdeci">struct SquidConfig::@90 onoff</div></div>
<div class="ttc" id="aclassSquidConfig_html_a929d4ff2de22582634f37e2523f73d20"><div class="ttname"><a href="classSquidConfig.html#a929d4ff2de22582634f37e2523f73d20">SquidConfig::icp_query_min</a></div><div class="ttdeci">int icp_query_min</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00128">SquidConfig.h:128</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a9cd83a8e2feaa63684c1b820821d5093"><div class="ttname"><a href="classSquidConfig.html#a9cd83a8e2feaa63684c1b820821d5093">SquidConfig::query_icmp</a></div><div class="ttdeci">int query_icmp</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00282">SquidConfig.h:282</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_aa11776521bdbbd1348221ea9d7237907"><div class="ttname"><a href="classSquidConfig.html#aa11776521bdbbd1348221ea9d7237907">SquidConfig::icp</a></div><div class="ttdeci">unsigned short icp</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00141">SquidConfig.h:141</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ac7f4e2240c8dc2d56abe34caef997beb"><div class="ttname"><a href="classSquidConfig.html#ac7f4e2240c8dc2d56abe34caef997beb">SquidConfig::Port</a></div><div class="ttdeci">struct SquidConfig::@78 Port</div></div>
<div class="ttc" id="aclassSquidConfig_html_ad7192b1392b8c86408ef2ed76ea18bc6"><div class="ttname"><a href="classSquidConfig.html#ad7192b1392b8c86408ef2ed76ea18bc6">SquidConfig::icp_query</a></div><div class="ttdeci">int icp_query</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00126">SquidConfig.h:126</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ade552a1fb91b50004f0d1b89a14935f9"><div class="ttname"><a href="classSquidConfig.html#ade552a1fb91b50004f0d1b89a14935f9">SquidConfig::backgroundPingRate</a></div><div class="ttdeci">time_t backgroundPingRate</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00108">SquidConfig.h:108</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ae4b11be553f50f26ce088bc4ab7d0c84"><div class="ttname"><a href="classSquidConfig.html#ae4b11be553f50f26ce088bc4ab7d0c84">SquidConfig::htcp</a></div><div class="ttdeci">unsigned short htcp</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00144">SquidConfig.h:144</a></div></div>
<div class="ttc" id="aclassStoreEntry_html"><div class="ttname"><a href="classStoreEntry.html">StoreEntry</a></div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00037">Store.h:38</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a15b61bc1167a3670130a81bc5eca9f16"><div class="ttname"><a href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">StoreEntry::flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00231">Store.h:231</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a28ae41d1feaa7e59d3714b98fe8fdab1"><div class="ttname"><a href="classStoreEntry.html#a28ae41d1feaa7e59d3714b98fe8fdab1">StoreEntry::locked</a></div><div class="ttdeci">int locked() const</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00145">Store.h:145</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a35618603cff249c1cc64abf8127f3b7d"><div class="ttname"><a href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">StoreEntry::unlock</a></div><div class="ttdeci">int unlock(const char *context)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00469">store.cc:469</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a3835284a1cb3623987d557c9754e5ffc"><div class="ttname"><a href="classStoreEntry.html#a3835284a1cb3623987d557c9754e5ffc">StoreEntry::url</a></div><div class="ttdeci">const char * url() const</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01566">store.cc:1566</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a4b622f050f56a5d977471cbdd41fe869"><div class="ttname"><a href="classStoreEntry.html#a4b622f050f56a5d977471cbdd41fe869">StoreEntry::hasDisk</a></div><div class="ttdeci">bool hasDisk(const sdirno dirn=-1, const sfileno filen=-1) const</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01929">store.cc:1929</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a88e8fcd41e9d2d0c24ea68daa9a4eb57"><div class="ttname"><a href="classStoreEntry.html#a88e8fcd41e9d2d0c24ea68daa9a4eb57">StoreEntry::getMD5Text</a></div><div class="ttdeci">const char * getMD5Text() const</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00207">store.cc:207</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_ab79c9d3fba14d5c997bae61161d9992f"><div class="ttname"><a href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">StoreEntry::mem_obj</a></div><div class="ttdeci">MemObject * mem_obj</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00220">Store.h:220</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_abc675c0ac6ddb7ddd97d2159439d74ac"><div class="ttname"><a href="classStoreEntry.html#abc675c0ac6ddb7ddd97d2159439d74ac">StoreEntry::ping_status</a></div><div class="ttdeci">ping_status_t ping_status</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00241">Store.h:241</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_ace7147cc8e2b3795b763329829954795"><div class="ttname"><a href="classStoreEntry.html#ace7147cc8e2b3795b763329829954795">StoreEntry::abort</a></div><div class="ttdeci">void abort()</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01077">store.cc:1077</a></div></div>
<div class="ttc" id="aclassStore_1_1Controller_html_a16c6b4a12f5f01bee84ee04f2f2353a0"><div class="ttname"><a href="classStore_1_1Controller.html#a16c6b4a12f5f01bee84ee04f2f2353a0">Store::Controller::findCallbackXXX</a></div><div class="ttdeci">StoreEntry * findCallbackXXX(const cache_key *)</div><div class="ttdef"><b>Definition</b> <a href="Controller_8cc_source.html#l00389">Controller.cc:389</a></div></div>
<div class="ttc" id="aclassWholeEnum_html"><div class="ttname"><a href="classWholeEnum.html">WholeEnum</a></div><div class="ttdef"><b>Definition</b> <a href="EnumIterator_8h_source.html#l00221">EnumIterator.h:222</a></div></div>
<div class="ttc" id="aclasshash__link_html_ae8c6b512f09a15a32ce953deb2e58ffb"><div class="ttname"><a href="classhash__link.html#ae8c6b512f09a15a32ce953deb2e58ffb">hash_link::key</a></div><div class="ttdeci">void * key</div><div class="ttdef"><b>Definition</b> <a href="hash_8h_source.html#l00019">hash.h:19</a></div></div>
<div class="ttc" id="aclassicp__common__t_html"><div class="ttname"><a href="classicp__common__t.html">icp_common_t</a></div><div class="ttdef"><b>Definition</b> <a href="ICP_8h_source.html#l00035">ICP.h:35</a></div></div>
<div class="ttc" id="aclassicp__common__t_html_a30e6fde4cdb580e70b438508311a9f9e"><div class="ttname"><a href="classicp__common__t.html#a30e6fde4cdb580e70b438508311a9f9e">icp_common_t::version</a></div><div class="ttdeci">unsigned char version</div><div class="ttdef"><b>Definition</b> <a href="ICP_8h_source.html#l00040">ICP.h:40</a></div></div>
<div class="ttc" id="aclassicp__common__t_html_aafb31bceebb70d4463d29aa9866b6b15"><div class="ttname"><a href="classicp__common__t.html#aafb31bceebb70d4463d29aa9866b6b15">icp_common_t::opcode</a></div><div class="ttdeci">unsigned char opcode</div><div class="ttdef"><b>Definition</b> <a href="ICP_8h_source.html#l00038">ICP.h:38</a></div></div>
<div class="ttc" id="aclassping__data_html_a49e745664d82b1960bbc3a0332e1c33f"><div class="ttname"><a href="classping__data.html#a49e745664d82b1960bbc3a0332e1c33f">ping_data::n_recv</a></div><div class="ttdeci">int n_recv</div><div class="ttdef"><b>Definition</b> <a href="PingData_8h_source.html#l00039">PingData.h:39</a></div></div>
<div class="ttc" id="acompat__shared_8h_html_a3d8cde9338394cf0f0f324862cd78533"><div class="ttname"><a href="compat__shared_8h.html#a3d8cde9338394cf0f0f324862cd78533">max</a></div><div class="ttdeci">A const &amp; max(A const &amp;lhs, A const &amp;rhs)</div><div class="ttdef"><b>Definition</b> <a href="compat__shared_8h_source.html#l00124">compat_shared.h:124</a></div></div>
<div class="ttc" id="adebug_2Messages_8h_html"><div class="ttname"><a href="debug_2Messages_8h.html">Messages.h</a></div></div>
<div class="ttc" id="adebug_2Messages_8h_html_a3627f132658efd674ba366496239d303"><div class="ttname"><a href="debug_2Messages_8h.html#a3627f132658efd674ba366496239d303">Important</a></div><div class="ttdeci">#define Important(id)</div><div class="ttdef"><b>Definition</b> <a href="debug_2Messages_8h_source.html#l00093">Messages.h:93</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_ad1f6f001d275799243ee96d0b1519d3a"><div class="ttname"><a href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a></div><div class="ttdeci">#define DBG_IMPORTANT</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00038">Stream.h:38</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_ad8cd33a7d75c0efd4d3fd369dc6a8f13"><div class="ttname"><a href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a></div><div class="ttdeci">#define debugs(SECTION, LEVEL, CONTENT)</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00192">Stream.h:192</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_af0ecf487aee4d8ff164c0f40e71c5150"><div class="ttname"><a href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a></div><div class="ttdeci">#define DBG_CRITICAL</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00037">Stream.h:37</a></div></div>
<div class="ttc" id="adefines_8h_html_a11b068a3943fb56b10a37b25d8cdb2c8"><div class="ttname"><a href="defines_8h.html#a11b068a3943fb56b10a37b25d8cdb2c8">RTT_BACKGROUND_AV_FACTOR</a></div><div class="ttdeci">#define RTT_BACKGROUND_AV_FACTOR</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00081">defines.h:81</a></div></div>
<div class="ttc" id="adefines_8h_html_a1412a7dae9a055a047258c2fc26e6d4a"><div class="ttname"><a href="defines_8h.html#a1412a7dae9a055a047258c2fc26e6d4a">PEER_TCP_MAGIC_COUNT</a></div><div class="ttdeci">#define PEER_TCP_MAGIC_COUNT</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00122">defines.h:122</a></div></div>
<div class="ttc" id="adefines_8h_html_a6f57fb93c40248c437a2ccc0b9f8b04d"><div class="ttname"><a href="defines_8h.html#a6f57fb93c40248c437a2ccc0b9f8b04d">PEER_MAX_ADDRESSES</a></div><div class="ttdeci">#define PEER_MAX_ADDRESSES</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00079">defines.h:79</a></div></div>
<div class="ttc" id="adefines_8h_html_a7cc174d6a17cf73325615e9cae5751c6"><div class="ttname"><a href="defines_8h.html#a7cc174d6a17cf73325615e9cae5751c6">ICP_FLAG_SRC_RTT</a></div><div class="ttdeci">#define ICP_FLAG_SRC_RTT</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00039">defines.h:39</a></div></div>
<div class="ttc" id="adefines_8h_html_a9c62a1d0b8cba00b16026a20553ebb8a"><div class="ttname"><a href="defines_8h.html#a9c62a1d0b8cba00b16026a20553ebb8a">PEER_ALIVE</a></div><div class="ttdeci">#define PEER_ALIVE</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00084">defines.h:84</a></div></div>
<div class="ttc" id="adefines_8h_html_ab95d04f2bc1e1888b8024635971997a9"><div class="ttname"><a href="defines_8h.html#ab95d04f2bc1e1888b8024635971997a9">PEER_DEAD</a></div><div class="ttdeci">#define PEER_DEAD</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00083">defines.h:83</a></div></div>
<div class="ttc" id="adefines_8h_html_abe101f3231226dd50b7e5db7852191e0"><div class="ttname"><a href="defines_8h.html#abe101f3231226dd50b7e5db7852191e0">ICP_VERSION_2</a></div><div class="ttdeci">#define ICP_VERSION_2</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00042">defines.h:42</a></div></div>
<div class="ttc" id="adefines_8h_html_ac1f8e975d5c9f901f8ec9f29db1aca92"><div class="ttname"><a href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a></div><div class="ttdeci">#define EBIT_TEST(flag, bit)</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00067">defines.h:67</a></div></div>
<div class="ttc" id="adefines_8h_html_adb5ef0088b5947951fab1bd4ca7c7652"><div class="ttname"><a href="defines_8h.html#adb5ef0088b5947951fab1bd4ca7c7652">RTT_AV_FACTOR</a></div><div class="ttdeci">#define RTT_AV_FACTOR</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00080">defines.h:80</a></div></div>
<div class="ttc" id="adefines_8h_html_afcbf7727d6416354930cd43f1c1e480c"><div class="ttname"><a href="defines_8h.html#afcbf7727d6416354930cd43f1c1e480c">MAX_URL</a></div><div class="ttdeci">#define MAX_URL</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00076">defines.h:76</a></div></div>
<div class="ttc" id="aenums_8h_html_a16685eea158879e41b101ca3634de462ae584c58365523cce1a435dd86165d7a8"><div class="ttname"><a href="enums_8h.html#a16685eea158879e41b101ca3634de462ae584c58365523cce1a435dd86165d7a8">ENTRY_DISPATCHED</a></div><div class="ttdeci">@ ENTRY_DISPATCHED</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00096">enums.h:96</a></div></div>
<div class="ttc" id="aenums_8h_html_a4bd207d3fdbf20f48de074b84f74563ea15e97486bd90d641808bbc2eb177cf94"><div class="ttname"><a href="enums_8h.html#a4bd207d3fdbf20f48de074b84f74563ea15e97486bd90d641808bbc2eb177cf94">PING_WAITING</a></div><div class="ttdeci">@ PING_WAITING</div><div class="ttdoc">Sent ICP queries to peers and still awaiting responses.</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00038">enums.h:38</a></div></div>
<div class="ttc" id="aenums_8h_html_a53f367a6c6ec6520d99a817d002ad400"><div class="ttname"><a href="enums_8h.html#a53f367a6c6ec6520d99a817d002ad400">htcp_clr_reason</a></div><div class="ttdeci">htcp_clr_reason</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00234">enums.h:234</a></div></div>
<div class="ttc" id="aenums_8h_html_a53f367a6c6ec6520d99a817d002ad400aa19c85f7acec13d3daa407a93c92f508"><div class="ttname"><a href="enums_8h.html#a53f367a6c6ec6520d99a817d002ad400aa19c85f7acec13d3daa407a93c92f508">HTCP_CLR_PURGE</a></div><div class="ttdeci">@ HTCP_CLR_PURGE</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00235">enums.h:235</a></div></div>
<div class="ttc" id="aenums_8h_html_addda50b75bf05b054b12d6edc2690463"><div class="ttname"><a href="enums_8h.html#addda50b75bf05b054b12d6edc2690463">peer_t</a></div><div class="ttdeci">peer_t</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00022">enums.h:22</a></div></div>
<div class="ttc" id="aenums_8h_html_addda50b75bf05b054b12d6edc2690463a4c68e42a267dc3266e07c1afdeac933a"><div class="ttname"><a href="enums_8h.html#addda50b75bf05b054b12d6edc2690463a4c68e42a267dc3266e07c1afdeac933a">PEER_SIBLING</a></div><div class="ttdeci">@ PEER_SIBLING</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00024">enums.h:24</a></div></div>
<div class="ttc" id="aenums_8h_html_addda50b75bf05b054b12d6edc2690463aba32b04d1912b06357198f4603dcdb12"><div class="ttname"><a href="enums_8h.html#addda50b75bf05b054b12d6edc2690463aba32b04d1912b06357198f4603dcdb12">PEER_PARENT</a></div><div class="ttdeci">@ PEER_PARENT</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00025">enums.h:25</a></div></div>
<div class="ttc" id="aenums_8h_html_addda50b75bf05b054b12d6edc2690463ad0a923afe5d043e0b2cebf2bc50400aa"><div class="ttname"><a href="enums_8h.html#addda50b75bf05b054b12d6edc2690463ad0a923afe5d043e0b2cebf2bc50400aa">PEER_NONE</a></div><div class="ttdeci">@ PEER_NONE</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00023">enums.h:23</a></div></div>
<div class="ttc" id="aenums_8h_html_addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0"><div class="ttname"><a href="enums_8h.html#addda50b75bf05b054b12d6edc2690463af7bfa335d072e04573fa9515411874d0">PEER_MULTICAST</a></div><div class="ttdeci">@ PEER_MULTICAST</div><div class="ttdef"><b>Definition</b> <a href="enums_8h_source.html#l00027">enums.h:26</a></div></div>
<div class="ttc" id="aevent_8cc_html_a529afc9a0fa97418d6349e8ebbaf1e8f"><div class="ttname"><a href="event_8cc.html#a529afc9a0fa97418d6349e8ebbaf1e8f">eventAddIsh</a></div><div class="ttdeci">void eventAddIsh(const char *name, EVH *func, void *arg, double delta_ish, int weight)</div><div class="ttdef"><b>Definition</b> <a href="event_8cc_source.html#l00114">event.cc:114</a></div></div>
<div class="ttc" id="aevent_8cc_html_a5e368c7b2d3b8bc0e1667ece2c440944"><div class="ttname"><a href="event_8cc.html#a5e368c7b2d3b8bc0e1667ece2c440944">eventFind</a></div><div class="ttdeci">int eventFind(EVH *func, void *arg)</div><div class="ttdef"><b>Definition</b> <a href="event_8cc_source.html#l00145">event.cc:145</a></div></div>
<div class="ttc" id="aevent_8cc_html_ae111818525827ae123def674b61b7770"><div class="ttname"><a href="event_8cc.html#ae111818525827ae123def674b61b7770">eventDelete</a></div><div class="ttdeci">void eventDelete(EVH *func, void *arg)</div><div class="ttdef"><b>Definition</b> <a href="event_8cc_source.html#l00127">event.cc:127</a></div></div>
<div class="ttc" id="aevent_8cc_html_afbfd8e1e91d5ad60e6124aea52a5f006"><div class="ttname"><a href="event_8cc.html#afbfd8e1e91d5ad60e6124aea52a5f006">eventAdd</a></div><div class="ttdeci">void eventAdd(const char *name, EVH *func, void *arg, double when, int weight, bool cbdata)</div><div class="ttdef"><b>Definition</b> <a href="event_8cc_source.html#l00107">event.cc:107</a></div></div>
<div class="ttc" id="aevent_8h_html"><div class="ttname"><a href="event_8h.html">event.h</a></div></div>
<div class="ttc" id="aglobals_8h_html"><div class="ttname"><a href="globals_8h.html">globals.h</a></div></div>
<div class="ttc" id="aglobals_8h_html_a85fb5b16080caacaaf9ca40e713fccb9"><div class="ttname"><a href="globals_8h.html#a85fb5b16080caacaaf9ca40e713fccb9">Squid_MaxFD</a></div><div class="ttdeci">int Squid_MaxFD</div></div>
<div class="ttc" id="agroup__IPCacheAPI_html_gae327ee2f13a395e7caeff7cbd783c765"><div class="ttname"><a href="group__IPCacheAPI.html#gae327ee2f13a395e7caeff7cbd783c765">ipcache_nbgethostbyname</a></div><div class="ttdeci">void ipcache_nbgethostbyname(const char *name, IPH *handler, void *handlerData)</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8cc_source.html#l00609">ipcache.cc:609</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_ga4d210ff125985b55f52278cc17868ad1"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#ga4d210ff125985b55f52278cc17868ad1">icpSetCacheKey</a></div><div class="ttdeci">int icpSetCacheKey(const cache_key *key)</div><div class="ttdef"><b>Definition</b> <a href="icp__v2_8cc_source.html#l00842">icp_v2.cc:842</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_ga53e8fe6736b5dfae15ba459a4e8c3376"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#ga53e8fe6736b5dfae15ba459a4e8c3376">icpCreateAndSend</a></div><div class="ttdeci">void icpCreateAndSend(icp_opcode, int flags, char const *url, int reqnum, int pad, int fd, const Ip::Address &amp;from, AccessLogEntryPointer)</div><div class="ttdef"><b>Definition</b> <a href="icp__v2_8cc_source.html#l00418">icp_v2.cc:418</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_ga6d172cc0273c7eb44afd1351198704c6"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#ga6d172cc0273c7eb44afd1351198704c6">icp_opcode</a></div><div class="ttdeci">icp_opcode</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00013">icp_opcode.h:13</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gga6d172cc0273c7eb44afd1351198704c6a16755cd560859f4b80fc3268d86f1377"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a16755cd560859f4b80fc3268d86f1377">ICP_DECHO</a></div><div class="ttdeci">@ ICP_DECHO</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00026">icp_opcode.h:26</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gga6d172cc0273c7eb44afd1351198704c6a5c6250115ccf383ec8ad97bc82abd5de"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a5c6250115ccf383ec8ad97bc82abd5de">ICP_QUERY</a></div><div class="ttdeci">@ ICP_QUERY</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00016">icp_opcode.h:16</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gga6d172cc0273c7eb44afd1351198704c6a6363622dfdc43141e3df39a81425176f"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a6363622dfdc43141e3df39a81425176f">ICP_MISS_NOFETCH</a></div><div class="ttdeci">@ ICP_MISS_NOFETCH</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00036">icp_opcode.h:36</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gga6d172cc0273c7eb44afd1351198704c6a6b90e3137805b84a36b36fa9016b0a37"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a6b90e3137805b84a36b36fa9016b0a37">ICP_END</a></div><div class="ttdeci">@ ICP_END</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00039">icp_opcode.h:39</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gga6d172cc0273c7eb44afd1351198704c6a6d0200c4d928ab973233042d75e192c1"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a6d0200c4d928ab973233042d75e192c1">ICP_DENIED</a></div><div class="ttdeci">@ ICP_DENIED</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00037">icp_opcode.h:37</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gga6d172cc0273c7eb44afd1351198704c6a9d41e5c7ef15fb29ac27e3d282ef322e"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6a9d41e5c7ef15fb29ac27e3d282ef322e">ICP_SECHO</a></div><div class="ttdeci">@ ICP_SECHO</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00025">icp_opcode.h:25</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gga6d172cc0273c7eb44afd1351198704c6abef39c1952136e11de121425150e3f8d"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6abef39c1952136e11de121425150e3f8d">ICP_MISS</a></div><div class="ttdeci">@ ICP_MISS</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00018">icp_opcode.h:18</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPAPI_html_gga6d172cc0273c7eb44afd1351198704c6ae976d3e0d00dd042e09fc832b7d2c5df"><div class="ttname"><a href="group__ServerProtocolICPAPI.html#gga6d172cc0273c7eb44afd1351198704c6ae976d3e0d00dd042e09fc832b7d2c5df">ICP_HIT</a></div><div class="ttdeci">@ ICP_HIT</div><div class="ttdef"><b>Definition</b> <a href="icp__opcode_8h_source.html#l00017">icp_opcode.h:17</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPInternal2_html_ga27833f39d27c05bc1f06c4bcf25ef9fc"><div class="ttname"><a href="group__ServerProtocolICPInternal2.html#ga27833f39d27c05bc1f06c4bcf25ef9fc">icpOutgoingConn</a></div><div class="ttdeci">Comm::ConnectionPointer icpOutgoingConn</div><div class="ttdef"><b>Definition</b> <a href="icp__v2_8cc_source.html#l00101">icp_v2.cc:101</a></div></div>
<div class="ttc" id="agroup__ServerProtocolICPInternal2_html_ga670a12c55edf7e7173c4f97c777ec36b"><div class="ttname"><a href="group__ServerProtocolICPInternal2.html#ga670a12c55edf7e7173c4f97c777ec36b">icpIncomingConn</a></div><div class="ttdeci">Comm::ConnectionPointer icpIncomingConn</div><div class="ttdef"><b>Definition</b> <a href="icp__v2_8cc_source.html#l00099">icp_v2.cc:99</a></div></div>
<div class="ttc" id="ahtcp_8cc_html_a34bd9e78778bc1a1a2bf78895d3d0e43"><div class="ttname"><a href="htcp_8cc.html#a34bd9e78778bc1a1a2bf78895d3d0e43">htcpQuery</a></div><div class="ttdeci">int htcpQuery(StoreEntry *e, HttpRequest *req, CachePeer *p)</div><div class="ttdef"><b>Definition</b> <a href="htcp_8cc_source.html#l01558">htcp.cc:1558</a></div></div>
<div class="ttc" id="ahtcp_8cc_html_a943b217cb6299040d1e73ce075ff792a"><div class="ttname"><a href="htcp_8cc.html#a943b217cb6299040d1e73ce075ff792a">htcpClear</a></div><div class="ttdeci">void htcpClear(StoreEntry *e, HttpRequest *req, const HttpRequestMethod &amp;, CachePeer *p, htcp_clr_reason reason)</div><div class="ttdef"><b>Definition</b> <a href="htcp_8cc_source.html#l01607">htcp.cc:1607</a></div></div>
<div class="ttc" id="ahtcp_8h_html"><div class="ttname"><a href="htcp_8h.html">htcp.h</a></div></div>
<div class="ttc" id="ahttp_2Message_8h_html_afbf13ecd1cc5c007367ae094c1aa19a9"><div class="ttname"><a href="http_2Message_8h.html#afbf13ecd1cc5c007367ae094c1aa19a9">HTTPMSGLOCK</a></div><div class="ttdeci">void HTTPMSGLOCK(Http::Message *a)</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00161">Message.h:161</a></div></div>
<div class="ttc" id="aicp__opcode_8h_html_ac1431af6f906aacf2b4af78e1474d619"><div class="ttname"><a href="icp__opcode_8h.html#ac1431af6f906aacf2b4af78e1474d619">icp_opcode_str</a></div><div class="ttdeci">const char * icp_opcode_str[]</div></div>
<div class="ttc" id="aint_8cc_html_a447b20e752a00e512f1ead308f55db38"><div class="ttname"><a href="int_8cc.html#a447b20e752a00e512f1ead308f55db38">isPowTen</a></div><div class="ttdeci">int isPowTen(int count)</div><div class="ttdef"><b>Definition</b> <a href="int_8cc_source.html#l00017">int.cc:17</a></div></div>
<div class="ttc" id="aint_8h_html"><div class="ttname"><a href="int_8h.html">int.h</a></div></div>
<div class="ttc" id="aip_2Address_8h_html"><div class="ttname"><a href="ip_2Address_8h.html">Address.h</a></div></div>
<div class="ttc" id="aip_2forward_8h_html_a28806a9f06b4d32dab73b27053f10494"><div class="ttname"><a href="ip_2forward_8h.html#a28806a9f06b4d32dab73b27053f10494">MAX_IPSTRLEN</a></div><div class="ttdeci">#define MAX_IPSTRLEN</div><div class="ttdoc">Length of buffer that needs to be allocated to old a null-terminated IP-string.</div><div class="ttdef"><b>Definition</b> <a href="ip_2forward_8h_source.html#l00025">forward.h:25</a></div></div>
<div class="ttc" id="aip_2tools_8h_html"><div class="ttname"><a href="ip_2tools_8h.html">tools.h</a></div></div>
<div class="ttc" id="aipcache_8h_html"><div class="ttname"><a href="ipcache_8h.html">ipcache.h</a></div></div>
<div class="ttc" id="aipcache_8h_html_ab4f16a3f392afd628bd4b38661e25d0a"><div class="ttname"><a href="ipcache_8h.html#ab4f16a3f392afd628bd4b38661e25d0a">IPH</a></div><div class="ttdeci">void IPH(const ipcache_addrs *, const Dns::LookupDetails &amp;details, void *)</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8h_source.html#l00227">ipcache.h:227</a></div></div>
<div class="ttc" id="alookup__t_8h_html_a5b9bbc54b0caf77e33da07034f9fca8b"><div class="ttname"><a href="lookup__t_8h.html#a5b9bbc54b0caf77e33da07034f9fca8b">lookup_t_str</a></div><div class="ttdeci">const char * lookup_t_str[]</div></div>
<div class="ttc" id="alookup__t_8h_html_a9bc035ee78e3ac41f2f6a4c85c9ebf45"><div class="ttname"><a href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45">lookup_t</a></div><div class="ttdeci">lookup_t</div><div class="ttdef"><b>Definition</b> <a href="lookup__t_8h_source.html#l00012">lookup_t.h:12</a></div></div>
<div class="ttc" id="alookup__t_8h_html_a9bc035ee78e3ac41f2f6a4c85c9ebf45a63a9bb33f90ed77a78376604d01020e5"><div class="ttname"><a href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45a63a9bb33f90ed77a78376604d01020e5">LOOKUP_MISS</a></div><div class="ttdeci">@ LOOKUP_MISS</div><div class="ttdef"><b>Definition</b> <a href="lookup__t_8h_source.html#l00016">lookup_t.h:15</a></div></div>
<div class="ttc" id="alookup__t_8h_html_a9bc035ee78e3ac41f2f6a4c85c9ebf45a8dc1a097130703bb4c1487b03935585d"><div class="ttname"><a href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45a8dc1a097130703bb4c1487b03935585d">LOOKUP_HIT</a></div><div class="ttdeci">@ LOOKUP_HIT</div><div class="ttdef"><b>Definition</b> <a href="lookup__t_8h_source.html#l00014">lookup_t.h:14</a></div></div>
<div class="ttc" id="alookup__t_8h_html_a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e"><div class="ttname"><a href="lookup__t_8h.html#a9bc035ee78e3ac41f2f6a4c85c9ebf45aec9c40360adab2e2f707698946741d3e">LOOKUP_NONE</a></div><div class="ttdeci">@ LOOKUP_NONE</div><div class="ttdef"><b>Definition</b> <a href="lookup__t_8h_source.html#l00013">lookup_t.h:13</a></div></div>
<div class="ttc" id="amgr_2forward_8h_html_a8c23ffe1f8e3bdc1d0bc4924111a8c2f"><div class="ttname"><a href="mgr_2forward_8h.html#a8c23ffe1f8e3bdc1d0bc4924111a8c2f">OBJH</a></div><div class="ttdeci">void OBJH(StoreEntry *)</div><div class="ttdef"><b>Definition</b> <a href="mgr_2forward_8h_source.html#l00044">forward.h:44</a></div></div>
<div class="ttc" id="amulticast_8cc_html_aae50610fcb12fde0d35ae39cfd73a7e1"><div class="ttname"><a href="multicast_8cc.html#aae50610fcb12fde0d35ae39cfd73a7e1">mcastSetTtl</a></div><div class="ttdeci">int mcastSetTtl(int fd, int mcast_ttl)</div><div class="ttdef"><b>Definition</b> <a href="multicast_8cc_source.html#l00021">multicast.cc:21</a></div></div>
<div class="ttc" id="amulticast_8h_html"><div class="ttname"><a href="multicast_8h.html">multicast.h</a></div></div>
<div class="ttc" id="anamespaceAnyP_html_af0ba7042d4344a04b758836b3e6e7acc"><div class="ttname"><a href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acc">AnyP::ProtocolType</a></div><div class="ttdeci">ProtocolType</div><div class="ttdef"><b>Definition</b> <a href="ProtocolType_8h_source.html#l00023">ProtocolType.h:23</a></div></div>
<div class="ttc" id="anamespaceAnyP_html_af0ba7042d4344a04b758836b3e6e7acca277a0d7571dfa3828d42713b4cc0dc2f"><div class="ttname"><a href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca277a0d7571dfa3828d42713b4cc0dc2f">AnyP::PROTO_HTCP</a></div><div class="ttdeci">@ PROTO_HTCP</div><div class="ttdef"><b>Definition</b> <a href="ProtocolType_8h_source.html#l00033">ProtocolType.h:33</a></div></div>
<div class="ttc" id="anamespaceAnyP_html_af0ba7042d4344a04b758836b3e6e7accacc70e659b8153a808b7c0da5de0428ea"><div class="ttname"><a href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7accacc70e659b8153a808b7c0da5de0428ea">AnyP::PROTO_ICP</a></div><div class="ttdeci">@ PROTO_ICP</div><div class="ttdef"><b>Definition</b> <a href="ProtocolType_8h_source.html#l00031">ProtocolType.h:31</a></div></div>
<div class="ttc" id="anamespaceComm_html_a91f0a0e22e74a7ad6f7c44c137c6f005"><div class="ttname"><a href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a></div><div class="ttdeci">bool IsConnOpen(const Comm::ConnectionPointer &amp;conn)</div><div class="ttdef"><b>Definition</b> <a href="Connection_8cc_source.html#l00027">Connection.cc:27</a></div></div>
<div class="ttc" id="anamespaceComm_html_a9d8d4f4a5745b975c5785998e4246050"><div class="ttname"><a href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050">Comm::Flag</a></div><div class="ttdeci">Flag</div><div class="ttdef"><b>Definition</b> <a href="Flag_8h_source.html#l00015">Flag.h:15</a></div></div>
<div class="ttc" id="anamespaceComm_html_a9d8d4f4a5745b975c5785998e4246050a2d02cf4ed31f765e18f4d8474ede4e24"><div class="ttname"><a href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050a2d02cf4ed31f765e18f4d8474ede4e24">Comm::OK</a></div><div class="ttdeci">@ OK</div><div class="ttdef"><b>Definition</b> <a href="Flag_8h_source.html#l00016">Flag.h:16</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7">Http::METHOD_CONNECT</a></div><div class="ttdeci">@ METHOD_CONNECT</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00029">MethodType.h:29</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a></div><div class="ttdeci">@ METHOD_GET</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00025">MethodType.h:25</a></div></div>
<div class="ttc" id="anamespaceMath_html_a5c5c74f00ace4f0a2b80f1b13900b6ce"><div class="ttname"><a href="namespaceMath.html#a5c5c74f00ace4f0a2b80f1b13900b6ce">Math::intPercent</a></div><div class="ttdeci">int intPercent(const int a, const int b)</div><div class="ttdef"><b>Definition</b> <a href="SquidMath_8cc_source.html#l00013">SquidMath.cc:13</a></div></div>
<div class="ttc" id="anamespaceMath_html_a5dfbfabfb22aa352e6730f6cb3b8d6f8"><div class="ttname"><a href="namespaceMath.html#a5dfbfabfb22aa352e6730f6cb3b8d6f8">Math::doubleAverage</a></div><div class="ttdeci">double doubleAverage(const double, const double, int, const int)</div><div class="ttdef"><b>Definition</b> <a href="SquidMath_8cc_source.html#l00031">SquidMath.cc:31</a></div></div>
<div class="ttc" id="anamespaceMath_html_ae00e8f5a2d22e3eb488bfa26d5848a7c"><div class="ttname"><a href="namespaceMath.html#ae00e8f5a2d22e3eb488bfa26d5848a7c">Math::intAverage</a></div><div class="ttdeci">int intAverage(const int, const int, int, const int)</div><div class="ttdef"><b>Definition</b> <a href="SquidMath_8cc_source.html#l00040">SquidMath.cc:40</a></div></div>
<div class="ttc" id="anamespaceMgr_html_af75bac55ce6610d5102ca58f8d1c1ecf"><div class="ttname"><a href="namespaceMgr.html#af75bac55ce6610d5102ca58f8d1c1ecf">Mgr::RegisterAction</a></div><div class="ttdeci">void RegisterAction(char const *action, char const *desc, OBJH *handler, Protected, Atomic, Format)</div><div class="ttdef"><b>Definition</b> <a href="Registration_8cc_source.html#l00054">Registration.cc:54</a></div></div>
<div class="ttc" id="anamespaceStore_html_a0151d620409db8bd3af40e3570a18f8c"><div class="ttname"><a href="namespaceStore.html#a0151d620409db8bd3af40e3570a18f8c">Store::Root</a></div><div class="ttdeci">Controller &amp; Root()</div><div class="ttdoc">safely access controller singleton</div><div class="ttdef"><b>Definition</b> <a href="Controller_8cc_source.html#l00926">Controller.cc:926</a></div></div>
<div class="ttc" id="anamespaceTime_html_a9eae609ba8ed49e159c091173b47edc0"><div class="ttname"><a href="namespaceTime.html#a9eae609ba8ed49e159c091173b47edc0">Time::FormatHttpd</a></div><div class="ttdeci">const char * FormatHttpd(time_t)</div><div class="ttdef"><b>Definition</b> <a href="time_2gadgets_8cc_source.html#l00116">gadgets.cc:116</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a03640b5e6e91173327f269d4b4275479"><div class="ttname"><a href="neighbors_8cc.html#a03640b5e6e91173327f269d4b4275479">dump_peers</a></div><div class="ttdeci">static void dump_peers(StoreEntry *, CachePeers *)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01505">neighbors.cc:1505</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a0d9b13418092a0d4cde2826ab37911c9"><div class="ttname"><a href="neighbors_8cc.html#a0d9b13418092a0d4cde2826ab37911c9">peerClearRRLoop</a></div><div class="ttdeci">static void peerClearRRLoop(void *data)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00414">neighbors.cc:414</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a1014ea8daa499be8fc82b3efb4d13d4d"><div class="ttname"><a href="neighbors_8cc.html#a1014ea8daa499be8fc82b3efb4d13d4d">peerScheduleDnsRefreshCheck</a></div><div class="ttdeci">static void peerScheduleDnsRefreshCheck(const double delayInSeconds)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01155">neighbors.cc:1155</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a118fc9cfb76ca751cc3758457edc5a01"><div class="ttname"><a href="neighbors_8cc.html#a118fc9cfb76ca751cc3758457edc5a01">peerCountMcastPeersDone</a></div><div class="ttdeci">static void peerCountMcastPeersDone(void *data)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01323">neighbors.cc:1323</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a1e411bf651fa9fdc3e4b0a97de8fe143"><div class="ttname"><a href="neighbors_8cc.html#a1e411bf651fa9fdc3e4b0a97de8fe143">peerNoteDigestLookup</a></div><div class="ttdeci">void peerNoteDigestLookup(HttpRequest *request, CachePeer *p, lookup_t lookup)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00811">neighbors.cc:811</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a24fed2aabf197388b6c52b39cdd478d6"><div class="ttname"><a href="neighbors_8cc.html#a24fed2aabf197388b6c52b39cdd478d6">peerWouldBePinged</a></div><div class="ttdeci">static int peerWouldBePinged(const CachePeer *, PeerSelector *)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00178">neighbors.cc:178</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a2959da26b2b78dcef9887f71e725aa15"><div class="ttname"><a href="neighbors_8cc.html#a2959da26b2b78dcef9887f71e725aa15">neighborAliveHtcp</a></div><div class="ttdeci">static void neighborAliveHtcp(CachePeer *, const MemObject *, const HtcpReplyData *)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00866">neighbors.cc:866</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a2c5c2cb4d8baeb8345a3665462708336"><div class="ttname"><a href="neighbors_8cc.html#a2c5c2cb4d8baeb8345a3665462708336">peerCountMcastPeersSchedule</a></div><div class="ttdeci">static void peerCountMcastPeersSchedule(CachePeer *p, time_t when)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01252">neighbors.cc:1252</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a2f4988cdd50e3844d829a7c363dcce5c"><div class="ttname"><a href="neighbors_8cc.html#a2f4988cdd50e3844d829a7c363dcce5c">neighborsHtcpClear</a></div><div class="ttdeci">void neighborsHtcpClear(StoreEntry *e, HttpRequest *req, const HttpRequestMethod &amp;method, htcp_clr_reason reason)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01675">neighbors.cc:1675</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a30f50fd22e7ec7415db78fad8ccb32ee"><div class="ttname"><a href="neighbors_8cc.html#a30f50fd22e7ec7415db78fad8ccb32ee">getFirstUpParent</a></div><div class="ttdeci">CachePeer * getFirstUpParent(PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00282">neighbors.cc:282</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a311d35bea078e41fe82162df782311f0"><div class="ttname"><a href="neighbors_8cc.html#a311d35bea078e41fe82162df782311f0">findCachePeerByName</a></div><div class="ttdeci">CachePeer * findCachePeerByName(const char *const name)</div><div class="ttdoc">cache_peer with a given name (or nil)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01048">neighbors.cc:1048</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a3269559f810fd86a0d91ffe9f24ef758"><div class="ttname"><a href="neighbors_8cc.html#a3269559f810fd86a0d91ffe9f24ef758">peerDNSConfigure</a></div><div class="ttdeci">static IPH peerDNSConfigure</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00065">neighbors.cc:65</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a35194ab936916470ce011e25834b6572"><div class="ttname"><a href="neighbors_8cc.html#a35194ab936916470ce011e25834b6572">whichPeer</a></div><div class="ttdeci">CachePeer * whichPeer(const Ip::Address &amp;from)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00099">neighbors.cc:99</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a3e2752d95ce98c8cfaf10516e4517d48"><div class="ttname"><a href="neighbors_8cc.html#a3e2752d95ce98c8cfaf10516e4517d48">peerCountMcastPeersCreateAndSend</a></div><div class="ttdeci">static void peerCountMcastPeersCreateAndSend(CachePeer *p)</div><div class="ttdoc">initiates an ICP transaction to a multicast peer</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01277">neighbors.cc:1277</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a4013e86a2af31337f8b6f1ad5cf77a1f"><div class="ttname"><a href="neighbors_8cc.html#a4013e86a2af31337f8b6f1ad5cf77a1f">neighborsHtcpReply</a></div><div class="ttdeci">void neighborsHtcpReply(const cache_key *key, HtcpReplyData *htcp, const Ip::Address &amp;from)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01601">neighbors.cc:1601</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a4706bdd6d749bb72a80d49021c62d99f"><div class="ttname"><a href="neighbors_8cc.html#a4706bdd6d749bb72a80d49021c62d99f">neighborUpdateRtt</a></div><div class="ttdeci">static void neighborUpdateRtt(CachePeer *p, MemObject *mem)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00841">neighbors.cc:841</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a4a27f36856d050c4cbc4adf4041febd0"><div class="ttname"><a href="neighbors_8cc.html#a4a27f36856d050c4cbc4adf4041febd0">peerProbeConnectDone</a></div><div class="ttdeci">static CNCB peerProbeConnectDone</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00067">neighbors.cc:67</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a4b7e15e120b5911f84b09d8828ea5530"><div class="ttname"><a href="neighbors_8cc.html#a4b7e15e120b5911f84b09d8828ea5530">peerAlive</a></div><div class="ttdeci">void peerAlive(CachePeer *p)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00450">neighbors.cc:450</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a4c86a5e936aa3100d594a5b3d896d076"><div class="ttname"><a href="neighbors_8cc.html#a4c86a5e936aa3100d594a5b3d896d076">peerClearRR</a></div><div class="ttdeci">void peerClearRR()</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00443">neighbors.cc:443</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a4e9c73e9e7ec8a90679bed5d18b593a7"><div class="ttname"><a href="neighbors_8cc.html#a4e9c73e9e7ec8a90679bed5d18b593a7">neighbors_init</a></div><div class="ttdeci">void neighbors_init(void)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00505">neighbors.cc:505</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a4f2ef0cb3a2344aab8ecd924faf291a5"><div class="ttname"><a href="neighbors_8cc.html#a4f2ef0cb3a2344aab8ecd924faf291a5">neighborDumpPeers</a></div><div class="ttdeci">static OBJH neighborDumpPeers</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00076">neighbors.cc:76</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a54bd3bb8e4b86c206fb06f1ff2441428"><div class="ttname"><a href="neighbors_8cc.html#a54bd3bb8e4b86c206fb06f1ff2441428">peerHasConnAvailable</a></div><div class="ttdeci">bool peerHasConnAvailable(const CachePeer *p)</div><div class="ttdoc">Whether the peer has idle or standby connections that can be used now.</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00227">neighbors.cc:227</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a586a59168fdff3449465f60a45eb85a5"><div class="ttname"><a href="neighbors_8cc.html#a586a59168fdff3449465f60a45eb85a5">neighborsCount</a></div><div class="ttdeci">int neighborsCount(PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00268">neighbors.cc:268</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a6132f21ce167ad8753fdd6af168abaf5"><div class="ttname"><a href="neighbors_8cc.html#a6132f21ce167ad8753fdd6af168abaf5">peerCountMcastPeersAbort</a></div><div class="ttdeci">static void peerCountMcastPeersAbort(PeerSelector *)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01335">neighbors.cc:1335</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a616e3d85ea457a8b22ad8ee588d47e55"><div class="ttname"><a href="neighbors_8cc.html#a616e3d85ea457a8b22ad8ee588d47e55">dump_peer_options</a></div><div class="ttdeci">void dump_peer_options(StoreEntry *sentry, CachePeer *p)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01382">neighbors.cc:1382</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a6204ffb9f5e7d51413c2514de20d68cd"><div class="ttname"><a href="neighbors_8cc.html#a6204ffb9f5e7d51413c2514de20d68cd">neighborUp</a></div><div class="ttdeci">int neighborUp(const CachePeer *p)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01058">neighbors.cc:1058</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a63febaac1744f757453991f3e32f15f6"><div class="ttname"><a href="neighbors_8cc.html#a63febaac1744f757453991f3e32f15f6">peerProbeIsBusy</a></div><div class="ttdeci">static bool peerProbeIsBusy(const CachePeer *p)</div><div class="ttdoc">whether new TCP probes are currently banned</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01189">neighbors.cc:1189</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a64df8c2ea854d15091937d1f2887d91b"><div class="ttname"><a href="neighbors_8cc.html#a64df8c2ea854d15091937d1f2887d91b">peerHTTPOkay</a></div><div class="ttdeci">int peerHTTPOkay(const CachePeer *p, PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00253">neighbors.cc:253</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a6dceaa9d65cf631100011d688bc2dcd4"><div class="ttname"><a href="neighbors_8cc.html#a6dceaa9d65cf631100011d688bc2dcd4">getDefaultParent</a></div><div class="ttdeci">CachePeer * getDefaultParent(PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00469">neighbors.cc:469</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a6f432abad2de5f1a61015440c1e39bfc"><div class="ttname"><a href="neighbors_8cc.html#a6f432abad2de5f1a61015440c1e39bfc">getRoundRobinParent</a></div><div class="ttdeci">CachePeer * getRoundRobinParent(PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00308">neighbors.cc:308</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a7271928a2f26b9c331bd057c813e9865"><div class="ttname"><a href="neighbors_8cc.html#a7271928a2f26b9c331bd057c813e9865">neighborTypeStr</a></div><div class="ttdeci">const char * neighborTypeStr(const CachePeer *p)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00084">neighbors.cc:84</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a752438ef7dd82516762385a1e4f1b41c"><div class="ttname"><a href="neighbors_8cc.html#a752438ef7dd82516762385a1e4f1b41c">positiveTimeout</a></div><div class="ttdeci">time_t positiveTimeout(const time_t timeout)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01092">neighbors.cc:1092</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a7552c902985ade500b9f9c1c4c7b54a2"><div class="ttname"><a href="neighbors_8cc.html#a7552c902985ade500b9f9c1c4c7b54a2">peerAllowedToUse</a></div><div class="ttdeci">bool peerAllowedToUse(const CachePeer *, PeerSelector *)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00138">neighbors.cc:138</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a776a970d39e7c5550a097dff61df0c14"><div class="ttname"><a href="neighbors_8cc.html#a776a970d39e7c5550a097dff61df0c14">neighborsRegisterWithCacheManager</a></div><div class="ttdeci">static void neighborsRegisterWithCacheManager()</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00497">neighbors.cc:497</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a7be43fba026f388788f344cfea3e65b2"><div class="ttname"><a href="neighbors_8cc.html#a7be43fba026f388788f344cfea3e65b2">peerClearRRStart</a></div><div class="ttdeci">void peerClearRRStart(void)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00426">neighbors.cc:426</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a7cc63794439adcb1426b0954ce936e6c"><div class="ttname"><a href="neighbors_8cc.html#a7cc63794439adcb1426b0954ce936e6c">peerCanOpenMore</a></div><div class="ttdeci">bool peerCanOpenMore(const CachePeer *p)</div><div class="ttdoc">Whether we can open new connections to the peer (e.g., despite max-conn)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00218">neighbors.cc:218</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a7d9b8b2006eddbf1058f8cd894f28798"><div class="ttname"><a href="neighbors_8cc.html#a7d9b8b2006eddbf1058f8cd894f28798">NLateReplies</a></div><div class="ttdeci">static int NLateReplies</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00081">neighbors.cc:81</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a7fdb5c5dd15618d30a7a2cfc23a4ffdc"><div class="ttname"><a href="neighbors_8cc.html#a7fdb5c5dd15618d30a7a2cfc23a4ffdc">peerDnsRefreshStart</a></div><div class="ttdeci">static void peerDnsRefreshStart()</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01175">neighbors.cc:1175</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a80f58d2931ed7efc035a1beb6fb173c8"><div class="ttname"><a href="neighbors_8cc.html#a80f58d2931ed7efc035a1beb6fb173c8">neighborType</a></div><div class="ttdeci">peer_t neighborType(const CachePeer *p, const AnyP::Uri &amp;url)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00117">neighbors.cc:117</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a8327463934cc694a0754ec058fda849b"><div class="ttname"><a href="neighbors_8cc.html#a8327463934cc694a0754ec058fda849b">neighborsUdpPing</a></div><div class="ttdeci">int neighborsUdpPing(HttpRequest *request, StoreEntry *entry, IRCB *callback, PeerSelector *ps, int *exprep, int *timeout)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00544">neighbors.cc:544</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a83e6621723b8edf8ca244558fa453d19"><div class="ttname"><a href="neighbors_8cc.html#a83e6621723b8edf8ca244558fa453d19">neighborsDigestSelect</a></div><div class="ttdeci">CachePeer * neighborsDigestSelect(PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00749">neighbors.cc:749</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a956def714ac0ed251dad6f60ff91abfd"><div class="ttname"><a href="neighbors_8cc.html#a956def714ac0ed251dad6f60ff91abfd">peerCountHandleIcpReply</a></div><div class="ttdeci">static IRCB peerCountHandleIcpReply</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00073">neighbors.cc:73</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a9b08654d548438ab5cf806d4d605ab6e"><div class="ttname"><a href="neighbors_8cc.html#a9b08654d548438ab5cf806d4d605ab6e">echo_port</a></div><div class="ttdeci">static unsigned short echo_port</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00079">neighbors.cc:79</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_a9f2a764443af2685e1e71af8e474bc83"><div class="ttname"><a href="neighbors_8cc.html#a9f2a764443af2685e1e71af8e474bc83">neighborAlive</a></div><div class="ttdeci">static void neighborAlive(CachePeer *, const MemObject *, const icp_common_t *)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00829">neighbors.cc:829</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_aa684bf58dc62515bea74168b567213fb"><div class="ttname"><a href="neighbors_8cc.html#aa684bf58dc62515bea74168b567213fb">peerDigestLookup</a></div><div class="ttdeci">lookup_t peerDigestLookup(CachePeer *p, PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00703">neighbors.cc:703</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_aad025aebc8aa3df1d1eee52819686336"><div class="ttname"><a href="neighbors_8cc.html#aad025aebc8aa3df1d1eee52819686336">MCAST_COUNT_RATE</a></div><div class="ttdeci">#define MCAST_COUNT_RATE</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00054">neighbors.cc:54</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_ab45d5074d12de81b09819a822e2b36f1"><div class="ttname"><a href="neighbors_8cc.html#ab45d5074d12de81b09819a822e2b36f1">neighborCountIgnored</a></div><div class="ttdeci">static void neighborCountIgnored(CachePeer *)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00877">neighbors.cc:877</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_abbc058016c442c715870cd2939531481"><div class="ttname"><a href="neighbors_8cc.html#abbc058016c442c715870cd2939531481">peerConnClosed</a></div><div class="ttdeci">void peerConnClosed(CachePeer *p)</div><div class="ttdoc">Notifies peer of an associated connection closure.</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00242">neighbors.cc:242</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_ac4b350a9f6eac0a4bf823ec15126bb66"><div class="ttname"><a href="neighbors_8cc.html#ac4b350a9f6eac0a4bf823ec15126bb66">neighborIgnoreNonPeer</a></div><div class="ttdeci">static void neighborIgnoreNonPeer(const Ip::Address &amp;, icp_opcode)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00888">neighbors.cc:888</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_ac9518f7ddccf53e35d2e2f6adfc403f1"><div class="ttname"><a href="neighbors_8cc.html#ac9518f7ddccf53e35d2e2f6adfc403f1">ignoreMulticastReply</a></div><div class="ttdeci">static int ignoreMulticastReply(CachePeer *p, PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00905">neighbors.cc:905</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_ad3b48714a55e560882a1d417c1153c36"><div class="ttname"><a href="neighbors_8cc.html#ad3b48714a55e560882a1d417c1153c36">neighborsUdpAck</a></div><div class="ttdeci">void neighborsUdpAck(const cache_key *key, icp_common_t *header, const Ip::Address &amp;from)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00927">neighbors.cc:927</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_aef96ae2795b76fe6db1eb6ed4201cda5"><div class="ttname"><a href="neighbors_8cc.html#aef96ae2795b76fe6db1eb6ed4201cda5">peerProbeConnect</a></div><div class="ttdeci">static void peerProbeConnect(CachePeer *, const bool reprobeIfBusy=false)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01205">neighbors.cc:1205</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_af4286c6576d68b7a48ad7733947113cb"><div class="ttname"><a href="neighbors_8cc.html#af4286c6576d68b7a48ad7733947113cb">getWeightedRoundRobinParent</a></div><div class="ttdeci">CachePeer * getWeightedRoundRobinParent(PeerSelector *ps)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l00350">neighbors.cc:350</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_afc217053539cabc9b792dbdb5b077611"><div class="ttname"><a href="neighbors_8cc.html#afc217053539cabc9b792dbdb5b077611">peerCountMcastPeersStart</a></div><div class="ttdeci">static void peerCountMcastPeersStart(void *data)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01266">neighbors.cc:1266</a></div></div>
<div class="ttc" id="aneighbors_8cc_html_afcb5d6c5cf86ca011f9574afb353d061"><div class="ttname"><a href="neighbors_8cc.html#afcb5d6c5cf86ca011f9574afb353d061">peerDnsRefreshCheck</a></div><div class="ttdeci">static void peerDnsRefreshCheck(void *)</div><div class="ttdef"><b>Definition</b> <a href="neighbors_8cc_source.html#l01163">neighbors.cc:1163</a></div></div>
<div class="ttc" id="aneighbors_8h_html"><div class="ttname"><a href="neighbors_8h.html">neighbors.h</a></div></div>
<div class="ttc" id="anet__db_8cc_html_a36bf2a8653a5872a61579b0943a7045d"><div class="ttname"><a href="net__db_8cc.html#a36bf2a8653a5872a61579b0943a7045d">netdbHostRtt</a></div><div class="ttdeci">int netdbHostRtt(const char *host)</div><div class="ttdef"><b>Definition</b> <a href="net__db_8cc_source.html#l00944">net_db.cc:944</a></div></div>
<div class="ttc" id="anet__db_8cc_html_af862f29fc9234a7dc7ea8015f511bcc1"><div class="ttname"><a href="net__db_8cc.html#af862f29fc9234a7dc7ea8015f511bcc1">netdbExchangeStart</a></div><div class="ttdeci">void netdbExchangeStart(void *data)</div><div class="ttdef"><b>Definition</b> <a href="net__db_8cc_source.html#l01181">net_db.cc:1181</a></div></div>
<div class="ttc" id="anet__db_8h_html"><div class="ttname"><a href="net__db_8h.html">net_db.h</a></div></div>
<div class="ttc" id="anetdb_8h_html"><div class="ttname"><a href="netdb_8h.html">netdb.h</a></div></div>
<div class="ttc" id="anetdb_8h_html_aef683974bf7dcd4810e4d5ecfe915ff8"><div class="ttname"><a href="netdb_8h.html#aef683974bf7dcd4810e4d5ecfe915ff8">xgetservbyname</a></div><div class="ttdeci">struct servent * xgetservbyname(const char *name, const char *proto)</div><div class="ttdoc">POSIX getservbyname(3) equivalent.</div><div class="ttdef"><b>Definition</b> <a href="netdb_8h_source.html#l00031">netdb.h:31</a></div></div>
<div class="ttc" id="apconn_8h_html"><div class="ttname"><a href="pconn_8h.html">pconn.h</a></div></div>
<div class="ttc" id="apeer__digest_8cc_html_ac02c7896e61987e7f1482f789ae81d09"><div class="ttname"><a href="peer__digest_8cc.html#ac02c7896e61987e7f1482f789ae81d09">peerDigestNeeded</a></div><div class="ttdeci">void peerDigestNeeded(PeerDigest *pd)</div><div class="ttdef"><b>Definition</b> <a href="peer__digest_8cc_source.html#l00130">peer_digest.cc:130</a></div></div>
<div class="ttc" id="asquid_8h_html"><div class="ttname"><a href="squid_8h.html">squid.h</a></div></div>
<div class="ttc" id="asquid_8h_html_a9b17dd86bdde2e8cb89abe153a0f4f23"><div class="ttname"><a href="squid_8h.html#a9b17dd86bdde2e8cb89abe153a0f4f23">LOCAL_ARRAY</a></div><div class="ttdeci">#define LOCAL_ARRAY(type, name, size)</div><div class="ttdef"><b>Definition</b> <a href="squid_8h_source.html#l00062">squid.h:62</a></div></div>
<div class="ttc" id="astat_8cc_html_ac0d551a1aab3545af90f4a8b40691ce2"><div class="ttname"><a href="stat_8cc.html#ac0d551a1aab3545af90f4a8b40691ce2">statSawRecentRequests</a></div><div class="ttdeci">bool statSawRecentRequests()</div><div class="ttdef"><b>Definition</b> <a href="stat_8cc_source.html#l01688">stat.cc:1688</a></div></div>
<div class="ttc" id="astat_8h_html"><div class="ttname"><a href="stat_8h.html">stat.h</a></div></div>
<div class="ttc" id="astore_2forward_8h_html_ab1424e1b13666cc28f4c5cb05f8c8305"><div class="ttname"><a href="store_2forward_8h.html#ab1424e1b13666cc28f4c5cb05f8c8305">cache_key</a></div><div class="ttdeci">unsigned char cache_key</div><div class="ttdoc">Store key.</div><div class="ttdef"><b>Definition</b> <a href="store_2forward_8h_source.html#l00029">forward.h:29</a></div></div>
<div class="ttc" id="astore_8cc_html_a270563a6d5ec90328acb0edd0a53b185"><div class="ttname"><a href="store_8cc.html#a270563a6d5ec90328acb0edd0a53b185">storeAppendPrintf</a></div><div class="ttdeci">void storeAppendPrintf(StoreEntry *e, const char *fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00855">store.cc:855</a></div></div>
<div class="ttc" id="astore_8cc_html_a872157d7a8c43bb5facb072ce03c4d48"><div class="ttname"><a href="store_8cc.html#a872157d7a8c43bb5facb072ce03c4d48">storeCreateEntry</a></div><div class="ttdeci">StoreEntry * storeCreateEntry(const char *url, const char *logUrl, const RequestFlags &amp;flags, const HttpRequestMethod &amp;method)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00759">store.cc:759</a></div></div>
<div class="ttc" id="astore__key__md5_8cc_html_a26af53797f468930492b0d33f993feac"><div class="ttname"><a href="store__key__md5_8cc.html#a26af53797f468930492b0d33f993feac">storeKeyPublicByRequest</a></div><div class="ttdeci">const cache_key * storeKeyPublicByRequest(HttpRequest *request, const KeyScope keyScope)</div><div class="ttdef"><b>Definition</b> <a href="store__key__md5_8cc_source.html#l00110">store_key_md5.cc:110</a></div></div>
<div class="ttc" id="astore__key__md5_8cc_html_ae14de11fa2cd3e2dc15d4763a06d0850"><div class="ttname"><a href="store__key__md5_8cc.html#ae14de11fa2cd3e2dc15d4763a06d0850">storeKeyText</a></div><div class="ttdeci">const char * storeKeyText(const cache_key *key)</div><div class="ttdef"><b>Definition</b> <a href="store__key__md5_8cc_source.html#l00017">store_key_md5.cc:17</a></div></div>
<div class="ttc" id="astore__key__md5_8h_html"><div class="ttname"><a href="store__key__md5_8h.html">store_key_md5.h</a></div></div>
<div class="ttc" id="astructCachePeer_1_1icp___html_a0fd3ca844136a22d04ad79b3d53b7cb5"><div class="ttname"><a href="structCachePeer_1_1icp__.html#a0fd3ca844136a22d04ad79b3d53b7cb5">CachePeer::icp_::port</a></div><div class="ttdeci">unsigned short port</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00093">CachePeer.h:93</a></div></div>
<div class="ttc" id="astructCachePeer_1_1icp___html_a60ce43773ae66cf79adbffe0f0e02221"><div class="ttname"><a href="structCachePeer_1_1icp__.html#a60ce43773ae66cf79adbffe0f0e02221">CachePeer::icp_::version</a></div><div class="ttdeci">int version</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00091">CachePeer.h:91</a></div></div>
<div class="ttc" id="astructCachePeer_1_1icp___html_a780ce4f235b5682ab958fb897dadd14a"><div class="ttname"><a href="structCachePeer_1_1icp__.html#a780ce4f235b5682ab958fb897dadd14a">CachePeer::icp_::counts</a></div><div class="ttdeci">int counts[ICP_END+1]</div><div class="ttdef"><b>Definition</b> <a href="CachePeer_8h_source.html#l00092">CachePeer.h:92</a></div></div>
<div class="ttc" id="astub__event_8cc_html_a0c9547f061079f5587b085091da968bc"><div class="ttname"><a href="stub__event_8cc.html#a0c9547f061079f5587b085091da968bc">double</a></div><div class="ttdeci">void EVH void double</div><div class="ttdef"><b>Definition</b> <a href="stub__event_8cc_source.html#l00016">stub_event.cc:16</a></div></div>
<div class="ttc" id="astub__fd_8cc_html_a35fed7109d24712d6b86b6134537c7bd"><div class="ttname"><a href="stub__fd_8cc.html#a35fed7109d24712d6b86b6134537c7bd">int</a></div><div class="ttdeci">int unsigned int</div><div class="ttdef"><b>Definition</b> <a href="stub__fd_8cc_source.html#l00019">stub_fd.cc:19</a></div></div>
<div class="ttc" id="astub__tools_8cc_html_a2a195065f59151742dac1bc54c3ef1e9"><div class="ttname"><a href="stub__tools_8cc.html#a2a195065f59151742dac1bc54c3ef1e9">IamWorkerProcess</a></div><div class="ttdeci">bool IamWorkerProcess()</div><div class="ttdoc">whether the current process handles HTTP transactions and such</div><div class="ttdef"><b>Definition</b> <a href="stub__tools_8cc_source.html#l00047">stub_tools.cc:47</a></div></div>
<div class="ttc" id="atime_2gadgets_8cc_html_a502612b4a32c5902726b120d713d7952"><div class="ttname"><a href="time_2gadgets_8cc.html#a502612b4a32c5902726b120d713d7952">current_time</a></div><div class="ttdeci">struct timeval current_time</div><div class="ttdoc">the current UNIX time in timeval {seconds, microseconds} format</div><div class="ttdef"><b>Definition</b> <a href="time_2gadgets_8cc_source.html#l00018">gadgets.cc:18</a></div></div>
<div class="ttc" id="atime_2gadgets_8cc_html_af7a3c9de59180267762f047ffd42e503"><div class="ttname"><a href="time_2gadgets_8cc.html#af7a3c9de59180267762f047ffd42e503">tvSubMsec</a></div><div class="ttdeci">int tvSubMsec(struct timeval t1, struct timeval t2)</div><div class="ttdef"><b>Definition</b> <a href="time_2gadgets_8cc_source.html#l00051">gadgets.cc:51</a></div></div>
<div class="ttc" id="atools_8cc_html_a2d24834d9959fb3fa7d4789d055c1768"><div class="ttname"><a href="tools_8cc.html#a2d24834d9959fb3fa7d4789d055c1768">getMyHostname</a></div><div class="ttdeci">const char * getMyHostname(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00468">tools.cc:468</a></div></div>
<div class="ttc" id="atools_8cc_html_abf17a12ab2f03f92a22edeca4be36e19"><div class="ttname"><a href="tools_8cc.html#abf17a12ab2f03f92a22edeca4be36e19">debug_trap</a></div><div class="ttdeci">void debug_trap(const char *message)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00459">tools.cc:459</a></div></div>
<div class="ttc" id="atools_8h_html"><div class="ttname"><a href="tools_8h.html">tools.h</a></div></div>
<div class="ttc" id="atypedefs_8h_html_a553228e11bbd528f7f0bf2d11b54b0fa"><div class="ttname"><a href="typedefs_8h.html#a553228e11bbd528f7f0bf2d11b54b0fa">IRCB</a></div><div class="ttdeci">void IRCB(CachePeer *, peer_t, AnyP::ProtocolType, void *, void *data)</div><div class="ttdef"><b>Definition</b> <a href="typedefs_8h_source.html#l00022">typedefs.h:22</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3c69fff7f634b97773a4d39d4565ffb4.html">squid</a></li><li class="navelem"><a class="el" href="dir_27a06220d184fcc3bd2c56b7794ae45b.html">src</a></li><li class="navelem"><a class="el" href="neighbors_8cc.html">neighbors.cc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
