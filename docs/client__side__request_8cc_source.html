<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squid Web Cache: squid/src/client_side_request.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Squid Web Cache<span id="projectnumber">&#160;v8/master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('client__side__request_8cc_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">client_side_request.cc</div></div>
</div><!--header-->
<div class="contents">
<a href="client__side__request_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * Copyright (C) 1996-2025 The Squid Software Foundation and contributors</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> *</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * Squid software is distributed under GPLv2+ license and includes</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * contributions from numerous individuals and organizations.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * Please see the COPYING and CONTRIBUTORS files for details.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> */</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">/* DEBUG: section 85    Client-side Request Routines */</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">/*</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> * General logic of request processing:</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> *</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> * We run a series of tests to determine if access will be permitted, and to do</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> * any redirection. Then we call into the result clientStream to retrieve data.</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> * From that point on it&#39;s up to reply management.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> */</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="squid_8h.html">squid.h</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="FilledChecklist_8h.html">acl/FilledChecklist.h</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="acl_2Gadgets_8h.html">acl/Gadgets.h</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="PortCfg_8h.html">anyp/PortCfg.h</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="AsyncJobCalls_8h.html">base/AsyncJobCalls.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="client__side_8h.html">client_side.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="client__side__reply_8h.html">client_side_reply.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="client__side__request_8h.html">client_side_request.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="ClientRequestContext_8h.html">ClientRequestContext.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="clientStream_8h.html">clientStream.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="Connection_8h.html">comm/Connection.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="Write_8h.html">comm/Write.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="debug_2Messages_8h.html">debug/Messages.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="Detail_8h.html">error/Detail.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="errorpage_8h.html">errorpage.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="fd_8h.html">fd.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="fde_8h.html">fde.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="Token_8h.html">format/Token.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;<a class="code" href="FwdState_8h.html">FwdState.h</a>&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &quot;<a class="code" href="ssl_2helper_8h.html">helper.h</a>&quot;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;<a class="code" href="Reply_8h.html">helper/Reply.h</a>&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;<a class="code" href="http_8h.html">http.h</a>&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &quot;<a class="code" href="http_2Stream_8h.html">http/Stream.h</a>&quot;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &quot;<a class="code" href="HttpHdrCc_8h.html">HttpHdrCc.h</a>&quot;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &quot;<a class="code" href="HttpReply_8h.html">HttpReply.h</a>&quot;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &quot;<a class="code" href="HttpRequest_8h.html">HttpRequest.h</a>&quot;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &quot;<a class="code" href="internal_8h.html">internal.h</a>&quot;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &quot;<a class="code" href="NfMarkConfig_8h.html">ip/NfMarkConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &quot;<a class="code" href="QosConfig_8h.html">ip/QosConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &quot;<a class="code" href="ipcache_8h.html">ipcache.h</a>&quot;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#include &quot;<a class="code" href="access__log_8h.html">log/access_log.h</a>&quot;</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="preprocessor">#include &quot;<a class="code" href="MemObject_8h.html">MemObject.h</a>&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#include &quot;<a class="code" href="Parsing_8h.html">Parsing.h</a>&quot;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#include &quot;<a class="code" href="Header_8h.html">proxyp/Header.h</a>&quot;</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="preprocessor">#include &quot;<a class="code" href="redirect_8h.html">redirect.h</a>&quot;</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#include &quot;<a class="code" href="rfc1738_8h.html">rfc1738.h</a>&quot;</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="preprocessor">#include &quot;<a class="code" href="StringConvert_8h.html">sbuf/StringConvert.h</a>&quot;</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="preprocessor">#include &quot;<a class="code" href="SquidConfig_8h.html">SquidConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="preprocessor">#include &quot;<a class="code" href="Store_8h.html">Store.h</a>&quot;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#include &quot;<a class="code" href="StrList_8h.html">StrList.h</a>&quot;</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="preprocessor">#include &quot;<a class="code" href="tools_8h.html">tools.h</a>&quot;</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#include &quot;<a class="code" href="wordlist_8h.html">wordlist.h</a>&quot;</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="preprocessor">#include &quot;<a class="code" href="UserRequest_8h.html">auth/UserRequest.h</a>&quot;</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="preprocessor">#if USE_ADAPTATION</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">#include &quot;<a class="code" href="AccessCheck_8h.html">adaptation/AccessCheck.h</a>&quot;</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="preprocessor">#include &quot;<a class="code" href="Answer_8h.html">adaptation/Answer.h</a>&quot;</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">#include &quot;<a class="code" href="Iterator_8h.html">adaptation/Iterator.h</a>&quot;</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="preprocessor">#include &quot;<a class="code" href="Service_8h.html">adaptation/Service.h</a>&quot;</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="preprocessor">#if ICAP_CLIENT</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="preprocessor">#include &quot;<a class="code" href="icap_2History_8h.html">adaptation/icap/History.h</a>&quot;</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="preprocessor">#include &quot;<a class="code" href="ServerBump_8h.html">ssl/ServerBump.h</a>&quot;</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="preprocessor">#include &quot;<a class="code" href="ssl_2support_8h.html">ssl/support.h</a>&quot;</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="preprocessor">#if FOLLOW_X_FORWARDED_FOR</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="preprocessor">#if !defined(SQUID_X_FORWARDED_FOR_HOP_MAX)</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#afbc1de07ad7aca7bdbfd47333a41ecfa">   81</a></span><span class="preprocessor">#define SQUID_X_FORWARDED_FOR_HOP_MAX 64</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="client__side__request_8cc.html#a3d74ef57ca7a73b9afcf11b39b232ca7">clientFollowXForwardedForCheck</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> answer, <span class="keywordtype">void</span> *data);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span><span class="preprocessor">#endif </span><span class="comment">/* FOLLOW_X_FORWARDED_FOR */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><a class="code hl_class" href="classErrorState.html">ErrorState</a> *<a class="code hl_function" href="client__side__request_8cc.html#a5060082d1706884b9f28609a295f7e5a">clientBuildError</a>(<a class="code hl_enumeration" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a>, <a class="code hl_enumeration" href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a>, <span class="keywordtype">char</span> <span class="keyword">const</span> *url, <span class="keyword">const</span> <a class="code hl_class" href="classConnStateData.html">ConnStateData</a> *, <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *, <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">AccessLogEntry::Pointer</a> &amp;);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><a class="code hl_define" href="cbdata_8h.html#a4710a3530194cffbc7f74fa2b2c4529d">CBDATA_CLASS_INIT</a>(<a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a>);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="comment">/* Local functions */</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="comment">/* other */</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="client__side__request_8cc.html#ac83479871c875bdb5f7245fa03b9fdb1">clientAccessCheckDoneWrapper</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a>, <span class="keywordtype">void</span> *);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="client__side__request_8cc.html#a4dfa5d0ca935688bbe22c2385d753b1e">sslBumpAccessCheckDoneWrapper</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a>, <span class="keywordtype">void</span> *);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code hl_function" href="client__side__request_8cc.html#a735a532956f51fa77e73d03064f13424">clientHierarchical</a>(<a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> * http);</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="client__side__request_8cc.html#a22bce20949eaf9c5562098a53cb6fee0">clientInterpretRequestHeaders</a>(<a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> * http);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a998efc2ba7574e34f7266f22bdb6b5ea">   99</a></span><span class="keyword">static</span> <a class="code hl_typedef" href="helper_2forward_8h.html#a25fa139de778b4cf256ada984da2be85">HLPCB</a> <a class="code hl_variable" href="client__side__request_8cc.html#a998efc2ba7574e34f7266f22bdb6b5ea">clientRedirectDoneWrapper</a>;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a80f5c9d940e83a142afa6e7591f27f52">  100</a></span><span class="keyword">static</span> <a class="code hl_typedef" href="helper_2forward_8h.html#a25fa139de778b4cf256ada984da2be85">HLPCB</a> <a class="code hl_variable" href="client__side__request_8cc.html#a80f5c9d940e83a142afa6e7591f27f52">clientStoreIdDoneWrapper</a>;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="client__side__request_8cc.html#a4823e00c3c632f760a59b35b624145b5">checkNoCacheDoneWrapper</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a>, <span class="keywordtype">void</span> *);</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">  102</a></span><a class="code hl_typedef" href="clientStreamForward_8h.html#adfeb9a20de88d7ad3433ca3c7f50a364">CSR</a> <a class="code hl_variable" href="client__side__request_8cc.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">clientGetMoreData</a>;</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a3d42a7ece901f14e6ec973a0feb096e1">  103</a></span><a class="code hl_typedef" href="clientStreamForward_8h.html#afe231eb7220220dab4804637c286f6e0">CSS</a> <a class="code hl_variable" href="client__side__request_8cc.html#a3d42a7ece901f14e6ec973a0feb096e1">clientReplyStatus</a>;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#ab806362f706a7b39732957bb45e3c2df">  104</a></span><a class="code hl_typedef" href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a> <a class="code hl_variable" href="client__side__request_8cc.html#ab806362f706a7b39732957bb45e3c2df">clientReplyDetach</a>;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code hl_function" href="client__side__request_8cc.html#a985be8c59ea695cbaa2c1953ea90b5f7">checkFailureRatio</a>(<a class="code hl_enumeration" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a>, <a class="code hl_enumeration" href="hier__code_8h.html#a8836a137c62397b51ab64e564c94177d">hier_code</a>);</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="foldopen" id="foldopen00107" data-start="{" data-end="}">
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a981b1e47936a17c8935edc65f6022d7a">  107</a></span><a class="code hl_function" href="classClientRequestContext.html#a981b1e47936a17c8935edc65f6022d7a">ClientRequestContext::~ClientRequestContext</a>()</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>{</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="comment">     * Release our &quot;lock&quot; on our parent, ClientHttpRequest, if we</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="comment">     * still have one</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span><span class="comment">     */</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <a class="code hl_define" href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    <span class="keyword">delete</span> <a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85,3, <span class="stringliteral">&quot;ClientRequestContext destructed, this=&quot;</span> &lt;&lt; <span class="keyword">this</span>);</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>}</div>
</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="foldopen" id="foldopen00120" data-start="{" data-end="}">
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a71911d920002e0ddc70f8780215b93a6">  120</a></span><a class="code hl_function" href="classClientRequestContext.html#a71911d920002e0ddc70f8780215b93a6">ClientRequestContext::ClientRequestContext</a>(<a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> *anHttp) :</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    http(<a class="code hl_define" href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a>(anHttp))</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>{</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;ClientRequestContext constructed, this=&quot;</span> &lt;&lt; <span class="keyword">this</span>);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>}</div>
</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span><a class="code hl_define" href="cbdata_8h.html#a4710a3530194cffbc7f74fa2b2c4529d">CBDATA_CLASS_INIT</a>(<a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a>);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="foldopen" id="foldopen00128" data-start="{" data-end="}">
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a04dd0ad1467801e14f12166d39767aa4">  128</a></span><a class="code hl_function" href="classClientHttpRequest.html#a04dd0ad1467801e14f12166d39767aa4">ClientHttpRequest::ClientHttpRequest</a>(<a class="code hl_class" href="classConnStateData.html">ConnStateData</a> * aConn) :</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>#if <a class="code hl_define" href="autoconf_8h.html#aa955ac26436bae87f4774af6c870f762">USE_ADAPTATION</a></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    <a class="code hl_class" href="classAsyncJob.html">AsyncJob</a>(<span class="stringliteral">&quot;ClientHttpRequest&quot;</span>),</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>#endif</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    al(new <a class="code hl_class" href="classAccessLogEntry.html">AccessLogEntry</a>()),</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    conn_(<a class="code hl_define" href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a>(aConn))</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>{</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <a class="code hl_function" href="classCodeContext.html#aeed1567dd2fb1c97eb3fa3f10df4622e">CodeContext::Reset</a>(<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">cache</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1CacheDetails.html#a17380db1a07c6fa0aa73c3107650a3f6">start_time</a> = <a class="code hl_variable" href="time_2gadgets_8cc.html#a502612b4a32c5902726b120d713d7952">current_time</a>;</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="keywordflow">if</span> (aConn) {</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a7526170211aae1d9c98e2866281e7f5c">tcpClient</a> = aConn-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">cache</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1CacheDetails.html#a02ec662fe003473c6cc317e7b1cda66b">port</a> = aConn-&gt;<a class="code hl_variable" href="classConnStateData.html#ae06c387dd773449597078259a953013b">port</a>;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">cache</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1CacheDetails.html#ad2623b54e07c80bf68230b9127ca1878">caddr</a> = aConn-&gt;<a class="code hl_variable" href="classConnStateData.html#ab4bed752a0b6a81679cdb594f98e7022">log_addr</a>;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#ad81723baa479b57c574cca4a3d29b25c">proxyProtocolHeader</a> = aConn-&gt;<a class="code hl_function" href="classConnStateData.html#a25b3fe939ab58955e7a41302da7d64a1">proxyProtocolHeader</a>();</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_function" href="classAccessLogEntry.html#af60bc81e8501b430cbb4e209699c0091">updateError</a>(aConn-&gt;<a class="code hl_variable" href="classConnStateData.html#a5230ce05c11307d10d7f118c4246082f">bareError</a>);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        <span class="keywordflow">if</span> (aConn-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a> != <span class="keyword">nullptr</span> &amp;&amp; aConn-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>-&gt;<a class="code hl_function" href="classComm_1_1Connection.html#a2cd96e61e73907e8a07add1c1e4f3750">isOpen</a>()) {</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> ssl = <a class="code hl_define" href="fde_8h.html#a0f820c6a388ea0380a19a97713736a35">fd_table</a>[aConn-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">fd</a>].ssl.get())</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>                <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">cache</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1CacheDetails.html#a0807169fe49e64321a78126974f31868">sslClientCert</a>.<a class="code hl_function" href="classSecurity_1_1LockingPointer.html#a761bee3ceb5853c9098117f6d3f657eb">resetWithoutLocking</a>(SSL_get_peer_certificate(ssl));</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        }</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    }</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <a class="code hl_function" href="dlink_8cc.html#a6653213a8433b9e40b94980846e0634a">dlinkAdd</a>(<span class="keyword">this</span>, &amp;<a class="code hl_variable" href="classClientHttpRequest.html#ad2bda94a7fa9e86b17a08e3018f82c0e">active</a>, &amp;<a class="code hl_variable" href="dlink_8cc.html#a9c55f8c6c000159340141e62253dc26f">ClientActiveRequests</a>);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>}</div>
</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span> </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span><span class="comment">/*</span></div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span><span class="comment"> * returns true if client specified that the object must come from the cache</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span><span class="comment"> * without contacting origin server</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span><span class="comment"> */</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00159" data-start="{" data-end="}">
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ab2d33ce5e3e5a930de04639ee09a1bcc">  159</a></span><a class="code hl_function" href="classClientHttpRequest.html#ab2d33ce5e3e5a930de04639ee09a1bcc">ClientHttpRequest::onlyIfCached</a>()<span class="keyword">const</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#adecda0b631f46c076e91fb61d429a865">cache_control</a> &amp;&amp;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>           <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#adecda0b631f46c076e91fb61d429a865">cache_control</a>-&gt;<a class="code hl_function" href="classHttpHdrCc.html#aa9822d58df5d7d5c5527ad0b5337b78e">hasOnlyIfCached</a>();</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>}</div>
</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00179" data-start="{" data-end="}">
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a985be8c59ea695cbaa2c1953ea90b5f7">  179</a></span><a class="code hl_function" href="client__side__request_8cc.html#a985be8c59ea695cbaa2c1953ea90b5f7">checkFailureRatio</a>(<a class="code hl_enumeration" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a> etype, <a class="code hl_enumeration" href="hier__code_8h.html#a8836a137c62397b51ab64e564c94177d">hier_code</a> hcode)</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>{</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <span class="comment">// Can be set at compile time with -D compiler flag</span></div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span><span class="preprocessor">#ifndef FAILURE_MODE_TIME</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span><span class="preprocessor">#define FAILURE_MODE_TIME 300</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="keywordflow">if</span> (hcode == <a class="code hl_enumvalue" href="hier__code_8h.html#a8836a137c62397b51ab64e564c94177da3dd14aff7318d1e1ec693b032a493706">HIER_NONE</a>)</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="comment">// don&#39;t bother when ICP is disabled.</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f4e2240c8dc2d56abe34caef997beb">Port</a>.<a class="code hl_variable" href="classSquidConfig.html#aa11776521bdbbd1348221ea9d7237907">icp</a> &lt;= 0)</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="keyword">static</span> <span class="keywordtype">double</span> magic_factor = 100.0;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="keywordtype">double</span> n_good;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="keywordtype">double</span> n_bad;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    n_good = magic_factor / (1.0 + <a class="code hl_variable" href="globals_8h.html#adc11e3edf1986aba8ef7f5bc87ad5cc9">request_failure_ratio</a>);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    n_bad = magic_factor - n_good;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <span class="keywordflow">switch</span> (etype) {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa3160dbf875ae8dc585f2ef9f5050b31e">ERR_DNS_FAIL</a>:</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa25c9d005a130c3356ea3fb07785405ca">ERR_CONNECT_FAIL</a>:</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa298ac2b8812fe165e53492b830384bc5">ERR_SECURE_CONNECT_FAIL</a>:</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span> </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aacd0129ea7567a99caef7ab86ed500d9a">ERR_READ_ERROR</a>:</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        ++n_bad;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        ++n_good;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <a class="code hl_variable" href="globals_8h.html#adc11e3edf1986aba8ef7f5bc87ad5cc9">request_failure_ratio</a> = n_bad / n_good;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="globals_8h.html#ae9785ae5ad141155f0d192ef337afaf1">hit_only_mode_until</a> &gt; <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a>)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="globals_8h.html#adc11e3edf1986aba8ef7f5bc87ad5cc9">request_failure_ratio</a> &lt; 1.0)</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;WARNING: Failure Ratio at &quot;</span>&lt;&lt; std::setw(4)&lt;&lt;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>           std::setprecision(3) &lt;&lt; <a class="code hl_variable" href="globals_8h.html#adc11e3edf1986aba8ef7f5bc87ad5cc9">request_failure_ratio</a>);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;WARNING: ICP going into HIT-only mode for &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>           <a class="code hl_define" href="client__side__request_8cc.html#a3e1608b9b7fdf0bb62db15dcd7ca0bc9">FAILURE_MODE_TIME</a> / 60 &lt;&lt; <span class="stringliteral">&quot; minutes...&quot;</span>);</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <a class="code hl_variable" href="globals_8h.html#ae9785ae5ad141155f0d192ef337afaf1">hit_only_mode_until</a> = <a class="code hl_variable" href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a> + <a class="code hl_define" href="client__side__request_8cc.html#a3e1608b9b7fdf0bb62db15dcd7ca0bc9">FAILURE_MODE_TIME</a>;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <a class="code hl_variable" href="globals_8h.html#adc11e3edf1986aba8ef7f5bc87ad5cc9">request_failure_ratio</a> = 0.8;    <span class="comment">/* reset to something less than 1.0 */</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>}</div>
</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="foldopen" id="foldopen00235" data-start="{" data-end="}">
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a7473743cac10ac76866ed9dd147d2f66">  235</a></span><a class="code hl_function" href="classClientHttpRequest.html#a7473743cac10ac76866ed9dd147d2f66">ClientHttpRequest::~ClientHttpRequest</a>()</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>{</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 3, <span class="stringliteral">&quot;httpRequestFree: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="comment">// Even though freeResources() below may destroy the request,</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="comment">// we no longer set request-&gt;body_pipe to NULL here</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="comment">// because we did not initiate that pipe (ConnStateData did)</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    <span class="comment">/* the ICP check here was erroneous</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="comment">     * - StoreEntry::releaseRequest was always called if entry was valid</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="comment">     */</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span> </div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <a class="code hl_function" href="classClientHttpRequest.html#a479a52ea68d38e907287b7e921d4fd68">logRequest</a>();</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <a class="code hl_function" href="classClientHttpRequest.html#af52b42fc3f7ed18172aa09d69f856e55">loggingEntry</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>)</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        <a class="code hl_function" href="client__side__request_8cc.html#a985be8c59ea695cbaa2c1953ea90b5f7">checkFailureRatio</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#aeeb3de67d14be944d152c249379832cb">error</a>.<a class="code hl_variable" href="classError.html#a1220700c3c5aa1181e2f1fd762b67e8b">category</a>, <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a550f1fb979566c3e705422eeb6d0b66c">hier</a>.<a class="code hl_variable" href="classHierarchyLogEntry.html#ac79cc06b0d8333ee14e8cc66d3941e6d">code</a>);</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <a class="code hl_function" href="classClientHttpRequest.html#a52f95c3b38b4cacf5fa0e4d157b6eac6">freeResources</a>();</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="preprocessor">#if USE_ADAPTATION</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    <a class="code hl_function" href="classAdaptation_1_1Initiator.html#ac6f89220ffe700ed34f09c5f6d66a70d">announceInitiatorAbort</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">virginHeadSource</a>);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        <a class="code hl_function" href="classBodyConsumer.html#a790352eb36ab2d4e38d9e00247de0c94">stopConsumingFrom</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="keyword">delete</span> <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <a class="code hl_define" href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a9230e617966aced0ed6f9e8b29f16256">conn_</a>);</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="comment">/* moving to the next connection is handled by the context free */</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <a class="code hl_function" href="dlink_8cc.html#a26c24944a77583bb90a7efb1455a269b">dlinkDelete</a>(&amp;<a class="code hl_variable" href="classClientHttpRequest.html#ad2bda94a7fa9e86b17a08e3018f82c0e">active</a>, &amp;<a class="code hl_variable" href="dlink_8cc.html#a9c55f8c6c000159340141e62253dc26f">ClientActiveRequests</a>);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>}</div>
</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen00272" data-start="{" data-end="}">
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">  272</a></span><a class="code hl_function" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">ClientRequestContext::httpStateIsValid</a>()</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>{</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> *http_ = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a>(http_))</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <a class="code hl_define" href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a>(http_);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>}</div>
</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span> </div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span><span class="preprocessor">#if FOLLOW_X_FORWARDED_FOR</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00302" data-start="{" data-end="}">
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a3d74ef57ca7a73b9afcf11b39b232ca7">  302</a></span><a class="code hl_function" href="client__side__request_8cc.html#a3d74ef57ca7a73b9afcf11b39b232ca7">clientFollowXForwardedForCheck</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> answer, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>{</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *calloutContext = (<a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *) data;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="keywordflow">if</span> (!calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">httpStateIsValid</a>())</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> *http = calloutContext-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = http-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    <span class="keywordflow">if</span> (answer.<a class="code hl_function" href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">allowed</a>() &amp;&amp; request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">x_forwarded_for_iterator</a>.<a class="code hl_function" href="classString.html#aff70196bf32e527af1116bb4eb93f353">size</a>() != 0) {</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><span class="comment">         * Remove the last comma-delimited element from the</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span><span class="comment">         * x_forwarded_for_iterator and use it to repeat the cycle.</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span><span class="comment">         */</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *p;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *asciiaddr;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        <span class="keywordtype">int</span> l;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        <a class="code hl_class" href="classIp_1_1Address.html">Ip::Address</a> addr;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>        p = request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">x_forwarded_for_iterator</a>.<a class="code hl_function" href="classString.html#aba5551ee62c6e82730c0cb1856238c14">termedBuf</a>();</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        l = request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">x_forwarded_for_iterator</a>.<a class="code hl_function" href="classString.html#aff70196bf32e527af1116bb4eb93f353">size</a>();</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span><span class="comment">        * XXX x_forwarded_for_iterator should really be a list of</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span><span class="comment">        * IP addresses, but it&#39;s a String instead.  We have to</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span><span class="comment">        * walk backwards through the String, biting off the last</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span><span class="comment">        * comma-delimited part each time.  As long as the data is in</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="comment">        * a String, we should probably implement and use a variant of</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="comment">        * strListGetItem() that walks backwards instead of forwards</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="comment">        * through a comma-separated list.  But we don&#39;t even do that;</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="comment">        * we just do the work in-line here.</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span><span class="comment">        */</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>        <span class="comment">/* skip trailing space and commas */</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>        <span class="keywordflow">while</span> (l &gt; 0 &amp;&amp; (p[l-1] == <span class="charliteral">&#39;,&#39;</span> || <a class="code hl_define" href="xis_8h.html#a1ddc35653ddbcf46386d5c824a83a150">xisspace</a>(p[l-1])))</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>            --l;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">x_forwarded_for_iterator</a>.<a class="code hl_function" href="classString.html#a81bb18e2351263a07da5ee354034abc4">cut</a>(l);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <span class="comment">/* look for start of last item in list */</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <span class="keywordflow">while</span> (l &gt; 0 &amp;&amp; ! (p[l-1] == <span class="charliteral">&#39;,&#39;</span> || <a class="code hl_define" href="xis_8h.html#a1ddc35653ddbcf46386d5c824a83a150">xisspace</a>(p[l-1])))</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>            --l;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        asciiaddr = p+l;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <span class="keywordflow">if</span> ((addr = asciiaddr)) {</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">indirect_client_addr</a> = addr;</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">x_forwarded_for_iterator</a>.<a class="code hl_function" href="classString.html#a81bb18e2351263a07da5ee354034abc4">cut</a>(l);</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>            <span class="keyword">auto</span> ch = <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a29f05f66b8ce06a5465e7a6d70499db1">followXFF</a>, http);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a192f4e4ee92d4a55bda1111f6388988f">acl_uses_indirect_client</a>) {</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>                <span class="comment">/* override the default src_addr tested if we have to go deeper than one level into XFF */</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>                ch-&gt;src_addr = request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">indirect_client_addr</a>;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>            }</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>            <span class="keywordflow">if</span> (++calloutContext-&gt;<a class="code hl_variable" href="classClientRequestContext.html#adc8709afbf6ed349a3c492fa5c4fa539">currentXffHopNumber</a> &lt; <a class="code hl_define" href="client__side__request_8cc.html#afbc1de07ad7aca7bdbfd47333a41ecfa">SQUID_X_FORWARDED_FOR_HOP_MAX</a>) {</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>                <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(ch), <a class="code hl_function" href="client__side__request_8cc.html#a3d74ef57ca7a73b9afcf11b39b232ca7">clientFollowXForwardedForCheck</a>, data);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            }</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>            <span class="keyword">const</span> <span class="keyword">auto</span> headerName = <a class="code hl_variable" href="namespaceHttp.html#aaf4bcdea88a47c87334b1a4edb064b02">Http::HeaderLookupTable</a>.<a class="code hl_function" href="classHttp_1_1HeaderLookupTable__t.html#ad0a69236a64abb15d18d914cce89bc48">lookup</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a51d3bc271c12fd9b48b247fa1d1f8de0">Http::HdrType::X_FORWARDED_FOR</a>).<a class="code hl_variable" href="classHttp_1_1HeaderTableRecord.html#a99dc1fa2b3d56798babeac7f436305ff">name</a>;</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(28, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: Ignoring trailing &quot;</span> &lt;&lt; headerName &lt;&lt; <span class="stringliteral">&quot; addresses&quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>                   <a class="code hl_function" href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a> &lt;&lt; <span class="stringliteral">&quot;addresses allowed by follow_x_forwarded_for: &quot;</span> &lt;&lt; calloutContext-&gt;<a class="code hl_variable" href="classClientRequestContext.html#adc8709afbf6ed349a3c492fa5c4fa539">currentXffHopNumber</a> &lt;&lt;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>                   <a class="code hl_function" href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a> &lt;&lt; <span class="stringliteral">&quot;last/accepted address: &quot;</span> &lt;&lt; request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">indirect_client_addr</a> &lt;&lt;</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                   <a class="code hl_function" href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a> &lt;&lt; <span class="stringliteral">&quot;ignored trailing addresses: &quot;</span> &lt;&lt; request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">x_forwarded_for_iterator</a>);</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>            <span class="comment">// fall through to resume clientAccessCheck() processing</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        }</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    }</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="comment">/* clean up, and pass control to clientAccessCheck */</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a180efe1001cab8c4b64aed677cd2b9c0">log_uses_indirect_client</a>) {</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="comment">        * Ensure that the access log shows the indirect client</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment">        * instead of the direct client.</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span><span class="comment">        */</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        http-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">cache</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1CacheDetails.html#ad2623b54e07c80bf68230b9127ca1878">caddr</a> = request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">indirect_client_addr</a>;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        <span class="keywordflow">if</span> (<a class="code hl_class" href="classConnStateData.html">ConnStateData</a> *conn = http-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>())</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>            conn-&gt;log_addr = request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">indirect_client_addr</a>;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    }</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">x_forwarded_for_iterator</a>.<a class="code hl_function" href="classString.html#a60a0fdff84d3470d812b2adbcb2cbf38">clean</a>();</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a71595a4670414eec0b1aa2cd8b205590">done_follow_x_forwarded_for</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="keywordflow">if</span> (answer.<a class="code hl_function" href="classAcl_1_1Answer.html#aba69510c81a5b32017e59c7187062392">conflicted</a>()) {</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(28, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: Processing X-Forwarded-For. Stopping at IP address: &quot;</span> &lt;&lt; request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">indirect_client_addr</a> );</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    }</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    <span class="comment">/* process actual access ACL as normal. */</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a71477b784014a3f5309153a6d8b1f70c">clientAccessCheck</a>();</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>}</div>
</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span><span class="preprocessor">#endif </span><span class="comment">/* FOLLOW_X_FORWARDED_FOR */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span> </div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00387" data-start="{" data-end="}">
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a656ae23809551213625e54ef0febc910">  387</a></span><a class="code hl_function" href="client__side__request_8cc.html#a656ae23809551213625e54ef0febc910">hostHeaderIpVerifyWrapper</a>(<span class="keyword">const</span> <a class="code hl_class" href="classDns_1_1CachedIps.html">ipcache_addrs</a>* ia, <span class="keyword">const</span> <a class="code hl_class" href="classDns_1_1LookupDetails.html">Dns::LookupDetails</a> &amp;dns, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>{</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *c = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a>*<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    c-&gt;<a class="code hl_function" href="classClientRequestContext.html#af8f934f2f27ff1c700141d23a308d7b7">hostHeaderIpVerify</a>(ia, dns);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>}</div>
</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00394" data-start="{" data-end="}">
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#af8f934f2f27ff1c700141d23a308d7b7">  394</a></span><a class="code hl_function" href="classClientRequestContext.html#af8f934f2f27ff1c700141d23a308d7b7">ClientRequestContext::hostHeaderIpVerify</a>(<span class="keyword">const</span> <a class="code hl_class" href="classDns_1_1CachedIps.html">ipcache_addrs</a>* ia, <span class="keyword">const</span> <a class="code hl_class" href="classDns_1_1LookupDetails.html">Dns::LookupDetails</a> &amp;dns)</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>{</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <a class="code hl_class" href="classRefCount.html">Comm::ConnectionPointer</a> clientConn = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    <span class="comment">// note the DNS details for the transaction stats.</span></div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#a07108e36a4b7e86c096b04a557a7a023">recordLookup</a>(dns);</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="comment">// Is the NAT destination IP in DNS?</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <span class="keywordflow">if</span> (ia &amp;&amp; ia-&gt;<a class="code hl_function" href="classDns_1_1CachedIps.html#a6b2198324262b6580817aeccf8f5424c">have</a>(clientConn-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a84e6544b719c79cbecbc7d2a891fbcb2">local</a>)) {</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;validate IP &quot;</span> &lt;&lt; clientConn-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a84e6544b719c79cbecbc7d2a891fbcb2">local</a> &lt;&lt; <span class="stringliteral">&quot; possible from Host:&quot;</span>);</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a70ad8dd58ad2ad4d515f11c74c085472">hostVerified</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    }</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;FAIL: validate IP &quot;</span> &lt;&lt; clientConn-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a84e6544b719c79cbecbc7d2a891fbcb2">local</a> &lt;&lt; <span class="stringliteral">&quot; possible from Host:&quot;</span>);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <a class="code hl_function" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">hostHeaderVerifyFailed</a>(<span class="stringliteral">&quot;local IP&quot;</span>, <span class="stringliteral">&quot;any domain IP&quot;</span>);</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>}</div>
</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00413" data-start="{" data-end="}">
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">  413</a></span><a class="code hl_function" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">ClientRequestContext::hostHeaderVerifyFailed</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *A, <span class="keyword">const</span> <span class="keywordtype">char</span> *B)</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>{</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="comment">// IP address validation for Host: failed. Admin wants to ignore them.</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <span class="comment">// NP: we do not yet handle CONNECT tunnels well, so ignore for them</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a430c99a1ac73f36a587a63bf2b91eb66">hostStrictVerify</a> &amp;&amp; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> != <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7">Http::METHOD_CONNECT</a>) {</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;SECURITY ALERT: Host header forgery detected on &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a> &lt;&lt;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>               <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; A &lt;&lt; <span class="stringliteral">&quot; does not match &quot;</span> &lt;&lt; B &lt;&lt; <span class="stringliteral">&quot;) on URL: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>());</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span> </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        <span class="comment">// MUST NOT cache (for now). It is tempting to set flags.noCache, but</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        <span class="comment">// that flag is about satisfying _this_ request. We are actually OK with</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        <span class="comment">// satisfying this request from the cache, but want to prevent _other_</span></div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        <span class="comment">// requests from being satisfied using this response.</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af33cb0e80d9996c532479ef942d1eb91">cachable</a>.<a class="code hl_function" href="classSupportOrVeto.html#aa34618d1c0303ab67ec91663d046faea">veto</a>();</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        <span class="comment">// XXX: when we have updated the cache key to base on raw-IP + URI this cacheable limit can go.</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af8a2c52a07a38ceb366a512eab1d854b">hierarchical</a> = <span class="keyword">false</span>; <span class="comment">// MUST NOT pass to peers (for now)</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>        <span class="comment">// XXX: when we have sorted out the best way to relay requests properly to peers this hierarchical limit can go.</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    }</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;SECURITY ALERT: Host header forgery detected on &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>           <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a> &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; A &lt;&lt; <span class="stringliteral">&quot; does not match &quot;</span> &lt;&lt; B &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *ua = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#a89a87680aa68d7143be79793bcbce500">getStr</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a70cbaa89da5d5c5b1adb98835b3cdb88">Http::HdrType::USER_AGENT</a>))</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;SECURITY ALERT: By user agent: &quot;</span> &lt;&lt; ua);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;SECURITY ALERT: on URL: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>());</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="comment">// IP address validation for Host: failed. reject the connection.</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *<a class="code hl_struct" href="structnode.html">node</a> = (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">tail</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a4660c70e36112cd329b84f7152a671fa">prev</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *repContext = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *<span class="keyword">&gt;</span>(<a class="code hl_struct" href="structnode.html">node</a>-&gt;data.getRaw());</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a> (repContext);</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    repContext-&gt;<a class="code hl_function" href="classclientReplyContext.html#aefdedf444de122be303a2c56dc7ef1a9">setReplyToError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aab293f6e5c8060c0b9aab28a2a98b4b4c">ERR_CONFLICT_HOST</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a8a648efec58a8f2a280fbe512237d3dd">Http::scConflict</a>,</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>                                <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>                                <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(),</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>                                <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>,</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>                                <span class="keyword">nullptr</span>,</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>#<span class="keywordflow">if</span> <a class="code hl_define" href="autoconf_8h.html#aa6119eb054c0919b333de6888ac28c75">USE_AUTH</a></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>                                <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">getAuth</a>() != <span class="keyword">nullptr</span> ?</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>                                <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">getAuth</a>() : <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a>);</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>                                <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    <a class="code hl_struct" href="structnode.html">node</a> = (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">tail</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <a class="code hl_function" href="group__ClientStreamInternal.html#ga54ab73d51a7454c7ccafed27b3f87011">clientStreamRead</a>(<a class="code hl_struct" href="structnode.html">node</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>, <a class="code hl_struct" href="structnode.html">node</a>-&gt;readBuffer);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>}</div>
</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00460" data-start="{" data-end="}">
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#ad126658971216f8be7208f906bd640ea">  460</a></span><a class="code hl_function" href="classClientRequestContext.html#ad126658971216f8be7208f906bd640ea">ClientRequestContext::hostHeaderVerify</a>()</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>{</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    <span class="comment">// Require a Host: header.</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *host = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#a89a87680aa68d7143be79793bcbce500">getStr</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a304355a5f731e2a76ba795ebe1ffd247">Http::HdrType::HOST</a>);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    <span class="keywordflow">if</span> (!host) {</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        <span class="comment">// TODO: dump out the HTTP/1.1 error about missing host header.</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        <span class="comment">// otherwise this is fine, can&#39;t forge a header value when its not even set.</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;validate skipped with no Host: header present.&quot;</span>);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    }</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a26c4900e600bc57c506766fcbdf3c0e3">internal</a>) {</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        <span class="comment">// TODO: kill this when URL handling allows partial URLs out of accel mode</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <span class="comment">//       and we no longer screw with the URL just to add our internal host there</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 6, <span class="stringliteral">&quot;validate skipped due to internal composite URL.&quot;</span>);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    <span class="comment">// TODO: Unify Host value parsing below with AnyP::Uri authority parsing</span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    <span class="comment">// Locate if there is a port attached, strip ready for IP lookup</span></div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <span class="keywordtype">char</span> *portStr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <span class="keywordtype">char</span> *hostB = <a class="code hl_define" href="negotiate__wrapper_8cc.html#a5eb055ca3b42205cc134b4a438cd9a72">xstrdup</a>(host);</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    host = hostB;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <span class="keywordflow">if</span> (host[0] == <span class="charliteral">&#39;[&#39;</span>) {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        <span class="comment">// IPv6 literal.</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        portStr = strchr(hostB, <span class="charliteral">&#39;]&#39;</span>);</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>        <span class="keywordflow">if</span> (portStr &amp;&amp; *(++portStr) != <span class="charliteral">&#39;:&#39;</span>) {</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>            portStr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>        }</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        <span class="comment">// Domain or IPv4 literal with port</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        portStr = strrchr(hostB, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    }</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span> </div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    uint16_t <a class="code hl_variable" href="eDirectory_2ldap__backend_8cc.html#a63c89c04d1feae07ca35558055155ffb">port</a> = 0;</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    <span class="keywordflow">if</span> (portStr) {</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        *portStr = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">// strip the &#39;:&#39;</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>        <span class="keywordflow">if</span> (*(++portStr) != <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>            <span class="keywordtype">char</span> *end = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>            int64_t ret = <a class="code hl_function" href="strtoll_8c.html#a6d7fad4b09dcc36131cf70e8ec8bb77b">strtoll</a>(portStr, &amp;end, 10);</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>            <span class="keywordflow">if</span> (end == portStr || *end != <span class="charliteral">&#39;\0&#39;</span> || ret &lt; 1 || ret &gt; 0xFFFF) {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>                <span class="comment">// invalid port details. Replace the &#39;:&#39;</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                *(--portStr) = <span class="charliteral">&#39;:&#39;</span>;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                portStr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                <a class="code hl_variable" href="eDirectory_2ldap__backend_8cc.html#a63c89c04d1feae07ca35558055155ffb">port</a> = (ret &amp; 0xFFFF);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        }</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    }</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;validate host=&quot;</span> &lt;&lt; host &lt;&lt; <span class="stringliteral">&quot;, port=&quot;</span> &lt;&lt; <a class="code hl_variable" href="eDirectory_2ldap__backend_8cc.html#a63c89c04d1feae07ca35558055155ffb">port</a> &lt;&lt; <span class="stringliteral">&quot;, portStr=&quot;</span> &lt;&lt; (portStr?portStr:<span class="stringliteral">&quot;NULL&quot;</span>));</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a7feb14e42e2a35fb38fb744e98b8af7b">intercepted</a> || <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a067afb76219d72cd969eba5e44c6a9ea">interceptTproxy</a>) {</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>        <span class="comment">// verify the Host: port (if any) matches the apparent destination</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        <span class="keywordflow">if</span> (portStr &amp;&amp; <a class="code hl_variable" href="eDirectory_2ldap__backend_8cc.html#a63c89c04d1feae07ca35558055155ffb">port</a> != <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a84e6544b719c79cbecbc7d2a891fbcb2">local</a>.<a class="code hl_function" href="classIp_1_1Address.html#aeea3c669850f18acd2efcd336fcf2438">port</a>()) {</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;FAIL on validate port &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a84e6544b719c79cbecbc7d2a891fbcb2">local</a>.<a class="code hl_function" href="classIp_1_1Address.html#aeea3c669850f18acd2efcd336fcf2438">port</a>() &lt;&lt;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>                   <span class="stringliteral">&quot; matches Host: port &quot;</span> &lt;&lt; <a class="code hl_variable" href="eDirectory_2ldap__backend_8cc.html#a63c89c04d1feae07ca35558055155ffb">port</a> &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; portStr &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>            <a class="code hl_function" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">hostHeaderVerifyFailed</a>(<span class="stringliteral">&quot;intercepted port&quot;</span>, portStr);</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>            <span class="comment">// XXX: match the scheme default port against the apparent destination</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            <span class="comment">// verify the destination DNS is one of the Host: headers IPs</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>            <a class="code hl_function" href="group__IPCacheAPI.html#gae327ee2f13a395e7caeff7cbd783c765">ipcache_nbgethostbyname</a>(host, <a class="code hl_function" href="client__side__request_8cc.html#a656ae23809551213625e54ef0febc910">hostHeaderIpVerifyWrapper</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        }</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a430c99a1ac73f36a587a63bf2b91eb66">hostStrictVerify</a>) {</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;validate skipped.&quot;</span>);</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strlen(host) != strlen(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>())) {</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        <span class="comment">// Verify forward-proxy requested URL domain matches the Host: header</span></div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;FAIL on validate URL domain length &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>() &lt;&lt; <span class="stringliteral">&quot; matches Host: &quot;</span> &lt;&lt; host);</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        <a class="code hl_function" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">hostHeaderVerifyFailed</a>(host, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>());</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="Uri_8cc.html#a7b3d400c54dd0ce685ac6c136ae73fe3">matchDomainName</a>(host, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>()) != 0) {</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <span class="comment">// Verify forward-proxy requested URL domain matches the Host: header</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;FAIL on validate URL domain &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>() &lt;&lt; <span class="stringliteral">&quot; matches Host: &quot;</span> &lt;&lt; host);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        <a class="code hl_function" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">hostHeaderVerifyFailed</a>(host, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>());</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (portStr &amp;&amp; !<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">port</a>()) {</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;FAIL on validate portless URI matches Host: &quot;</span> &lt;&lt; portStr);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        <a class="code hl_function" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">hostHeaderVerifyFailed</a>(<span class="stringliteral">&quot;portless URI&quot;</span>, portStr);</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (portStr &amp;&amp; <a class="code hl_variable" href="eDirectory_2ldap__backend_8cc.html#a63c89c04d1feae07ca35558055155ffb">port</a> != *<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">port</a>()) {</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        <span class="comment">// Verify forward-proxy requested URL domain matches the Host: header</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;FAIL on validate URL port &quot;</span> &lt;&lt; *<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">port</a>() &lt;&lt; <span class="stringliteral">&quot; matches Host: port &quot;</span> &lt;&lt; portStr);</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <a class="code hl_function" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">hostHeaderVerifyFailed</a>(<span class="stringliteral">&quot;URL port&quot;</span>, portStr);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!portStr &amp;&amp; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> != <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7">Http::METHOD_CONNECT</a> &amp;&amp; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">port</a>() != <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">getScheme</a>().<a class="code hl_function" href="classAnyP_1_1UriScheme.html#ad403d4352324e814c01a859a11678a31">defaultPort</a>()) {</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        <span class="comment">// Verify forward-proxy requested URL domain matches the Host: header</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        <span class="comment">// Special case: we don&#39;t have a default-port to check for CONNECT. Assume URL is correct.</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;FAIL on validate URL port &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">port</a>().value_or(0) &lt;&lt; <span class="stringliteral">&quot; matches Host: default port &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">getScheme</a>().<a class="code hl_function" href="classAnyP_1_1UriScheme.html#ad403d4352324e814c01a859a11678a31">defaultPort</a>().value_or(0));</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        <a class="code hl_function" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">hostHeaderVerifyFailed</a>(<span class="stringliteral">&quot;URL port&quot;</span>, <span class="stringliteral">&quot;default port&quot;</span>);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        <span class="comment">// Okay no problem.</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;validate passed.&quot;</span>);</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a70ad8dd58ad2ad4d515f11c74c085472">hostVerified</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    }</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    <a class="code hl_define" href="xalloc_8h.html#a74ad4c3c3aa58c8fea96eb0dc090fd67">safe_free</a>(hostB);</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>}</div>
</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span><span class="comment">/* This is the entry point for external users of the client_side routines */</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00559" data-start="{" data-end="}">
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a71477b784014a3f5309153a6d8b1f70c">  559</a></span><a class="code hl_function" href="classClientRequestContext.html#a71477b784014a3f5309153a6d8b1f70c">ClientRequestContext::clientAccessCheck</a>()</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>{</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span><span class="preprocessor">#if FOLLOW_X_FORWARDED_FOR</span></div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_function" href="classRequestFlags.html#a02092fe75d2b0aadb80ebdef09ebdb1e">doneFollowXff</a>() &amp;&amp;</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>            <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a29f05f66b8ce06a5465e7a6d70499db1">followXFF</a> &amp;&amp;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>            <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a51d3bc271c12fd9b48b247fa1d1f8de0">Http::HdrType::X_FORWARDED_FOR</a>)) {</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span> </div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        <span class="comment">/* we always trust the direct client address for actual use */</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">indirect_client_addr</a> = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af6301466f6d3594f4fdacb4713a44c61">client_addr</a>;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">indirect_client_addr</a>.<a class="code hl_function" href="classIp_1_1Address.html#aeea3c669850f18acd2efcd336fcf2438">port</a>(0);</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span> </div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        <span class="comment">/* setup the XFF iterator for processing */</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">x_forwarded_for_iterator</a> = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>.<a class="code hl_function" href="classHttpHeader.html#a5bd52e3f8d517f7c1c919aa4a82f4e29">getList</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a51d3bc271c12fd9b48b247fa1d1f8de0">Http::HdrType::X_FORWARDED_FOR</a>);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <span class="comment">/* begin by checking to see if we trust direct client enough to walk XFF */</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        <span class="keyword">auto</span> acl_checklist = <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a29f05f66b8ce06a5465e7a6d70499db1">followXFF</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>        <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(acl_checklist), <a class="code hl_function" href="client__side__request_8cc.html#a3d74ef57ca7a73b9afcf11b39b232ca7">clientFollowXForwardedForCheck</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    }</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span> </div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a4f8434f02e4ddaf8a7397a902b250be5">http</a>) {</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <span class="keyword">auto</span> acl_checklist = <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a4f8434f02e4ddaf8a7397a902b250be5">http</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(acl_checklist), <a class="code hl_function" href="client__side__request_8cc.html#ac83479871c875bdb5f7245fa03b9fdb1">clientAccessCheckDoneWrapper</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(0, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;No http_access configuration found. This will block ALL traffic&quot;</span>);</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        <a class="code hl_function" href="classClientRequestContext.html#a24e8bfe9fb32a61b382c7b6c7f791de1">clientAccessCheckDone</a>(<a class="code hl_enumvalue" href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5a9c57583ad491217a69a63fdabf336c8e">ACCESS_DENIED</a>);</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>    }</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>}</div>
</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span> </div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00595" data-start="{" data-end="}">
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a004907eaa1efbcc4eb3bec5784ec0960">  595</a></span><a class="code hl_function" href="classClientRequestContext.html#a004907eaa1efbcc4eb3bec5784ec0960">ClientRequestContext::clientAccessCheck2</a>()</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>{</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a10bc53b0e5cbf3ad43465d61e912f438">adapted_http</a>) {</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        <span class="keyword">auto</span> acl_checklist = <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a10bc53b0e5cbf3ad43465d61e912f438">adapted_http</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(acl_checklist), <a class="code hl_function" href="client__side__request_8cc.html#ac83479871c875bdb5f7245fa03b9fdb1">clientAccessCheckDoneWrapper</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 2, <span class="stringliteral">&quot;No adapted_http_access configuration. default: ALLOW&quot;</span>);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        <a class="code hl_function" href="classClientRequestContext.html#a24e8bfe9fb32a61b382c7b6c7f791de1">clientAccessCheckDone</a>(<a class="code hl_enumvalue" href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5aa3d37d87d9b3887abc5466afb368cb8a">ACCESS_ALLOWED</a>);</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    }</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>}</div>
</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span> </div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00607" data-start="{" data-end="}">
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#ac83479871c875bdb5f7245fa03b9fdb1">  607</a></span><a class="code hl_function" href="client__side__request_8cc.html#ac83479871c875bdb5f7245fa03b9fdb1">clientAccessCheckDoneWrapper</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> answer, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>{</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *calloutContext = (<a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *) data;</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span> </div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <span class="keywordflow">if</span> (!calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">httpStateIsValid</a>())</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a24e8bfe9fb32a61b382c7b6c7f791de1">clientAccessCheckDone</a>(answer);</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>}</div>
</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span> </div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00618" data-start="{" data-end="}">
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a24e8bfe9fb32a61b382c7b6c7f791de1">  618</a></span><a class="code hl_function" href="classClientRequestContext.html#a24e8bfe9fb32a61b382c7b6c7f791de1">ClientRequestContext::clientAccessCheckDone</a>(<span class="keyword">const</span> <a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> &amp;answer)</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>{</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    <a class="code hl_enumeration" href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a> status;</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 2, <span class="stringliteral">&quot;The request &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt;</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>           <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; answer &lt;&lt;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>           <span class="stringliteral">&quot;; last ACL checked: &quot;</span> &lt;&lt; answer.<a class="code hl_function" href="classAcl_1_1Answer.html#a8a8bb1976fa15edce01b4af92dbafad8">lastCheckDescription</a>());</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>    <span class="keywordtype">char</span> <span class="keyword">const</span> *proxy_auth_msg = <span class="stringliteral">&quot;&lt;null&gt;&quot;</span>;</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">getAuth</a>() != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>        proxy_auth_msg = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">getAuth</a>()-&gt;<a class="code hl_function" href="classAuth_1_1UserRequest.html#a72983e97d9364c9b197308d1f3211b9d">denyMessage</a>(<span class="stringliteral">&quot;&lt;null&gt;&quot;</span>);</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        proxy_auth_msg = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a>-&gt;<a class="code hl_function" href="classAuth_1_1UserRequest.html#a72983e97d9364c9b197308d1f3211b9d">denyMessage</a>(<span class="stringliteral">&quot;&lt;null&gt;&quot;</span>);</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span> </div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    <span class="keywordflow">if</span> (!answer.<a class="code hl_function" href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">allowed</a>()) {</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>        <span class="comment">// auth has a grace period where credentials can be expired but okay not to challenge.</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        <span class="comment">/* Send an auth challenge or error */</span></div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        <span class="comment">// XXX: do we still need aclIsProxyAuth() ?</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        <span class="keyword">const</span> <span class="keyword">auto</span> auth_challenge = (answer == <a class="code hl_enumvalue" href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5a859fbb6f0f22ef6a93c61d193077a33f">ACCESS_AUTH_REQUIRED</a> || <a class="code hl_function" href="acl_2Gadgets_8cc.html#a387f34c73ec617a8825e4ec24486fc60">aclIsProxyAuth</a>(answer.<a class="code hl_variable" href="classAcl_1_1Answer.html#af71cc70f0bd7fabbe328876a6ff73f07">lastCheckedName</a>));</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;Access Denied: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>        <span class="keywordflow">if</span> (auth_challenge)</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 5, <span class="stringliteral">&quot;Proxy Auth Message = &quot;</span> &lt;&lt; (proxy_auth_msg ? proxy_auth_msg : <span class="stringliteral">&quot;&lt;null&gt;&quot;</span>));</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>        <span class="keyword">auto</span> page_id = <a class="code hl_function" href="acl_2Gadgets_8cc.html#a08bdf8035f35f6af7f7d4ada13655efa">FindDenyInfoPage</a>(answer, answer != <a class="code hl_enumvalue" href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5a859fbb6f0f22ef6a93c61d193077a33f">ACCESS_AUTH_REQUIRED</a>);</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span> </div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36">LOG_TCP_DENIED</a>);</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span> </div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>        <span class="keywordflow">if</span> (auth_challenge) {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#abbde600374891ccc540eea4812414b69">sslBumped</a>) {</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>                <span class="comment">/*SSL Bumped request, authentication is not possible*/</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>                status = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#aaa05fd2e87baa36553d2039aa92901a3">flags</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Flags.html#a409fd4d5e3b72f06df2921bd417e0a5c">accel</a>) {</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>                <span class="comment">/* Proxy authorisation needed */</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>                status = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aa140c4f7dc1624466a96d42cc209f155">Http::scProxyAuthenticationRequired</a>;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>                <span class="comment">/* WWW authorisation needed */</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>                status = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a3868c9f40f16676c17393a2e5565a83a">Http::scUnauthorized</a>;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>            }</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>            <span class="comment">// need auth, but not possible to do.</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>            status = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>            <span class="keywordflow">if</span> (page_id == <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d">ERR_NONE</a>)</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>                page_id = (status == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>) ? <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a> : <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aae0318cd74e59bed6f39622164c68bf4d">ERR_CACHE_ACCESS_DENIED</a>;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>            status = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a>;</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span> </div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>            <span class="keywordflow">if</span> (page_id == <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d">ERR_NONE</a>)</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                page_id = <a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a>;</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        }</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span> </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        <a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a> = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(page_id, status, <span class="keyword">nullptr</span>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span> </div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        <a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>-&gt;<a class="code hl_variable" href="classErrorState.html#aaa2499a9aec80fa57d4fe9f54ce1a153">auth_user_request</a> =</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>            <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">getAuth</a>() != <span class="keyword">nullptr</span> ?</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>            <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">getAuth</a>() : <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a>;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span> </div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>        <a class="code hl_variable" href="classClientRequestContext.html#a808ac8e44e079957a7bde4a46f23c62a">readNextRequest</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    }</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    <span class="comment">/* ACCESS_ALLOWED continues here ... */</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>    <a class="code hl_define" href="negotiate__wrapper_8cc.html#a2c3897f7c46ca54a2e0dd7b24a40c7cb">xfree</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> = <a class="code hl_function" href="SBuf_8h.html#a826aafc8068f24cb125e700733cd2bee">SBufToCstring</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>());</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>}</div>
</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span> </div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span><span class="preprocessor">#if USE_ADAPTATION</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00693" data-start="{" data-end="}">
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a0fd2f80aff7232c86a9e83ae876b3493">  693</a></span><a class="code hl_function" href="classClientHttpRequest.html#a0fd2f80aff7232c86a9e83ae876b3493">ClientHttpRequest::noteAdaptationAclCheckDone</a>(<a class="code hl_class" href="classRefCount.html">Adaptation::ServiceGroupPointer</a> g)</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>{</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(93,3, <span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot; adaptationAclCheckDone called&quot;</span>);</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span><span class="preprocessor">#if ICAP_CLIENT</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <a class="code hl_class" href="classRefCount.html">Adaptation::Icap::History::Pointer</a> ih = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#af12cd51466974ad702972c18238ef5a2">icapHistory</a>();</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    <span class="keywordflow">if</span> (ih != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection-&gt;<a class="code hl_function" href="classConnStateData.html#aaeed787292abe965e062beadfe35ea42">isOpen</a>()) {</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>                ih-&gt;ssluser = <a class="code hl_function" href="group__ServerProtocolSSLAPI.html#gadf059a1837d13958f66199a0b0676aa1">sslGetUserEmail</a>(<a class="code hl_define" href="fde_8h.html#a0f820c6a388ea0380a19a97713736a35">fd_table</a>[<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection-&gt;fd].ssl.get());</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>            }</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>        }</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>        ih-&gt;log_uri = <a class="code hl_variable" href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">log_uri</a>;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>        ih-&gt;req_sz = <a class="code hl_variable" href="classClientHttpRequest.html#a88642d6f6a181e20927a9e54cabf3c91">req_sz</a>;</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    }</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <span class="keywordflow">if</span> (!g) {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85,3, <span class="stringliteral">&quot;no adaptation needed&quot;</span>);</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>        <a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    }</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>    <a class="code hl_function" href="classClientHttpRequest.html#af85263c90594b13b5e367a6dca152c2d">startAdaptation</a>(g);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>}</div>
</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span> </div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00724" data-start="{" data-end="}">
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a28ea36632dc8aa2f6dfd2f254bc6cc2f">  724</a></span><a class="code hl_function" href="client__side__request_8cc.html#a28ea36632dc8aa2f6dfd2f254bc6cc2f">clientRedirectAccessCheckDone</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> answer, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>{</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *context = (<a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *)data;</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> *http = context-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>;</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    <span class="keywordflow">if</span> (answer.<a class="code hl_function" href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">allowed</a>())</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>        <a class="code hl_function" href="redirect_8cc.html#ac9db978c5757b982596418dd15cb6ba9">redirectStart</a>(http, <a class="code hl_variable" href="client__side__request_8cc.html#a998efc2ba7574e34f7266f22bdb6b5ea">clientRedirectDoneWrapper</a>, context);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        <a class="code hl_class" href="classHelper_1_1Reply.html">Helper::Reply</a> <span class="keyword">const</span> nilReply(<a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a986818311528872aa99b8b360922c0fb">Helper::Error</a>);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        context-&gt;<a class="code hl_function" href="classClientRequestContext.html#a313d206ae3ee4bd6a0d4d347b5ca6ad7">clientRedirectDone</a>(nilReply);</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    }</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>}</div>
</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span> </div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00738" data-start="{" data-end="}">
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a44f5f9d8c0e99a76e6bec35478d473b0">  738</a></span><a class="code hl_function" href="classClientRequestContext.html#a44f5f9d8c0e99a76e6bec35478d473b0">ClientRequestContext::clientRedirectStart</a>()</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>{</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 5, <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_function" href="classAccessLogEntry.html#a551791241b593874d721ffdf04f6b4ed">syncNotes</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a30a3d4912be2414f5f5075fc696d7c6d">redirector</a>) {</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>        <span class="keyword">auto</span> acl_checklist = <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a30a3d4912be2414f5f5075fc696d7c6d">redirector</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(acl_checklist), <a class="code hl_function" href="client__side__request_8cc.html#a28ea36632dc8aa2f6dfd2f254bc6cc2f">clientRedirectAccessCheckDone</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        <a class="code hl_function" href="redirect_8cc.html#ac9db978c5757b982596418dd15cb6ba9">redirectStart</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>, <a class="code hl_variable" href="client__side__request_8cc.html#a998efc2ba7574e34f7266f22bdb6b5ea">clientRedirectDoneWrapper</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>}</div>
</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span> </div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00754" data-start="{" data-end="}">
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a8d7a17ceeb383ec58b528870cbc69d16">  754</a></span><a class="code hl_function" href="client__side__request_8cc.html#a8d7a17ceeb383ec58b528870cbc69d16">clientStoreIdAccessCheckDone</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> answer, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>{</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *context = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> *http = context-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span> </div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>    <span class="keywordflow">if</span> (answer.<a class="code hl_function" href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">allowed</a>())</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>        <a class="code hl_function" href="redirect_8cc.html#a7d5d0e17dcebbd0fc8ca8d1cf11f4a95">storeIdStart</a>(http, <a class="code hl_variable" href="client__side__request_8cc.html#a80f5c9d940e83a142afa6e7591f27f52">clientStoreIdDoneWrapper</a>, context);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;access denied expected ERR reply handling: &quot;</span> &lt;&lt; answer);</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>        <a class="code hl_class" href="classHelper_1_1Reply.html">Helper::Reply</a> <span class="keyword">const</span> nilReply(<a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a986818311528872aa99b8b360922c0fb">Helper::Error</a>);</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>        context-&gt;<a class="code hl_function" href="classClientRequestContext.html#a2f1d001cc37e78d4530357a13dfbfe41">clientStoreIdDone</a>(nilReply);</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    }</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>}</div>
</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00774" data-start="{" data-end="}">
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#af64a43978912fa5d3fa189faaec50970">  774</a></span><a class="code hl_function" href="classClientRequestContext.html#af64a43978912fa5d3fa189faaec50970">ClientRequestContext::clientStoreIdStart</a>()</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>{</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 5,<span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a200f7109251db7e9719d331381aa8b2c">store_id</a>) {</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>        <span class="keyword">auto</span> acl_checklist = <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#a200f7109251db7e9719d331381aa8b2c">store_id</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>        <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(acl_checklist), <a class="code hl_function" href="client__side__request_8cc.html#a8d7a17ceeb383ec58b528870cbc69d16">clientStoreIdAccessCheckDone</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>        <a class="code hl_function" href="redirect_8cc.html#a7d5d0e17dcebbd0fc8ca8d1cf11f4a95">storeIdStart</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>, <a class="code hl_variable" href="client__side__request_8cc.html#a80f5c9d940e83a142afa6e7591f27f52">clientStoreIdDoneWrapper</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>}</div>
</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> </div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="foldopen" id="foldopen00786" data-start="{" data-end="}">
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a735a532956f51fa77e73d03064f13424">  786</a></span><a class="code hl_function" href="client__side__request_8cc.html#a735a532956f51fa77e73d03064f13424">clientHierarchical</a>(<a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> * http)</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>{</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = http-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>    <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a> method = request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span> </div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    <span class="comment">// intercepted requests MUST NOT (yet) be sent to peers unless verified</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a70ad8dd58ad2ad4d515f11c74c085472">hostVerified</a> &amp;&amp; (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a7feb14e42e2a35fb38fb744e98b8af7b">intercepted</a> || request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a067afb76219d72cd969eba5e44c6a9ea">interceptTproxy</a>))</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span> </div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span><span class="comment">     * IMS needs a private key, so we can use the hierarchy for IMS only if our</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span><span class="comment">     * neighbors support private keys</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span><span class="comment">     */</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span> </div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a12193c977b3da18c04e6e4b350e860ba">ims</a> &amp;&amp; !<a class="code hl_variable" href="globals_8h.html#a861395382bde6d6cab9fb54fade35809">neighbors_do_private_keys</a>)</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span> </div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span><span class="comment">     * This is incorrect: authenticating requests can be sent via a hierarchy</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span><span class="comment">     * (they can even be cached if the correct headers are set on the reply)</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span><span class="comment">     */</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#abccdcdee48ee6281933ecff24d265b0e">auth</a>)</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span> </div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>    <span class="keywordflow">if</span> (method == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a048d612501964b8d3f0d41ede55395f3">Http::METHOD_TRACE</a>)</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span> </div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>    <span class="keywordflow">if</span> (method != <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a>)</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span> </div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">loopDetected</a>)</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">getScheme</a>() == <a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d">AnyP::PROTO_HTTP</a>)</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>        <span class="keywordflow">return</span> method.<a class="code hl_function" href="classHttpRequestMethod.html#a9c903186b972ba0f9d703ae150596eda">respMaybeCacheable</a>();</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>}</div>
</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00826" data-start="{" data-end="}">
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a6fab94b46ff30d5e7f3164db7b456870">  826</a></span><a class="code hl_function" href="client__side__request_8cc.html#a6fab94b46ff30d5e7f3164db7b456870">clientCheckPinning</a>(<a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> * http)</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>{</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = http-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    <a class="code hl_class" href="classHttpHeader.html">HttpHeader</a> *req_hdr = &amp;request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    <a class="code hl_class" href="classConnStateData.html">ConnStateData</a> *http_conn = http-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>();</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span> </div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>    <span class="comment">// Internal requests may be without a client connection</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>    <span class="keywordflow">if</span> (!http_conn)</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span> </div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ad71e99859e4130efc5ef12af8aaefe98">connectionAuthDisabled</a> = http_conn-&gt;<a class="code hl_variable" href="classConnStateData.html#ae06c387dd773449597078259a953013b">port</a>-&gt;connection_auth_disabled;</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ad71e99859e4130efc5ef12af8aaefe98">connectionAuthDisabled</a>) {</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(http_conn-&gt;<a class="code hl_variable" href="classConnStateData.html#a0a6bcd9010a0dfdd48910ec1972c6d6e">pinning</a>.<a class="code hl_variable" href="classConnStateData.html#a287046cdc188f80b47e3b54c7b3a2178">serverConnection</a>)) {</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>            <span class="keywordflow">if</span> (http_conn-&gt;<a class="code hl_variable" href="classConnStateData.html#a0a6bcd9010a0dfdd48910ec1972c6d6e">pinning</a>.<a class="code hl_variable" href="classConnStateData.html#a0c235db1c5743aaba238b4f4584ec12d">auth</a>) {</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>                request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1cb8c962b36f5ebd3f897fede719dd43">connectionAuth</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>                request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#abccdcdee48ee6281933ecff24d265b0e">auth</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>                request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a58d2a443729b565caed5fa174a975fbc">connectionProxyAuth</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>            }</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>            <span class="comment">// These should already be linked correctly.</span></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>            <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a13f1a21e71a902ac14ab9b4ee8133276">clientConnectionManager</a> == http_conn);</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>        }</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    }</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span> </div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>    <span class="comment">/* check if connection auth is used, and flag as candidate for pinning</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span><span class="comment">     * in such case.</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span><span class="comment">     * Note: we may need to set flags.connectionAuth even if the connection</span></div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span><span class="comment">     * is already pinned if it was pinned earlier due to proxy auth</span></div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span><span class="comment">     */</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1cb8c962b36f5ebd3f897fede719dd43">connectionAuth</a>) {</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>        <span class="keywordflow">if</span> (req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a4095e0e8a4ed5b5639c6c51330d062a0">Http::HdrType::AUTHORIZATION</a>) || req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a5cbe8a0c0649160f4bcceed89927afb6">Http::HdrType::PROXY_AUTHORIZATION</a>)) {</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>            <a class="code hl_typedef" href="HttpHeader_8h.html#aac9fc01c2b9cda8c02b1f7f8a2a9c78b">HttpHeaderPos</a> pos = <a class="code hl_define" href="HttpHeader_8h.html#abf5d862281ddf9a5315fcfa5be166c07">HttpHeaderInitPos</a>;</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>            <a class="code hl_class" href="classHttpHeaderEntry.html">HttpHeaderEntry</a> *e;</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>            <span class="keywordtype">int</span> may_pin = 0;</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>            <span class="keywordflow">while</span> ((e = req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a81cb2fc85a9629783ba1e607de0f41ed">getEntry</a>(&amp;pos))) {</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>                <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="classHttpHeaderEntry.html#ad4de5645a10ac4022a3667753b7904a8">id</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a4095e0e8a4ed5b5639c6c51330d062a0">Http::HdrType::AUTHORIZATION</a> || e-&gt;<a class="code hl_variable" href="classHttpHeaderEntry.html#ad4de5645a10ac4022a3667753b7904a8">id</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a5cbe8a0c0649160f4bcceed89927afb6">Http::HdrType::PROXY_AUTHORIZATION</a>) {</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>                    <span class="keyword">const</span> <span class="keywordtype">char</span> *value = e-&gt;<a class="code hl_variable" href="classHttpHeaderEntry.html#af1721f40aef39eef4476a19f806aedaa">value</a>.<a class="code hl_function" href="classString.html#a77a7c8c6845f33722735772524b8034d">rawBuf</a>();</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>                    <span class="keywordflow">if</span> (strncasecmp(value, <span class="stringliteral">&quot;NTLM &quot;</span>, 5) == 0</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>                            ||</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>                            strncasecmp(value, <span class="stringliteral">&quot;Negotiate &quot;</span>, 10) == 0</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>                            ||</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>                            strncasecmp(value, <span class="stringliteral">&quot;Kerberos &quot;</span>, 9) == 0) {</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>                        <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="classHttpHeaderEntry.html#ad4de5645a10ac4022a3667753b7904a8">id</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a4095e0e8a4ed5b5639c6c51330d062a0">Http::HdrType::AUTHORIZATION</a>) {</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>                            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1cb8c962b36f5ebd3f897fede719dd43">connectionAuth</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>                            may_pin = 1;</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>                            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a58d2a443729b565caed5fa174a975fbc">connectionProxyAuth</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>                            may_pin = 1;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>                        }</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>                    }</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>                }</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>            }</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>            <span class="keywordflow">if</span> (may_pin &amp;&amp; !request-&gt;<a class="code hl_function" href="classHttpRequest.html#a98624db05b1d0e020b1178042857038b">pinnedConnection</a>()) {</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>                <span class="comment">// These should already be linked correctly. Just need the ServerConnection to pinn.</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>                <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a13f1a21e71a902ac14ab9b4ee8133276">clientConnectionManager</a> == http_conn);</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>            }</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>        }</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>    }</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>}</div>
</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span> </div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00887" data-start="{" data-end="}">
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a22bce20949eaf9c5562098a53cb6fee0">  887</a></span><a class="code hl_function" href="client__side__request_8cc.html#a22bce20949eaf9c5562098a53cb6fee0">clientInterpretRequestHeaders</a>(<a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> * http)</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>{</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *request = http-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>    <a class="code hl_class" href="classHttpHeader.html">HttpHeader</a> *req_hdr = &amp;request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">header</a>;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>    <span class="keywordtype">bool</span> no_cache = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span> </div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a6617b5b1e4c90874af16ac68e0f8673c">imslen</a> = -1;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>    request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5f8f335cf16fa13580238d91973bc566">ims</a> = req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ab5451998313dbafbc7f8c0b6d5aadbc7">getTime</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4ab72dfe4a5620a1e4d7b096afe4aca653">Http::HdrType::IF_MODIFIED_SINCE</a>);</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span> </div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a5f8f335cf16fa13580238d91973bc566">ims</a> &gt; 0)</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a12193c977b3da18c04e6e4b350e860ba">ims</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#acf71a0fdc5234b31ec50cc2d53142377">ignoreCc</a>) {</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>        <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#adecda0b631f46c076e91fb61d429a865">cache_control</a>) {</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>            <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#adecda0b631f46c076e91fb61d429a865">cache_control</a>-&gt;<a class="code hl_function" href="classHttpHdrCc.html#a1f64d7d9ca1f2fee35e7bf490e05fe88">hasNoCache</a>())</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>                no_cache=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span> </div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>            <span class="comment">// RFC 2616: treat Pragma:no-cache as if it was Cache-Control:no-cache when Cache-Control is missing</span></div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4af68e3494f1d9555cc09a10784bc2d89e">Http::HdrType::PRAGMA</a>))</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>            no_cache = req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#af87838abd8fbd3fa454ccf7abf16ebed">hasListMember</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4af68e3494f1d9555cc09a10784bc2d89e">Http::HdrType::PRAGMA</a>,<span class="stringliteral">&quot;no-cache&quot;</span>,<span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    }</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span> </div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a1fa639d2eb3bfb92c2b42d4703450ba9">Http::METHOD_OTHER</a>) {</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>        no_cache=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    }</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    <span class="keywordflow">if</span> (no_cache) {</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span><span class="preprocessor">#if USE_HTTP_VIOLATIONS</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span> </div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#a4b49febd900d168bbb6f89af1a331b33">reload_into_ims</a>)</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a900c1d5ec957547f3f15a76d5b4ca854">nocacheHack</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="globals_8h.html#a0eb6526f36d953cd406ec15754b5f4af">refresh_nocache_hack</a>)</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a900c1d5ec957547f3f15a76d5b4ca854">nocacheHack</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span> </div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a452db2a617d946222557c73d97888918">noCache</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>    }</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span> </div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>    <span class="comment">/* ignore range header in non-GETs or non-HEADs */</span></div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a> || request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a>) {</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>        <span class="comment">// XXX: initialize if we got here without HttpRequest::parseHeader()</span></div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>        <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a>)</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a> = req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#ab8ed2262022bb3925ce93f20ee0073d9">getRange</a>();</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span> </div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>        <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a>) {</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1e4c34b9be432a556d28cd9da295eb41">isRanged</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>            <a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *<a class="code hl_struct" href="structnode.html">node</a> = (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)http-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">tail</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            <span class="comment">/* XXX: This is suboptimal. We should give the stream the range set,</span></div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span><span class="comment">             * and thereby let the top of the stream set the offset when the</span></div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span><span class="comment">             * size becomes known. As it is, we will end up requesting from 0</span></div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span><span class="comment">             * for every -X range specification.</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span><span class="comment">             * RBC - this may be somewhat wrong. We should probably set the range</span></div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span><span class="comment">             * iter up at this point.</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span><span class="comment">             */</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>            <a class="code hl_struct" href="structnode.html">node</a>-&gt;readBuffer.offset = request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a>-&gt;<a class="code hl_function" href="classHttpHdrRange.html#abc61bead0e22fc2e41630498593b27e1">lowestOffset</a>(0);</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>        }</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    }</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span> </div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    <span class="comment">/* Only HEAD and GET requests permit a Range or Request-Range header.</span></div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span><span class="comment">     * If these headers appear on any other type of request, delete them now.</span></div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span><span class="comment">     */</span></div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>        req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a870efb6e1f983cee349ae492ff7a7da3">Http::HdrType::RANGE</a>);</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>        req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">delById</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a3a0ece368a9661b52a9b5942f46fc24e">Http::HdrType::REQUEST_RANGE</a>);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        request-&gt;<a class="code hl_function" href="classHttpRequest.html#a9d63ea3655ec440fedf74c3eb2ea99e9">ignoreRange</a>(<span class="stringliteral">&quot;neither HEAD nor GET&quot;</span>);</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>    }</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span> </div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    <span class="keywordflow">if</span> (req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a4095e0e8a4ed5b5639c6c51330d062a0">Http::HdrType::AUTHORIZATION</a>))</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#abccdcdee48ee6281933ecff24d265b0e">auth</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>    <a class="code hl_function" href="client__side__request_8cc.html#a6fab94b46ff30d5e7f3164db7b456870">clientCheckPinning</a>(http);</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span> </div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>    <span class="keywordflow">if</span> (!request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aff2c3402a1b8f1ebc50bc6a3e5933708">userInfo</a>().isEmpty())</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#abccdcdee48ee6281933ecff24d265b0e">auth</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    <span class="keywordflow">if</span> (req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4abf700acafa97eb2e7ebf04496aa2b4fa">Http::HdrType::VIA</a>)) {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>        <a class="code hl_class" href="classString.html">String</a> s = req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a5bd52e3f8d517f7c1c919aa4a82f4e29">getList</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4abf700acafa97eb2e7ebf04496aa2b4fa">Http::HdrType::VIA</a>);</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span><span class="comment">         * ThisCache cannot be a member of Via header, &quot;1.1 ThisCache&quot; can.</span></div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span><span class="comment">         * Note ThisCache2 has a space prepended to the hostname so we don&#39;t</span></div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span><span class="comment">         * accidentally match super-domains.</span></div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span><span class="comment">         */</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span> </div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="StrList_8cc.html#aca60d260ede4dbe28a1454b943ff9633">strListIsSubstr</a>(&amp;s, <a class="code hl_variable" href="globals_8h.html#a14324d58b24c52ebef1fad97e595249d">ThisCache2</a>, <span class="charliteral">&#39;,&#39;</span>)) {</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">loopDetected</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>        }</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span> </div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span><span class="preprocessor">#if USE_FORW_VIA_DB</span></div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>        <a class="code hl_function" href="access__log_8h.html#a40b99f30ccbf64b3415228c7226beaee">fvdbCountVia</a>(<a class="code hl_function" href="StringConvert_8h.html#abe3faac648d76d22de22d375e730a00a">StringToSBuf</a>(s));</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span> </div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span> </div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>        s.<a class="code hl_function" href="classString.html#a60a0fdff84d3470d812b2adbcb2cbf38">clean</a>();</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>    }</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> </div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>    <span class="comment">// headers only relevant to reverse-proxy</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a0e7db730c27abb7eac3b676961773797">accelerated</a>) {</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>        <span class="comment">// check for a cdn-info member with a cdn-id matching surrogate_id</span></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>        <span class="comment">// XXX: HttpHeader::hasListMember() does not handle OWS around &quot;;&quot; yet</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>        <span class="keywordflow">if</span> (req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#af87838abd8fbd3fa454ccf7abf16ebed">hasListMember</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4ae3cc2208ffc4bf683859c9418631b762">Http::HdrType::CDN_LOOP</a>, <a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#acf3a5393cee89bdde86ce50e0d15bbbd">Accel</a>.<a class="code hl_variable" href="classSquidConfig.html#a7f8f0c2909a291f930e687d36f10106e">surrogate_id</a>, <span class="charliteral">&#39;,&#39;</span>))</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>            request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">loopDetected</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    }</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span> </div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    <span class="keywordflow">if</span> (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">loopDetected</a>) {</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>        <a class="code hl_function" href="tools_8cc.html#aa3f5a1d3a4bc67144cc318637612ddf1">debugObj</a>(33, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;WARNING: Forwarding loop detected for:\n&quot;</span>,</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>                 request, (<a class="code hl_typedef" href="tools_8h.html#adfbde7d952e179f88f0768705a009c4b">ObjPackMethod</a>) &amp; <a class="code hl_function" href="HttpRequest_8cc.html#a9c833fc483befd50385f75ec1b4eceba">httpRequestPack</a>);</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    }</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span> </div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span><span class="preprocessor">#if USE_FORW_VIA_DB</span></div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span> </div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>    <span class="keywordflow">if</span> (req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">has</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a51d3bc271c12fd9b48b247fa1d1f8de0">Http::HdrType::X_FORWARDED_FOR</a>)) {</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>        <a class="code hl_class" href="classString.html">String</a> s = req_hdr-&gt;<a class="code hl_function" href="classHttpHeader.html#a5bd52e3f8d517f7c1c919aa4a82f4e29">getList</a>(<a class="code hl_enumvalue" href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a51d3bc271c12fd9b48b247fa1d1f8de0">Http::HdrType::X_FORWARDED_FOR</a>);</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>        <a class="code hl_function" href="access__log_8h.html#a87d8c9354d8a3f2eb8c018518fc68f1f">fvdbCountForwarded</a>(<a class="code hl_function" href="StringConvert_8h.html#abe3faac648d76d22de22d375e730a00a">StringToSBuf</a>(s));</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>        s.<a class="code hl_function" href="classString.html#a60a0fdff84d3470d812b2adbcb2cbf38">clean</a>();</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>    }</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span> </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span> </div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>    <span class="keywordflow">if</span> (http-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#aad089156bdf4c54795c19ad20d332f4a">maybeCacheable</a>())</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af33cb0e80d9996c532479ef942d1eb91">cachable</a>.<a class="code hl_function" href="classSupportOrVeto.html#a89cd12f04613edb8f17087b2ae1e2a3a">support</a>();</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af33cb0e80d9996c532479ef942d1eb91">cachable</a>.<a class="code hl_function" href="classSupportOrVeto.html#aa34618d1c0303ab67ec91663d046faea">veto</a>();</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span> </div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="client__side__request_8cc.html#a735a532956f51fa77e73d03064f13424">clientHierarchical</a>(http))</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>        request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af8a2c52a07a38ceb366a512eab1d854b">hierarchical</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span> </div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;clientInterpretRequestHeaders: REQ_NOCACHE = &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>           (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a452db2a617d946222557c73d97888918">noCache</a> ? <span class="stringliteral">&quot;SET&quot;</span> : <span class="stringliteral">&quot;NOT SET&quot;</span>));</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;clientInterpretRequestHeaders: REQ_CACHABLE = &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>           (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af33cb0e80d9996c532479ef942d1eb91">cachable</a> ? <span class="stringliteral">&quot;SET&quot;</span> : <span class="stringliteral">&quot;NOT SET&quot;</span>));</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;clientInterpretRequestHeaders: REQ_HIERARCHICAL = &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>           (request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af8a2c52a07a38ceb366a512eab1d854b">hierarchical</a> ? <span class="stringliteral">&quot;SET&quot;</span> : <span class="stringliteral">&quot;NOT SET&quot;</span>));</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span> </div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>}</div>
</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span> </div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01024" data-start="{" data-end="}">
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a9bf687eb74cd9c2a247652869b15f3d2"> 1024</a></span><a class="code hl_variable" href="client__side__request_8cc.html#a998efc2ba7574e34f7266f22bdb6b5ea">clientRedirectDoneWrapper</a>(<span class="keywordtype">void</span> *data, <span class="keyword">const</span> <a class="code hl_class" href="classHelper_1_1Reply.html">Helper::Reply</a> &amp;result)</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>{</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *calloutContext = (<a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *)data;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span> </div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>    <span class="keywordflow">if</span> (!calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">httpStateIsValid</a>())</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span> </div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a313d206ae3ee4bd6a0d4d347b5ca6ad7">clientRedirectDone</a>(result);</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>}</div>
</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span> </div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01035" data-start="{" data-end="}">
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a179ab72655743ca840abec4f652c2c1b"> 1035</a></span><a class="code hl_variable" href="client__side__request_8cc.html#a80f5c9d940e83a142afa6e7591f27f52">clientStoreIdDoneWrapper</a>(<span class="keywordtype">void</span> *data, <span class="keyword">const</span> <a class="code hl_class" href="classHelper_1_1Reply.html">Helper::Reply</a> &amp;result)</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>{</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *calloutContext = (<a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *)data;</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span> </div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>    <span class="keywordflow">if</span> (!calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">httpStateIsValid</a>())</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span> </div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a2f1d001cc37e78d4530357a13dfbfe41">clientStoreIdDone</a>(result);</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>}</div>
</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span> </div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01046" data-start="{" data-end="}">
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a313d206ae3ee4bd6a0d4d347b5ca6ad7"> 1046</a></span><a class="code hl_function" href="classClientRequestContext.html#a313d206ae3ee4bd6a0d4d347b5ca6ad7">ClientRequestContext::clientRedirectDone</a>(<span class="keyword">const</span> <a class="code hl_class" href="classHelper_1_1Reply.html">Helper::Reply</a> &amp;reply)</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>{</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *old_request = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot;&#39; result=&quot;</span> &lt;&lt; reply);</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientRequestContext.html#acb3bd1387cd493ebc0da7e6ceee1743f">redirect_state</a> == <a class="code hl_define" href="defines_8h.html#a35197769b18b837100d0576e84f8a63f">REDIRECT_PENDING</a>);</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>    <a class="code hl_variable" href="classClientRequestContext.html#acb3bd1387cd493ebc0da7e6ceee1743f">redirect_state</a> = <a class="code hl_define" href="defines_8h.html#a30ba86da30acfd14e4a38c95aded3065">REDIRECT_DONE</a>;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span> </div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    <span class="comment">// Put helper response Notes into the transaction state record (ALE) eventually</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>    <span class="comment">// do it early to ensure that no matter what the outcome the notes are present.</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>)</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_function" href="classAccessLogEntry.html#a551791241b593874d721ffdf04f6b4ed">syncNotes</a>(old_request);</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span> </div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>    <a class="code hl_function" href="HttpRequest_8cc.html#a4739298dc79dc234cafa3914208f63ad">UpdateRequestNotes</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), *old_request, reply.<a class="code hl_variable" href="classHelper_1_1Reply.html#a7919dd5e59757b9c0e3e9a3cc3b54156">notes</a>);</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span> </div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>    <span class="keywordflow">switch</span> (reply.<a class="code hl_variable" href="classHelper_1_1Reply.html#a9c644b392f1fea31662c2532c25ebaa4">result</a>) {</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984ae46c05751453143f5b34ea94881ad858">Helper::TimedOut</a>:</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#aa5cb356a718ae133f8c58f5d43cec405">onUrlRewriteTimeout</a>.<a class="code hl_variable" href="structSquidConfig_1_1UrlHelperTimeout.html#aa7efe6f51b2f99da05607bcaee1feac0">action</a> != <a class="code hl_enumvalue" href="redirect_8h.html#ac64a89dc3c9f926c5f32c791274b5133aed7a9fc0ecd761fd05cfb7a5329dbf3f">toutActBypass</a>) {</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>            <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> d = <a class="code hl_function" href="Detail_8cc.html#a3daf1a4d3c9feca00e60712558a94558">MakeNamedErrorDetail</a>(<span class="stringliteral">&quot;REDIRECTOR_TIMEDOUT&quot;</span>);</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>            <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a476c10011cb11adbff01ab61a23bc059">calloutsError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa484c5a83c6dddc445cad0243e75d88e1">ERR_GATEWAY_FAILURE</a>, d);</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: URL rewrite helper: Timedout&quot;</span>);</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>        }</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span> </div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a4d7334de216e58ff6aa5163293149757">Helper::Unknown</a>:</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984abb8efc132f13782d623b85c84e887abd">Helper::TT</a>:</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>        <span class="comment">// Handler in redirect.cc should have already mapped Unknown</span></div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>        <span class="comment">// IF it contained valid entry for the old URL-rewrite helper protocol</span></div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: URL rewrite helper returned invalid result code. Wrong helper? &quot;</span> &lt;&lt; reply);</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span> </div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a69cdbb4d469ada5a0f13681d9ab8940e">Helper::BrokenHelper</a>:</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: URL rewrite helper: &quot;</span> &lt;&lt; reply);</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span> </div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a986818311528872aa99b8b360922c0fb">Helper::Error</a>:</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>        <span class="comment">// no change to be done.</span></div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span> </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984af5ab78a4aaa17e6dbcf76c28a2f6d198">Helper::Okay</a>: {</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>        <span class="comment">// #1: redirect with a specific status code    OK status=NNN url=&quot;...&quot;</span></div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>        <span class="comment">// #2: redirect with a default status code     OK url=&quot;...&quot;</span></div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>        <span class="comment">// #3: re-write the URL                        OK rewrite-url=&quot;...&quot;</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span> </div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *statusNote = reply.<a class="code hl_variable" href="classHelper_1_1Reply.html#a7919dd5e59757b9c0e3e9a3cc3b54156">notes</a>.<a class="code hl_function" href="classNotePairs.html#a8fd18fa94362de739d33ec0259bc4505">findFirst</a>(<span class="stringliteral">&quot;status&quot;</span>);</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *urlNote = reply.<a class="code hl_variable" href="classHelper_1_1Reply.html#a7919dd5e59757b9c0e3e9a3cc3b54156">notes</a>.<a class="code hl_function" href="classNotePairs.html#a8fd18fa94362de739d33ec0259bc4505">findFirst</a>(<span class="stringliteral">&quot;url&quot;</span>);</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span> </div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>        <span class="keywordflow">if</span> (urlNote != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>            <span class="comment">// HTTP protocol redirect to be done.</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span> </div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>            <span class="comment">// TODO: change default redirect status for appropriate requests</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>            <span class="comment">// Squid defaults to 302 status for now for better compatibility with old clients.</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>            <span class="comment">// HTTP/1.0 client should get 302 (Http::scFound)</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>            <span class="comment">// HTTP/1.1 client contacting reverse-proxy should get 307 (Http::scTemporaryRedirect)</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>            <span class="comment">// HTTP/1.1 client being diverted by forward-proxy should get 303 (Http::scSeeOther)</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>            <a class="code hl_enumeration" href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a> status = <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a66a8af2fba9c318bac7a183c39c05c7c">Http::scFound</a>;</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>            <span class="keywordflow">if</span> (statusNote != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>                <span class="keyword">const</span> <span class="keywordtype">char</span> * result = statusNote;</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>                status = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a><span class="keyword">&gt;</span>(atoi(result));</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>            }</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span> </div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>            <span class="keywordflow">if</span> (status == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722ace80322983d749adccb645d37e5972bd">Http::scMovedPermanently</a></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>                    || status == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a66a8af2fba9c318bac7a183c39c05c7c">Http::scFound</a></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>                    || status == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a9c26c2970d7403177ef4d25ca149aedb">Http::scSeeOther</a></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>                    || status == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a985ea76ef28026e5fd8850cda608e6b0">Http::scPermanentRedirect</a></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>                    || status == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722ab481404a40aad5708b07ceb1ec5e27d3">Http::scTemporaryRedirect</a>) {</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>                <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">redirect</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Redirect.html#a51a61e18a57f2018c331c346b4a75816">status</a> = status;</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>                <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">redirect</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Redirect.html#a98ac56cf94b890c981797389fba6b520">location</a> = <a class="code hl_define" href="negotiate__wrapper_8cc.html#a5eb055ca3b42205cc134b4a438cd9a72">xstrdup</a>(urlNote);</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>                <span class="comment">// TODO: validate the URL produced here is RFC 2616 compliant absolute URI</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: URL-rewrite produces invalid &quot;</span> &lt;&lt; status &lt;&lt; <span class="stringliteral">&quot; redirect Location: &quot;</span> &lt;&lt; urlNote);</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>            }</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>            <span class="comment">// URL-rewrite wanted. Ew.</span></div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>            urlNote = reply.<a class="code hl_variable" href="classHelper_1_1Reply.html#a7919dd5e59757b9c0e3e9a3cc3b54156">notes</a>.<a class="code hl_function" href="classNotePairs.html#a8fd18fa94362de739d33ec0259bc4505">findFirst</a>(<span class="stringliteral">&quot;rewrite-url&quot;</span>);</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span> </div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>            <span class="comment">// prevent broken helpers causing too much damage. If old URL == new URL skip the re-write.</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>            <span class="keywordflow">if</span> (urlNote != <span class="keyword">nullptr</span> &amp;&amp; strcmp(urlNote, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>)) {</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>                <a class="code hl_class" href="classAnyP_1_1Uri.html">AnyP::Uri</a> tmpUrl;</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>                <span class="keywordflow">if</span> (tmpUrl.<a class="code hl_function" href="classAnyP_1_1Uri.html#abc68f14b9b29923b2864b862eea8ea64">parse</a>(old_request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>, <a class="code hl_class" href="classSBuf.html">SBuf</a>(urlNote))) {</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>                    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *new_request = old_request-&gt;<a class="code hl_function" href="classHttpRequest.html#a22edb4b67bb2f310d3396c623b636343">clone</a>();</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>                    new_request-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a> = tmpUrl;</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>                    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(61, 2, <span class="stringliteral">&quot;URL-rewriter diverts URL from &quot;</span> &lt;&lt; old_request-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>() &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; new_request-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>());</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span> </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>                    <span class="comment">// unlink bodypipe from the old request. Not needed there any longer.</span></div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>                    <span class="keywordflow">if</span> (old_request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#ad9f13ecd98f1ef921791a25163226f39">body_pipe</a> != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>                        old_request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#ad9f13ecd98f1ef921791a25163226f39">body_pipe</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>                        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(61,2, <span class="stringliteral">&quot;URL-rewriter diverts body_pipe &quot;</span> &lt;&lt; new_request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#ad9f13ecd98f1ef921791a25163226f39">body_pipe</a> &lt;&lt;</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>                               <span class="stringliteral">&quot; from request &quot;</span> &lt;&lt; old_request &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; new_request);</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>                    }</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span> </div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>                    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ac5ce3f99e959e0e6da56d7daf5b9fb53">resetRequestXXX</a>(new_request, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>                    old_request = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>                    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a>, <span class="stringliteral">&quot;ERROR: URL-rewrite produces invalid request: &quot;</span> &lt;&lt;</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>                           old_request-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; urlNote &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; old_request-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#afcb0c1d278e61a1379032790c427788d">http_ver</a>);</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>                }</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>            }</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>        }</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>    }</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>    }</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span> </div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>    <span class="comment">/* XXX PIPELINE: This is inaccurate during pipelining */</span></div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span> </div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>))</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>        <a class="code hl_function" href="fd_8cc.html#a397dc4e5e5cf728d8f1a48b32cb4e60d">fd_note</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>-&gt;<a class="code hl_variable" href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">fd</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span> </div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span> </div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>}</div>
</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span> </div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01162" data-start="{" data-end="}">
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a2f1d001cc37e78d4530357a13dfbfe41"> 1162</a></span><a class="code hl_function" href="classClientRequestContext.html#a2f1d001cc37e78d4530357a13dfbfe41">ClientRequestContext::clientStoreIdDone</a>(<span class="keyword">const</span> <a class="code hl_class" href="classHelper_1_1Reply.html">Helper::Reply</a> &amp;reply)</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>{</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *old_request = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot;&#39; result=&quot;</span> &lt;&lt; reply);</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientRequestContext.html#afe53d111b9377770e03f382fcf15f711">store_id_state</a> == <a class="code hl_define" href="defines_8h.html#a35197769b18b837100d0576e84f8a63f">REDIRECT_PENDING</a>);</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>    <a class="code hl_variable" href="classClientRequestContext.html#afe53d111b9377770e03f382fcf15f711">store_id_state</a> = <a class="code hl_define" href="defines_8h.html#a30ba86da30acfd14e4a38c95aded3065">REDIRECT_DONE</a>;</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span> </div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    <span class="comment">// Put helper response Notes into the transaction state record (ALE) eventually</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>    <span class="comment">// do it early to ensure that no matter what the outcome the notes are present.</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>)</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_function" href="classAccessLogEntry.html#a551791241b593874d721ffdf04f6b4ed">syncNotes</a>(old_request);</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span> </div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>    <a class="code hl_function" href="HttpRequest_8cc.html#a4739298dc79dc234cafa3914208f63ad">UpdateRequestNotes</a>(<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>(), *old_request, reply.<a class="code hl_variable" href="classHelper_1_1Reply.html#a7919dd5e59757b9c0e3e9a3cc3b54156">notes</a>);</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span> </div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    <span class="keywordflow">switch</span> (reply.<a class="code hl_variable" href="classHelper_1_1Reply.html#a9c644b392f1fea31662c2532c25ebaa4">result</a>) {</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a4d7334de216e58ff6aa5163293149757">Helper::Unknown</a>:</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984abb8efc132f13782d623b85c84e887abd">Helper::TT</a>:</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>        <span class="comment">// Handler in redirect.cc should have already mapped Unknown</span></div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>        <span class="comment">// IF it contained valid entry for the old helper protocol</span></div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: storeID helper returned invalid result code. Wrong helper? &quot;</span> &lt;&lt; reply);</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span> </div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984ae46c05751453143f5b34ea94881ad858">Helper::TimedOut</a>:</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>    <span class="comment">// Timeouts for storeID are not implemented</span></div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a69cdbb4d469ada5a0f13681d9ab8940e">Helper::BrokenHelper</a>:</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ERROR: storeID helper: &quot;</span> &lt;&lt; reply);</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span> </div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a986818311528872aa99b8b360922c0fb">Helper::Error</a>:</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>        <span class="comment">// no change to be done.</span></div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span> </div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984af5ab78a4aaa17e6dbcf76c28a2f6d198">Helper::Okay</a>: {</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *urlNote = reply.<a class="code hl_variable" href="classHelper_1_1Reply.html#a7919dd5e59757b9c0e3e9a3cc3b54156">notes</a>.<a class="code hl_function" href="classNotePairs.html#a8fd18fa94362de739d33ec0259bc4505">findFirst</a>(<span class="stringliteral">&quot;store-id&quot;</span>);</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span> </div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>        <span class="comment">// prevent broken helpers causing too much damage. If old URL == new URL skip the re-write.</span></div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>        <span class="keywordflow">if</span> (urlNote != <span class="keyword">nullptr</span> &amp;&amp; strcmp(urlNote, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>) ) {</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>            <span class="comment">// Debug section required for some very specific cases.</span></div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 9, <span class="stringliteral">&quot;Setting storeID with: &quot;</span> &lt;&lt; urlNote );</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>            <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a760997c2728fee37daff20549eab2d74">store_id</a> = urlNote;</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>            <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a77f852cb942a8f0372648b7209853927">store_id</a> = urlNote;</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>        }</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>    }</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>    }</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span> </div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>}</div>
</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span> </div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01213" data-start="{" data-end="}">
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#ab523448fe90265c989bafbf7d88009cd"> 1213</a></span><a class="code hl_function" href="classClientRequestContext.html#ab523448fe90265c989bafbf7d88009cd">ClientRequestContext::checkNoCache</a>()</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>{</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#ad0eb1efb330448abf65a159417f31f8e">noCache</a>) {</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>        <span class="keyword">auto</span> acl_checklist = <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#ad0eb1efb330448abf65a159417f31f8e">noCache</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>        <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(acl_checklist), <a class="code hl_function" href="client__side__request_8cc.html#a4823e00c3c632f760a59b35b624145b5">checkNoCacheDoneWrapper</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>        <span class="comment">/* unless otherwise specified, we try to cache. */</span></div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>        <a class="code hl_function" href="classClientRequestContext.html#afb1f17a80c1d0f55d3c45d93c763500d">checkNoCacheDone</a>(<a class="code hl_enumvalue" href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5aa3d37d87d9b3887abc5466afb368cb8a">ACCESS_ALLOWED</a>);</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>    }</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>}</div>
</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span> </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01225" data-start="{" data-end="}">
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a4823e00c3c632f760a59b35b624145b5"> 1225</a></span><a class="code hl_function" href="client__side__request_8cc.html#a4823e00c3c632f760a59b35b624145b5">checkNoCacheDoneWrapper</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> answer, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>{</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *calloutContext = (<a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *) data;</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span> </div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>    <span class="keywordflow">if</span> (!calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">httpStateIsValid</a>())</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span> </div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>    calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#afb1f17a80c1d0f55d3c45d93c763500d">checkNoCacheDone</a>(answer);</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>}</div>
</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span> </div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01236" data-start="{" data-end="}">
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#afb1f17a80c1d0f55d3c45d93c763500d"> 1236</a></span><a class="code hl_function" href="classClientRequestContext.html#afb1f17a80c1d0f55d3c45d93c763500d">ClientRequestContext::checkNoCacheDone</a>(<span class="keyword">const</span> <a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> &amp;answer)</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>{</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>    <span class="keywordflow">if</span> (answer.<a class="code hl_function" href="classAcl_1_1Answer.html#a4833930fc429062f28b63b96ba17861a">denied</a>()) {</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_function" href="classRequestFlags.html#a7a87d1bd6000a6ce88eae02e6edf9f4c">disableCacheUse</a>(<span class="stringliteral">&quot;a cache deny rule matched&quot;</span>);</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>    }</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>}</div>
</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span> </div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen01246" data-start="{" data-end="}">
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a17a0ac78b84650e7d10ed8b0fed306d7"> 1246</a></span><a class="code hl_function" href="classClientRequestContext.html#a17a0ac78b84650e7d10ed8b0fed306d7">ClientRequestContext::sslBumpAccessCheck</a>()</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>{</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()) {</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#af282ed52728346f9a1549a67e4cc8fb2">ssl</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1SslDetails.html#a950d067714ceddb9129ac1cc7bb6d5ab">bumpMode</a> = <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a06ff25b96e1b9974bda38b9fb3f8bd80">Ssl::bumpEnd</a>; <span class="comment">// SslBump does not apply; log -</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>    }</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span> </div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>    <span class="keyword">const</span> <a class="code hl_enumeration" href="group__ServerProtocolSSLAPI.html#gae6b7865118af149a83cc4569060c1af9">Ssl::BumpMode</a> bumpMode = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classConnStateData.html#abca96f1a2792ad7128762d1dac280cd6">sslBumpMode</a>;</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1ec3ec0b8c3d8f8cd603180e8312885b">forceTunnel</a>) {</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;not needed; already decided to tunnel &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>());</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>        <span class="keywordflow">if</span> (bumpMode != <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a06ff25b96e1b9974bda38b9fb3f8bd80">Ssl::bumpEnd</a>)</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>            <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#af282ed52728346f9a1549a67e4cc8fb2">ssl</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1SslDetails.html#a950d067714ceddb9129ac1cc7bb6d5ab">bumpMode</a> = bumpMode; <span class="comment">// inherited from bumped connection</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>    }</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span> </div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>    <span class="comment">// If SSL connection tunneling or bumping decision has been made, obey it.</span></div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    <span class="keywordflow">if</span> (bumpMode != <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a06ff25b96e1b9974bda38b9fb3f8bd80">Ssl::bumpEnd</a>) {</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;SslBump already decided (&quot;</span> &lt;&lt; bumpMode &lt;&lt;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>               <span class="stringliteral">&quot;), &quot;</span> &lt;&lt; <span class="stringliteral">&quot;ignoring ssl_bump for &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>());</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span> </div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>        <span class="comment">// We need the following &quot;if&quot; for transparently bumped TLS connection,</span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>        <span class="comment">// because in this case we are running ssl_bump access list before</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>        <span class="comment">// the doCallouts runs. It can be removed after the bug #4340 fixed.</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>        <span class="comment">// We do not want to proceed to bumping steps:</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>        <span class="comment">//  - if the TLS connection with the client is already established</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>        <span class="comment">//    because we are accepting normal HTTP requests on TLS port,</span></div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>        <span class="comment">//    or because of the client-first bumping mode</span></div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>        <span class="comment">//  - When the bumping is already started</span></div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a12339fb2c6778b15820c53a9137de210">switchedToHttps</a>() &amp;&amp;</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>                !<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a0452329238b5201c25f125bfd39ebd5f">serverBump</a>())</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>            <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aeaf768b20ad5656ca8d8db3e69776575">sslBumpNeed</a>(bumpMode); <span class="comment">// for processRequest() to bump if needed and not already bumped</span></div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#af282ed52728346f9a1549a67e4cc8fb2">ssl</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1SslDetails.html#a950d067714ceddb9129ac1cc7bb6d5ab">bumpMode</a> = bumpMode; <span class="comment">// inherited from bumped connection</span></div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>    }</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span> </div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    <span class="comment">// If we have not decided yet, decide whether to bump now.</span></div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span> </div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>    <span class="comment">// Bumping here can only start with a CONNECT request on a bumping port</span></div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    <span class="comment">// (bumping of intercepted SSL conns is decided before we get 1st request).</span></div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>    <span class="comment">// We also do not bump redirected CONNECT requests.</span></div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> != <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7">Http::METHOD_CONNECT</a> || <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">redirect</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Redirect.html#a51a61e18a57f2018c331c346b4a75816">status</a> ||</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>            !<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#aa6bcbad5359c0b290dffff6716171c55">ssl_bump</a> ||</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>            !<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classConnStateData.html#ae06c387dd773449597078259a953013b">port</a>-&gt;flags.tunnelSslBumping) {</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#af282ed52728346f9a1549a67e4cc8fb2">ssl</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1SslDetails.html#a950d067714ceddb9129ac1cc7bb6d5ab">bumpMode</a> = <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a06ff25b96e1b9974bda38b9fb3f8bd80">Ssl::bumpEnd</a>; <span class="comment">// SslBump does not apply; log -</span></div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;cannot SslBump this request&quot;</span>);</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>    }</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span> </div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    <span class="comment">// Do not bump during authentication: clients would not proxy-authenticate</span></div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    <span class="comment">// if we delay a 407 response and respond with 200 OK to CONNECT.</span></div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a> &amp;&amp; <a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>-&gt;<a class="code hl_variable" href="classErrorState.html#aeb69480d52455c3be9e80e1a77655308">httpStatus</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722aa140c4f7dc1624466a96d42cc209f155">Http::scProxyAuthenticationRequired</a>) {</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#af282ed52728346f9a1549a67e4cc8fb2">ssl</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1SslDetails.html#a950d067714ceddb9129ac1cc7bb6d5ab">bumpMode</a> = <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a06ff25b96e1b9974bda38b9fb3f8bd80">Ssl::bumpEnd</a>; <span class="comment">// SslBump does not apply; log -</span></div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;no SslBump during proxy authentication&quot;</span>);</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>    }</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span> </div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>) {</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;SslBump applies. Force bump action on error &quot;</span> &lt;&lt; <a class="code hl_function" href="Error_8h.html#a8fc4507124d050ffda9a5e90efbd209a">errorTypeName</a>(<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>-&gt;<a class="code hl_variable" href="classErrorState.html#a44aa54a5e918a6cb3008df0ff7494ded">type</a>));</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aeaf768b20ad5656ca8d8db3e69776575">sslBumpNeed</a>(<a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9ab474c808e5ea2e0c4a475c73bef1d399">Ssl::bumpBump</a>);</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>        <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#af282ed52728346f9a1549a67e4cc8fb2">ssl</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1SslDetails.html#a950d067714ceddb9129ac1cc7bb6d5ab">bumpMode</a> = <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9ab474c808e5ea2e0c4a475c73bef1d399">Ssl::bumpBump</a>;</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>    }</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span> </div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;SslBump possible, checking ACL&quot;</span>);</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> </div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>    <span class="keyword">auto</span> aclChecklist = <a class="code hl_function" href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a>(<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#aa6bcbad5359c0b290dffff6716171c55">ssl_bump</a>, <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    <a class="code hl_function" href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a>(std::move(aclChecklist), <a class="code hl_function" href="client__side__request_8cc.html#a4dfa5d0ca935688bbe22c2385d753b1e">sslBumpAccessCheckDoneWrapper</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>}</div>
</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span> </div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01321" data-start="{" data-end="}">
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#a4dfa5d0ca935688bbe22c2385d753b1e"> 1321</a></span><a class="code hl_function" href="client__side__request_8cc.html#a4dfa5d0ca935688bbe22c2385d753b1e">sslBumpAccessCheckDoneWrapper</a>(<a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> answer, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>{</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>    <a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *calloutContext = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classClientRequestContext.html">ClientRequestContext</a> *<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span> </div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>    <span class="keywordflow">if</span> (!calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">httpStateIsValid</a>())</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>    calloutContext-&gt;<a class="code hl_function" href="classClientRequestContext.html#a40e4e50e91be122ff320b114fa65fc9a">sslBumpAccessCheckDone</a>(answer);</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>}</div>
</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span> </div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01331" data-start="{" data-end="}">
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"><a class="line" href="classClientRequestContext.html#a40e4e50e91be122ff320b114fa65fc9a"> 1331</a></span><a class="code hl_function" href="classClientRequestContext.html#a40e4e50e91be122ff320b114fa65fc9a">ClientRequestContext::sslBumpAccessCheckDone</a>(<span class="keyword">const</span> <a class="code hl_class" href="classAcl_1_1Answer.html">Acl::Answer</a> &amp;answer)</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>{</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">httpStateIsValid</a>())</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span> </div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>    <span class="keyword">const</span> <a class="code hl_enumeration" href="group__ServerProtocolSSLAPI.html#gae6b7865118af149a83cc4569060c1af9">Ssl::BumpMode</a> bumpMode = answer.<a class="code hl_function" href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">allowed</a>() ?</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>                                   <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="group__ServerProtocolSSLAPI.html#gae6b7865118af149a83cc4569060c1af9">Ssl::BumpMode</a><span class="keyword">&gt;</span>(answer.<a class="code hl_variable" href="classAcl_1_1Answer.html#a2c742f67e11b7b92c02b286f91339298">kind</a>) : <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9aaa41037e8896833d425589e945cbb064">Ssl::bumpSplice</a>;</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#aeaf768b20ad5656ca8d8db3e69776575">sslBumpNeed</a>(bumpMode); <span class="comment">// for processRequest() to bump if needed</span></div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#af282ed52728346f9a1549a67e4cc8fb2">ssl</a>.<a class="code hl_variable" href="classAccessLogEntry_1_1SslDetails.html#a950d067714ceddb9129ac1cc7bb6d5ab">bumpMode</a> = bumpMode; <span class="comment">// for logging</span></div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span> </div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>    <span class="keywordflow">if</span> (bumpMode == <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a0048f5b977ec8cb08f3afa8f9554876a">Ssl::bumpTerminate</a>) {</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>        <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">Comm::ConnectionPointer</a> clientConn = <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() ? <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a> : <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(clientConn)) {</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;closing after Ssl::bumpTerminate &quot;</span>);</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>            clientConn-&gt;<a class="code hl_function" href="classComm_1_1Connection.html#a32253e90999f679dc032e19ad50d03ab">close</a>();</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>        }</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>    }</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span> </div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>    <a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>}</div>
</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span> </div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span><span class="comment">/*</span></div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span><span class="comment"> * Identify requests that do not go through the store and client side stream</span></div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span><span class="comment"> * and forward them to the appropriate location. All other requests, request</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span><span class="comment"> * them.</span></div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span><span class="comment"> */</span></div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01360" data-start="{" data-end="}">
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a3ae260da15d4ddba163608ce64145d25"> 1360</a></span><a class="code hl_function" href="classClientHttpRequest.html#a3ae260da15d4ddba163608ce64145d25">ClientHttpRequest::processRequest</a>()</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>{</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 4, <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span> </div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> untouchedConnect = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a> == <a class="code hl_enumvalue" href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7">Http::METHOD_CONNECT</a> &amp;&amp; !<a class="code hl_variable" href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">redirect</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Redirect.html#a51a61e18a57f2018c331c346b4a75816">status</a>;</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span> </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>    <span class="keywordflow">if</span> (untouchedConnect &amp;&amp; <a class="code hl_function" href="classClientHttpRequest.html#adceec3ccda3b1ac9a47bbd789939abba">sslBumpNeeded</a>()) {</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1ec3ec0b8c3d8f8cd603180e8312885b">forceTunnel</a>);</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>        <a class="code hl_function" href="classClientHttpRequest.html#a8e46a2567cf2ddf2283557d8662f3988">sslBumpStart</a>();</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>    }</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span> </div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>    <span class="keywordflow">if</span> (untouchedConnect || <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a1ec3ec0b8c3d8f8cd603180e8312885b">forceTunnel</a>) {</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>        <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classServer.html#a8ca89bbc00095c4706eb2131889fb26d">stopReading</a>(); <span class="comment">// tunnels read for themselves</span></div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>        <a class="code hl_function" href="client__side__request_8h.html#a463df90046fef514df797f43c881f0af">tunnelStart</a>(<span class="keyword">this</span>);</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>    }</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span> </div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>    <a class="code hl_function" href="classClientHttpRequest.html#aebb8148d406c65e3890ccb0ba88b8bf4">httpStart</a>();</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>}</div>
</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span> </div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01384" data-start="{" data-end="}">
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#aebb8148d406c65e3890ccb0ba88b8bf4"> 1384</a></span><a class="code hl_function" href="classClientHttpRequest.html#aebb8148d406c65e3890ccb0ba88b8bf4">ClientHttpRequest::httpStart</a>()</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>{</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>    <span class="comment">// XXX: Re-initializes rather than updates. Should not be needed at all.</span></div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>    <a class="code hl_function" href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">updateLoggingTags</a>(<a class="code hl_enumvalue" href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5aa5ae6efde2911aca58a1954a66c2aeed">LOG_TAG_NONE</a>);</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 4, <a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>().c_str() &lt;&lt; <span class="stringliteral">&quot; for &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span> </div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>    <span class="comment">/* no one should have touched this */</span></div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> == 0);</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>    <span class="comment">/* Use the Stream Luke */</span></div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>    <a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *<a class="code hl_struct" href="structnode.html">node</a> = (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">tail</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>    <a class="code hl_function" href="group__ClientStreamInternal.html#ga54ab73d51a7454c7ccafed27b3f87011">clientStreamRead</a>(<a class="code hl_struct" href="structnode.html">node</a>, <span class="keyword">this</span>, <a class="code hl_struct" href="structnode.html">node</a>-&gt;readBuffer);</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>}</div>
</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span> </div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span> </div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01400" data-start="{" data-end="}">
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a7f2a15ed8685d82667aa244440899cb4"> 1400</a></span><a class="code hl_function" href="classClientHttpRequest.html#aeaf768b20ad5656ca8d8db3e69776575">ClientHttpRequest::sslBumpNeed</a>(<a class="code hl_enumeration" href="group__ServerProtocolSSLAPI.html#gae6b7865118af149a83cc4569060c1af9">Ssl::BumpMode</a> mode)</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>{</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3, <span class="stringliteral">&quot;sslBump required: &quot;</span>&lt;&lt; <a class="code hl_function" href="group__ServerProtocolSSLAPI.html#ga326212e49d2774b730d08ae598a11e30">Ssl::bumpMode</a>(mode));</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>    <a class="code hl_variable" href="classClientHttpRequest.html#a9c5bc221afbfe0347bee1fafba128574">sslBumpNeed_</a> = mode;</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>}</div>
</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span> </div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span><span class="comment">// called when comm_write has completed</span></div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01408" data-start="{" data-end="}">
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"><a class="line" href="client__side__request_8cc.html#ae8bc52b96ef80d3fb21368626967ac1e"> 1408</a></span><a class="code hl_function" href="client__side__request_8cc.html#ae8bc52b96ef80d3fb21368626967ac1e">SslBumpEstablish</a>(<span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">Comm::ConnectionPointer</a> &amp;, <span class="keywordtype">char</span> *, <span class="keywordtype">size_t</span>, <a class="code hl_enumeration" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050">Comm::Flag</a> errflag, <span class="keywordtype">int</span>, <span class="keywordtype">void</span> *data)</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>{</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>    <a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a> *r = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classClientHttpRequest.html">ClientHttpRequest</a>*<span class="keyword">&gt;</span>(data);</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;responded to CONNECT: &quot;</span> &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot; ? &quot;</span> &lt;&lt; errflag);</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span> </div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(r &amp;&amp; <a class="code hl_function" href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a>(r));</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>    r-&gt;<a class="code hl_function" href="classClientHttpRequest.html#ad8b7c76779fca1362e6944da47f561e9">sslBumpEstablish</a>(errflag);</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>}</div>
</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span> </div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01418" data-start="{" data-end="}">
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ad8b7c76779fca1362e6944da47f561e9"> 1418</a></span><a class="code hl_function" href="classClientHttpRequest.html#ad8b7c76779fca1362e6944da47f561e9">ClientHttpRequest::sslBumpEstablish</a>(<a class="code hl_enumeration" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050">Comm::Flag</a> errflag)</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>{</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>    <span class="comment">// Bail out quickly on Comm::ERR_CLOSING - close handlers will tidy up</span></div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>    <span class="keywordflow">if</span> (errflag == <a class="code hl_enumvalue" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050a884f9d58f0f131131497fa9ceefb3b3c">Comm::ERR_CLOSING</a>)</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span> </div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>    <span class="keywordflow">if</span> (errflag) {</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;CONNECT response failure in SslBump: &quot;</span> &lt;&lt; errflag);</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>        <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>-&gt;<a class="code hl_function" href="classComm_1_1Connection.html#a32253e90999f679dc032e19ad50d03ab">close</a>();</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>    }</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>    <span class="comment">// Preserve authentication info for the ssl-bumped request</span></div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a> != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>        <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a365239c8b450a844e46cc7c28d465ba3">setAuth</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a>, <span class="stringliteral">&quot;SSL-bumped CONNECT&quot;</span>);</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span> </div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_function" href="classClientHttpRequest.html#adceec3ccda3b1ac9a47bbd789939abba">sslBumpNeeded</a>());</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>    <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#a2d458e5d1aecb62f7a9568e34467262c">switchToHttps</a>(<span class="keyword">this</span>, <a class="code hl_variable" href="classClientHttpRequest.html#a9c5bc221afbfe0347bee1fafba128574">sslBumpNeed_</a>);</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>}</div>
</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span> </div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01441" data-start="{" data-end="}">
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a8e46a2567cf2ddf2283557d8662f3988"> 1441</a></span><a class="code hl_function" href="classClientHttpRequest.html#a8e46a2567cf2ddf2283557d8662f3988">ClientHttpRequest::sslBumpStart</a>()</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>{</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 5, <span class="stringliteral">&quot;Confirming &quot;</span> &lt;&lt; <a class="code hl_function" href="group__ServerProtocolSSLAPI.html#ga326212e49d2774b730d08ae598a11e30">Ssl::bumpMode</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a9c5bc221afbfe0347bee1fafba128574">sslBumpNeed_</a>) &lt;&lt;</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>           <span class="stringliteral">&quot;-bumped CONNECT tunnel on FD &quot;</span> &lt;&lt; <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection);</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>    <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classConnStateData.html#abca96f1a2792ad7128762d1dac280cd6">sslBumpMode</a> = <a class="code hl_variable" href="classClientHttpRequest.html#a9c5bc221afbfe0347bee1fafba128574">sslBumpNeed_</a>;</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span> </div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>    <a class="code hl_class" href="classRefCount.html">AsyncCall::Pointer</a> bumpCall = <a class="code hl_function" href="CommCalls_8h.html#a7e143fa246c3e54c90fa8d20b390b88d">commCbCall</a>(85, 5, <span class="stringliteral">&quot;ClientSocketContext::sslBumpEstablish&quot;</span>,</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>                                  <a class="code hl_class" href="classCommIoCbPtrFun.html">CommIoCbPtrFun</a>(&amp;<a class="code hl_function" href="client__side__request_8cc.html#ae8bc52b96ef80d3fb21368626967ac1e">SslBumpEstablish</a>, <span class="keyword">this</span>));</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span> </div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a067afb76219d72cd969eba5e44c6a9ea">interceptTproxy</a> || <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a7feb14e42e2a35fb38fb744e98b8af7b">intercepted</a>) {</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>        <a class="code hl_class" href="classCommIoCbParams.html">CommIoCbParams</a> &amp;params = GetCommParams&lt;CommIoCbParams&gt;(bumpCall);</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>        params.<a class="code hl_variable" href="classCommCommonCbParams.html#aaa1b70c6ff254ac72ac1503fc158df7e">flag</a> = <a class="code hl_enumvalue" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050a2d02cf4ed31f765e18f4d8474ede4e24">Comm::OK</a>;</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>        params.<a class="code hl_variable" href="classCommCommonCbParams.html#acbcbe42d3ccd12c6de3b1f3d1d7c4bc3">conn</a> = <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>;</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>        <a class="code hl_define" href="AsyncCall_8h.html#a467b8011155e661a2d87e340039ba5bc">ScheduleCallHere</a>(bumpCall);</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>    }</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span> </div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>    <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a19bddcabb9a3d2f290c183a171afa4b3">reply</a> = <a class="code hl_function" href="classHttpReply.html#ae96652fc2dfe69192b90208c78f16148">HttpReply::MakeConnectionEstablished</a>();</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span> </div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>    <span class="keyword">const</span> <span class="keyword">auto</span> mb = <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a19bddcabb9a3d2f290c183a171afa4b3">reply</a>-&gt;<a class="code hl_function" href="classHttpReply.html#a0e8069f4331ea7989365cc8a9b2c8aa3">pack</a>();</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>    <span class="comment">// send an HTTP 200 response to kick client SSL negotiation</span></div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>    <span class="comment">// TODO: Unify with tunnel.cc and add a Server(?) header</span></div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>    <a class="code hl_function" href="namespaceComm.html#a96a9518a6c2c77d282a79f406e0252a9">Comm::Write</a>(<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection, mb, bumpCall);</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>    <span class="keyword">delete</span> mb;</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>}</div>
</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span> </div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span> </div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01470" data-start="{" data-end="}">
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a6c8eb3e0781de2af44142a360eec1738"> 1470</a></span><a class="code hl_function" href="classClientHttpRequest.html#a6c8eb3e0781de2af44142a360eec1738">ClientHttpRequest::updateError</a>(<span class="keyword">const</span> <a class="code hl_class" href="classError.html">Error</a> &amp;<a class="code hl_function" href="acl_2external_2kerberos__ldap__group_2support_8h.html#a3654b5eb0d17fed9fc1f1dee818ad49f">error</a>)</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>{</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>)</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#aeeb3de67d14be944d152c249379832cb">error</a>.<a class="code hl_function" href="classError.html#a6e163b6a5a08adf7f23ea363d8935ee3">update</a>(<a class="code hl_function" href="acl_2external_2kerberos__ldap__group_2support_8h.html#a3654b5eb0d17fed9fc1f1dee818ad49f">error</a>);</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_function" href="classAccessLogEntry.html#af60bc81e8501b430cbb4e209699c0091">updateError</a>(<a class="code hl_function" href="acl_2external_2kerberos__ldap__group_2support_8h.html#a3654b5eb0d17fed9fc1f1dee818ad49f">error</a>);</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>}</div>
</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span> </div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span><span class="keywordtype">bool</span></div>
<div class="foldopen" id="foldopen01479" data-start="{" data-end="}">
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a3e8660eb3f78ddb12f5f36f716755109"> 1479</a></span><a class="code hl_function" href="classClientHttpRequest.html#a3e8660eb3f78ddb12f5f36f716755109">ClientHttpRequest::gotEnough</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>    <span class="comment">// TODO: See also (and unify with) clientReplyContext::storeNotOKTransferDone()</span></div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>    int64_t contentLength =</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>        <a class="code hl_function" href="classClientHttpRequest.html#a7b72433c2b94db09d5fa9725a2a189f0">memObject</a>()-&gt;<a class="code hl_function" href="classMemObject.html#ad5355b4679045222e5ea75b0c36f16c4">baseReply</a>().<a class="code hl_function" href="classHttpReply.html#a74ed30d9587d67debbc07741d36609a5">bodySize</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>);</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(contentLength &gt;= 0);</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span> </div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> &lt; contentLength)</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span> </div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>}</div>
</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span> </div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01493" data-start="{" data-end="}">
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a3b68d4eda26edef911fc90801e27cc5c"> 1493</a></span><a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">ClientHttpRequest::storeEntry</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *newEntry)</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>{</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>    <a class="code hl_variable" href="classClientHttpRequest.html#a97aeb0db7a8920729b3226df1b080e9d">entry_</a> = newEntry;</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>}</div>
</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span> </div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01499" data-start="{" data-end="}">
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#affbf5cd820b537ea77a2fb2b6db506ff"> 1499</a></span><a class="code hl_function" href="classClientHttpRequest.html#af52b42fc3f7ed18172aa09d69f856e55">ClientHttpRequest::loggingEntry</a>(<a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *newEntry)</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>{</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a3d120f7d2ea8044fe284eb015748c4fe">loggingEntry_</a>)</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a3d120f7d2ea8044fe284eb015748c4fe">loggingEntry_</a>-&gt;<a class="code hl_function" href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">unlock</a>(<span class="stringliteral">&quot;ClientHttpRequest::loggingEntry&quot;</span>);</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span> </div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>    <a class="code hl_variable" href="classClientHttpRequest.html#a3d120f7d2ea8044fe284eb015748c4fe">loggingEntry_</a> = newEntry;</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span> </div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a3d120f7d2ea8044fe284eb015748c4fe">loggingEntry_</a>)</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a3d120f7d2ea8044fe284eb015748c4fe">loggingEntry_</a>-&gt;<a class="code hl_function" href="classStoreEntry.html#a53a607cfbdb22fde40edd2c72bfb6dd3">lock</a>(<span class="stringliteral">&quot;ClientHttpRequest::loggingEntry&quot;</span>);</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>}</div>
</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01511" data-start="{" data-end="}">
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a5912c3e9af285d3f77ec815c719b8105"> 1511</a></span><a class="code hl_function" href="classClientHttpRequest.html#a5912c3e9af285d3f77ec815c719b8105">ClientHttpRequest::initRequest</a>(<a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *aRequest)</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>{</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>    <a class="code hl_function" href="classClientHttpRequest.html#ac7ceae8151d9b71a15fd9f99474ecac8">assignRequest</a>(aRequest);</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> csd = <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()) {</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>        <span class="keywordflow">if</span> (!csd-&gt;notes()-&gt;empty())</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>            <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#a88c3369b97fa30b60dc234b21dda9b91">notes</a>()-&gt;<a class="code hl_function" href="classNotePairs.html#a0235547d238fc65bbf8088f62c1cb085">appendNewOnly</a>(csd-&gt;notes().getRaw());</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>    }</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>    <span class="comment">// al is created in the constructor</span></div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a92312350a82deb4331b171bdea7ff3d5">request</a>) {</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a92312350a82deb4331b171bdea7ff3d5">request</a> = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>        <a class="code hl_function" href="http_2Message_8h.html#afbf13ecd1cc5c007367ae094c1aa19a9">HTTPMSGLOCK</a>(<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a92312350a82deb4331b171bdea7ff3d5">request</a>);</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_function" href="classAccessLogEntry.html#a551791241b593874d721ffdf04f6b4ed">syncNotes</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>    }</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>}</div>
</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span> </div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01528" data-start="{" data-end="}">
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ab06c843bb34e78fbb741e2c7c9632dff"> 1528</a></span><a class="code hl_function" href="classClientHttpRequest.html#ab06c843bb34e78fbb741e2c7c9632dff">ClientHttpRequest::resetRequest</a>(<a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *newRequest)</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>{</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>    <span class="keyword">const</span> <span class="keyword">auto</span> uriChanged = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>() != newRequest-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>();</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>    <a class="code hl_function" href="classClientHttpRequest.html#ac5ce3f99e959e0e6da56d7daf5b9fb53">resetRequestXXX</a>(newRequest, uriChanged);</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>}</div>
</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span> </div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01535" data-start="{" data-end="}">
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ac5ce3f99e959e0e6da56d7daf5b9fb53"> 1535</a></span><a class="code hl_function" href="classClientHttpRequest.html#ac5ce3f99e959e0e6da56d7daf5b9fb53">ClientHttpRequest::resetRequestXXX</a>(<a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *newRequest, <span class="keyword">const</span> <span class="keywordtype">bool</span> uriChanged)</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>{</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a> != newRequest);</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>    <a class="code hl_function" href="classClientHttpRequest.html#a27dbe3e5b15be5edba058de0cfbf9f92">clearRequest</a>();</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>    <a class="code hl_function" href="classClientHttpRequest.html#ac7ceae8151d9b71a15fd9f99474ecac8">assignRequest</a>(newRequest);</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>    <a class="code hl_define" href="negotiate__wrapper_8cc.html#a2c3897f7c46ca54a2e0dd7b24a40c7cb">xfree</a>(<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>    <a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> = <a class="code hl_function" href="SBuf_8h.html#a826aafc8068f24cb125e700733cd2bee">SBufToCstring</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">effectiveRequestUri</a>());</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span> </div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>    <span class="keywordflow">if</span> (uriChanged) {</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#acbd8e449ba6d3cc3b181d714a4539f00">redirected</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>        <a class="code hl_function" href="classClientHttpRequest.html#a68e1aa2eaed3852cef68f86d4a1865c2">checkForInternalAccess</a>();</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>    }</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>}</div>
</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span> </div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01550" data-start="{" data-end="}">
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a68e1aa2eaed3852cef68f86d4a1865c2"> 1550</a></span><a class="code hl_function" href="classClientHttpRequest.html#a68e1aa2eaed3852cef68f86d4a1865c2">ClientHttpRequest::checkForInternalAccess</a>()</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>{</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="internal_8cc.html#a76eaf4388b308548216736a932f7ec44">internalCheck</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a4499a7819274e2dbe4ceb399e77e250d">path</a>()))</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span> </div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">port</a>() == <a class="code hl_function" href="tools_8cc.html#a8905d1b1ed6354e381bb48fc5ce505de">getMyPort</a>() &amp;&amp; <a class="code hl_function" href="internal_8cc.html#adb34130666d96a221011e9ee78d4ebdc">internalHostnameIs</a>(<a class="code hl_class" href="classSBuf.html">SBuf</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>()))) {</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 3, <span class="stringliteral">&quot;internal URL found: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">getScheme</a>() &lt;&lt; <span class="stringliteral">&quot;://&quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a2c86b2285f5a7f86cd1862e8d7b8fe48">authority</a>(<span class="keyword">true</span>));</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a26c4900e600bc57c506766fcbdf3c0e3">internal</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">onoff</a>.<a class="code hl_variable" href="classSquidConfig.html#af176cee9d6decb267d306c6a0c2f5035">global_internal_static</a> &amp;&amp; <a class="code hl_function" href="internal_8cc.html#a3c8ef76cbf49bd431ba514e72de34978">internalStaticCheck</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a4499a7819274e2dbe4ceb399e77e250d">path</a>())) {</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 3, <span class="stringliteral">&quot;internal URL found: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">getScheme</a>() &lt;&lt; <span class="stringliteral">&quot;://&quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a2c86b2285f5a7f86cd1862e8d7b8fe48">authority</a>(<span class="keyword">true</span>) &lt;&lt; <span class="stringliteral">&quot; (global_internal_static on)&quot;</span>);</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a446037a0d5240188b96983e256dfe48b">setScheme</a>(<a class="code hl_enumvalue" href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d">AnyP::PROTO_HTTP</a>, <span class="stringliteral">&quot;http&quot;</span>);</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">host</a>(<a class="code hl_function" href="internal_8cc.html#aa48847e699b786df1b9591aa0bedcb6b">internalHostname</a>());</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">port</a>(<a class="code hl_function" href="tools_8cc.html#a8905d1b1ed6354e381bb48fc5ce505de">getMyPort</a>());</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#a26c4900e600bc57c506766fcbdf3c0e3">internal</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>        <a class="code hl_function" href="classClientHttpRequest.html#a628397814ae1783a4cecbe90ab9b010a">setLogUriToRequestUri</a>();</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(33, 3, <span class="stringliteral">&quot;internal URL found: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">getScheme</a>() &lt;&lt; <span class="stringliteral">&quot;://&quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a2c86b2285f5a7f86cd1862e8d7b8fe48">authority</a>(<span class="keyword">true</span>) &lt;&lt; <span class="stringliteral">&quot; (not this proxy)&quot;</span>);</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>    }</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span> </div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="internal_8cc.html#a0e2d2f23938169a0f1b55c147645bf8f">ForSomeCacheManager</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">url</a>.<a class="code hl_function" href="classAnyP_1_1Uri.html#a4499a7819274e2dbe4ceb399e77e250d">path</a>()))</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_function" href="classRequestFlags.html#a7a87d1bd6000a6ce88eae02e6edf9f4c">disableCacheUse</a>(<span class="stringliteral">&quot;cache manager URL&quot;</span>);</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>}</div>
</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span> </div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01574" data-start="{" data-end="}">
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ac7ceae8151d9b71a15fd9f99474ecac8"> 1574</a></span><a class="code hl_function" href="classClientHttpRequest.html#ac7ceae8151d9b71a15fd9f99474ecac8">ClientHttpRequest::assignRequest</a>(<a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *newRequest)</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>{</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(newRequest);</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>    <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *&amp;<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>) = newRequest;</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>    <a class="code hl_function" href="http_2Message_8h.html#afbf13ecd1cc5c007367ae094c1aa19a9">HTTPMSGLOCK</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>    <a class="code hl_function" href="classClientHttpRequest.html#a628397814ae1783a4cecbe90ab9b010a">setLogUriToRequestUri</a>();</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>}</div>
</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span> </div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01584" data-start="{" data-end="}">
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a27dbe3e5b15be5edba058de0cfbf9f92"> 1584</a></span><a class="code hl_function" href="classClientHttpRequest.html#a27dbe3e5b15be5edba058de0cfbf9f92">ClientHttpRequest::clearRequest</a>()</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>{</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>    <a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *oldRequest = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>;</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>    <a class="code hl_function" href="http_2Message_8h.html#adc5c03415efc511e2b62e809310969b6">HTTPMSGUNLOCK</a>(oldRequest);</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>    <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *&amp;<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>) = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>    <a class="code hl_function" href="classClientHttpRequest.html#a48c8c21eac3e3e223b313902fe14e692">absorbLogUri</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>}</div>
</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span> </div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span><span class="comment">/*</span></div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span><span class="comment"> * doCallouts() - This function controls the order of &quot;callout&quot;</span></div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span><span class="comment"> * executions, including non-blocking access control checks, the</span></div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span><span class="comment"> * redirector, and ICAP.  Previously, these callouts were chained</span></div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span><span class="comment"> * together such that &quot;clientAccessCheckDone()&quot; would call</span></div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span><span class="comment"> * &quot;clientRedirectStart()&quot; and so on.</span></div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span><span class="comment"> *</span></div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span><span class="comment"> * The ClientRequestContext (aka calloutContext) class holds certain</span></div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span><span class="comment"> * state data for the callout/callback operations.  Previously</span></div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span><span class="comment"> * ClientHttpRequest would sort of hand off control to ClientRequestContext</span></div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span><span class="comment"> * for a short time.  ClientRequestContext would then delete itself</span></div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span><span class="comment"> * and pass control back to ClientHttpRequest when all callouts</span></div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span><span class="comment"> * were finished.</span></div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span><span class="comment"> *</span></div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span><span class="comment"> * This caused some problems for ICAP because we want to make the</span></div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span><span class="comment"> * ICAP callout after checking ACLs, but before checking the no_cache</span></div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span><span class="comment"> * list.  We can&#39;t stuff the ICAP state into the ClientRequestContext</span></div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span><span class="comment"> * class because we still need the ICAP state after ClientRequestContext</span></div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span><span class="comment"> * goes away.</span></div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span><span class="comment"> *</span></div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span><span class="comment"> * Note that ClientRequestContext is created before the first call</span></div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span><span class="comment"> * to doCallouts().</span></div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span><span class="comment"> *</span></div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span><span class="comment"> * If one of the callouts notices that ClientHttpRequest is no</span></div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span><span class="comment"> * longer valid, it should call cbdataReferenceDone() so that</span></div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span><span class="comment"> * ClientHttpRequest&#39;s reference count goes to zero and it will get</span></div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span><span class="comment"> * deleted.  ClientHttpRequest will then delete ClientRequestContext.</span></div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span><span class="comment"> *</span></div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span><span class="comment"> * Note that we set the _done flags here before actually starting</span></div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span><span class="comment"> * the callout.  This is strictly for convenience.</span></div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span><span class="comment"> */</span></div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span> </div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01625" data-start="{" data-end="}">
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1"> 1625</a></span><a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">ClientHttpRequest::doCallouts</a>()</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>{</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>);</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span> </div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>) {</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>        <span class="comment">// CVE-2009-0801: verify the Host: header is consistent with other known details.</span></div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a3a33e3dbc18e1d4081f25f70113482d6">host_header_verify_done</a>) {</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3, <span class="stringliteral">&quot;Doing calloutContext-&gt;hostHeaderVerify()&quot;</span>);</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a3a33e3dbc18e1d4081f25f70113482d6">host_header_verify_done</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_function" href="classClientRequestContext.html#ad126658971216f8be7208f906bd640ea">hostHeaderVerify</a>();</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>        }</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span> </div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a9702d46ba83f3300042f512255af4564">http_access_done</a>) {</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3, <span class="stringliteral">&quot;Doing calloutContext-&gt;clientAccessCheck()&quot;</span>);</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a9702d46ba83f3300042f512255af4564">http_access_done</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_function" href="classClientRequestContext.html#a71477b784014a3f5309153a6d8b1f70c">clientAccessCheck</a>();</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>        }</div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span> </div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span><span class="preprocessor">#if USE_ADAPTATION</span></div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ab75ca746c730c960f7eba0f46709e1dc">adaptation_acl_check_done</a>) {</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ab75ca746c730c960f7eba0f46709e1dc">adaptation_acl_check_done</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classAdaptation_1_1AccessCheck.html#abbd888b460056d88c416343c0107331c">Adaptation::AccessCheck::Start</a>(</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>                        <a class="code hl_enumvalue" href="namespaceAdaptation.html#a04386cc017d5ec2d7e60fc3f4921fc02addd2e5a513e9b4f5a398a793315f85a5">Adaptation::methodReqmod</a>, <a class="code hl_enumvalue" href="namespaceAdaptation.html#a6510d03a11ef873d96df015109b82585a6b588df0b78a7515e2848893fbbd2088">Adaptation::pointPreCache</a>,</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>                        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <span class="keyword">nullptr</span>, <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>, <span class="keyword">this</span>))</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>                <span class="keywordflow">return</span>; <span class="comment">// will call callback</span></div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>        }</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span> </div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a8efe7580a5fc3ce72fb30c3f7ccbca7c">redirect_done</a>) {</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a8efe7580a5fc3ce72fb30c3f7ccbca7c">redirect_done</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span> </div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a51a38078dc00ab41305e3439e0be5160">Program</a>.<a class="code hl_variable" href="classSquidConfig.html#a5a30792b1b32673c91bbf76ff503a087">redirect</a>) {</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3, <span class="stringliteral">&quot;Doing calloutContext-&gt;clientRedirectStart()&quot;</span>);</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>                <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#acb3bd1387cd493ebc0da7e6ceee1743f">redirect_state</a> = <a class="code hl_define" href="defines_8h.html#a35197769b18b837100d0576e84f8a63f">REDIRECT_PENDING</a>;</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>                <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_function" href="classClientRequestContext.html#a44f5f9d8c0e99a76e6bec35478d473b0">clientRedirectStart</a>();</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>            }</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>        }</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span> </div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a658825d664e00ebf33d7bf70f7e96e3f">adapted_http_access_done</a>) {</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3, <span class="stringliteral">&quot;Doing calloutContext-&gt;clientAccessCheck2()&quot;</span>);</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a658825d664e00ebf33d7bf70f7e96e3f">adapted_http_access_done</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_function" href="classClientRequestContext.html#a004907eaa1efbcc4eb3bec5784ec0960">clientAccessCheck2</a>();</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>        }</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span> </div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a0223272029ea7fef9b896be0c4c6f86f">store_id_done</a>) {</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a0223272029ea7fef9b896be0c4c6f86f">store_id_done</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span> </div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#a51a38078dc00ab41305e3439e0be5160">Program</a>.<a class="code hl_variable" href="classSquidConfig.html#a200f7109251db7e9719d331381aa8b2c">store_id</a>) {</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3,<span class="stringliteral">&quot;Doing calloutContext-&gt;clientStoreIdStart()&quot;</span>);</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>                <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#afe53d111b9377770e03f382fcf15f711">store_id_state</a> = <a class="code hl_define" href="defines_8h.html#a35197769b18b837100d0576e84f8a63f">REDIRECT_PENDING</a>;</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>                <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_function" href="classClientRequestContext.html#af64a43978912fa5d3fa189faaec50970">clientStoreIdStart</a>();</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>            }</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>        }</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span> </div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a07989b09ef23aaeb719886d5bf8dc569">interpreted_req_hdrs</a>) {</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3, <span class="stringliteral">&quot;Doing clientInterpretRequestHeaders()&quot;</span>);</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a07989b09ef23aaeb719886d5bf8dc569">interpreted_req_hdrs</a> = 1;</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>            <a class="code hl_function" href="client__side__request_8cc.html#a22bce20949eaf9c5562098a53cb6fee0">clientInterpretRequestHeaders</a>(<span class="keyword">this</span>);</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>        }</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span> </div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a7a6bc55e0f61702b9e2e25f5e37b43dd">no_cache_done</a>) {</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a7a6bc55e0f61702b9e2e25f5e37b43dd">no_cache_done</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span> </div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>.<a class="code hl_variable" href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">accessList</a>.<a class="code hl_variable" href="classSquidConfig.html#ad0eb1efb330448abf65a159417f31f8e">noCache</a> &amp;&amp; <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>.<a class="code hl_variable" href="classRequestFlags.html#af33cb0e80d9996c532479ef942d1eb91">cachable</a>) {</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>                <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3, <span class="stringliteral">&quot;Doing calloutContext-&gt;checkNoCache()&quot;</span>);</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>                <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_function" href="classClientRequestContext.html#ab523448fe90265c989bafbf7d88009cd">checkNoCache</a>();</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>            }</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>        }</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>    } <span class="comment">//  if !calloutContext-&gt;error</span></div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span> </div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>    <span class="comment">// Set appropriate MARKs and CONNMARKs if needed.</span></div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() &amp;&amp; <a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection)) {</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>        <a class="code hl_class" href="classACLFilledChecklist.html">ACLFilledChecklist</a> ch(<span class="keyword">nullptr</span>, <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>        ch.<a class="code hl_variable" href="classACLFilledChecklist.html#ac9fc7ac3b0ef5a2a0d2811aa762dbeab">al</a> = <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>-&gt;<a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>;</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>        ch.<a class="code hl_variable" href="classACLFilledChecklist.html#aa75a941c2634f5faa0eef864c4153b93">src_addr</a> = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#af6301466f6d3594f4fdacb4713a44c61">client_addr</a>;</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>        ch.<a class="code hl_variable" href="classACLFilledChecklist.html#a5eede657a1f9b1bfe54ac2ee58af9d2e">my_addr</a> = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac2bbb9182fe895f52e1ac045ef717d76">my_addr</a>;</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>        ch.<a class="code hl_function" href="classACLFilledChecklist.html#ae77611904901fa5f796cdd54ff5be235">syncAle</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">log_uri</a>);</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span> </div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#aa95c1ad804bd5e7d93b46a937c57c57f">toClientMarkingDone</a>) {</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#aa95c1ad804bd5e7d93b46a937c57c57f">toClientMarkingDone</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>            <a class="code hl_typedef" href="ip_2forward_8h.html#a6bd5fd9a27e152eb6dd4faa68729f310">tos_t</a> tos = <a class="code hl_function" href="FwdState_8cc.html#a87fba5ba04ec8c40f988dc58da70e86b">aclMapTOS</a>(<a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.tosToClient, &amp;ch);</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>            <span class="keywordflow">if</span> (tos)</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>                <a class="code hl_function" href="namespaceIp_1_1Qos.html#aaa320dc24fac9b1952edaea803a3dd9a">Ip::Qos::setSockTos</a>(<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection, tos);</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span> </div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>            <span class="keyword">const</span> <span class="keyword">auto</span> packetMark = <a class="code hl_function" href="FwdState_8cc.html#a7878013cfc9139fe220001fd6f127337">aclFindNfMarkConfig</a>(<a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.nfmarkToClient, &amp;ch);</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>            <span class="keywordflow">if</span> (!packetMark.isEmpty())</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>                <a class="code hl_function" href="namespaceIp_1_1Qos.html#aebe4081962f547bada77396ee0d56b00">Ip::Qos::setSockNfmark</a>(<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection, packetMark.mark);</div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span> </div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>            <span class="keyword">const</span> <span class="keyword">auto</span> connmark = <a class="code hl_function" href="FwdState_8cc.html#a7878013cfc9139fe220001fd6f127337">aclFindNfMarkConfig</a>(<a class="code hl_variable" href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a>.nfConnmarkToClient, &amp;ch);</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>            <span class="keywordflow">if</span> (!connmark.isEmpty())</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>                <a class="code hl_function" href="namespaceIp_1_1Qos.html#a2243acee556f7a7ec0041da16459d0f9">Ip::Qos::setNfConnmark</a>(<a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection, <a class="code hl_enumvalue" href="namespaceIp_1_1Qos.html#a4e05130943d49767946ade3e7e50d5ecac94474857ae419ca1d01cd7539c7830f">Ip::Qos::dirAccepted</a>, connmark);</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>        }</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>    }</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span> </div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>    <span class="comment">// Even with calloutContext-&gt;error, we call sslBumpAccessCheck() to decide</span></div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>    <span class="comment">// whether SslBump applies to this transaction. If it applies, we will</span></div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>    <span class="comment">// attempt to bump the client to serve the error.</span></div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ad4e5c1fe9c02000df992d04cb995f6f5">sslBumpCheckDone</a>) {</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>        <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ad4e5c1fe9c02000df992d04cb995f6f5">sslBumpCheckDone</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_function" href="classClientRequestContext.html#a17a0ac78b84650e7d10ed8b0fed306d7">sslBumpAccessCheck</a>())</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>        <span class="comment">/* else no ssl bump required*/</span></div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>    }</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span> </div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>) {</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>        <span class="comment">// XXX: prformance regression. c_str() reallocates</span></div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>        <a class="code hl_class" href="classSBuf.html">SBuf</a> storeUriBuf(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#aaac8481b254d6cee121c75ae3e71ce8b">storeId</a>());</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> *storeUri = storeUriBuf.<a class="code hl_function" href="classSBuf.html#a2a7fda503e54cb36b023dcaaab633f65">c_str</a>();</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>        <a class="code hl_class" href="classStoreEntry.html">StoreEntry</a> *e = <a class="code hl_function" href="store_8cc.html#a872157d7a8c43bb5facb072ce03c4d48">storeCreateEntry</a>(storeUri, storeUri, <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>, <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>);</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span><span class="preprocessor">#if USE_OPENSSL</span></div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classClientHttpRequest.html#adceec3ccda3b1ac9a47bbd789939abba">sslBumpNeeded</a>()) {</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>            <span class="comment">// We have to serve an error, so bump the client first.</span></div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>            <a class="code hl_function" href="classClientHttpRequest.html#aeaf768b20ad5656ca8d8db3e69776575">sslBumpNeed</a>(<a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a63dd03e830a0746569e5635a3dfa28dc">Ssl::bumpClientFirst</a>);</div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>            <span class="comment">// set final error but delay sending until we bump</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>            <a class="code hl_class" href="classSsl_1_1ServerBump.html">Ssl::ServerBump</a> *srvBump = <span class="keyword">new</span> <a class="code hl_class" href="classSsl_1_1ServerBump.html">Ssl::ServerBump</a>(<span class="keyword">this</span>, e, <a class="code hl_enumvalue" href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a63dd03e830a0746569e5635a3dfa28dc">Ssl::bumpClientFirst</a>);</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>            <a class="code hl_function" href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry</a>(e, <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>);</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>            <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_function" href="classConnStateData.html#afd9feaaac6844a8d9899233c0d8146db">setServerBump</a>(srvBump);</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>            e-&gt;<a class="code hl_function" href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">unlock</a>(<span class="stringliteral">&quot;ClientHttpRequest::doCallouts+sslBumpNeeded&quot;</span>);</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>        } <span class="keywordflow">else</span></div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>        {</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>            <span class="comment">// send the error to the client now</span></div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>            <a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *<a class="code hl_struct" href="structnode.html">node</a> = (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">tail</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a4660c70e36112cd329b84f7152a671fa">prev</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>            <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *repContext = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *<span class="keyword">&gt;</span>(<a class="code hl_struct" href="structnode.html">node</a>-&gt;data.getRaw());</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>            <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a> (repContext);</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>            repContext-&gt;<a class="code hl_function" href="classclientReplyContext.html#a54642fc1f8d38e1860d4e945d820889d">setReplyToStoreEntry</a>(e, <span class="stringliteral">&quot;immediate SslBump error&quot;</span>);</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>            <a class="code hl_function" href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry</a>(e, <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>);</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>            <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a808ac8e44e079957a7bde4a46f23c62a">readNextRequest</a> &amp;&amp; <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>())</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>                <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classConnStateData.html#a7f95d063c54bfa6618b5d45869b5c21b">flags</a>.<a class="code hl_variable" href="classConnStateData.html#ac049eac9adf044f1310c48e058778f6d">readMore</a> = <span class="keyword">true</span>; <span class="comment">// resume any pipeline reads.</span></div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>            <a class="code hl_struct" href="structnode.html">node</a> = (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">tail</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>            <a class="code hl_function" href="group__ClientStreamInternal.html#ga54ab73d51a7454c7ccafed27b3f87011">clientStreamRead</a>(<a class="code hl_struct" href="structnode.html">node</a>, <span class="keyword">this</span>, <a class="code hl_struct" href="structnode.html">node</a>-&gt;readBuffer);</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>            e-&gt;<a class="code hl_function" href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">unlock</a>(<span class="stringliteral">&quot;ClientHttpRequest::doCallouts-sslBumpNeeded&quot;</span>);</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>        }</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>    }</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span> </div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>    <a class="code hl_define" href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a>(<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">http</a>);</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>    <span class="keyword">delete</span> <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>;</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>    <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span> </div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(83, 3, <span class="stringliteral">&quot;calling processRequest()&quot;</span>);</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>    <a class="code hl_function" href="classClientHttpRequest.html#a3ae260da15d4ddba163608ce64145d25">processRequest</a>();</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span> </div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span><span class="preprocessor">#if ICAP_CLIENT</span></div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>    <a class="code hl_class" href="classRefCount.html">Adaptation::Icap::History::Pointer</a> ih = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#af12cd51466974ad702972c18238ef5a2">icapHistory</a>();</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>    <span class="keywordflow">if</span> (ih != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>        ih-&gt;logType = <a class="code hl_function" href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">loggingTags</a>();</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>}</div>
</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span> </div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01786" data-start="{" data-end="}">
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a628397814ae1783a4cecbe90ab9b010a"> 1786</a></span><a class="code hl_function" href="classClientHttpRequest.html#a628397814ae1783a4cecbe90ab9b010a">ClientHttpRequest::setLogUriToRequestUri</a>()</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>{</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>    <span class="keyword">const</span> <span class="keyword">auto</span> canonicalUri = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#ac0c4711b9c47a56e565c14b763d86214">canonicalCleanUrl</a>();</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>    <a class="code hl_function" href="classClientHttpRequest.html#a48c8c21eac3e3e223b313902fe14e692">absorbLogUri</a>(<a class="code hl_function" href="xstring_8cc.html#a4282f37eaa4a260c714ac6d1bf6a200f">xstrndup</a>(canonicalUri, <a class="code hl_define" href="defines_8h.html#afcbf7727d6416354930cd43f1c1e480c">MAX_URL</a>));</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>}</div>
</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span> </div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01794" data-start="{" data-end="}">
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a847eef916e63f6fdeb7cc8ef7095e392"> 1794</a></span><a class="code hl_function" href="classClientHttpRequest.html#a847eef916e63f6fdeb7cc8ef7095e392">ClientHttpRequest::setLogUriToRawUri</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *rawUri, <span class="keyword">const</span> <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a> &amp;method)</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>{</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(rawUri);</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>    <span class="comment">// Should(!request);</span></div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span> </div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>    <span class="comment">// TODO: SBuf() performance regression, fix by converting rawUri to SBuf</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>    <span class="keywordtype">char</span> *canonicalUri = <a class="code hl_function" href="Uri_8cc.html#a7bced763e70ec14e5e5ef88173302b6b">urlCanonicalCleanWithoutRequest</a>(<a class="code hl_class" href="classSBuf.html">SBuf</a>(rawUri), method, <a class="code hl_class" href="classAnyP_1_1UriScheme.html">AnyP::UriScheme</a>());</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span> </div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>    <a class="code hl_function" href="classClientHttpRequest.html#a48c8c21eac3e3e223b313902fe14e692">absorbLogUri</a>(<a class="code hl_function" href="classAnyP_1_1Uri.html#a77bfb036e33e7d6d3a9c0fd7ae1451fc">AnyP::Uri::cleanup</a>(canonicalUri));</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span> </div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>    <span class="keywordtype">char</span> *cleanedRawUri = <a class="code hl_function" href="classAnyP_1_1Uri.html#a77bfb036e33e7d6d3a9c0fd7ae1451fc">AnyP::Uri::cleanup</a>(rawUri);</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>    <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_function" href="classAccessLogEntry.html#ac8bced80c5b9d493aa9e97e8e2aa9866">setVirginUrlForMissingRequest</a>(<a class="code hl_class" href="classSBuf.html">SBuf</a>(cleanedRawUri));</div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>    <a class="code hl_define" href="negotiate__wrapper_8cc.html#a2c3897f7c46ca54a2e0dd7b24a40c7cb">xfree</a>(cleanedRawUri);</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>}</div>
</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span> </div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01810" data-start="{" data-end="}">
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a48c8c21eac3e3e223b313902fe14e692"> 1810</a></span><a class="code hl_function" href="classClientHttpRequest.html#a48c8c21eac3e3e223b313902fe14e692">ClientHttpRequest::absorbLogUri</a>(<span class="keywordtype">char</span> *aUri)</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>{</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>    <a class="code hl_define" href="negotiate__wrapper_8cc.html#a2c3897f7c46ca54a2e0dd7b24a40c7cb">xfree</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">log_uri</a>);</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>    <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *&amp;<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">log_uri</a>) = aUri;</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>}</div>
</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span> </div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01817" data-start="{" data-end="}">
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a9891746d2fe370c2930a7fddb44c1a35"> 1817</a></span><a class="code hl_function" href="classClientHttpRequest.html#a9891746d2fe370c2930a7fddb44c1a35">ClientHttpRequest::setErrorUri</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *aUri)</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>{</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a>);</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(aUri);</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>    <span class="comment">// Should(!request);</span></div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span> </div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>    <a class="code hl_variable" href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">uri</a> = <a class="code hl_define" href="negotiate__wrapper_8cc.html#a5eb055ca3b42205cc134b4a438cd9a72">xstrdup</a>(aUri);</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>    <span class="comment">// TODO: SBuf() performance regression, fix by converting setErrorUri() parameter to SBuf</span></div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>    <span class="keyword">const</span> <a class="code hl_class" href="classSBuf.html">SBuf</a> errorUri(aUri);</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>    <span class="keyword">const</span> <span class="keyword">auto</span> canonicalUri = <a class="code hl_function" href="Uri_8cc.html#a7bced763e70ec14e5e5ef88173302b6b">urlCanonicalCleanWithoutRequest</a>(errorUri, <a class="code hl_class" href="classHttpRequestMethod.html">HttpRequestMethod</a>(), <a class="code hl_class" href="classAnyP_1_1UriScheme.html">AnyP::UriScheme</a>());</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>    <a class="code hl_function" href="classClientHttpRequest.html#a48c8c21eac3e3e223b313902fe14e692">absorbLogUri</a>(<a class="code hl_function" href="xstring_8cc.html#a4282f37eaa4a260c714ac6d1bf6a200f">xstrndup</a>(canonicalUri, <a class="code hl_define" href="defines_8h.html#afcbf7727d6416354930cd43f1c1e480c">MAX_URL</a>));</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span> </div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>    <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_function" href="classAccessLogEntry.html#ac8bced80c5b9d493aa9e97e8e2aa9866">setVirginUrlForMissingRequest</a>(errorUri);</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>}</div>
</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span> </div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span><span class="comment">// XXX: This should not be a _request_ method. Move range_iter elsewhere.</span></div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>int64_t</div>
<div class="foldopen" id="foldopen01834" data-start="{" data-end="}">
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a02e882b436ac3874015529dc62a5291f"> 1834</a></span><a class="code hl_function" href="classClientHttpRequest.html#a02e882b436ac3874015529dc62a5291f">ClientHttpRequest::prepPartialResponseGeneration</a>()</div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>{</div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>);</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a>);</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span> </div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>    <a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_variable" href="classHttpHdrRangeIter.html#a319db564ce02056a930282cb57ab3f15">pos</a> = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a>-&gt;<a class="code hl_function" href="classHttpHdrRange.html#a4caf5a47b28b4f4e141b98e95914fe95">begin</a>();</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>    <a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_variable" href="classHttpHdrRangeIter.html#a52d32525864512d6e66aeb1e71d08345">end</a> = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a>-&gt;<a class="code hl_function" href="classHttpHdrRange.html#a5eefced91bb33dc3f5a518746238de0e">end</a>();</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>    <a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_variable" href="classHttpHdrRangeIter.html#a81c917bf59ffdc6af49563a23eac45ce">debt_size</a> = 0;</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>    <span class="keyword">const</span> <span class="keyword">auto</span> multipart = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">range</a>-&gt;<a class="code hl_variable" href="classHttpHdrRange.html#aac6c2acebe05f12765d394dcc86c0367">specs</a>.size() &gt; 1;</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>    <span class="keywordflow">if</span> (multipart)</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>        <a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_variable" href="classHttpHdrRangeIter.html#ab6e6dd729f76e0e4a34ac1105af0e715">boundary</a> = <a class="code hl_function" href="classClientHttpRequest.html#a53f0bfbec60d40769f21aff66eeaaa79">rangeBoundaryStr</a>();</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>    <a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_variable" href="classHttpHdrRangeIter.html#a9b4eac35b29b0ccff88dbb13676ea139">valid</a> = <span class="keyword">true</span>; <span class="comment">// TODO: Remove.</span></div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>    <a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_function" href="classHttpHdrRangeIter.html#ab695e670a8bc107e4346855768722a3c">updateSpec</a>(); <span class="comment">// TODO: Refactor to initialize rather than update.</span></div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span> </div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_variable" href="classHttpHdrRangeIter.html#a319db564ce02056a930282cb57ab3f15">pos</a> != <a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_variable" href="classHttpHdrRangeIter.html#a52d32525864512d6e66aeb1e71d08345">end</a>);</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;firstRange = *<a class="code hl_variable" href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">range_iter</a>.<a class="code hl_variable" href="classHttpHdrRangeIter.html#a319db564ce02056a930282cb57ab3f15">pos</a>;</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(firstRange);</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>    <a class="code hl_variable" href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">out</a>.<a class="code hl_variable" href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">offset</a> = firstRange-&gt;offset;</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span> </div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>    <span class="keywordflow">return</span> multipart ? <a class="code hl_function" href="classClientHttpRequest.html#a3f3960bd399a7b8e6905d5f95a7e7fdc">mRangeCLen</a>() : firstRange-&gt;length;</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>}</div>
</div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span> </div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span><span class="preprocessor">#if USE_ADAPTATION</span></div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01859" data-start="{" data-end="}">
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#af85263c90594b13b5e367a6dca152c2d"> 1859</a></span><a class="code hl_function" href="classClientHttpRequest.html#af85263c90594b13b5e367a6dca152c2d">ClientHttpRequest::startAdaptation</a>(<span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">Adaptation::ServiceGroupPointer</a> &amp;g)</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>{</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;adaptation needed for &quot;</span> &lt;&lt; <span class="keyword">this</span>);</div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_variable" href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">virginHeadSource</a>);</div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>);</div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>    <a class="code hl_variable" href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">virginHeadSource</a> = <a class="code hl_function" href="classAdaptation_1_1Initiator.html#a00803fe012f61478096a8803ed6472ca">initiateAdaptation</a>(</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>                           <span class="keyword">new</span> <a class="code hl_class" href="classAdaptation_1_1Iterator.html">Adaptation::Iterator</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <span class="keyword">nullptr</span>, <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>, g));</div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span> </div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>    <span class="comment">// we could try to guess whether we can bypass this adaptation</span></div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>    <span class="comment">// initiation failure, but it should not really happen</span></div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>    <a class="code hl_define" href="TextException_8h.html#ad79a19f4098f2506d0aa28628f18fd36">Must</a>(<a class="code hl_function" href="classAdaptation_1_1Initiator.html#ad39c4ea82ce5e14cefb42a41019d36a1">initiated</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">virginHeadSource</a>));</div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>}</div>
</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span> </div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01873" data-start="{" data-end="}">
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#aa1320fd6e5980fd72036190843b5a965"> 1873</a></span><a class="code hl_function" href="classClientHttpRequest.html#aa1320fd6e5980fd72036190843b5a965">ClientHttpRequest::noteAdaptationAnswer</a>(<span class="keyword">const</span> <a class="code hl_class" href="classAdaptation_1_1Answer.html">Adaptation::Answer</a> &amp;answer)</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>{</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_function" href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a>(<span class="keyword">this</span>));     <span class="comment">// indicates bug</span></div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>    <a class="code hl_function" href="classAdaptation_1_1Initiator.html#a94fb4b7d6803403366df089e3f067947">clearAdaptation</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">virginHeadSource</a>);</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>);</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span> </div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>    <span class="keywordflow">switch</span> (answer.<a class="code hl_variable" href="classAdaptation_1_1Answer.html#aa834bcd1e5e37a54e6e35abaa7c7b3ed">kind</a>) {</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAdaptation_1_1Answer.html#af77e5290a9f5573f432692b749bec61ea1d09a8659bbd0fc56e3522dd7d0ef65b">Adaptation::Answer::akForward</a>:</div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>        <a class="code hl_function" href="classClientHttpRequest.html#aa35128b3716ff224baf3e690b7406b0c">handleAdaptedHeader</a>(<span class="keyword">const_cast&lt;</span><a class="code hl_class" href="classHttp_1_1Message.html">Http::Message</a>*<span class="keyword">&gt;</span>(answer.<a class="code hl_variable" href="classAdaptation_1_1Answer.html#aaf7aaa5611fb79f0d8855e328f8e7a95">message</a>.<a class="code hl_function" href="classRefCount.html#a9f2168c1df4a4ab6b7931425d85c37f0">getRaw</a>()));</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span> </div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAdaptation_1_1Answer.html#af77e5290a9f5573f432692b749bec61ea388466c574004524555018863c812e8b">Adaptation::Answer::akBlock</a>:</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>        <a class="code hl_function" href="classClientHttpRequest.html#ad04475d6fd01e4616be790d0304254c8">handleAdaptationBlock</a>(answer);</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span> </div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classAdaptation_1_1Answer.html#af77e5290a9f5573f432692b749bec61ea73176733ff46e4839e5ffd90364c8aef">Adaptation::Answer::akError</a>: {</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> d = <a class="code hl_function" href="Detail_8cc.html#a3daf1a4d3c9feca00e60712558a94558">MakeNamedErrorDetail</a>(<span class="stringliteral">&quot;CLT_REQMOD_ABORT&quot;</span>);</div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>        <a class="code hl_function" href="classClientHttpRequest.html#af12bc3076f1661b2737645b67c61bc84">handleAdaptationFailure</a>(d, !answer.<a class="code hl_variable" href="classAdaptation_1_1Answer.html#af44812656a39cb00ef867fb6ebbf8057">final</a>);</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>    }</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>    }</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>}</div>
</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span> </div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01897" data-start="{" data-end="}">
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#aa35128b3716ff224baf3e690b7406b0c"> 1897</a></span><a class="code hl_function" href="classClientHttpRequest.html#aa35128b3716ff224baf3e690b7406b0c">ClientHttpRequest::handleAdaptedHeader</a>(<a class="code hl_class" href="classHttp_1_1Message.html">Http::Message</a> *msg)</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span>{</div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(msg);</div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span> </div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>    <span class="keywordflow">if</span> (<a class="code hl_class" href="classHttpRequest.html">HttpRequest</a> *new_req = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classHttpRequest.html">HttpRequest</a>*<span class="keyword">&gt;</span>(msg)) {</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>        <a class="code hl_function" href="classClientHttpRequest.html#ab06c843bb34e78fbb741e2c7c9632dff">resetRequest</a>(new_req);</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>.<a class="code hl_function" href="classHttpRequestMethod.html#ae3fea5f21ee623ff0749a67eacc8e9c9">id</a>());</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_class" href="classHttpReply.html">HttpReply</a> *new_rep = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classHttpReply.html">HttpReply</a>*<span class="keyword">&gt;</span>(msg)) {</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85,3, <span class="stringliteral">&quot;REQMOD reply is HTTP reply&quot;</span>);</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span> </div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>        <span class="comment">// subscribe to receive reply body</span></div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>        <span class="keywordflow">if</span> (new_rep-&gt;body_pipe != <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>            <a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a> = new_rep-&gt;body_pipe;</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>            <span class="keywordtype">int</span> consumer_ok = <a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>-&gt;<a class="code hl_function" href="classBodyPipe.html#a6cbd83458f1ccb1ce0adb2e7e82d43b1">setConsumerIfNotLate</a>(<span class="keyword">this</span>);</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>            <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(consumer_ok);</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>        }</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span> </div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>        <a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *<a class="code hl_struct" href="structnode.html">node</a> = (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">tail</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a4660c70e36112cd329b84f7152a671fa">prev</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>        <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *repContext = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *<span class="keyword">&gt;</span>(<a class="code hl_struct" href="structnode.html">node</a>-&gt;data.getRaw());</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>        <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(repContext);</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>        repContext-&gt;<a class="code hl_function" href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">createStoreEntry</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">method</a>, <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">flags</a>);</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span> </div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a22e31cda7d10d32098d899889f54da61">request_satisfaction_mode</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>        <a class="code hl_variable" href="classClientHttpRequest.html#aafded04dda1f651ac69a24bb0be9410e">request_satisfaction_offset</a> = 0;</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>        <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#aae28c5e9a323d60ac8fe8ce98f6eb7c5">replaceHttpReply</a>(new_rep);</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>        <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a5bc295d1b8532fe259f903a6e9128d66">timestampsSet</a>();</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span> </div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>        <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>-&gt;<a class="code hl_variable" href="classAccessLogEntry.html#a19bddcabb9a3d2f290c183a171afa4b3">reply</a> = new_rep;</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span> </div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>) <span class="comment">// no body</span></div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>            <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a3ae4c0876a20686e558e7183b67805f4">complete</a>();</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>        <a class="code hl_variable" href="client__side_8h.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">clientGetMoreData</a>(<a class="code hl_struct" href="structnode.html">node</a>, <span class="keyword">this</span>);</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>    }</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span> </div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>    <span class="comment">// we are done with getting headers (but may be receiving body)</span></div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>    <a class="code hl_function" href="classAdaptation_1_1Initiator.html#a94fb4b7d6803403366df089e3f067947">clearAdaptation</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">virginHeadSource</a>);</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span> </div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#a22e31cda7d10d32098d899889f54da61">request_satisfaction_mode</a>)</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>        <a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>}</div>
</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span> </div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01939" data-start="{" data-end="}">
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ad04475d6fd01e4616be790d0304254c8"> 1939</a></span><a class="code hl_function" href="classClientHttpRequest.html#ad04475d6fd01e4616be790d0304254c8">ClientHttpRequest::handleAdaptationBlock</a>(<span class="keyword">const</span> <a class="code hl_class" href="classAdaptation_1_1Answer.html">Adaptation::Answer</a> &amp;answer)</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>{</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> d = <a class="code hl_function" href="Detail_8cc.html#a3daf1a4d3c9feca00e60712558a94558">MakeNamedErrorDetail</a>(<span class="stringliteral">&quot;REQMOD_BLOCK&quot;</span>);</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>    <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#a83bb32366a62b3f6b0e611c3bb4bf659">detailError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a>, d);</div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>);</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>    <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_function" href="classClientRequestContext.html#a24e8bfe9fb32a61b382c7b6c7f791de1">clientAccessCheckDone</a>(answer.<a class="code hl_function" href="classAdaptation_1_1Answer.html#a907342484050b2b875e7ee6c3b082386">blockedToChecklistAnswer</a>());</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>}</div>
</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span> </div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01948" data-start="{" data-end="}">
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a37139a6352bb99cc7f5e7442bfaf442e"> 1948</a></span><a class="code hl_function" href="classClientHttpRequest.html#a37139a6352bb99cc7f5e7442bfaf442e">ClientHttpRequest::resumeBodyStorage</a>()</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>{</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>)</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span> </div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>    <a class="code hl_function" href="classClientHttpRequest.html#a1dfed151e543e6393eb246f24da36f44">noteMoreBodyDataAvailable</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>);</div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>}</div>
</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span> </div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01957" data-start="{" data-end="}">
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a1dfed151e543e6393eb246f24da36f44"> 1957</a></span><a class="code hl_function" href="classClientHttpRequest.html#a1dfed151e543e6393eb246f24da36f44">ClientHttpRequest::noteMoreBodyDataAvailable</a>(<a class="code hl_class" href="classRefCount.html">BodyPipe::Pointer</a>)</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>{</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a22e31cda7d10d32098d899889f54da61">request_satisfaction_mode</a>);</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span> </div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>    <span class="keywordflow">if</span> (<span class="keywordtype">size_t</span> contentSize = <a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>-&gt;<a class="code hl_function" href="classBodyPipe.html#a1c2a49617812bb676c1d92296ce897fc">buf</a>().<a class="code hl_function" href="classMemBuf.html#aaaf0cc30487417b07680613bcf518dca">contentSize</a>()) {</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>        <span class="keyword">const</span> <span class="keywordtype">size_t</span> spaceAvailable = <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a03097a677184f0c65ad08f031e30fa21">bytesWanted</a>(<a class="code hl_class" href="classRange.html">Range&lt;size_t&gt;</a>(0,contentSize));</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span> </div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>        <span class="keywordflow">if</span> (spaceAvailable &lt; contentSize ) {</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>            <span class="comment">// No or partial body data consuming</span></div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>            <span class="keyword">typedef</span> <a class="code hl_class" href="classNullaryMemFunT.html">NullaryMemFunT&lt;ClientHttpRequest&gt;</a> Dialer;</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>            <a class="code hl_class" href="classRefCount.html">AsyncCall::Pointer</a> call = <a class="code hl_function" href="AsyncCall_8h.html#ab4ed1188674ac6e234bc4e37b384035b">asyncCall</a>(93, 5, <span class="stringliteral">&quot;ClientHttpRequest::resumeBodyStorage&quot;</span>,</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>                                                Dialer(<span class="keyword">this</span>, &amp;<a class="code hl_function" href="classClientHttpRequest.html#a37139a6352bb99cc7f5e7442bfaf442e">ClientHttpRequest::resumeBodyStorage</a>));</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>            <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#af097b6c50d55016f786ca506cff868d6">deferProducer</a>(call);</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>        }</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span> </div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>        <span class="keywordflow">if</span> (!spaceAvailable)</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span> </div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>        <span class="keywordflow">if</span> (spaceAvailable &lt; contentSize )</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>            contentSize = spaceAvailable;</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span> </div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>        <a class="code hl_class" href="classBodyPipeCheckout.html">BodyPipeCheckout</a> bpc(*<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>);</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>        <span class="keyword">const</span> <a class="code hl_class" href="classStoreIOBuffer.html">StoreIOBuffer</a> ioBuf(&amp;bpc.<a class="code hl_variable" href="classBodyPipeCheckout.html#af5cabb26c71cf3560c5fa06d4858f003">buf</a>, <a class="code hl_variable" href="classClientHttpRequest.html#aafded04dda1f651ac69a24bb0be9410e">request_satisfaction_offset</a>, contentSize);</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>        <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a4fddeabe874c22dc83799d0f69a95fd2">write</a>(ioBuf);</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>        <span class="comment">// assume StoreEntry::write() writes the entire ioBuf</span></div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>        <a class="code hl_variable" href="classClientHttpRequest.html#aafded04dda1f651ac69a24bb0be9410e">request_satisfaction_offset</a> += ioBuf.<a class="code hl_variable" href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">length</a>;</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>        bpc.<a class="code hl_variable" href="classBodyPipeCheckout.html#af5cabb26c71cf3560c5fa06d4858f003">buf</a>.<a class="code hl_function" href="classMemBuf.html#ab56abceebd43d65f6634708808911987">consume</a>(contentSize);</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>        bpc.<a class="code hl_function" href="classBodyPipeCheckout.html#a62723d6305175d8cc0933d64ec0e6701">checkIn</a>();</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>    }</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span> </div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>-&gt;<a class="code hl_function" href="classBodyPipe.html#a456c477892ca55fa69d02525a5965283">exhausted</a>()) {</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>        <span class="comment">// XXX: Setting receivedWholeAdaptedReply here is a workaround for a</span></div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>        <span class="comment">// regression, as described in https://bugs.squid-cache.org/show_bug.cgi?id=5187#c6</span></div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a381bca090fdedfee261dda825ee40fa7">receivedWholeAdaptedReply</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Messages_8h.html#a3627f132658efd674ba366496239d303">Important</a>(72), <span class="stringliteral">&quot;WARNING: Squid bug 5187 workaround triggered&quot;</span>);</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>        <a class="code hl_function" href="classClientHttpRequest.html#a4dbc0f19084e278ac577fb6a669c6a40">endRequestSatisfaction</a>();</div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>    }</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>    <span class="comment">// else wait for more body data</span></div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>}</div>
</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span> </div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01999" data-start="{" data-end="}">
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a39c53b2ed9f4a0aab966c303dda97542"> 1999</a></span><a class="code hl_function" href="classClientHttpRequest.html#a39c53b2ed9f4a0aab966c303dda97542">ClientHttpRequest::noteBodyProductionEnded</a>(<a class="code hl_class" href="classRefCount.html">BodyPipe::Pointer</a>)</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>{</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_variable" href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">virginHeadSource</a>);</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span> </div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>    <span class="comment">// distinguish this code path from future noteBodyProducerAborted() that</span></div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>    <span class="comment">// would continue storing/delivering (truncated) reply if necessary (TODO)</span></div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>    <a class="code hl_variable" href="classClientHttpRequest.html#a381bca090fdedfee261dda825ee40fa7">receivedWholeAdaptedReply</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span> </div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>    <span class="comment">// should we end request satisfaction now?</span></div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a> != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>-&gt;<a class="code hl_function" href="classBodyPipe.html#a456c477892ca55fa69d02525a5965283">exhausted</a>())</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>        <a class="code hl_function" href="classClientHttpRequest.html#a4dbc0f19084e278ac577fb6a669c6a40">endRequestSatisfaction</a>();</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>}</div>
</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span> </div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen02013" data-start="{" data-end="}">
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a4dbc0f19084e278ac577fb6a669c6a40"> 2013</a></span><a class="code hl_function" href="classClientHttpRequest.html#a4dbc0f19084e278ac577fb6a669c6a40">ClientHttpRequest::endRequestSatisfaction</a>()</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>{</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85,4, <span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot; ends request satisfaction&quot;</span>);</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a22e31cda7d10d32098d899889f54da61">request_satisfaction_mode</a>);</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>    <a class="code hl_function" href="classBodyConsumer.html#a790352eb36ab2d4e38d9e00247de0c94">stopConsumingFrom</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>);</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span> </div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>    <span class="comment">// TODO: anything else needed to end store entry formation correctly?</span></div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a381bca090fdedfee261dda825ee40fa7">receivedWholeAdaptedReply</a>) {</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>        <span class="comment">// We received the entire reply per receivedWholeAdaptedReply.</span></div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>        <span class="comment">// We are called when we consumed everything received (per our callers).</span></div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>        <span class="comment">// We consume only what we store per noteMoreBodyDataAvailable().</span></div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>        <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a028aa7eef91cf47c704d42ab5ab58a42">completeSuccessfully</a>(<span class="stringliteral">&quot;received, consumed, and, hence, stored the entire REQMOD reply&quot;</span>);</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>        <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#a32b9d771a1b58fd4ae471fcda46cd4c4">completeTruncated</a>(<span class="stringliteral">&quot;REQMOD request satisfaction default&quot;</span>);</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>    }</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>}</div>
</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span> </div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen02031" data-start="{" data-end="}">
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ad39ab5cd4bead17efa5d2a4ace512f29"> 2031</a></span><a class="code hl_function" href="classClientHttpRequest.html#ad39ab5cd4bead17efa5d2a4ace512f29">ClientHttpRequest::noteBodyProducerAborted</a>(<a class="code hl_class" href="classRefCount.html">BodyPipe::Pointer</a>)</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>{</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(!<a class="code hl_variable" href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">virginHeadSource</a>);</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>    <a class="code hl_function" href="classBodyConsumer.html#a790352eb36ab2d4e38d9e00247de0c94">stopConsumingFrom</a>(<a class="code hl_variable" href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">adaptedBodySource</a>);</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span> </div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85,3, <span class="stringliteral">&quot;REQMOD body production failed&quot;</span>);</div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#a22e31cda7d10d32098d899889f54da61">request_satisfaction_mode</a>) { <span class="comment">// too late to recover or serve an error</span></div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> d = <a class="code hl_function" href="Detail_8cc.html#a3daf1a4d3c9feca00e60712558a94558">MakeNamedErrorDetail</a>(<span class="stringliteral">&quot;CLT_REQMOD_RESP_BODY&quot;</span>);</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>        <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_function" href="classHttpRequest.html#a83bb32366a62b3f6b0e611c3bb4bf659">detailError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa684fdd96d3d0db7469e3826589467fe8">ERR_ICAP_FAILURE</a>, d);</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>        <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">Comm::ConnectionPointer</a> c = <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;<a class="code hl_variable" href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">clientConnection</a>;</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>        <a class="code hl_define" href="TextException_8h.html#ad79a19f4098f2506d0aa28628f18fd36">Must</a>(<a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(c));</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>        c-&gt;<a class="code hl_function" href="classComm_1_1Connection.html#a32253e90999f679dc032e19ad50d03ab">close</a>(); <span class="comment">// drastic, but we may be writing a response already</span></div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> d = <a class="code hl_function" href="Detail_8cc.html#a3daf1a4d3c9feca00e60712558a94558">MakeNamedErrorDetail</a>(<span class="stringliteral">&quot;CLT_REQMOD_REQ_BODY&quot;</span>);</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span>        <a class="code hl_function" href="classClientHttpRequest.html#af12bc3076f1661b2737645b67c61bc84">handleAdaptationFailure</a>(d);</div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>    }</div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>}</div>
</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span> </div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen02050" data-start="{" data-end="}">
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#af12bc3076f1661b2737645b67c61bc84"> 2050</a></span><a class="code hl_function" href="classClientHttpRequest.html#af12bc3076f1661b2737645b67c61bc84">ClientHttpRequest::handleAdaptationFailure</a>(<span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">ErrorDetail::Pointer</a> &amp;errDetail, <span class="keywordtype">bool</span> bypassable)</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>{</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85,3, <span class="stringliteral">&quot;handleAdaptationFailure(&quot;</span> &lt;&lt; bypassable &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span> </div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> usedStore = <a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>() &amp;&amp; !<a class="code hl_function" href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">storeEntry</a>()-&gt;<a class="code hl_function" href="classStoreEntry.html#ae4dc05b6c5ca398130c0a155156592d2">isEmpty</a>();</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> usedPipe = <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#ad9f13ecd98f1ef921791a25163226f39">body_pipe</a> != <span class="keyword">nullptr</span> &amp;&amp;</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>                          <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttp_1_1Message.html#ad9f13ecd98f1ef921791a25163226f39">body_pipe</a>-&gt;<a class="code hl_function" href="classBodyPipe.html#a61e05a27a2c607e1edcefb1a6eed3843">consumedSize</a>() &gt; 0;</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span> </div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>    <span class="keywordflow">if</span> (bypassable &amp;&amp; !usedStore &amp;&amp; !usedPipe) {</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>        <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85,3, <span class="stringliteral">&quot;ICAP REQMOD callout failed, bypassing: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>);</div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>)</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>            <a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span>    }</div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span> </div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85,3, <span class="stringliteral">&quot;ICAP REQMOD callout failed, responding with error&quot;</span>);</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span> </div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>    <a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *<a class="code hl_struct" href="structnode.html">node</a> = (<a class="code hl_class" href="classclientStreamNode.html">clientStreamNode</a> *)<a class="code hl_variable" href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">client_stream</a>.<a class="code hl_variable" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">tail</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a4660c70e36112cd329b84f7152a671fa">prev</a>-&gt;<a class="code hl_variable" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">data</a>;</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span>    <a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *repContext = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="classclientReplyContext.html">clientReplyContext</a> *<span class="keyword">&gt;</span>(<a class="code hl_struct" href="structnode.html">node</a>-&gt;data.getRaw());</div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>    <a class="code hl_define" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>(repContext);</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span> </div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>    <a class="code hl_function" href="classClientHttpRequest.html#a476c10011cb11adbff01ab61a23bc059">calloutsError</a>(<a class="code hl_enumvalue" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa684fdd96d3d0db7469e3826589467fe8">ERR_ICAP_FAILURE</a>, errDetail);</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span> </div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>)</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>        <a class="code hl_function" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">doCallouts</a>();</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>}</div>
</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span> </div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen02078" data-start="{" data-end="}">
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#ac7a7063190d20387c2c50488dad8cd4e"> 2078</a></span><a class="code hl_function" href="classClientHttpRequest.html#ac7a7063190d20387c2c50488dad8cd4e">ClientHttpRequest::callException</a>(<span class="keyword">const</span> std::exception &amp;ex)</div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>{</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> clientConn = <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>() ? <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>()-&gt;clientConnection : <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a>(clientConn)) {</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>            <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, 3, <span class="stringliteral">&quot;closing after exception: &quot;</span> &lt;&lt; ex.what());</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>            clientConn-&gt;close(); <span class="comment">// initiate orderly top-to-bottom cleanup</span></div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>        }</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>    }</div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>    <a class="code hl_define" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>(85, <a class="code hl_define" href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a>, <span class="stringliteral">&quot;ClientHttpRequest exception without connection. Ignoring &quot;</span> &lt;&lt; ex.what());</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>    <span class="comment">// XXX: Normally, we mustStop() but we cannot do that here because it is</span></div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>    <span class="comment">// likely to leave Http::Stream and ConnStateData with a dangling http</span></div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>    <span class="comment">// pointer. See r13480 or XXX in Http::Stream class description.</span></div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>}</div>
</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span> </div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span><span class="comment">// XXX: modify and use with ClientRequestContext::clientAccessCheckDone too.</span></div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span><span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen02096" data-start="{" data-end="}">
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"><a class="line" href="classClientHttpRequest.html#a476c10011cb11adbff01ab61a23bc059"> 2096</a></span><a class="code hl_function" href="classClientHttpRequest.html#a476c10011cb11adbff01ab61a23bc059">ClientHttpRequest::calloutsError</a>(<span class="keyword">const</span> <a class="code hl_enumeration" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a> <a class="code hl_function" href="acl_2external_2kerberos__ldap__group_2support_8h.html#a3654b5eb0d17fed9fc1f1dee818ad49f">error</a>, <span class="keyword">const</span> <a class="code hl_class" href="classRefCount.html">ErrorDetail::Pointer</a> &amp;errDetail)</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>{</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>    <span class="comment">// The original author of the code also wanted to pass an errno to</span></div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span>    <span class="comment">// setReplyToError, but it seems unlikely that the errno reflects the</span></div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>    <span class="comment">// true cause of the error at this point, so I did not pass it.</span></div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>) {</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>        <a class="code hl_class" href="classConnStateData.html">ConnStateData</a> * c = <a class="code hl_function" href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">getConn</a>();</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>        <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a> = <a class="code hl_function" href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a>(<a class="code hl_function" href="acl_2external_2kerberos__ldap__group_2support_8h.html#a3654b5eb0d17fed9fc1f1dee818ad49f">error</a>, <a class="code hl_enumvalue" href="namespaceHttp.html#a432f881deb187c726161d6435daec722a6f94589e93c5e1111f2b2ccfc538d9cc">Http::scInternalServerError</a>,</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>                                <span class="keyword">nullptr</span>, c, <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>, <a class="code hl_variable" href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">al</a>);</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span><span class="preprocessor">#if USE_AUTH</span></div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>        <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>-&gt;<a class="code hl_variable" href="classErrorState.html#aaa2499a9aec80fa57d4fe9f54ce1a153">auth_user_request</a> =</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>            c != <span class="keyword">nullptr</span> &amp;&amp; c-&gt;<a class="code hl_function" href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">getAuth</a>() != <span class="keyword">nullptr</span> ? c-&gt;<a class="code hl_function" href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">getAuth</a>() : <a class="code hl_variable" href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">request</a>-&gt;<a class="code hl_variable" href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">auth_user_request</a>;</div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>        <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">error</a>-&gt;<a class="code hl_function" href="classErrorState.html#a8c81559af6790d05dfc0c22447c3709a">detailError</a>(errDetail);</div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>        <a class="code hl_variable" href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">calloutContext</a>-&gt;<a class="code hl_variable" href="classClientRequestContext.html#a808ac8e44e079957a7bde4a46f23c62a">readNextRequest</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>        <span class="keywordflow">if</span> (c != <span class="keyword">nullptr</span>)</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>            c-&gt;<a class="code hl_function" href="classConnStateData.html#a56c3ce7c30a3ab5ac9a83489ee862e20">expectNoForwarding</a>();</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>    }</div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>    <span class="comment">//else if(calloutContext == NULL) is it possible?</span></div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>}</div>
</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span> </div>
<div class="ttc" id="aAccessCheck_8h_html"><div class="ttname"><a href="AccessCheck_8h.html">AccessCheck.h</a></div></div>
<div class="ttc" id="aAnswer_8h_html"><div class="ttname"><a href="Answer_8h.html">Answer.h</a></div></div>
<div class="ttc" id="aAsyncCall_8h_html_a467b8011155e661a2d87e340039ba5bc"><div class="ttname"><a href="AsyncCall_8h.html#a467b8011155e661a2d87e340039ba5bc">ScheduleCallHere</a></div><div class="ttdeci">#define ScheduleCallHere(call)</div><div class="ttdef"><b>Definition</b> <a href="AsyncCall_8h_source.html#l00166">AsyncCall.h:166</a></div></div>
<div class="ttc" id="aAsyncCall_8h_html_ab4ed1188674ac6e234bc4e37b384035b"><div class="ttname"><a href="AsyncCall_8h.html#ab4ed1188674ac6e234bc4e37b384035b">asyncCall</a></div><div class="ttdeci">RefCount&lt; AsyncCallT&lt; Dialer &gt; &gt; asyncCall(int aDebugSection, int aDebugLevel, const char *aName, const Dialer &amp;aDialer)</div><div class="ttdef"><b>Definition</b> <a href="AsyncCall_8h_source.html#l00156">AsyncCall.h:156</a></div></div>
<div class="ttc" id="aAsyncJobCalls_8h_html"><div class="ttname"><a href="AsyncJobCalls_8h.html">AsyncJobCalls.h</a></div></div>
<div class="ttc" id="aClientRequestContext_8h_html"><div class="ttname"><a href="ClientRequestContext_8h.html">ClientRequestContext.h</a></div></div>
<div class="ttc" id="aCommCalls_8h_html_a7e143fa246c3e54c90fa8d20b390b88d"><div class="ttname"><a href="CommCalls_8h.html#a7e143fa246c3e54c90fa8d20b390b88d">commCbCall</a></div><div class="ttdeci">CommCbFunPtrCallT&lt; Dialer &gt; * commCbCall(int debugSection, int debugLevel, const char *callName, const Dialer &amp;dialer)</div><div class="ttdef"><b>Definition</b> <a href="CommCalls_8h_source.html#l00312">CommCalls.h:312</a></div></div>
<div class="ttc" id="aConnection_8h_html"><div class="ttname"><a href="Connection_8h.html">Connection.h</a></div></div>
<div class="ttc" id="aDetail_8cc_html_a3daf1a4d3c9feca00e60712558a94558"><div class="ttname"><a href="Detail_8cc.html#a3daf1a4d3c9feca00e60712558a94558">MakeNamedErrorDetail</a></div><div class="ttdeci">ErrorDetail::Pointer MakeNamedErrorDetail(const char *name)</div><div class="ttdef"><b>Definition</b> <a href="Detail_8cc_source.html#l00054">Detail.cc:54</a></div></div>
<div class="ttc" id="aDetail_8h_html"><div class="ttname"><a href="Detail_8h.html">Detail.h</a></div></div>
<div class="ttc" id="aError_8h_html_a8fc4507124d050ffda9a5e90efbd209a"><div class="ttname"><a href="Error_8h.html#a8fc4507124d050ffda9a5e90efbd209a">errorTypeName</a></div><div class="ttdeci">const char * errorTypeName(err_type err)</div><div class="ttdef"><b>Definition</b> <a href="Error_8h_source.html#l00077">Error.h:77</a></div></div>
<div class="ttc" id="aFilledChecklist_8h_html"><div class="ttname"><a href="FilledChecklist_8h.html">FilledChecklist.h</a></div></div>
<div class="ttc" id="aFwdState_8cc_html_a7878013cfc9139fe220001fd6f127337"><div class="ttname"><a href="FwdState_8cc.html#a7878013cfc9139fe220001fd6f127337">aclFindNfMarkConfig</a></div><div class="ttdeci">Ip::NfMarkConfig aclFindNfMarkConfig(acl_nfmark *head, ACLChecklist *ch)</div><div class="ttdoc">Checks for a netfilter mark value to apply depending on the ACL.</div><div class="ttdef"><b>Definition</b> <a href="FwdState_8cc_source.html#l01470">FwdState.cc:1470</a></div></div>
<div class="ttc" id="aFwdState_8cc_html_a87fba5ba04ec8c40f988dc58da70e86b"><div class="ttname"><a href="FwdState_8cc.html#a87fba5ba04ec8c40f988dc58da70e86b">aclMapTOS</a></div><div class="ttdeci">tos_t aclMapTOS(acl_tos *head, ACLChecklist *ch)</div><div class="ttdoc">Checks for a TOS value to apply depending on the ACL.</div><div class="ttdef"><b>Definition</b> <a href="FwdState_8cc_source.html#l01458">FwdState.cc:1458</a></div></div>
<div class="ttc" id="aFwdState_8h_html"><div class="ttname"><a href="FwdState_8h.html">FwdState.h</a></div></div>
<div class="ttc" id="aHeader_8h_html"><div class="ttname"><a href="Header_8h.html">Header.h</a></div></div>
<div class="ttc" id="aHttpHdrCc_8h_html"><div class="ttname"><a href="HttpHdrCc_8h.html">HttpHdrCc.h</a></div></div>
<div class="ttc" id="aHttpHeader_8h_html_aac9fc01c2b9cda8c02b1f7f8a2a9c78b"><div class="ttname"><a href="HttpHeader_8h.html#aac9fc01c2b9cda8c02b1f7f8a2a9c78b">HttpHeaderPos</a></div><div class="ttdeci">ssize_t HttpHeaderPos</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00045">HttpHeader.h:45</a></div></div>
<div class="ttc" id="aHttpHeader_8h_html_abf5d862281ddf9a5315fcfa5be166c07"><div class="ttname"><a href="HttpHeader_8h.html#abf5d862281ddf9a5315fcfa5be166c07">HttpHeaderInitPos</a></div><div class="ttdeci">#define HttpHeaderInitPos</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00048">HttpHeader.h:48</a></div></div>
<div class="ttc" id="aHttpReply_8h_html"><div class="ttname"><a href="HttpReply_8h.html">HttpReply.h</a></div></div>
<div class="ttc" id="aHttpRequest_8cc_html_a4739298dc79dc234cafa3914208f63ad"><div class="ttname"><a href="HttpRequest_8cc.html#a4739298dc79dc234cafa3914208f63ad">UpdateRequestNotes</a></div><div class="ttdeci">void UpdateRequestNotes(ConnStateData *csd, HttpRequest &amp;request, NotePairs const &amp;helperNotes)</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00757">HttpRequest.cc:757</a></div></div>
<div class="ttc" id="aHttpRequest_8cc_html_a9c833fc483befd50385f75ec1b4eceba"><div class="ttname"><a href="HttpRequest_8cc.html#a9c833fc483befd50385f75ec1b4eceba">httpRequestPack</a></div><div class="ttdeci">void httpRequestPack(void *obj, Packable *p)</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00358">HttpRequest.cc:358</a></div></div>
<div class="ttc" id="aHttpRequest_8h_html"><div class="ttname"><a href="HttpRequest_8h.html">HttpRequest.h</a></div></div>
<div class="ttc" id="aIterator_8h_html"><div class="ttname"><a href="Iterator_8h.html">Iterator.h</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5a16a4df28091bca4eda98565febc8fe36">LOG_TCP_DENIED</a></div><div class="ttdeci">@ LOG_TCP_DENIED</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00055">LogTags.h:55</a></div></div>
<div class="ttc" id="aLogTags_8h_html_ab2f83b3caf1d5c271706d2a6d2e196f5aa5ae6efde2911aca58a1954a66c2aeed"><div class="ttname"><a href="LogTags_8h.html#ab2f83b3caf1d5c271706d2a6d2e196f5aa5ae6efde2911aca58a1954a66c2aeed">LOG_TAG_NONE</a></div><div class="ttdeci">@ LOG_TAG_NONE</div><div class="ttdef"><b>Definition</b> <a href="LogTags_8h_source.html#l00041">LogTags.h:41</a></div></div>
<div class="ttc" id="aMemObject_8h_html"><div class="ttname"><a href="MemObject_8h.html">MemObject.h</a></div></div>
<div class="ttc" id="aNfMarkConfig_8h_html"><div class="ttname"><a href="NfMarkConfig_8h.html">NfMarkConfig.h</a></div></div>
<div class="ttc" id="aParsing_8h_html"><div class="ttname"><a href="Parsing_8h.html">Parsing.h</a></div></div>
<div class="ttc" id="aPool_8cc_html_a161e26ef0307ccb4300ad3ea54bf9fd4"><div class="ttname"><a href="Pool_8cc.html#a161e26ef0307ccb4300ad3ea54bf9fd4">squid_curtime</a></div><div class="ttdeci">time_t squid_curtime</div><div class="ttdef"><b>Definition</b> <a href="stub__libtime_8cc_source.html#l00020">stub_libtime.cc:20</a></div></div>
<div class="ttc" id="aPortCfg_8h_html"><div class="ttname"><a href="PortCfg_8h.html">PortCfg.h</a></div></div>
<div class="ttc" id="aQosConfig_8h_html"><div class="ttname"><a href="QosConfig_8h.html">QosConfig.h</a></div></div>
<div class="ttc" id="aReply_8h_html"><div class="ttname"><a href="Reply_8h.html">Reply.h</a></div></div>
<div class="ttc" id="aSBuf_8h_html_a826aafc8068f24cb125e700733cd2bee"><div class="ttname"><a href="SBuf_8h.html#a826aafc8068f24cb125e700733cd2bee">SBufToCstring</a></div><div class="ttdeci">void SBufToCstring(char *d, const SBuf &amp;s)</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8h_source.html#l00756">SBuf.h:756</a></div></div>
<div class="ttc" id="aServerBump_8h_html"><div class="ttname"><a href="ServerBump_8h.html">ServerBump.h</a></div></div>
<div class="ttc" id="aService_8h_html"><div class="ttname"><a href="Service_8h.html">Service.h</a></div></div>
<div class="ttc" id="aSquidConfig_8cc_html_a75b136e6a1eef61424d84596a404aafe"><div class="ttname"><a href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a></div><div class="ttdeci">class SquidConfig Config</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8cc_source.html#l00012">SquidConfig.cc:12</a></div></div>
<div class="ttc" id="aSquidConfig_8h_html"><div class="ttname"><a href="SquidConfig_8h.html">SquidConfig.h</a></div></div>
<div class="ttc" id="aStore_8h_html"><div class="ttname"><a href="Store_8h.html">Store.h</a></div></div>
<div class="ttc" id="aStrList_8cc_html_aca60d260ede4dbe28a1454b943ff9633"><div class="ttname"><a href="StrList_8cc.html#aca60d260ede4dbe28a1454b943ff9633">strListIsSubstr</a></div><div class="ttdeci">int strListIsSubstr(const String *list, const char *s, char del)</div><div class="ttdef"><b>Definition</b> <a href="StrList_8cc_source.html#l00063">StrList.cc:63</a></div></div>
<div class="ttc" id="aStrList_8h_html"><div class="ttname"><a href="StrList_8h.html">StrList.h</a></div></div>
<div class="ttc" id="aStringConvert_8h_html"><div class="ttname"><a href="StringConvert_8h.html">StringConvert.h</a></div></div>
<div class="ttc" id="aStringConvert_8h_html_abe3faac648d76d22de22d375e730a00a"><div class="ttname"><a href="StringConvert_8h.html#abe3faac648d76d22de22d375e730a00a">StringToSBuf</a></div><div class="ttdeci">SBuf StringToSBuf(const String &amp;s)</div><div class="ttdoc">create a new SBuf from a String by copying contents</div><div class="ttdef"><b>Definition</b> <a href="StringConvert_8h_source.html#l00017">StringConvert.h:17</a></div></div>
<div class="ttc" id="aTextException_8h_html_ad79a19f4098f2506d0aa28628f18fd36"><div class="ttname"><a href="TextException_8h.html#ad79a19f4098f2506d0aa28628f18fd36">Must</a></div><div class="ttdeci">#define Must(condition)</div><div class="ttdef"><b>Definition</b> <a href="TextException_8h_source.html#l00075">TextException.h:75</a></div></div>
<div class="ttc" id="aToken_8h_html"><div class="ttname"><a href="Token_8h.html">Token.h</a></div></div>
<div class="ttc" id="aUri_8cc_html_a7b3d400c54dd0ce685ac6c136ae73fe3"><div class="ttname"><a href="Uri_8cc.html#a7b3d400c54dd0ce685ac6c136ae73fe3">matchDomainName</a></div><div class="ttdeci">int matchDomainName(const char *h, const char *d, MatchDomainNameFlags flags)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00903">Uri.cc:903</a></div></div>
<div class="ttc" id="aUri_8cc_html_a7bced763e70ec14e5e5ef88173302b6b"><div class="ttname"><a href="Uri_8cc.html#a7bced763e70ec14e5e5ef88173302b6b">urlCanonicalCleanWithoutRequest</a></div><div class="ttdeci">char * urlCanonicalCleanWithoutRequest(const SBuf &amp;url, const HttpRequestMethod &amp;method, const AnyP::UriScheme &amp;scheme)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00790">Uri.cc:790</a></div></div>
<div class="ttc" id="aUserRequest_8h_html"><div class="ttname"><a href="UserRequest_8h.html">UserRequest.h</a></div></div>
<div class="ttc" id="aWrite_8h_html"><div class="ttname"><a href="Write_8h.html">Write.h</a></div></div>
<div class="ttc" id="aaccess__log_8h_html"><div class="ttname"><a href="access__log_8h.html">access_log.h</a></div></div>
<div class="ttc" id="aaccess__log_8h_html_a40b99f30ccbf64b3415228c7226beaee"><div class="ttname"><a href="access__log_8h.html#a40b99f30ccbf64b3415228c7226beaee">fvdbCountVia</a></div><div class="ttdeci">void fvdbCountVia(const SBuf &amp;)</div></div>
<div class="ttc" id="aaccess__log_8h_html_a87d8c9354d8a3f2eb8c018518fc68f1f"><div class="ttname"><a href="access__log_8h.html#a87d8c9354d8a3f2eb8c018518fc68f1f">fvdbCountForwarded</a></div><div class="ttdeci">void fvdbCountForwarded(const SBuf &amp;)</div><div class="ttdoc">count occurrences of the given X-Forwarded-For header value</div></div>
<div class="ttc" id="aacl_2Gadgets_8cc_html_a08bdf8035f35f6af7f7d4ada13655efa"><div class="ttname"><a href="acl_2Gadgets_8cc.html#a08bdf8035f35f6af7f7d4ada13655efa">FindDenyInfoPage</a></div><div class="ttdeci">err_type FindDenyInfoPage(const Acl::Answer &amp;answer, const bool redirect_allowed)</div><div class="ttdef"><b>Definition</b> <a href="acl_2Gadgets_8cc_source.html#l00034">Gadgets.cc:34</a></div></div>
<div class="ttc" id="aacl_2Gadgets_8cc_html_a387f34c73ec617a8825e4ec24486fc60"><div class="ttname"><a href="acl_2Gadgets_8cc.html#a387f34c73ec617a8825e4ec24486fc60">aclIsProxyAuth</a></div><div class="ttdeci">bool aclIsProxyAuth(const std::optional&lt; SBuf &gt; &amp;name)</div><div class="ttdef"><b>Definition</b> <a href="acl_2Gadgets_8cc_source.html#l00062">Gadgets.cc:62</a></div></div>
<div class="ttc" id="aacl_2Gadgets_8h_html"><div class="ttname"><a href="acl_2Gadgets_8h.html">Gadgets.h</a></div></div>
<div class="ttc" id="aacl_2external_2kerberos__ldap__group_2support_8h_html_a3654b5eb0d17fed9fc1f1dee818ad49f"><div class="ttname"><a href="acl_2external_2kerberos__ldap__group_2support_8h.html#a3654b5eb0d17fed9fc1f1dee818ad49f">error</a></div><div class="ttdeci">void error(char *format,...)</div></div>
<div class="ttc" id="aassert_8h_html_a33fa45e42155e69ce8d0da0fd978b351"><div class="ttname"><a href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a></div><div class="ttdeci">#define assert(EX)</div><div class="ttdef"><b>Definition</b> <a href="assert_8h_source.html#l00017">assert.h:17</a></div></div>
<div class="ttc" id="aautoconf_8h_html_aa6119eb054c0919b333de6888ac28c75"><div class="ttname"><a href="autoconf_8h.html#aa6119eb054c0919b333de6888ac28c75">USE_AUTH</a></div><div class="ttdeci">#define USE_AUTH</div><div class="ttdef"><b>Definition</b> <a href="autoconf_8h_source.html#l01502">autoconf.h:1502</a></div></div>
<div class="ttc" id="aautoconf_8h_html_aa955ac26436bae87f4774af6c870f762"><div class="ttname"><a href="autoconf_8h.html#aa955ac26436bae87f4774af6c870f762">USE_ADAPTATION</a></div><div class="ttdeci">#define USE_ADAPTATION</div><div class="ttdef"><b>Definition</b> <a href="autoconf_8h_source.html#l01496">autoconf.h:1496</a></div></div>
<div class="ttc" id="acbdata_8cc_html_aa6ed5c53b844c6f8f3e7c39daa051835"><div class="ttname"><a href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid</a></div><div class="ttdeci">int cbdataReferenceValid(const void *p)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8cc_source.html#l00270">cbdata.cc:270</a></div></div>
<div class="ttc" id="acbdata_8h_html_a178af3acec8011dd955016f69e307037"><div class="ttname"><a href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a></div><div class="ttdeci">#define cbdataReferenceDone(var)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8h_source.html#l00357">cbdata.h:357</a></div></div>
<div class="ttc" id="acbdata_8h_html_a23338dbb451f460facd39a8a249bab46"><div class="ttname"><a href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a></div><div class="ttdeci">#define cbdataReference(var)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8h_source.html#l00348">cbdata.h:348</a></div></div>
<div class="ttc" id="acbdata_8h_html_a4710a3530194cffbc7f74fa2b2c4529d"><div class="ttname"><a href="cbdata_8h.html#a4710a3530194cffbc7f74fa2b2c4529d">CBDATA_CLASS_INIT</a></div><div class="ttdeci">#define CBDATA_CLASS_INIT(type)</div><div class="ttdef"><b>Definition</b> <a href="cbdata_8h_source.html#l00325">cbdata.h:325</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html"><div class="ttname"><a href="classACLFilledChecklist.html">ACLFilledChecklist</a></div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8h_source.html#l00033">FilledChecklist.h:34</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_a5521f60eda45233a9424f46161cf8809"><div class="ttname"><a href="classACLFilledChecklist.html#a5521f60eda45233a9424f46161cf8809">ACLFilledChecklist::NonBlockingCheck</a></div><div class="ttdeci">static void NonBlockingCheck(MakingPointer &amp;&amp;p, ACLCB *cb, void *data)</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8h_source.html#l00054">FilledChecklist.h:54</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_a5eede657a1f9b1bfe54ac2ee58af9d2e"><div class="ttname"><a href="classACLFilledChecklist.html#a5eede657a1f9b1bfe54ac2ee58af9d2e">ACLFilledChecklist::my_addr</a></div><div class="ttdeci">Ip::Address my_addr</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8h_source.html#l00099">FilledChecklist.h:99</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_aa75a941c2634f5faa0eef864c4153b93"><div class="ttname"><a href="classACLFilledChecklist.html#aa75a941c2634f5faa0eef864c4153b93">ACLFilledChecklist::src_addr</a></div><div class="ttdeci">Ip::Address src_addr</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8h_source.html#l00097">FilledChecklist.h:97</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_ac9fc7ac3b0ef5a2a0d2811aa762dbeab"><div class="ttname"><a href="classACLFilledChecklist.html#ac9fc7ac3b0ef5a2a0d2811aa762dbeab">ACLFilledChecklist::al</a></div><div class="ttdeci">AccessLogEntry::Pointer al</div><div class="ttdoc">info for the future access.log, and external ACL</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8h_source.html#l00124">FilledChecklist.h:124</a></div></div>
<div class="ttc" id="aclassACLFilledChecklist_html_ae77611904901fa5f796cdd54ff5be235"><div class="ttname"><a href="classACLFilledChecklist.html#ae77611904901fa5f796cdd54ff5be235">ACLFilledChecklist::syncAle</a></div><div class="ttdeci">void syncAle(HttpRequest *adaptedRequest, const char *logUri) const override</div><div class="ttdoc">assigns uninitialized adapted_request and url ALE components</div><div class="ttdef"><b>Definition</b> <a href="FilledChecklist_8cc_source.html#l00110">FilledChecklist.cc:110</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_1_1CacheDetails_html_a02ec662fe003473c6cc317e7b1cda66b"><div class="ttname"><a href="classAccessLogEntry_1_1CacheDetails.html#a02ec662fe003473c6cc317e7b1cda66b">AccessLogEntry::CacheDetails::port</a></div><div class="ttdeci">AnyP::PortCfgPointer port</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00162">AccessLogEntry.h:162</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_1_1CacheDetails_html_a0807169fe49e64321a78126974f31868"><div class="ttname"><a href="classAccessLogEntry_1_1CacheDetails.html#a0807169fe49e64321a78126974f31868">AccessLogEntry::CacheDetails::sslClientCert</a></div><div class="ttdeci">Security::CertPointer sslClientCert</div><div class="ttdoc">cert received from the client</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00160">AccessLogEntry.h:160</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_1_1CacheDetails_html_a17380db1a07c6fa0aa73c3107650a3f6"><div class="ttname"><a href="classAccessLogEntry_1_1CacheDetails.html#a17380db1a07c6fa0aa73c3107650a3f6">AccessLogEntry::CacheDetails::start_time</a></div><div class="ttdeci">struct timeval start_time</div><div class="ttdoc">The time the master transaction started.</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00155">AccessLogEntry.h:155</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_1_1CacheDetails_html_ad2623b54e07c80bf68230b9127ca1878"><div class="ttname"><a href="classAccessLogEntry_1_1CacheDetails.html#ad2623b54e07c80bf68230b9127ca1878">AccessLogEntry::CacheDetails::caddr</a></div><div class="ttdeci">Ip::Address caddr</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00151">AccessLogEntry.h:151</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_1_1SslDetails_html_a950d067714ceddb9129ac1cc7bb6d5ab"><div class="ttname"><a href="classAccessLogEntry_1_1SslDetails.html#a950d067714ceddb9129ac1cc7bb6d5ab">AccessLogEntry::SslDetails::bumpMode</a></div><div class="ttdeci">int bumpMode</div><div class="ttdoc">whether and how the request was SslBumped</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00133">AccessLogEntry.h:133</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html"><div class="ttname"><a href="classAccessLogEntry.html">AccessLogEntry</a></div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00040">AccessLogEntry.h:41</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a19bddcabb9a3d2f290c183a171afa4b3"><div class="ttname"><a href="classAccessLogEntry.html#a19bddcabb9a3d2f290c183a171afa4b3">AccessLogEntry::reply</a></div><div class="ttdeci">HttpReplyPointer reply</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00191">AccessLogEntry.h:191</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a4574f49181917c5496dca9ace95ea344"><div class="ttname"><a href="classAccessLogEntry.html#a4574f49181917c5496dca9ace95ea344">AccessLogEntry::cache</a></div><div class="ttdeci">class AccessLogEntry::CacheDetails cache</div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a550f1fb979566c3e705422eeb6d0b66c"><div class="ttname"><a href="classAccessLogEntry.html#a550f1fb979566c3e705422eeb6d0b66c">AccessLogEntry::hier</a></div><div class="ttdeci">HierarchyLogEntry hier</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00190">AccessLogEntry.h:190</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a551791241b593874d721ffdf04f6b4ed"><div class="ttname"><a href="classAccessLogEntry.html#a551791241b593874d721ffdf04f6b4ed">AccessLogEntry::syncNotes</a></div><div class="ttdeci">void syncNotes(HttpRequest *request)</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8cc_source.html#l00088">AccessLogEntry.cc:88</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a7526170211aae1d9c98e2866281e7f5c"><div class="ttname"><a href="classAccessLogEntry.html#a7526170211aae1d9c98e2866281e7f5c">AccessLogEntry::tcpClient</a></div><div class="ttdeci">Comm::ConnectionPointer tcpClient</div><div class="ttdoc">TCP/IP level details about the client connection.</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00080">AccessLogEntry.h:80</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_a92312350a82deb4331b171bdea7ff3d5"><div class="ttname"><a href="classAccessLogEntry.html#a92312350a82deb4331b171bdea7ff3d5">AccessLogEntry::request</a></div><div class="ttdeci">HttpRequest * request</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00192">AccessLogEntry.h:192</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_ac8bced80c5b9d493aa9e97e8e2aa9866"><div class="ttname"><a href="classAccessLogEntry.html#ac8bced80c5b9d493aa9e97e8e2aa9866">AccessLogEntry::setVirginUrlForMissingRequest</a></div><div class="ttdeci">void setVirginUrlForMissingRequest(const SBuf &amp;vu)</div><div class="ttdoc">Remember Client URI (or equivalent) when there is no HttpRequest.</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00260">AccessLogEntry.h:260</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_ad81723baa479b57c574cca4a3d29b25c"><div class="ttname"><a href="classAccessLogEntry.html#ad81723baa479b57c574cca4a3d29b25c">AccessLogEntry::proxyProtocolHeader</a></div><div class="ttdeci">ProxyProtocol::HeaderPointer proxyProtocolHeader</div><div class="ttdoc">see ConnStateData::proxyProtocolHeader_</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8h_source.html#l00206">AccessLogEntry.h:206</a></div></div>
<div class="ttc" id="aclassAccessLogEntry_html_af282ed52728346f9a1549a67e4cc8fb2"><div class="ttname"><a href="classAccessLogEntry.html#af282ed52728346f9a1549a67e4cc8fb2">AccessLogEntry::ssl</a></div><div class="ttdeci">class AccessLogEntry::SslDetails ssl</div></div>
<div class="ttc" id="aclassAccessLogEntry_html_af60bc81e8501b430cbb4e209699c0091"><div class="ttname"><a href="classAccessLogEntry.html#af60bc81e8501b430cbb4e209699c0091">AccessLogEntry::updateError</a></div><div class="ttdeci">void updateError(const Error &amp;)</div><div class="ttdoc">sets (or updates the already stored) transaction error as needed</div><div class="ttdef"><b>Definition</b> <a href="AccessLogEntry_8cc_source.html#l00198">AccessLogEntry.cc:198</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html"><div class="ttname"><a href="classAcl_1_1Answer.html">Acl::Answer</a></div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00053">Acl.h:54</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_a2c742f67e11b7b92c02b286f91339298"><div class="ttname"><a href="classAcl_1_1Answer.html#a2c742f67e11b7b92c02b286f91339298">Acl::Answer::kind</a></div><div class="ttdeci">int kind</div><div class="ttdoc">the matched custom access list verb (or zero)</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00099">Acl.h:99</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_a4833930fc429062f28b63b96ba17861a"><div class="ttname"><a href="classAcl_1_1Answer.html#a4833930fc429062f28b63b96ba17861a">Acl::Answer::denied</a></div><div class="ttdeci">bool denied() const</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00088">Acl.h:88</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_a8a8bb1976fa15edce01b4af92dbafad8"><div class="ttname"><a href="classAcl_1_1Answer.html#a8a8bb1976fa15edce01b4af92dbafad8">Acl::Answer::lastCheckDescription</a></div><div class="ttdeci">const SBuf &amp; lastCheckDescription() const</div><div class="ttdoc">describes the ACL that was evaluated last while obtaining this answer (for debugging)</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8cc_source.html#l00123">Acl.cc:123</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_aba69510c81a5b32017e59c7187062392"><div class="ttname"><a href="classAcl_1_1Answer.html#aba69510c81a5b32017e59c7187062392">Acl::Answer::conflicted</a></div><div class="ttdeci">bool conflicted() const</div><div class="ttdoc">whether Squid is uncertain about the allowed() or denied() answer</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00091">Acl.h:91</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_af1a1444d19654eb50f7a4323b225f845"><div class="ttname"><a href="classAcl_1_1Answer.html#af1a1444d19654eb50f7a4323b225f845">Acl::Answer::allowed</a></div><div class="ttdeci">bool allowed() const</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00082">Acl.h:82</a></div></div>
<div class="ttc" id="aclassAcl_1_1Answer_html_af71cc70f0bd7fabbe328876a6ff73f07"><div class="ttname"><a href="classAcl_1_1Answer.html#af71cc70f0bd7fabbe328876a6ff73f07">Acl::Answer::lastCheckedName</a></div><div class="ttdeci">std::optional&lt; SBuf &gt; lastCheckedName</div><div class="ttdoc">the name of the ACL (if any) that was evaluated last while obtaining this answer</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00105">Acl.h:105</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1AccessCheck_html_abbd888b460056d88c416343c0107331c"><div class="ttname"><a href="classAdaptation_1_1AccessCheck.html#abbd888b460056d88c416343c0107331c">Adaptation::AccessCheck::Start</a></div><div class="ttdeci">static bool Start(Method method, VectPoint vp, HttpRequest *req, HttpReply *, const AccessLogEntryPointer &amp;, Adaptation::Initiator *)</div><div class="ttdef"><b>Definition</b> <a href="AccessCheck_8cc_source.html#l00030">AccessCheck.cc:30</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Answer_html"><div class="ttname"><a href="classAdaptation_1_1Answer.html">Adaptation::Answer</a></div><div class="ttdoc">summarizes adaptation service answer for the noteAdaptationAnswer() API</div><div class="ttdef"><b>Definition</b> <a href="Answer_8h_source.html#l00024">Answer.h:25</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Answer_html_a907342484050b2b875e7ee6c3b082386"><div class="ttname"><a href="classAdaptation_1_1Answer.html#a907342484050b2b875e7ee6c3b082386">Adaptation::Answer::blockedToChecklistAnswer</a></div><div class="ttdeci">Acl::Answer blockedToChecklistAnswer() const</div><div class="ttdoc">creates an Acl::Answer from akBlock answer</div><div class="ttdef"><b>Definition</b> <a href="Answer_8cc_source.html#l00044">Answer.cc:44</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Answer_html_aa834bcd1e5e37a54e6e35abaa7c7b3ed"><div class="ttname"><a href="classAdaptation_1_1Answer.html#aa834bcd1e5e37a54e6e35abaa7c7b3ed">Adaptation::Answer::kind</a></div><div class="ttdeci">Kind kind</div><div class="ttdoc">the type of the answer</div><div class="ttdef"><b>Definition</b> <a href="Answer_8h_source.html#l00047">Answer.h:47</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Answer_html_aaf7aaa5611fb79f0d8855e328f8e7a95"><div class="ttname"><a href="classAdaptation_1_1Answer.html#aaf7aaa5611fb79f0d8855e328f8e7a95">Adaptation::Answer::message</a></div><div class="ttdeci">Http::MessagePointer message</div><div class="ttdoc">HTTP request or response to forward.</div><div class="ttdef"><b>Definition</b> <a href="Answer_8h_source.html#l00044">Answer.h:44</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Answer_html_af44812656a39cb00ef867fb6ebbf8057"><div class="ttname"><a href="classAdaptation_1_1Answer.html#af44812656a39cb00ef867fb6ebbf8057">Adaptation::Answer::final</a></div><div class="ttdeci">bool final</div><div class="ttdoc">whether the error, if any, cannot be bypassed</div><div class="ttdef"><b>Definition</b> <a href="Answer_8h_source.html#l00046">Answer.h:46</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Answer_html_af77e5290a9f5573f432692b749bec61ea1d09a8659bbd0fc56e3522dd7d0ef65b"><div class="ttname"><a href="classAdaptation_1_1Answer.html#af77e5290a9f5573f432692b749bec61ea1d09a8659bbd0fc56e3522dd7d0ef65b">Adaptation::Answer::akForward</a></div><div class="ttdeci">@ akForward</div><div class="ttdoc">forward the supplied adapted HTTP message</div><div class="ttdef"><b>Definition</b> <a href="Answer_8h_source.html#l00029">Answer.h:29</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Answer_html_af77e5290a9f5573f432692b749bec61ea388466c574004524555018863c812e8b"><div class="ttname"><a href="classAdaptation_1_1Answer.html#af77e5290a9f5573f432692b749bec61ea388466c574004524555018863c812e8b">Adaptation::Answer::akBlock</a></div><div class="ttdeci">@ akBlock</div><div class="ttdoc">block or deny the master xaction; see authority</div><div class="ttdef"><b>Definition</b> <a href="Answer_8h_source.html#l00030">Answer.h:30</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Answer_html_af77e5290a9f5573f432692b749bec61ea73176733ff46e4839e5ffd90364c8aef"><div class="ttname"><a href="classAdaptation_1_1Answer.html#af77e5290a9f5573f432692b749bec61ea73176733ff46e4839e5ffd90364c8aef">Adaptation::Answer::akError</a></div><div class="ttdeci">@ akError</div><div class="ttdoc">no adapted message will come; see bypassable</div><div class="ttdef"><b>Definition</b> <a href="Answer_8h_source.html#l00031">Answer.h:31</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Initiator_html_a00803fe012f61478096a8803ed6472ca"><div class="ttname"><a href="classAdaptation_1_1Initiator.html#a00803fe012f61478096a8803ed6472ca">Adaptation::Initiator::initiateAdaptation</a></div><div class="ttdeci">CbcPointer&lt; Initiate &gt; initiateAdaptation(Initiate *x)</div><div class="ttdoc">&lt; starts freshly created initiate and returns a safe pointer to it</div><div class="ttdef"><b>Definition</b> <a href="Initiator_8cc_source.html#l00023">Initiator.cc:23</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Initiator_html_a94fb4b7d6803403366df089e3f067947"><div class="ttname"><a href="classAdaptation_1_1Initiator.html#a94fb4b7d6803403366df089e3f067947">Adaptation::Initiator::clearAdaptation</a></div><div class="ttdeci">void clearAdaptation(CbcPointer&lt; Initiate &gt; &amp;x)</div><div class="ttdoc">clears the pointer (does not call announceInitiatorAbort)</div><div class="ttdef"><b>Definition</b> <a href="Initiator_8cc_source.html#l00032">Initiator.cc:32</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Initiator_html_ac6f89220ffe700ed34f09c5f6d66a70d"><div class="ttname"><a href="classAdaptation_1_1Initiator.html#ac6f89220ffe700ed34f09c5f6d66a70d">Adaptation::Initiator::announceInitiatorAbort</a></div><div class="ttdeci">void announceInitiatorAbort(CbcPointer&lt; Initiate &gt; &amp;x)</div><div class="ttdoc">inform the transaction about abnormal termination and clear the pointer</div><div class="ttdef"><b>Definition</b> <a href="Initiator_8cc_source.html#l00038">Initiator.cc:38</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Initiator_html_ad39c4ea82ce5e14cefb42a41019d36a1"><div class="ttname"><a href="classAdaptation_1_1Initiator.html#ad39c4ea82ce5e14cefb42a41019d36a1">Adaptation::Initiator::initiated</a></div><div class="ttdeci">bool initiated(const CbcPointer&lt; AsyncJob &gt; &amp;job) const</div><div class="ttdoc">Must(initiated(initiate)) instead of Must(initiate.set()), for clarity.</div><div class="ttdef"><b>Definition</b> <a href="Initiator_8h_source.html#l00052">Initiator.h:52</a></div></div>
<div class="ttc" id="aclassAdaptation_1_1Iterator_html"><div class="ttname"><a href="classAdaptation_1_1Iterator.html">Adaptation::Iterator</a></div><div class="ttdoc">iterates services in ServiceGroup, starting adaptation launchers</div><div class="ttdef"><b>Definition</b> <a href="Iterator_8h_source.html#l00031">Iterator.h:32</a></div></div>
<div class="ttc" id="aclassAnyP_1_1UriScheme_html"><div class="ttname"><a href="classAnyP_1_1UriScheme.html">AnyP::UriScheme</a></div><div class="ttdef"><b>Definition</b> <a href="UriScheme_8h_source.html#l00031">UriScheme.h:32</a></div></div>
<div class="ttc" id="aclassAnyP_1_1UriScheme_html_ad403d4352324e814c01a859a11678a31"><div class="ttname"><a href="classAnyP_1_1UriScheme.html#ad403d4352324e814c01a859a11678a31">AnyP::UriScheme::defaultPort</a></div><div class="ttdeci">Port defaultPort() const</div><div class="ttdef"><b>Definition</b> <a href="UriScheme_8cc_source.html#l00071">UriScheme.cc:71</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html"><div class="ttname"><a href="classAnyP_1_1Uri.html">AnyP::Uri</a></div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00031">Uri.h:32</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_a267687947070d739a63da8a42969f12c"><div class="ttname"><a href="classAnyP_1_1Uri.html#a267687947070d739a63da8a42969f12c">AnyP::Uri::getScheme</a></div><div class="ttdeci">AnyP::UriScheme const &amp; getScheme() const</div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00058">Uri.h:58</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_a2c86b2285f5a7f86cd1862e8d7b8fe48"><div class="ttname"><a href="classAnyP_1_1Uri.html#a2c86b2285f5a7f86cd1862e8d7b8fe48">AnyP::Uri::authority</a></div><div class="ttdeci">SBuf &amp; authority(bool requirePort=false) const</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00721">Uri.cc:721</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_a446037a0d5240188b96983e256dfe48b"><div class="ttname"><a href="classAnyP_1_1Uri.html#a446037a0d5240188b96983e256dfe48b">AnyP::Uri::setScheme</a></div><div class="ttdeci">void setScheme(const AnyP::ProtocolType &amp;p, const char *str)</div><div class="ttdoc">convert the URL scheme to that given</div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00061">Uri.h:61</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_a4499a7819274e2dbe4ceb399e77e250d"><div class="ttname"><a href="classAnyP_1_1Uri.html#a4499a7819274e2dbe4ceb399e77e250d">AnyP::Uri::path</a></div><div class="ttdeci">void path(const char *p)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00096">Uri.h:96</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_a77bfb036e33e7d6d3a9c0fd7ae1451fc"><div class="ttname"><a href="classAnyP_1_1Uri.html#a77bfb036e33e7d6d3a9c0fd7ae1451fc">AnyP::Uri::cleanup</a></div><div class="ttdeci">static char * cleanup(const char *uri)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l01076">Uri.cc:1076</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_aa09ef977328523ec48e7440c83d728d3"><div class="ttname"><a href="classAnyP_1_1Uri.html#aa09ef977328523ec48e7440c83d728d3">AnyP::Uri::port</a></div><div class="ttdeci">void port(const Port p)</div><div class="ttdoc">reset authority port subcomponent</div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00090">Uri.h:90</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_aab379cecc273683d9744197a8a2efe3f"><div class="ttname"><a href="classAnyP_1_1Uri.html#aab379cecc273683d9744197a8a2efe3f">AnyP::Uri::host</a></div><div class="ttdeci">void host(const char *src)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00142">Uri.cc:142</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_abc68f14b9b29923b2864b862eea8ea64"><div class="ttname"><a href="classAnyP_1_1Uri.html#abc68f14b9b29923b2864b862eea8ea64">AnyP::Uri::parse</a></div><div class="ttdeci">bool parse(const HttpRequestMethod &amp;, const SBuf &amp;url)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8cc_source.html#l00314">Uri.cc:314</a></div></div>
<div class="ttc" id="aclassAnyP_1_1Uri_html_aff2c3402a1b8f1ebc50bc6a3e5933708"><div class="ttname"><a href="classAnyP_1_1Uri.html#aff2c3402a1b8f1ebc50bc6a3e5933708">AnyP::Uri::userInfo</a></div><div class="ttdeci">void userInfo(const SBuf &amp;s)</div><div class="ttdef"><b>Definition</b> <a href="Uri_8h_source.html#l00070">Uri.h:70</a></div></div>
<div class="ttc" id="aclassAsyncJob_html"><div class="ttname"><a href="classAsyncJob.html">AsyncJob</a></div><div class="ttdef"><b>Definition</b> <a href="AsyncJob_8h_source.html#l00031">AsyncJob.h:32</a></div></div>
<div class="ttc" id="aclassAuth_1_1UserRequest_html_a72983e97d9364c9b197308d1f3211b9d"><div class="ttname"><a href="classAuth_1_1UserRequest.html#a72983e97d9364c9b197308d1f3211b9d">Auth::UserRequest::denyMessage</a></div><div class="ttdeci">char const * denyMessage(char const *const default_message=nullptr) const</div><div class="ttdef"><b>Definition</b> <a href="UserRequest_8cc_source.html#l00128">UserRequest.cc:128</a></div></div>
<div class="ttc" id="aclassBodyConsumer_html_a790352eb36ab2d4e38d9e00247de0c94"><div class="ttname"><a href="classBodyConsumer.html#a790352eb36ab2d4e38d9e00247de0c94">BodyConsumer::stopConsumingFrom</a></div><div class="ttdeci">void stopConsumingFrom(RefCount&lt; BodyPipe &gt; &amp;)</div><div class="ttdef"><b>Definition</b> <a href="BodyPipe_8cc_source.html#l00118">BodyPipe.cc:118</a></div></div>
<div class="ttc" id="aclassBodyPipeCheckout_html"><div class="ttname"><a href="classBodyPipeCheckout.html">BodyPipeCheckout</a></div><div class="ttdef"><b>Definition</b> <a href="BodyPipe_8h_source.html#l00061">BodyPipe.h:62</a></div></div>
<div class="ttc" id="aclassBodyPipeCheckout_html_a62723d6305175d8cc0933d64ec0e6701"><div class="ttname"><a href="classBodyPipeCheckout.html#a62723d6305175d8cc0933d64ec0e6701">BodyPipeCheckout::checkIn</a></div><div class="ttdeci">void checkIn()</div><div class="ttdef"><b>Definition</b> <a href="BodyPipe_8cc_source.html#l00501">BodyPipe.cc:501</a></div></div>
<div class="ttc" id="aclassBodyPipeCheckout_html_af5cabb26c71cf3560c5fa06d4858f003"><div class="ttname"><a href="classBodyPipeCheckout.html#af5cabb26c71cf3560c5fa06d4858f003">BodyPipeCheckout::buf</a></div><div class="ttdeci">MemBuf &amp; buf</div><div class="ttdef"><b>Definition</b> <a href="BodyPipe_8h_source.html#l00074">BodyPipe.h:74</a></div></div>
<div class="ttc" id="aclassBodyPipe_html_a1c2a49617812bb676c1d92296ce897fc"><div class="ttname"><a href="classBodyPipe.html#a1c2a49617812bb676c1d92296ce897fc">BodyPipe::buf</a></div><div class="ttdeci">const MemBuf &amp; buf() const</div><div class="ttdef"><b>Definition</b> <a href="BodyPipe_8h_source.html#l00137">BodyPipe.h:137</a></div></div>
<div class="ttc" id="aclassBodyPipe_html_a456c477892ca55fa69d02525a5965283"><div class="ttname"><a href="classBodyPipe.html#a456c477892ca55fa69d02525a5965283">BodyPipe::exhausted</a></div><div class="ttdeci">bool exhausted() const</div><div class="ttdef"><b>Definition</b> <a href="BodyPipe_8cc_source.html#l00174">BodyPipe.cc:174</a></div></div>
<div class="ttc" id="aclassBodyPipe_html_a61e05a27a2c607e1edcefb1a6eed3843"><div class="ttname"><a href="classBodyPipe.html#a61e05a27a2c607e1edcefb1a6eed3843">BodyPipe::consumedSize</a></div><div class="ttdeci">uint64_t consumedSize() const</div><div class="ttdef"><b>Definition</b> <a href="BodyPipe_8h_source.html#l00111">BodyPipe.h:111</a></div></div>
<div class="ttc" id="aclassBodyPipe_html_a6cbd83458f1ccb1ce0adb2e7e82d43b1"><div class="ttname"><a href="classBodyPipe.html#a6cbd83458f1ccb1ce0adb2e7e82d43b1">BodyPipe::setConsumerIfNotLate</a></div><div class="ttdeci">bool setConsumerIfNotLate(const Consumer::Pointer &amp;aConsumer)</div><div class="ttdef"><b>Definition</b> <a href="BodyPipe_8cc_source.html#l00228">BodyPipe.cc:228</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html"><div class="ttname"><a href="classClientHttpRequest.html">ClientHttpRequest</a></div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00030">client_side_request.h:35</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a02e882b436ac3874015529dc62a5291f"><div class="ttname"><a href="classClientHttpRequest.html#a02e882b436ac3874015529dc62a5291f">ClientHttpRequest::prepPartialResponseGeneration</a></div><div class="ttdeci">int64_t prepPartialResponseGeneration()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01834">client_side_request.cc:1834</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a04dd0ad1467801e14f12166d39767aa4"><div class="ttname"><a href="classClientHttpRequest.html#a04dd0ad1467801e14f12166d39767aa4">ClientHttpRequest::ClientHttpRequest</a></div><div class="ttdeci">ClientHttpRequest(ConnStateData *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00128">client_side_request.cc:128</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a0fd2f80aff7232c86a9e83ae876b3493"><div class="ttname"><a href="classClientHttpRequest.html#a0fd2f80aff7232c86a9e83ae876b3493">ClientHttpRequest::noteAdaptationAclCheckDone</a></div><div class="ttdeci">void noteAdaptationAclCheckDone(Adaptation::ServiceGroupPointer) override</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00693">client_side_request.cc:693</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a1dfed151e543e6393eb246f24da36f44"><div class="ttname"><a href="classClientHttpRequest.html#a1dfed151e543e6393eb246f24da36f44">ClientHttpRequest::noteMoreBodyDataAvailable</a></div><div class="ttdeci">void noteMoreBodyDataAvailable(BodyPipe::Pointer) override</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01957">client_side_request.cc:1957</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a220035029f64b125f600da80744a9ed1"><div class="ttname"><a href="classClientHttpRequest.html#a220035029f64b125f600da80744a9ed1">ClientHttpRequest::out</a></div><div class="ttdeci">struct ClientHttpRequest::Out out</div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a22e31cda7d10d32098d899889f54da61"><div class="ttname"><a href="classClientHttpRequest.html#a22e31cda7d10d32098d899889f54da61">ClientHttpRequest::request_satisfaction_mode</a></div><div class="ttdeci">bool request_satisfaction_mode</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00249">client_side_request.h:249</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a27dbe3e5b15be5edba058de0cfbf9f92"><div class="ttname"><a href="classClientHttpRequest.html#a27dbe3e5b15be5edba058de0cfbf9f92">ClientHttpRequest::clearRequest</a></div><div class="ttdeci">void clearRequest()</div><div class="ttdoc">resets the current request and log_uri to nil</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01584">client_side_request.cc:1584</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a2becc63f591bbc0b40542099c1bb05a9"><div class="ttname"><a href="classClientHttpRequest.html#a2becc63f591bbc0b40542099c1bb05a9">ClientHttpRequest::request</a></div><div class="ttdeci">HttpRequest *const request</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00130">client_side_request.h:130</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a37139a6352bb99cc7f5e7442bfaf442e"><div class="ttname"><a href="classClientHttpRequest.html#a37139a6352bb99cc7f5e7442bfaf442e">ClientHttpRequest::resumeBodyStorage</a></div><div class="ttdeci">void resumeBodyStorage()</div><div class="ttdoc">called by StoreEntry when it has more buffer space available</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01948">client_side_request.cc:1948</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a381bca090fdedfee261dda825ee40fa7"><div class="ttname"><a href="classClientHttpRequest.html#a381bca090fdedfee261dda825ee40fa7">ClientHttpRequest::receivedWholeAdaptedReply</a></div><div class="ttdeci">bool receivedWholeAdaptedReply</div><div class="ttdoc">noteBodyProductionEnded() was called</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00247">client_side_request.h:247</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a39c53b2ed9f4a0aab966c303dda97542"><div class="ttname"><a href="classClientHttpRequest.html#a39c53b2ed9f4a0aab966c303dda97542">ClientHttpRequest::noteBodyProductionEnded</a></div><div class="ttdeci">void noteBodyProductionEnded(BodyPipe::Pointer) override</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01999">client_side_request.cc:1999</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a3ae260da15d4ddba163608ce64145d25"><div class="ttname"><a href="classClientHttpRequest.html#a3ae260da15d4ddba163608ce64145d25">ClientHttpRequest::processRequest</a></div><div class="ttdeci">void processRequest()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01360">client_side_request.cc:1360</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a3d120f7d2ea8044fe284eb015748c4fe"><div class="ttname"><a href="classClientHttpRequest.html#a3d120f7d2ea8044fe284eb015748c4fe">ClientHttpRequest::loggingEntry_</a></div><div class="ttdeci">StoreEntry * loggingEntry_</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00189">client_side_request.h:189</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a3e8660eb3f78ddb12f5f36f716755109"><div class="ttname"><a href="classClientHttpRequest.html#a3e8660eb3f78ddb12f5f36f716755109">ClientHttpRequest::gotEnough</a></div><div class="ttdeci">bool gotEnough() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01479">client_side_request.cc:1479</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a3f3960bd399a7b8e6905d5f95a7e7fdc"><div class="ttname"><a href="classClientHttpRequest.html#a3f3960bd399a7b8e6905d5f95a7e7fdc">ClientHttpRequest::mRangeCLen</a></div><div class="ttdeci">int64_t mRangeCLen() const</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l00740">client_side.cc:740</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a3f6d0f7008f5302283e91937cdc67f75"><div class="ttname"><a href="classClientHttpRequest.html#a3f6d0f7008f5302283e91937cdc67f75">ClientHttpRequest::log_uri</a></div><div class="ttdeci">char *const log_uri</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00141">client_side_request.h:141</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a476c10011cb11adbff01ab61a23bc059"><div class="ttname"><a href="classClientHttpRequest.html#a476c10011cb11adbff01ab61a23bc059">ClientHttpRequest::calloutsError</a></div><div class="ttdeci">void calloutsError(const err_type, const ErrorDetail::Pointer &amp;)</div><div class="ttdoc">Build an error reply. For use with the callouts.</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l02096">client_side_request.cc:2096</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a479a52ea68d38e907287b7e921d4fd68"><div class="ttname"><a href="classClientHttpRequest.html#a479a52ea68d38e907287b7e921d4fd68">ClientHttpRequest::logRequest</a></div><div class="ttdeci">void logRequest()</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l00374">client_side.cc:374</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a48c8c21eac3e3e223b313902fe14e692"><div class="ttname"><a href="classClientHttpRequest.html#a48c8c21eac3e3e223b313902fe14e692">ClientHttpRequest::absorbLogUri</a></div><div class="ttdeci">void absorbLogUri(char *)</div><div class="ttdoc">assigns log_uri with aUri without copying the entire C-string</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01810">client_side_request.cc:1810</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a4ba011f5f09d32fba56441c385752255"><div class="ttname"><a href="classClientHttpRequest.html#a4ba011f5f09d32fba56441c385752255">ClientHttpRequest::getConn</a></div><div class="ttdeci">ConnStateData * getConn() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00068">client_side_request.h:68</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a4dbc0f19084e278ac577fb6a669c6a40"><div class="ttname"><a href="classClientHttpRequest.html#a4dbc0f19084e278ac577fb6a669c6a40">ClientHttpRequest::endRequestSatisfaction</a></div><div class="ttdeci">void endRequestSatisfaction()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l02013">client_side_request.cc:2013</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a52f95c3b38b4cacf5fa0e4d157b6eac6"><div class="ttname"><a href="classClientHttpRequest.html#a52f95c3b38b4cacf5fa0e4d157b6eac6">ClientHttpRequest::freeResources</a></div><div class="ttdeci">void freeResources()</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l00463">client_side.cc:463</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a53f0bfbec60d40769f21aff66eeaaa79"><div class="ttname"><a href="classClientHttpRequest.html#a53f0bfbec60d40769f21aff66eeaaa79">ClientHttpRequest::rangeBoundaryStr</a></div><div class="ttdeci">String rangeBoundaryStr() const</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l00780">client_side.cc:780</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a5912c3e9af285d3f77ec815c719b8105"><div class="ttname"><a href="classClientHttpRequest.html#a5912c3e9af285d3f77ec815c719b8105">ClientHttpRequest::initRequest</a></div><div class="ttdeci">void initRequest(HttpRequest *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01511">client_side_request.cc:1511</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a628397814ae1783a4cecbe90ab9b010a"><div class="ttname"><a href="classClientHttpRequest.html#a628397814ae1783a4cecbe90ab9b010a">ClientHttpRequest::setLogUriToRequestUri</a></div><div class="ttdeci">void setLogUriToRequestUri()</div><div class="ttdoc">sets log_uri when we know the current request</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01786">client_side_request.cc:1786</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a68e1aa2eaed3852cef68f86d4a1865c2"><div class="ttname"><a href="classClientHttpRequest.html#a68e1aa2eaed3852cef68f86d4a1865c2">ClientHttpRequest::checkForInternalAccess</a></div><div class="ttdeci">void checkForInternalAccess()</div><div class="ttdoc">Checks whether the current request is internal and adjusts it accordingly.</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01550">client_side_request.cc:1550</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a6c8eb3e0781de2af44142a360eec1738"><div class="ttname"><a href="classClientHttpRequest.html#a6c8eb3e0781de2af44142a360eec1738">ClientHttpRequest::updateError</a></div><div class="ttdeci">void updateError(const Error &amp;)</div><div class="ttdoc">if necessary, stores new error information (if any)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01470">client_side_request.cc:1470</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a72bfe474054a6fad7efc6aab9b18e431"><div class="ttname"><a href="classClientHttpRequest.html#a72bfe474054a6fad7efc6aab9b18e431">ClientHttpRequest::virginHeadSource</a></div><div class="ttdeci">CbcPointer&lt; Adaptation::Initiate &gt; virginHeadSource</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00243">client_side_request.h:243</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a7473743cac10ac76866ed9dd147d2f66"><div class="ttname"><a href="classClientHttpRequest.html#a7473743cac10ac76866ed9dd147d2f66">ClientHttpRequest::~ClientHttpRequest</a></div><div class="ttdeci">~ClientHttpRequest() override</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00235">client_side_request.cc:235</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a76420f9c4799ef8132d4e11dc494b5ef"><div class="ttname"><a href="classClientHttpRequest.html#a76420f9c4799ef8132d4e11dc494b5ef">ClientHttpRequest::updateLoggingTags</a></div><div class="ttdeci">void updateLoggingTags(const LogTags_ot code)</div><div class="ttdoc">update the code in the transaction processing tags</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00091">client_side_request.h:91</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a77f852cb942a8f0372648b7209853927"><div class="ttname"><a href="classClientHttpRequest.html#a77f852cb942a8f0372648b7209853927">ClientHttpRequest::store_id</a></div><div class="ttdeci">String store_id</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00143">client_side_request.h:143</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a7b72433c2b94db09d5fa9725a2a189f0"><div class="ttname"><a href="classClientHttpRequest.html#a7b72433c2b94db09d5fa9725a2a189f0">ClientHttpRequest::memObject</a></div><div class="ttdeci">MemObject * memObject() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00055">client_side_request.h:55</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a847eef916e63f6fdeb7cc8ef7095e392"><div class="ttname"><a href="classClientHttpRequest.html#a847eef916e63f6fdeb7cc8ef7095e392">ClientHttpRequest::setLogUriToRawUri</a></div><div class="ttdeci">void setLogUriToRawUri(const char *, const HttpRequestMethod &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01794">client_side_request.cc:1794</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a88642d6f6a181e20927a9e54cabf3c91"><div class="ttname"><a href="classClientHttpRequest.html#a88642d6f6a181e20927a9e54cabf3c91">ClientHttpRequest::req_sz</a></div><div class="ttdeci">size_t req_sz</div><div class="ttdoc">raw request size on input, not current request size</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00159">client_side_request.h:159</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a8e46a2567cf2ddf2283557d8662f3988"><div class="ttname"><a href="classClientHttpRequest.html#a8e46a2567cf2ddf2283557d8662f3988">ClientHttpRequest::sslBumpStart</a></div><div class="ttdeci">void sslBumpStart()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01441">client_side_request.cc:1441</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a9230e617966aced0ed6f9e8b29f16256"><div class="ttname"><a href="classClientHttpRequest.html#a9230e617966aced0ed6f9e8b29f16256">ClientHttpRequest::conn_</a></div><div class="ttdeci">ConnStateData * conn_</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00190">client_side_request.h:190</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a97aeb0db7a8920729b3226df1b080e9d"><div class="ttname"><a href="classClientHttpRequest.html#a97aeb0db7a8920729b3226df1b080e9d">ClientHttpRequest::entry_</a></div><div class="ttdeci">StoreEntry * entry_</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00188">client_side_request.h:188</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a9891746d2fe370c2930a7fddb44c1a35"><div class="ttname"><a href="classClientHttpRequest.html#a9891746d2fe370c2930a7fddb44c1a35">ClientHttpRequest::setErrorUri</a></div><div class="ttdeci">void setErrorUri(const char *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01817">client_side_request.cc:1817</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a99de0c310cceffd4be480afdd2e04870"><div class="ttname"><a href="classClientHttpRequest.html#a99de0c310cceffd4be480afdd2e04870">ClientHttpRequest::adaptedBodySource</a></div><div class="ttdeci">BodyPipe::Pointer adaptedBodySource</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00244">client_side_request.h:244</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_a9c5bc221afbfe0347bee1fafba128574"><div class="ttname"><a href="classClientHttpRequest.html#a9c5bc221afbfe0347bee1fafba128574">ClientHttpRequest::sslBumpNeed_</a></div><div class="ttdeci">Ssl::BumpMode sslBumpNeed_</div><div class="ttdoc">whether (and how) the request needs to be bumped</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00205">client_side_request.h:205</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aa0e86897a7631b6c698f6ca2acb1d1ac"><div class="ttname"><a href="classClientHttpRequest.html#aa0e86897a7631b6c698f6ca2acb1d1ac">ClientHttpRequest::range_iter</a></div><div class="ttdeci">HttpHdrRangeIter range_iter</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00158">client_side_request.h:158</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aa1320fd6e5980fd72036190843b5a965"><div class="ttname"><a href="classClientHttpRequest.html#aa1320fd6e5980fd72036190843b5a965">ClientHttpRequest::noteAdaptationAnswer</a></div><div class="ttdeci">void noteAdaptationAnswer(const Adaptation::Answer &amp;) override</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01873">client_side_request.cc:1873</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aa35128b3716ff224baf3e690b7406b0c"><div class="ttname"><a href="classClientHttpRequest.html#aa35128b3716ff224baf3e690b7406b0c">ClientHttpRequest::handleAdaptedHeader</a></div><div class="ttdeci">void handleAdaptedHeader(Http::Message *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01897">client_side_request.cc:1897</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aaa05fd2e87baa36553d2039aa92901a3"><div class="ttname"><a href="classClientHttpRequest.html#aaa05fd2e87baa36553d2039aa92901a3">ClientHttpRequest::flags</a></div><div class="ttdeci">struct ClientHttpRequest::Flags flags</div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aafded04dda1f651ac69a24bb0be9410e"><div class="ttname"><a href="classClientHttpRequest.html#aafded04dda1f651ac69a24bb0be9410e">ClientHttpRequest::request_satisfaction_offset</a></div><div class="ttdeci">int64_t request_satisfaction_offset</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00250">client_side_request.h:250</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ab06c843bb34e78fbb741e2c7c9632dff"><div class="ttname"><a href="classClientHttpRequest.html#ab06c843bb34e78fbb741e2c7c9632dff">ClientHttpRequest::resetRequest</a></div><div class="ttdeci">void resetRequest(HttpRequest *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01528">client_side_request.cc:1528</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ab2d33ce5e3e5a930de04639ee09a1bcc"><div class="ttname"><a href="classClientHttpRequest.html#ab2d33ce5e3e5a930de04639ee09a1bcc">ClientHttpRequest::onlyIfCached</a></div><div class="ttdeci">bool onlyIfCached() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00159">client_side_request.cc:159</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ab992ab634582a805bf248e2e311403e1"><div class="ttname"><a href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">ClientHttpRequest::doCallouts</a></div><div class="ttdeci">void doCallouts()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01625">client_side_request.cc:1625</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ac1d305af64fb92ccfce613c1eb96d178"><div class="ttname"><a href="classClientHttpRequest.html#ac1d305af64fb92ccfce613c1eb96d178">ClientHttpRequest::uri</a></div><div class="ttdeci">char * uri</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00135">client_side_request.h:135</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ac5ce3f99e959e0e6da56d7daf5b9fb53"><div class="ttname"><a href="classClientHttpRequest.html#ac5ce3f99e959e0e6da56d7daf5b9fb53">ClientHttpRequest::resetRequestXXX</a></div><div class="ttdeci">void resetRequestXXX(HttpRequest *, bool uriChanged)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01535">client_side_request.cc:1535</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ac7a7063190d20387c2c50488dad8cd4e"><div class="ttname"><a href="classClientHttpRequest.html#ac7a7063190d20387c2c50488dad8cd4e">ClientHttpRequest::callException</a></div><div class="ttdeci">void callException(const std::exception &amp;) override</div><div class="ttdoc">called when the job throws during an async call</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l02078">client_side_request.cc:2078</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ac7ceae8151d9b71a15fd9f99474ecac8"><div class="ttname"><a href="classClientHttpRequest.html#ac7ceae8151d9b71a15fd9f99474ecac8">ClientHttpRequest::assignRequest</a></div><div class="ttdeci">void assignRequest(HttpRequest *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01574">client_side_request.cc:1574</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ac8c0f73794781ce53acf6083e0077f34"><div class="ttname"><a href="classClientHttpRequest.html#ac8c0f73794781ce53acf6083e0077f34">ClientHttpRequest::storeEntry</a></div><div class="ttdeci">StoreEntry * storeEntry() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00063">client_side_request.h:63</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ad04475d6fd01e4616be790d0304254c8"><div class="ttname"><a href="classClientHttpRequest.html#ad04475d6fd01e4616be790d0304254c8">ClientHttpRequest::handleAdaptationBlock</a></div><div class="ttdeci">void handleAdaptationBlock(const Adaptation::Answer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01939">client_side_request.cc:1939</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ad2bda94a7fa9e86b17a08e3018f82c0e"><div class="ttname"><a href="classClientHttpRequest.html#ad2bda94a7fa9e86b17a08e3018f82c0e">ClientHttpRequest::active</a></div><div class="ttdeci">dlink_node active</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00173">client_side_request.h:173</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ad39ab5cd4bead17efa5d2a4ace512f29"><div class="ttname"><a href="classClientHttpRequest.html#ad39ab5cd4bead17efa5d2a4ace512f29">ClientHttpRequest::noteBodyProducerAborted</a></div><div class="ttdeci">void noteBodyProducerAborted(BodyPipe::Pointer) override</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l02031">client_side_request.cc:2031</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ad8b7c76779fca1362e6944da47f561e9"><div class="ttname"><a href="classClientHttpRequest.html#ad8b7c76779fca1362e6944da47f561e9">ClientHttpRequest::sslBumpEstablish</a></div><div class="ttdeci">void sslBumpEstablish(Comm::Flag)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01418">client_side_request.cc:1418</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_adceec3ccda3b1ac9a47bbd789939abba"><div class="ttname"><a href="classClientHttpRequest.html#adceec3ccda3b1ac9a47bbd789939abba">ClientHttpRequest::sslBumpNeeded</a></div><div class="ttdeci">bool sslBumpNeeded() const</div><div class="ttdoc">returns true if and only if the request needs to be bumped</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00197">client_side_request.h:197</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ae2f400bf3f3d140535bfa6c43908a348"><div class="ttname"><a href="classClientHttpRequest.html#ae2f400bf3f3d140535bfa6c43908a348">ClientHttpRequest::client_stream</a></div><div class="ttdeci">dlink_list client_stream</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00174">client_side_request.h:174</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_ae5d3bde3423ebc7185c259a6ae16efc3"><div class="ttname"><a href="classClientHttpRequest.html#ae5d3bde3423ebc7185c259a6ae16efc3">ClientHttpRequest::calloutContext</a></div><div class="ttdeci">ClientRequestContext * calloutContext</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00176">client_side_request.h:176</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aeaf768b20ad5656ca8d8db3e69776575"><div class="ttname"><a href="classClientHttpRequest.html#aeaf768b20ad5656ca8d8db3e69776575">ClientHttpRequest::sslBumpNeed</a></div><div class="ttdeci">Ssl::BumpMode sslBumpNeed() const</div><div class="ttdoc">returns raw sslBump mode value</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00195">client_side_request.h:195</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aebb8148d406c65e3890ccb0ba88b8bf4"><div class="ttname"><a href="classClientHttpRequest.html#aebb8148d406c65e3890ccb0ba88b8bf4">ClientHttpRequest::httpStart</a></div><div class="ttdeci">void httpStart()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01384">client_side_request.cc:1384</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_aee8237109aebae9e3711a066ddfa42c0"><div class="ttname"><a href="classClientHttpRequest.html#aee8237109aebae9e3711a066ddfa42c0">ClientHttpRequest::loggingTags</a></div><div class="ttdeci">const LogTags &amp; loggingTags() const</div><div class="ttdoc">the processing tags associated with this request transaction.</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00094">client_side_request.h:94</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_af12bc3076f1661b2737645b67c61bc84"><div class="ttname"><a href="classClientHttpRequest.html#af12bc3076f1661b2737645b67c61bc84">ClientHttpRequest::handleAdaptationFailure</a></div><div class="ttdeci">void handleAdaptationFailure(const ErrorDetail::Pointer &amp;, bool bypassable=false)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l02050">client_side_request.cc:2050</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_af1ec5778cbc7fcd488df2918c821f499"><div class="ttname"><a href="classClientHttpRequest.html#af1ec5778cbc7fcd488df2918c821f499">ClientHttpRequest::al</a></div><div class="ttdeci">const AccessLogEntry::Pointer al</div><div class="ttdoc">access.log entry</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00161">client_side_request.h:161</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_af52b42fc3f7ed18172aa09d69f856e55"><div class="ttname"><a href="classClientHttpRequest.html#af52b42fc3f7ed18172aa09d69f856e55">ClientHttpRequest::loggingEntry</a></div><div class="ttdeci">StoreEntry * loggingEntry() const</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00065">client_side_request.h:65</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_af85263c90594b13b5e367a6dca152c2d"><div class="ttname"><a href="classClientHttpRequest.html#af85263c90594b13b5e367a6dca152c2d">ClientHttpRequest::startAdaptation</a></div><div class="ttdeci">void startAdaptation(const Adaptation::ServiceGroupPointer &amp;)</div><div class="ttdoc">Initiate an asynchronous adaptation transaction which will call us back.</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01859">client_side_request.cc:1859</a></div></div>
<div class="ttc" id="aclassClientHttpRequest_html_afc0f851aa12908396cb5457c085a4e6f"><div class="ttname"><a href="classClientHttpRequest.html#afc0f851aa12908396cb5457c085a4e6f">ClientHttpRequest::redirect</a></div><div class="ttdeci">struct ClientHttpRequest::Redirect redirect</div></div>
<div class="ttc" id="aclassClientRequestContext_html"><div class="ttname"><a href="classClientRequestContext.html">ClientRequestContext</a></div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00028">ClientRequestContext.h:29</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a004907eaa1efbcc4eb3bec5784ec0960"><div class="ttname"><a href="classClientRequestContext.html#a004907eaa1efbcc4eb3bec5784ec0960">ClientRequestContext::clientAccessCheck2</a></div><div class="ttdeci">void clientAccessCheck2()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00595">client_side_request.cc:595</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a0223272029ea7fef9b896be0c4c6f86f"><div class="ttname"><a href="classClientRequestContext.html#a0223272029ea7fef9b896be0c4c6f86f">ClientRequestContext::store_id_done</a></div><div class="ttdeci">bool store_id_done</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00075">ClientRequestContext.h:75</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a07989b09ef23aaeb719886d5bf8dc569"><div class="ttname"><a href="classClientRequestContext.html#a07989b09ef23aaeb719886d5bf8dc569">ClientRequestContext::interpreted_req_hdrs</a></div><div class="ttdeci">bool interpreted_req_hdrs</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00077">ClientRequestContext.h:77</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a17a0ac78b84650e7d10ed8b0fed306d7"><div class="ttname"><a href="classClientRequestContext.html#a17a0ac78b84650e7d10ed8b0fed306d7">ClientRequestContext::sslBumpAccessCheck</a></div><div class="ttdeci">bool sslBumpAccessCheck()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01246">client_side_request.cc:1246</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a24e8bfe9fb32a61b382c7b6c7f791de1"><div class="ttname"><a href="classClientRequestContext.html#a24e8bfe9fb32a61b382c7b6c7f791de1">ClientRequestContext::clientAccessCheckDone</a></div><div class="ttdeci">void clientAccessCheckDone(const Acl::Answer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00618">client_side_request.cc:618</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a2f1d001cc37e78d4530357a13dfbfe41"><div class="ttname"><a href="classClientRequestContext.html#a2f1d001cc37e78d4530357a13dfbfe41">ClientRequestContext::clientStoreIdDone</a></div><div class="ttdeci">void clientStoreIdDone(const Helper::Reply &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01162">client_side_request.cc:1162</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a313d206ae3ee4bd6a0d4d347b5ca6ad7"><div class="ttname"><a href="classClientRequestContext.html#a313d206ae3ee4bd6a0d4d347b5ca6ad7">ClientRequestContext::clientRedirectDone</a></div><div class="ttdeci">void clientRedirectDone(const Helper::Reply &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01046">client_side_request.cc:1046</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a3a33e3dbc18e1d4081f25f70113482d6"><div class="ttname"><a href="classClientRequestContext.html#a3a33e3dbc18e1d4081f25f70113482d6">ClientRequestContext::host_header_verify_done</a></div><div class="ttdeci">bool host_header_verify_done</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00068">ClientRequestContext.h:68</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a40e4e50e91be122ff320b114fa65fc9a"><div class="ttname"><a href="classClientRequestContext.html#a40e4e50e91be122ff320b114fa65fc9a">ClientRequestContext::sslBumpAccessCheckDone</a></div><div class="ttdeci">void sslBumpAccessCheckDone(const Acl::Answer &amp;answer)</div><div class="ttdoc">The callback function for ssl-bump access check list.</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01331">client_side_request.cc:1331</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a44f5f9d8c0e99a76e6bec35478d473b0"><div class="ttname"><a href="classClientRequestContext.html#a44f5f9d8c0e99a76e6bec35478d473b0">ClientRequestContext::clientRedirectStart</a></div><div class="ttdeci">void clientRedirectStart()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00738">client_side_request.cc:738</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a658825d664e00ebf33d7bf70f7e96e3f"><div class="ttname"><a href="classClientRequestContext.html#a658825d664e00ebf33d7bf70f7e96e3f">ClientRequestContext::adapted_http_access_done</a></div><div class="ttdeci">bool adapted_http_access_done</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00070">ClientRequestContext.h:70</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a71477b784014a3f5309153a6d8b1f70c"><div class="ttname"><a href="classClientRequestContext.html#a71477b784014a3f5309153a6d8b1f70c">ClientRequestContext::clientAccessCheck</a></div><div class="ttdeci">void clientAccessCheck()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00559">client_side_request.cc:559</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a71911d920002e0ddc70f8780215b93a6"><div class="ttname"><a href="classClientRequestContext.html#a71911d920002e0ddc70f8780215b93a6">ClientRequestContext::ClientRequestContext</a></div><div class="ttdeci">ClientRequestContext(ClientHttpRequest *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00120">client_side_request.cc:120</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a784ab483ce56bc45309d8957b966eab5"><div class="ttname"><a href="classClientRequestContext.html#a784ab483ce56bc45309d8957b966eab5">ClientRequestContext::httpStateIsValid</a></div><div class="ttdeci">bool httpStateIsValid()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00272">client_side_request.cc:272</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a7a6bc55e0f61702b9e2e25f5e37b43dd"><div class="ttname"><a href="classClientRequestContext.html#a7a6bc55e0f61702b9e2e25f5e37b43dd">ClientRequestContext::no_cache_done</a></div><div class="ttdeci">bool no_cache_done</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00076">ClientRequestContext.h:76</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a808ac8e44e079957a7bde4a46f23c62a"><div class="ttname"><a href="classClientRequestContext.html#a808ac8e44e079957a7bde4a46f23c62a">ClientRequestContext::readNextRequest</a></div><div class="ttdeci">bool readNextRequest</div><div class="ttdoc">whether Squid should read after error handling</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00083">ClientRequestContext.h:83</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a8efe7580a5fc3ce72fb30c3f7ccbca7c"><div class="ttname"><a href="classClientRequestContext.html#a8efe7580a5fc3ce72fb30c3f7ccbca7c">ClientRequestContext::redirect_done</a></div><div class="ttdeci">bool redirect_done</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00074">ClientRequestContext.h:74</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a93cbbe1bffc57b94532b205c794942de"><div class="ttname"><a href="classClientRequestContext.html#a93cbbe1bffc57b94532b205c794942de">ClientRequestContext::http</a></div><div class="ttdeci">ClientHttpRequest * http</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00064">ClientRequestContext.h:64</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a9702d46ba83f3300042f512255af4564"><div class="ttname"><a href="classClientRequestContext.html#a9702d46ba83f3300042f512255af4564">ClientRequestContext::http_access_done</a></div><div class="ttdeci">bool http_access_done</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00069">ClientRequestContext.h:69</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_a981b1e47936a17c8935edc65f6022d7a"><div class="ttname"><a href="classClientRequestContext.html#a981b1e47936a17c8935edc65f6022d7a">ClientRequestContext::~ClientRequestContext</a></div><div class="ttdeci">~ClientRequestContext() override</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00107">client_side_request.cc:107</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_aa95c1ad804bd5e7d93b46a937c57c57f"><div class="ttname"><a href="classClientRequestContext.html#aa95c1ad804bd5e7d93b46a937c57c57f">ClientRequestContext::toClientMarkingDone</a></div><div class="ttdeci">bool toClientMarkingDone</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00078">ClientRequestContext.h:78</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_ab523448fe90265c989bafbf7d88009cd"><div class="ttname"><a href="classClientRequestContext.html#ab523448fe90265c989bafbf7d88009cd">ClientRequestContext::checkNoCache</a></div><div class="ttdeci">void checkNoCache()</div><div class="ttdoc">applies &quot;cache allow/deny&quot; rules, asynchronously if needed</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01213">client_side_request.cc:1213</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_ab75ca746c730c960f7eba0f46709e1dc"><div class="ttname"><a href="classClientRequestContext.html#ab75ca746c730c960f7eba0f46709e1dc">ClientRequestContext::adaptation_acl_check_done</a></div><div class="ttdeci">bool adaptation_acl_check_done</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00072">ClientRequestContext.h:72</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_ac3523c99c53a983d6d1ae809873455ed"><div class="ttname"><a href="classClientRequestContext.html#ac3523c99c53a983d6d1ae809873455ed">ClientRequestContext::error</a></div><div class="ttdeci">ErrorState * error</div><div class="ttdoc">saved error page for centralized/delayed processing</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00084">ClientRequestContext.h:84</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_acb3bd1387cd493ebc0da7e6ceee1743f"><div class="ttname"><a href="classClientRequestContext.html#acb3bd1387cd493ebc0da7e6ceee1743f">ClientRequestContext::redirect_state</a></div><div class="ttdeci">int redirect_state</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00065">ClientRequestContext.h:65</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_acf179694d4dcf1b64dc448c1284c5190"><div class="ttname"><a href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">ClientRequestContext::hostHeaderVerifyFailed</a></div><div class="ttdeci">void hostHeaderVerifyFailed(const char *A, const char *B)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00413">client_side_request.cc:413</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_ad126658971216f8be7208f906bd640ea"><div class="ttname"><a href="classClientRequestContext.html#ad126658971216f8be7208f906bd640ea">ClientRequestContext::hostHeaderVerify</a></div><div class="ttdeci">void hostHeaderVerify()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00460">client_side_request.cc:460</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_ad4e5c1fe9c02000df992d04cb995f6f5"><div class="ttname"><a href="classClientRequestContext.html#ad4e5c1fe9c02000df992d04cb995f6f5">ClientRequestContext::sslBumpCheckDone</a></div><div class="ttdeci">bool sslBumpCheckDone</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00080">ClientRequestContext.h:80</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_adc8709afbf6ed349a3c492fa5c4fa539"><div class="ttname"><a href="classClientRequestContext.html#adc8709afbf6ed349a3c492fa5c4fa539">ClientRequestContext::currentXffHopNumber</a></div><div class="ttdeci">size_t currentXffHopNumber</div><div class="ttdoc">number of X-Forwarded-For header values processed so far</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00087">ClientRequestContext.h:87</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_af64a43978912fa5d3fa189faaec50970"><div class="ttname"><a href="classClientRequestContext.html#af64a43978912fa5d3fa189faaec50970">ClientRequestContext::clientStoreIdStart</a></div><div class="ttdeci">void clientStoreIdStart()</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00774">client_side_request.cc:774</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_af8f934f2f27ff1c700141d23a308d7b7"><div class="ttname"><a href="classClientRequestContext.html#af8f934f2f27ff1c700141d23a308d7b7">ClientRequestContext::hostHeaderIpVerify</a></div><div class="ttdeci">void hostHeaderIpVerify(const ipcache_addrs *, const Dns::LookupDetails &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00394">client_side_request.cc:394</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_afb1f17a80c1d0f55d3c45d93c763500d"><div class="ttname"><a href="classClientRequestContext.html#afb1f17a80c1d0f55d3c45d93c763500d">ClientRequestContext::checkNoCacheDone</a></div><div class="ttdeci">void checkNoCacheDone(const Acl::Answer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01236">client_side_request.cc:1236</a></div></div>
<div class="ttc" id="aclassClientRequestContext_html_afe53d111b9377770e03f382fcf15f711"><div class="ttname"><a href="classClientRequestContext.html#afe53d111b9377770e03f382fcf15f711">ClientRequestContext::store_id_state</a></div><div class="ttdeci">int store_id_state</div><div class="ttdef"><b>Definition</b> <a href="ClientRequestContext_8h_source.html#l00066">ClientRequestContext.h:66</a></div></div>
<div class="ttc" id="aclassCodeContext_html_aeed1567dd2fb1c97eb3fa3f10df4622e"><div class="ttname"><a href="classCodeContext.html#aeed1567dd2fb1c97eb3fa3f10df4622e">CodeContext::Reset</a></div><div class="ttdeci">static void Reset()</div><div class="ttdoc">forgets the current context, setting it to nil/unknown</div><div class="ttdef"><b>Definition</b> <a href="CodeContext_8cc_source.html#l00077">CodeContext.cc:77</a></div></div>
<div class="ttc" id="aclassCommCommonCbParams_html_aaa1b70c6ff254ac72ac1503fc158df7e"><div class="ttname"><a href="classCommCommonCbParams.html#aaa1b70c6ff254ac72ac1503fc158df7e">CommCommonCbParams::flag</a></div><div class="ttdeci">Comm::Flag flag</div><div class="ttdoc">comm layer result status.</div><div class="ttdef"><b>Definition</b> <a href="CommCalls_8h_source.html#l00082">CommCalls.h:82</a></div></div>
<div class="ttc" id="aclassCommCommonCbParams_html_acbcbe42d3ccd12c6de3b1f3d1d7c4bc3"><div class="ttname"><a href="classCommCommonCbParams.html#acbcbe42d3ccd12c6de3b1f3d1d7c4bc3">CommCommonCbParams::conn</a></div><div class="ttdeci">Comm::ConnectionPointer conn</div><div class="ttdef"><b>Definition</b> <a href="CommCalls_8h_source.html#l00080">CommCalls.h:80</a></div></div>
<div class="ttc" id="aclassCommIoCbParams_html"><div class="ttname"><a href="classCommIoCbParams.html">CommIoCbParams</a></div><div class="ttdef"><b>Definition</b> <a href="CommCalls_8h_source.html#l00113">CommCalls.h:114</a></div></div>
<div class="ttc" id="aclassCommIoCbPtrFun_html"><div class="ttname"><a href="classCommIoCbPtrFun.html">CommIoCbPtrFun</a></div><div class="ttdef"><b>Definition</b> <a href="CommCalls_8h_source.html#l00229">CommCalls.h:231</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_a2cd96e61e73907e8a07add1c1e4f3750"><div class="ttname"><a href="classComm_1_1Connection.html#a2cd96e61e73907e8a07add1c1e4f3750">Comm::Connection::isOpen</a></div><div class="ttdeci">bool isOpen() const</div><div class="ttdef"><b>Definition</b> <a href="Connection_8h_source.html#l00101">Connection.h:101</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_a32253e90999f679dc032e19ad50d03ab"><div class="ttname"><a href="classComm_1_1Connection.html#a32253e90999f679dc032e19ad50d03ab">Comm::Connection::close</a></div><div class="ttdeci">void close()</div><div class="ttdef"><b>Definition</b> <a href="Connection_8cc_source.html#l00091">Connection.cc:91</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_a84e6544b719c79cbecbc7d2a891fbcb2"><div class="ttname"><a href="classComm_1_1Connection.html#a84e6544b719c79cbecbc7d2a891fbcb2">Comm::Connection::local</a></div><div class="ttdeci">Ip::Address local</div><div class="ttdef"><b>Definition</b> <a href="Connection_8h_source.html#l00149">Connection.h:149</a></div></div>
<div class="ttc" id="aclassComm_1_1Connection_html_a8e53f4d6fd38545947a5aac6efb98fca"><div class="ttname"><a href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">Comm::Connection::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition</b> <a href="Connection_8h_source.html#l00158">Connection.h:158</a></div></div>
<div class="ttc" id="aclassConnStateData_html"><div class="ttname"><a href="classConnStateData.html">ConnStateData</a></div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00079">client_side.h:84</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a0452329238b5201c25f125bfd39ebd5f"><div class="ttname"><a href="classConnStateData.html#a0452329238b5201c25f125bfd39ebd5f">ConnStateData::serverBump</a></div><div class="ttdeci">Ssl::ServerBump * serverBump()</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00285">client_side.h:285</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a0a6bcd9010a0dfdd48910ec1972c6d6e"><div class="ttname"><a href="classConnStateData.html#a0a6bcd9010a0dfdd48910ec1972c6d6e">ConnStateData::pinning</a></div><div class="ttdeci">struct ConnStateData::@29 pinning</div></div>
<div class="ttc" id="aclassConnStateData_html_a0c235db1c5743aaba238b4f4584ec12d"><div class="ttname"><a href="classConnStateData.html#a0c235db1c5743aaba238b4f4584ec12d">ConnStateData::auth</a></div><div class="ttdeci">bool auth</div><div class="ttdoc">pinned for www authentication</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00147">client_side.h:147</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a12339fb2c6778b15820c53a9137de210"><div class="ttname"><a href="classConnStateData.html#a12339fb2c6778b15820c53a9137de210">ConnStateData::switchedToHttps</a></div><div class="ttdeci">bool switchedToHttps() const</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00284">client_side.h:284</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a25b3fe939ab58955e7a41302da7d64a1"><div class="ttname"><a href="classConnStateData.html#a25b3fe939ab58955e7a41302da7d64a1">ConnStateData::proxyProtocolHeader</a></div><div class="ttdeci">const ProxyProtocol::HeaderPointer &amp; proxyProtocolHeader() const</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00360">client_side.h:360</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a287046cdc188f80b47e3b54c7b3a2178"><div class="ttname"><a href="classConnStateData.html#a287046cdc188f80b47e3b54c7b3a2178">ConnStateData::serverConnection</a></div><div class="ttdeci">Comm::ConnectionPointer serverConnection</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00143">client_side.h:143</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a2d458e5d1aecb62f7a9568e34467262c"><div class="ttname"><a href="classConnStateData.html#a2d458e5d1aecb62f7a9568e34467262c">ConnStateData::switchToHttps</a></div><div class="ttdeci">void switchToHttps(ClientHttpRequest *, Ssl::BumpMode bumpServerMode)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l02772">client_side.cc:2772</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a365239c8b450a844e46cc7c28d465ba3"><div class="ttname"><a href="classConnStateData.html#a365239c8b450a844e46cc7c28d465ba3">ConnStateData::setAuth</a></div><div class="ttdeci">void setAuth(const Auth::UserRequest::Pointer &amp;aur, const char *cause)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l00494">client_side.cc:494</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a4703123fe8d180f68321411d26ceb736"><div class="ttname"><a href="classConnStateData.html#a4703123fe8d180f68321411d26ceb736">ConnStateData::getAuth</a></div><div class="ttdeci">const Auth::UserRequest::Pointer &amp; getAuth() const</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00123">client_side.h:123</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a5230ce05c11307d10d7f118c4246082f"><div class="ttname"><a href="classConnStateData.html#a5230ce05c11307d10d7f118c4246082f">ConnStateData::bareError</a></div><div class="ttdeci">Error bareError</div><div class="ttdoc">a problem that occurred without a request (e.g., while parsing headers)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00381">client_side.h:381</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a56c3ce7c30a3ab5ac9a83489ee862e20"><div class="ttname"><a href="classConnStateData.html#a56c3ce7c30a3ab5ac9a83489ee862e20">ConnStateData::expectNoForwarding</a></div><div class="ttdeci">void expectNoForwarding()</div><div class="ttdoc">cleans up virgin request [body] forwarding state</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l03571">client_side.cc:3571</a></div></div>
<div class="ttc" id="aclassConnStateData_html_a7f95d063c54bfa6618b5d45869b5c21b"><div class="ttname"><a href="classConnStateData.html#a7f95d063c54bfa6618b5d45869b5c21b">ConnStateData::flags</a></div><div class="ttdeci">struct ConnStateData::@28 flags</div></div>
<div class="ttc" id="aclassConnStateData_html_aaeed787292abe965e062beadfe35ea42"><div class="ttname"><a href="classConnStateData.html#aaeed787292abe965e062beadfe35ea42">ConnStateData::isOpen</a></div><div class="ttdeci">bool isOpen() const</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l00640">client_side.cc:640</a></div></div>
<div class="ttc" id="aclassConnStateData_html_ab4bed752a0b6a81679cdb594f98e7022"><div class="ttname"><a href="classConnStateData.html#ab4bed752a0b6a81679cdb594f98e7022">ConnStateData::log_addr</a></div><div class="ttdeci">Ip::Address log_addr</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00136">client_side.h:136</a></div></div>
<div class="ttc" id="aclassConnStateData_html_abca96f1a2792ad7128762d1dac280cd6"><div class="ttname"><a href="classConnStateData.html#abca96f1a2792ad7128762d1dac280cd6">ConnStateData::sslBumpMode</a></div><div class="ttdeci">Ssl::BumpMode sslBumpMode</div><div class="ttdoc">ssl_bump decision (Ssl::bumpEnd if n/a).</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00304">client_side.h:304</a></div></div>
<div class="ttc" id="aclassConnStateData_html_ac049eac9adf044f1310c48e058778f6d"><div class="ttname"><a href="classConnStateData.html#ac049eac9adf044f1310c48e058778f6d">ConnStateData::readMore</a></div><div class="ttdeci">bool readMore</div><div class="ttdoc">needs comm_read (for this request or new requests)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00139">client_side.h:139</a></div></div>
<div class="ttc" id="aclassConnStateData_html_ae06c387dd773449597078259a953013b"><div class="ttname"><a href="classConnStateData.html#ae06c387dd773449597078259a953013b">ConnStateData::port</a></div><div class="ttdeci">AnyP::Port port</div><div class="ttdoc">destination port of the request that caused serverConnection</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00145">client_side.h:145</a></div></div>
<div class="ttc" id="aclassConnStateData_html_afd9feaaac6844a8d9899233c0d8146db"><div class="ttname"><a href="classConnStateData.html#afd9feaaac6844a8d9899233c0d8146db">ConnStateData::setServerBump</a></div><div class="ttdeci">void setServerBump(Ssl::ServerBump *srvBump)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00286">client_side.h:286</a></div></div>
<div class="ttc" id="aclassDebug_html_a469eccf6573cacd9bc0682d3fc0eaf11"><div class="ttname"><a href="classDebug.html#a469eccf6573cacd9bc0682d3fc0eaf11">Debug::Extra</a></div><div class="ttdeci">static std::ostream &amp; Extra(std::ostream &amp;)</div><div class="ttdef"><b>Definition</b> <a href="src_2debug_2debug_8cc_source.html#l01316">debug.cc:1316</a></div></div>
<div class="ttc" id="aclassDns_1_1CachedIps_html"><div class="ttname"><a href="classDns_1_1CachedIps.html">Dns::CachedIps</a></div><div class="ttdef"><b>Definition</b> <a href="ipcache_8h_source.html#l00050">ipcache.h:51</a></div></div>
<div class="ttc" id="aclassDns_1_1CachedIps_html_a6b2198324262b6580817aeccf8f5424c"><div class="ttname"><a href="classDns_1_1CachedIps.html#a6b2198324262b6580817aeccf8f5424c">Dns::CachedIps::have</a></div><div class="ttdeci">bool have(const Ip::Address &amp;ip, size_t *position=nullptr) const</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8cc_source.html#l00984">ipcache.cc:984</a></div></div>
<div class="ttc" id="aclassDns_1_1LookupDetails_html"><div class="ttname"><a href="classDns_1_1LookupDetails.html">Dns::LookupDetails</a></div><div class="ttdoc">encapsulates DNS lookup results</div><div class="ttdef"><b>Definition</b> <a href="LookupDetails_8h_source.html#l00022">LookupDetails.h:23</a></div></div>
<div class="ttc" id="aclassErrorState_html"><div class="ttname"><a href="classErrorState.html">ErrorState</a></div><div class="ttdef"><b>Definition</b> <a href="errorpage_8h_source.html#l00088">errorpage.h:89</a></div></div>
<div class="ttc" id="aclassErrorState_html_a44aa54a5e918a6cb3008df0ff7494ded"><div class="ttname"><a href="classErrorState.html#a44aa54a5e918a6cb3008df0ff7494ded">ErrorState::type</a></div><div class="ttdeci">err_type type</div><div class="ttdef"><b>Definition</b> <a href="errorpage_8h_source.html#l00170">errorpage.h:170</a></div></div>
<div class="ttc" id="aclassErrorState_html_a8c81559af6790d05dfc0c22447c3709a"><div class="ttname"><a href="classErrorState.html#a8c81559af6790d05dfc0c22447c3709a">ErrorState::detailError</a></div><div class="ttdeci">void detailError(const ErrorDetail::Pointer &amp;dCode)</div><div class="ttdoc">set error type-specific detail code</div><div class="ttdef"><b>Definition</b> <a href="errorpage_8h_source.html#l00111">errorpage.h:111</a></div></div>
<div class="ttc" id="aclassErrorState_html_aaa2499a9aec80fa57d4fe9f54ce1a153"><div class="ttname"><a href="classErrorState.html#aaa2499a9aec80fa57d4fe9f54ce1a153">ErrorState::auth_user_request</a></div><div class="ttdeci">Auth::UserRequest::Pointer auth_user_request</div><div class="ttdef"><b>Definition</b> <a href="errorpage_8h_source.html#l00175">errorpage.h:175</a></div></div>
<div class="ttc" id="aclassErrorState_html_aeb69480d52455c3be9e80e1a77655308"><div class="ttname"><a href="classErrorState.html#aeb69480d52455c3be9e80e1a77655308">ErrorState::httpStatus</a></div><div class="ttdeci">Http::StatusCode httpStatus</div><div class="ttdef"><b>Definition</b> <a href="errorpage_8h_source.html#l00173">errorpage.h:173</a></div></div>
<div class="ttc" id="aclassError_html"><div class="ttname"><a href="classError.html">Error</a></div><div class="ttdoc">a transaction problem</div><div class="ttdef"><b>Definition</b> <a href="Error_8h_source.html#l00027">Error.h:27</a></div></div>
<div class="ttc" id="aclassError_html_a1220700c3c5aa1181e2f1fd762b67e8b"><div class="ttname"><a href="classError.html#a1220700c3c5aa1181e2f1fd762b67e8b">Error::category</a></div><div class="ttdeci">err_type category</div><div class="ttdoc">primary error classification (or ERR_NONE)</div><div class="ttdef"><b>Definition</b> <a href="Error_8h_source.html#l00055">Error.h:55</a></div></div>
<div class="ttc" id="aclassError_html_a6e163b6a5a08adf7f23ea363d8935ee3"><div class="ttname"><a href="classError.html#a6e163b6a5a08adf7f23ea363d8935ee3">Error::update</a></div><div class="ttdeci">void update(const Error &amp;)</div><div class="ttdoc">if necessary, stores the given error information (if any)</div><div class="ttdef"><b>Definition</b> <a href="Error_8cc_source.html#l00051">Error.cc:51</a></div></div>
<div class="ttc" id="aclassHelper_1_1Reply_html"><div class="ttname"><a href="classHelper_1_1Reply.html">Helper::Reply</a></div><div class="ttdef"><b>Definition</b> <a href="Reply_8h_source.html#l00029">Reply.h:30</a></div></div>
<div class="ttc" id="aclassHelper_1_1Reply_html_a7919dd5e59757b9c0e3e9a3cc3b54156"><div class="ttname"><a href="classHelper_1_1Reply.html#a7919dd5e59757b9c0e3e9a3cc3b54156">Helper::Reply::notes</a></div><div class="ttdeci">NotePairs notes</div><div class="ttdef"><b>Definition</b> <a href="Reply_8h_source.html#l00062">Reply.h:62</a></div></div>
<div class="ttc" id="aclassHelper_1_1Reply_html_a9c644b392f1fea31662c2532c25ebaa4"><div class="ttname"><a href="classHelper_1_1Reply.html#a9c644b392f1fea31662c2532c25ebaa4">Helper::Reply::result</a></div><div class="ttdeci">Helper::ResultCode result</div><div class="ttdoc">The helper response 'result' field.</div><div class="ttdef"><b>Definition</b> <a href="Reply_8h_source.html#l00059">Reply.h:59</a></div></div>
<div class="ttc" id="aclassHierarchyLogEntry_html_ac79cc06b0d8333ee14e8cc66d3941e6d"><div class="ttname"><a href="classHierarchyLogEntry.html#ac79cc06b0d8333ee14e8cc66d3941e6d">HierarchyLogEntry::code</a></div><div class="ttdeci">hier_code code</div><div class="ttdef"><b>Definition</b> <a href="HierarchyLogEntry_8h_source.html#l00046">HierarchyLogEntry.h:46</a></div></div>
<div class="ttc" id="aclassHttpHdrCc_html_a1f64d7d9ca1f2fee35e7bf490e05fe88"><div class="ttname"><a href="classHttpHdrCc.html#a1f64d7d9ca1f2fee35e7bf490e05fe88">HttpHdrCc::hasNoCache</a></div><div class="ttdeci">bool hasNoCache(const String **val=nullptr) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHdrCc_8h_source.html#l00089">HttpHdrCc.h:89</a></div></div>
<div class="ttc" id="aclassHttpHdrCc_html_aa9822d58df5d7d5c5527ad0b5337b78e"><div class="ttname"><a href="classHttpHdrCc.html#aa9822d58df5d7d5c5527ad0b5337b78e">HttpHdrCc::hasOnlyIfCached</a></div><div class="ttdeci">bool hasOnlyIfCached() const</div><div class="ttdef"><b>Definition</b> <a href="HttpHdrCc_8h_source.html#l00145">HttpHdrCc.h:145</a></div></div>
<div class="ttc" id="aclassHttpHdrRangeIter_html_a319db564ce02056a930282cb57ab3f15"><div class="ttname"><a href="classHttpHdrRangeIter.html#a319db564ce02056a930282cb57ab3f15">HttpHdrRangeIter::pos</a></div><div class="ttdeci">HttpHdrRange::iterator pos</div><div class="ttdef"><b>Definition</b> <a href="HttpHeaderRange_8h_source.html#l00099">HttpHeaderRange.h:99</a></div></div>
<div class="ttc" id="aclassHttpHdrRangeIter_html_a52d32525864512d6e66aeb1e71d08345"><div class="ttname"><a href="classHttpHdrRangeIter.html#a52d32525864512d6e66aeb1e71d08345">HttpHdrRangeIter::end</a></div><div class="ttdeci">HttpHdrRange::iterator end</div><div class="ttdef"><b>Definition</b> <a href="HttpHeaderRange_8h_source.html#l00100">HttpHeaderRange.h:100</a></div></div>
<div class="ttc" id="aclassHttpHdrRangeIter_html_a81c917bf59ffdc6af49563a23eac45ce"><div class="ttname"><a href="classHttpHdrRangeIter.html#a81c917bf59ffdc6af49563a23eac45ce">HttpHdrRangeIter::debt_size</a></div><div class="ttdeci">int64_t debt_size</div><div class="ttdef"><b>Definition</b> <a href="HttpHeaderRange_8h_source.html#l00105">HttpHeaderRange.h:105</a></div></div>
<div class="ttc" id="aclassHttpHdrRangeIter_html_a9b4eac35b29b0ccff88dbb13676ea139"><div class="ttname"><a href="classHttpHdrRangeIter.html#a9b4eac35b29b0ccff88dbb13676ea139">HttpHdrRangeIter::valid</a></div><div class="ttdeci">bool valid</div><div class="ttdef"><b>Definition</b> <a href="HttpHeaderRange_8h_source.html#l00107">HttpHeaderRange.h:107</a></div></div>
<div class="ttc" id="aclassHttpHdrRangeIter_html_ab695e670a8bc107e4346855768722a3c"><div class="ttname"><a href="classHttpHdrRangeIter.html#ab695e670a8bc107e4346855768722a3c">HttpHdrRangeIter::updateSpec</a></div><div class="ttdeci">void updateSpec()</div><div class="ttdef"><b>Definition</b> <a href="HttpHdrRange_8cc_source.html#l00541">HttpHdrRange.cc:541</a></div></div>
<div class="ttc" id="aclassHttpHdrRangeIter_html_ab6e6dd729f76e0e4a34ac1105af0e715"><div class="ttname"><a href="classHttpHdrRangeIter.html#ab6e6dd729f76e0e4a34ac1105af0e715">HttpHdrRangeIter::boundary</a></div><div class="ttdeci">String boundary</div><div class="ttdef"><b>Definition</b> <a href="HttpHeaderRange_8h_source.html#l00106">HttpHeaderRange.h:106</a></div></div>
<div class="ttc" id="aclassHttpHdrRange_html_a4caf5a47b28b4f4e141b98e95914fe95"><div class="ttname"><a href="classHttpHdrRange.html#a4caf5a47b28b4f4e141b98e95914fe95">HttpHdrRange::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition</b> <a href="HttpHdrRange_8cc_source.html#l00284">HttpHdrRange.cc:284</a></div></div>
<div class="ttc" id="aclassHttpHdrRange_html_a5eefced91bb33dc3f5a518746238de0e"><div class="ttname"><a href="classHttpHdrRange.html#a5eefced91bb33dc3f5a518746238de0e">HttpHdrRange::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition</b> <a href="HttpHdrRange_8cc_source.html#l00290">HttpHdrRange.cc:290</a></div></div>
<div class="ttc" id="aclassHttpHdrRange_html_aac6c2acebe05f12765d394dcc86c0367"><div class="ttname"><a href="classHttpHdrRange.html#aac6c2acebe05f12765d394dcc86c0367">HttpHdrRange::specs</a></div><div class="ttdeci">std::vector&lt; HttpHdrRangeSpec * &gt; specs</div><div class="ttdef"><b>Definition</b> <a href="HttpHeaderRange_8h_source.html#l00084">HttpHeaderRange.h:84</a></div></div>
<div class="ttc" id="aclassHttpHdrRange_html_abc61bead0e22fc2e41630498593b27e1"><div class="ttname"><a href="classHttpHdrRange.html#abc61bead0e22fc2e41630498593b27e1">HttpHdrRange::lowestOffset</a></div><div class="ttdeci">int64_t lowestOffset(int64_t) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHdrRange_8cc_source.html#l00481">HttpHdrRange.cc:481</a></div></div>
<div class="ttc" id="aclassHttpHeaderEntry_html"><div class="ttname"><a href="classHttpHeaderEntry.html">HttpHeaderEntry</a></div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00050">HttpHeader.h:51</a></div></div>
<div class="ttc" id="aclassHttpHeaderEntry_html_ad4de5645a10ac4022a3667753b7904a8"><div class="ttname"><a href="classHttpHeaderEntry.html#ad4de5645a10ac4022a3667753b7904a8">HttpHeaderEntry::id</a></div><div class="ttdeci">Http::HdrType id</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00066">HttpHeader.h:66</a></div></div>
<div class="ttc" id="aclassHttpHeaderEntry_html_af1721f40aef39eef4476a19f806aedaa"><div class="ttname"><a href="classHttpHeaderEntry.html#af1721f40aef39eef4476a19f806aedaa">HttpHeaderEntry::value</a></div><div class="ttdeci">String value</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00068">HttpHeader.h:68</a></div></div>
<div class="ttc" id="aclassHttpHeader_html"><div class="ttname"><a href="classHttpHeader.html">HttpHeader</a></div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8h_source.html#l00074">HttpHeader.h:75</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a54dbaa59c66d44d0612450a6cc06e5ac"><div class="ttname"><a href="classHttpHeader.html#a54dbaa59c66d44d0612450a6cc06e5ac">HttpHeader::delById</a></div><div class="ttdeci">int delById(Http::HdrType id)</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l00799">HttpHeader.cc:799</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a5bd52e3f8d517f7c1c919aa4a82f4e29"><div class="ttname"><a href="classHttpHeader.html#a5bd52e3f8d517f7c1c919aa4a82f4e29">HttpHeader::getList</a></div><div class="ttdeci">String getList(Http::HdrType id) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l00921">HttpHeader.cc:921</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a81cb2fc85a9629783ba1e607de0f41ed"><div class="ttname"><a href="classHttpHeader.html#a81cb2fc85a9629783ba1e607de0f41ed">HttpHeader::getEntry</a></div><div class="ttdeci">HttpHeaderEntry * getEntry(HttpHeaderPos *pos) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l00716">HttpHeader.cc:716</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_a89a87680aa68d7143be79793bcbce500"><div class="ttname"><a href="classHttpHeader.html#a89a87680aa68d7143be79793bcbce500">HttpHeader::getStr</a></div><div class="ttdeci">const char * getStr(Http::HdrType id) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01296">HttpHeader.cc:1296</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_ab5451998313dbafbc7f8c0b6d5aadbc7"><div class="ttname"><a href="classHttpHeader.html#ab5451998313dbafbc7f8c0b6d5aadbc7">HttpHeader::getTime</a></div><div class="ttdeci">time_t getTime(Http::HdrType id) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01279">HttpHeader.cc:1279</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_ab8ed2262022bb3925ce93f20ee0073d9"><div class="ttname"><a href="classHttpHeader.html#ab8ed2262022bb3925ce93f20ee0073d9">HttpHeader::getRange</a></div><div class="ttdeci">HttpHdrRange * getRange() const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01353">HttpHeader.cc:1353</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_abe3327167942e75a78385e92bc1b26b7"><div class="ttname"><a href="classHttpHeader.html#abe3327167942e75a78385e92bc1b26b7">HttpHeader::has</a></div><div class="ttdeci">int has(Http::HdrType id) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01070">HttpHeader.cc:1070</a></div></div>
<div class="ttc" id="aclassHttpHeader_html_af87838abd8fbd3fa454ccf7abf16ebed"><div class="ttname"><a href="classHttpHeader.html#af87838abd8fbd3fa454ccf7abf16ebed">HttpHeader::hasListMember</a></div><div class="ttdeci">int hasListMember(Http::HdrType id, const char *member, const char separator) const</div><div class="ttdef"><b>Definition</b> <a href="HttpHeader_8cc_source.html#l01795">HttpHeader.cc:1795</a></div></div>
<div class="ttc" id="aclassHttpReply_html"><div class="ttname"><a href="classHttpReply.html">HttpReply</a></div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8h_source.html#l00024">HttpReply.h:25</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a0e8069f4331ea7989365cc8a9b2c8aa3"><div class="ttname"><a href="classHttpReply.html#a0e8069f4331ea7989365cc8a9b2c8aa3">HttpReply::pack</a></div><div class="ttdeci">MemBuf * pack() const</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00112">HttpReply.cc:112</a></div></div>
<div class="ttc" id="aclassHttpReply_html_a74ed30d9587d67debbc07741d36609a5"><div class="ttname"><a href="classHttpReply.html#a74ed30d9587d67debbc07741d36609a5">HttpReply::bodySize</a></div><div class="ttdeci">int64_t bodySize(const HttpRequestMethod &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00377">HttpReply.cc:377</a></div></div>
<div class="ttc" id="aclassHttpReply_html_ae96652fc2dfe69192b90208c78f16148"><div class="ttname"><a href="classHttpReply.html#ae96652fc2dfe69192b90208c78f16148">HttpReply::MakeConnectionEstablished</a></div><div class="ttdeci">static HttpReplyPointer MakeConnectionEstablished()</div><div class="ttdoc">construct and return an HTTP/200 (Connection Established) response</div><div class="ttdef"><b>Definition</b> <a href="HttpReply_8cc_source.html#l00121">HttpReply.cc:121</a></div></div>
<div class="ttc" id="aclassHttpRequestMethod_html"><div class="ttname"><a href="classHttpRequestMethod.html">HttpRequestMethod</a></div><div class="ttdef"><b>Definition</b> <a href="RequestMethod_8h_source.html#l00026">RequestMethod.h:27</a></div></div>
<div class="ttc" id="aclassHttpRequestMethod_html_a9c903186b972ba0f9d703ae150596eda"><div class="ttname"><a href="classHttpRequestMethod.html#a9c903186b972ba0f9d703ae150596eda">HttpRequestMethod::respMaybeCacheable</a></div><div class="ttdeci">bool respMaybeCacheable() const</div><div class="ttdef"><b>Definition</b> <a href="RequestMethod_8cc_source.html#l00208">RequestMethod.cc:208</a></div></div>
<div class="ttc" id="aclassHttpRequestMethod_html_ae3fea5f21ee623ff0749a67eacc8e9c9"><div class="ttname"><a href="classHttpRequestMethod.html#ae3fea5f21ee623ff0749a67eacc8e9c9">HttpRequestMethod::id</a></div><div class="ttdeci">Http::MethodType id() const</div><div class="ttdef"><b>Definition</b> <a href="RequestMethod_8h_source.html#l00070">RequestMethod.h:70</a></div></div>
<div class="ttc" id="aclassHttpRequest_html"><div class="ttname"><a href="classHttpRequest.html">HttpRequest</a></div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00048">HttpRequest.h:49</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a07108e36a4b7e86c096b04a557a7a023"><div class="ttname"><a href="classHttpRequest.html#a07108e36a4b7e86c096b04a557a7a023">HttpRequest::recordLookup</a></div><div class="ttdeci">void recordLookup(const Dns::LookupDetails &amp;detail)</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00577">HttpRequest.cc:577</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a0e84a414e1c5857a0d8681f0a9c13317"><div class="ttname"><a href="classHttpRequest.html#a0e84a414e1c5857a0d8681f0a9c13317">HttpRequest::range</a></div><div class="ttdeci">HttpHdrRange * range</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00143">HttpRequest.h:143</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a13f1a21e71a902ac14ab9b4ee8133276"><div class="ttname"><a href="classHttpRequest.html#a13f1a21e71a902ac14ab9b4ee8133276">HttpRequest::clientConnectionManager</a></div><div class="ttdeci">CbcPointer&lt; ConnStateData &gt; clientConnectionManager</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00230">HttpRequest.h:230</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a1f0af82ff15e9a29d15319fc3cf05a54"><div class="ttname"><a href="classHttpRequest.html#a1f0af82ff15e9a29d15319fc3cf05a54">HttpRequest::method</a></div><div class="ttdeci">HttpRequestMethod method</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00114">HttpRequest.h:114</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a22edb4b67bb2f310d3396c623b636343"><div class="ttname"><a href="classHttpRequest.html#a22edb4b67bb2f310d3396c623b636343">HttpRequest::clone</a></div><div class="ttdeci">HttpRequest * clone() const override</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00174">HttpRequest.cc:174</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a33ef80e76a41d392da18e323e60aad6c"><div class="ttname"><a href="classHttpRequest.html#a33ef80e76a41d392da18e323e60aad6c">HttpRequest::indirect_client_addr</a></div><div class="ttdeci">Ip::Address indirect_client_addr</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00152">HttpRequest.h:152</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a5f8f335cf16fa13580238d91973bc566"><div class="ttname"><a href="classHttpRequest.html#a5f8f335cf16fa13580238d91973bc566">HttpRequest::ims</a></div><div class="ttdeci">time_t ims</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00145">HttpRequest.h:145</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a6617b5b1e4c90874af16ac68e0f8673c"><div class="ttname"><a href="classHttpRequest.html#a6617b5b1e4c90874af16ac68e0f8673c">HttpRequest::imslen</a></div><div class="ttdeci">int imslen</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00147">HttpRequest.h:147</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a760997c2728fee37daff20549eab2d74"><div class="ttname"><a href="classHttpRequest.html#a760997c2728fee37daff20549eab2d74">HttpRequest::store_id</a></div><div class="ttdeci">String store_id</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00139">HttpRequest.h:139</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a76422841293a4230a1a76479e6964c04"><div class="ttname"><a href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">HttpRequest::flags</a></div><div class="ttdeci">RequestFlags flags</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00141">HttpRequest.h:141</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a78716ec3adf40429095b375415093bfa"><div class="ttname"><a href="classHttpRequest.html#a78716ec3adf40429095b375415093bfa">HttpRequest::x_forwarded_for_iterator</a></div><div class="ttdeci">String x_forwarded_for_iterator</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00185">HttpRequest.h:185</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a83bb32366a62b3f6b0e611c3bb4bf659"><div class="ttname"><a href="classHttpRequest.html#a83bb32366a62b3f6b0e611c3bb4bf659">HttpRequest::detailError</a></div><div class="ttdeci">void detailError(const err_type c, const ErrorDetail::Pointer &amp;d)</div><div class="ttdoc">sets error detail if no earlier detail was available</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00101">HttpRequest.h:101</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a88c3369b97fa30b60dc234b21dda9b91"><div class="ttname"><a href="classHttpRequest.html#a88c3369b97fa30b60dc234b21dda9b91">HttpRequest::notes</a></div><div class="ttdeci">NotePairs::Pointer notes()</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00749">HttpRequest.cc:749</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a98624db05b1d0e020b1178042857038b"><div class="ttname"><a href="classHttpRequest.html#a98624db05b1d0e020b1178042857038b">HttpRequest::pinnedConnection</a></div><div class="ttdeci">ConnStateData * pinnedConnection()</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00722">HttpRequest.cc:722</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_a9d63ea3655ec440fedf74c3eb2ea99e9"><div class="ttname"><a href="classHttpRequest.html#a9d63ea3655ec440fedf74c3eb2ea99e9">HttpRequest::ignoreRange</a></div><div class="ttdeci">void ignoreRange(const char *reason)</div><div class="ttdoc">forgets about the cached Range header (for a reason)</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00618">HttpRequest.cc:618</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_aaac8481b254d6cee121c75ae3e71ce8b"><div class="ttname"><a href="classHttpRequest.html#aaac8481b254d6cee121c75ae3e71ce8b">HttpRequest::storeId</a></div><div class="ttdeci">const SBuf storeId()</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00730">HttpRequest.cc:730</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_aad089156bdf4c54795c19ad20d332f4a"><div class="ttname"><a href="classHttpRequest.html#aad089156bdf4c54795c19ad20d332f4a">HttpRequest::maybeCacheable</a></div><div class="ttdeci">bool maybeCacheable()</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00535">HttpRequest.cc:535</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_ac0c4711b9c47a56e565c14b763d86214"><div class="ttname"><a href="classHttpRequest.html#ac0c4711b9c47a56e565c14b763d86214">HttpRequest::canonicalCleanUrl</a></div><div class="ttdeci">char * canonicalCleanUrl() const</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00810">HttpRequest.cc:810</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_ac2bbb9182fe895f52e1ac045ef717d76"><div class="ttname"><a href="classHttpRequest.html#ac2bbb9182fe895f52e1ac045ef717d76">HttpRequest::my_addr</a></div><div class="ttdeci">Ip::Address my_addr</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00155">HttpRequest.h:155</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_ac498f2030321d6bc845b115a5cabc6d1"><div class="ttname"><a href="classHttpRequest.html#ac498f2030321d6bc845b115a5cabc6d1">HttpRequest::auth_user_request</a></div><div class="ttdeci">Auth::UserRequest::Pointer auth_user_request</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00127">HttpRequest.h:127</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_aeeb3de67d14be944d152c249379832cb"><div class="ttname"><a href="classHttpRequest.html#aeeb3de67d14be944d152c249379832cb">HttpRequest::error</a></div><div class="ttdeci">Error error</div><div class="ttdoc">the first transaction problem encountered (or falsy)</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00161">HttpRequest.h:161</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_af12cd51466974ad702972c18238ef5a2"><div class="ttname"><a href="classHttpRequest.html#af12cd51466974ad702972c18238ef5a2">HttpRequest::icapHistory</a></div><div class="ttdeci">Adaptation::Icap::History::Pointer icapHistory() const</div><div class="ttdoc">Returns possibly nil history, creating it if icap logging is enabled.</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00386">HttpRequest.cc:386</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_af191362e7cf9b99f7f15dd20a0076e89"><div class="ttname"><a href="classHttpRequest.html#af191362e7cf9b99f7f15dd20a0076e89">HttpRequest::url</a></div><div class="ttdeci">AnyP::Uri url</div><div class="ttdoc">the request URI</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00115">HttpRequest.h:115</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_af6301466f6d3594f4fdacb4713a44c61"><div class="ttname"><a href="classHttpRequest.html#af6301466f6d3594f4fdacb4713a44c61">HttpRequest::client_addr</a></div><div class="ttdeci">Ip::Address client_addr</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8h_source.html#l00149">HttpRequest.h:149</a></div></div>
<div class="ttc" id="aclassHttpRequest_html_afc7b4dd61a4232033c8b06826f02ae29"><div class="ttname"><a href="classHttpRequest.html#afc7b4dd61a4232033c8b06826f02ae29">HttpRequest::effectiveRequestUri</a></div><div class="ttdeci">const SBuf &amp; effectiveRequestUri() const</div><div class="ttdoc">RFC 7230 section 5.5 - Effective Request URI.</div><div class="ttdef"><b>Definition</b> <a href="HttpRequest_8cc_source.html#l00741">HttpRequest.cc:741</a></div></div>
<div class="ttc" id="aclassHttp_1_1HeaderLookupTable__t_html_ad0a69236a64abb15d18d914cce89bc48"><div class="ttname"><a href="classHttp_1_1HeaderLookupTable__t.html#ad0a69236a64abb15d18d914cce89bc48">Http::HeaderLookupTable_t::lookup</a></div><div class="ttdeci">const HeaderTableRecord &amp; lookup(const char *buf, const std::size_t len) const</div><div class="ttdoc">look record type up by name (C-string and length)</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8cc_source.html#l00032">RegisteredHeaders.cc:32</a></div></div>
<div class="ttc" id="aclassHttp_1_1HeaderTableRecord_html_a99dc1fa2b3d56798babeac7f436305ff"><div class="ttname"><a href="classHttp_1_1HeaderTableRecord.html#a99dc1fa2b3d56798babeac7f436305ff">Http::HeaderTableRecord::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00158">RegisteredHeaders.h:158</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html"><div class="ttname"><a href="classHttp_1_1Message.html">Http::Message</a></div><div class="ttdoc">common parts of HttpRequest and HttpReply</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00025">Message.h:26</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_a79ae935ff618211b139dcfdd8a5277ec"><div class="ttname"><a href="classHttp_1_1Message.html#a79ae935ff618211b139dcfdd8a5277ec">Http::Message::header</a></div><div class="ttdeci">HttpHeader header</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00074">Message.h:74</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_ad9f13ecd98f1ef921791a25163226f39"><div class="ttname"><a href="classHttp_1_1Message.html#ad9f13ecd98f1ef921791a25163226f39">Http::Message::body_pipe</a></div><div class="ttdeci">BodyPipe::Pointer body_pipe</div><div class="ttdoc">optional pipeline to receive message body</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00097">Message.h:97</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_adecda0b631f46c076e91fb61d429a865"><div class="ttname"><a href="classHttp_1_1Message.html#adecda0b631f46c076e91fb61d429a865">Http::Message::cache_control</a></div><div class="ttdeci">HttpHdrCc * cache_control</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00076">Message.h:76</a></div></div>
<div class="ttc" id="aclassHttp_1_1Message_html_afcb0c1d278e61a1379032790c427788d"><div class="ttname"><a href="classHttp_1_1Message.html#afcb0c1d278e61a1379032790c427788d">Http::Message::http_ver</a></div><div class="ttdeci">AnyP::ProtocolVersion http_ver</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00072">Message.h:72</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html"><div class="ttname"><a href="classIp_1_1Address.html">Ip::Address</a></div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8h_source.html#l00042">Address.h:43</a></div></div>
<div class="ttc" id="aclassIp_1_1Address_html_aeea3c669850f18acd2efcd336fcf2438"><div class="ttname"><a href="classIp_1_1Address.html#aeea3c669850f18acd2efcd336fcf2438">Ip::Address::port</a></div><div class="ttdeci">unsigned short port() const</div><div class="ttdef"><b>Definition</b> <a href="ip_2Address_8cc_source.html#l00790">Address.cc:790</a></div></div>
<div class="ttc" id="aclassMemBuf_html_aaaf0cc30487417b07680613bcf518dca"><div class="ttname"><a href="classMemBuf.html#aaaf0cc30487417b07680613bcf518dca">MemBuf::contentSize</a></div><div class="ttdeci">mb_size_t contentSize() const</div><div class="ttdoc">available data size</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8h_source.html#l00047">MemBuf.h:47</a></div></div>
<div class="ttc" id="aclassMemBuf_html_ab56abceebd43d65f6634708808911987"><div class="ttname"><a href="classMemBuf.html#ab56abceebd43d65f6634708808911987">MemBuf::consume</a></div><div class="ttdeci">void consume(mb_size_t sz)</div><div class="ttdoc">removes sz bytes and &quot;packs&quot; by moving content left</div><div class="ttdef"><b>Definition</b> <a href="MemBuf_8cc_source.html#l00168">MemBuf.cc:168</a></div></div>
<div class="ttc" id="aclassMemObject_html_ad5355b4679045222e5ea75b0c36f16c4"><div class="ttname"><a href="classMemObject.html#ad5355b4679045222e5ea75b0c36f16c4">MemObject::baseReply</a></div><div class="ttdeci">const HttpReply &amp; baseReply() const</div><div class="ttdef"><b>Definition</b> <a href="MemObject_8h_source.html#l00060">MemObject.h:60</a></div></div>
<div class="ttc" id="aclassNotePairs_html_a0235547d238fc65bbf8088f62c1cb085"><div class="ttname"><a href="classNotePairs.html#a0235547d238fc65bbf8088f62c1cb085">NotePairs::appendNewOnly</a></div><div class="ttdeci">void appendNewOnly(const NotePairs *src)</div><div class="ttdef"><b>Definition</b> <a href="Notes_8cc_source.html#l00391">Notes.cc:391</a></div></div>
<div class="ttc" id="aclassNotePairs_html_a8fd18fa94362de739d33ec0259bc4505"><div class="ttname"><a href="classNotePairs.html#a8fd18fa94362de739d33ec0259bc4505">NotePairs::findFirst</a></div><div class="ttdeci">const char * findFirst(const char *noteKey) const</div><div class="ttdef"><b>Definition</b> <a href="Notes_8cc_source.html#l00307">Notes.cc:307</a></div></div>
<div class="ttc" id="aclassNullaryMemFunT_html"><div class="ttname"><a href="classNullaryMemFunT.html">NullaryMemFunT</a></div><div class="ttdef"><b>Definition</b> <a href="AsyncJobCalls_8h_source.html#l00091">AsyncJobCalls.h:92</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div><div class="ttdef"><b>Definition</b> <a href="Range_8h_source.html#l00018">Range.h:19</a></div></div>
<div class="ttc" id="aclassRefCount_html"><div class="ttname"><a href="classRefCount.html">RefCount&lt; AccessLogEntry &gt;</a></div></div>
<div class="ttc" id="aclassRefCount_html_a9f2168c1df4a4ab6b7931425d85c37f0"><div class="ttname"><a href="classRefCount.html#a9f2168c1df4a4ab6b7931425d85c37f0">RefCount::getRaw</a></div><div class="ttdeci">C * getRaw() const</div><div class="ttdef"><b>Definition</b> <a href="RefCount_8h_source.html#l00089">RefCount.h:89</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a02092fe75d2b0aadb80ebdef09ebdb1e"><div class="ttname"><a href="classRequestFlags.html#a02092fe75d2b0aadb80ebdef09ebdb1e">RequestFlags::doneFollowXff</a></div><div class="ttdeci">bool doneFollowXff() const</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00128">RequestFlags.h:128</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a067afb76219d72cd969eba5e44c6a9ea"><div class="ttname"><a href="classRequestFlags.html#a067afb76219d72cd969eba5e44c6a9ea">RequestFlags::interceptTproxy</a></div><div class="ttdeci">bool interceptTproxy</div><div class="ttdoc">Set for requests handled by a &quot;tproxy&quot; port.</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00070">RequestFlags.h:70</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a0e7db730c27abb7eac3b676961773797"><div class="ttname"><a href="classRequestFlags.html#a0e7db730c27abb7eac3b676961773797">RequestFlags::accelerated</a></div><div class="ttdeci">bool accelerated</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00062">RequestFlags.h:62</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a12193c977b3da18c04e6e4b350e860ba"><div class="ttname"><a href="classRequestFlags.html#a12193c977b3da18c04e6e4b350e860ba">RequestFlags::ims</a></div><div class="ttdeci">bool ims</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00028">RequestFlags.h:28</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a1cb8c962b36f5ebd3f897fede719dd43"><div class="ttname"><a href="classRequestFlags.html#a1cb8c962b36f5ebd3f897fede719dd43">RequestFlags::connectionAuth</a></div><div class="ttdeci">bool connectionAuth</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00085">RequestFlags.h:85</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a1e4c34b9be432a556d28cd9da295eb41"><div class="ttname"><a href="classRequestFlags.html#a1e4c34b9be432a556d28cd9da295eb41">RequestFlags::isRanged</a></div><div class="ttdeci">bool isRanged</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00117">RequestFlags.h:117</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a1ec3ec0b8c3d8f8cd603180e8312885b"><div class="ttname"><a href="classRequestFlags.html#a1ec3ec0b8c3d8f8cd603180e8312885b">RequestFlags::forceTunnel</a></div><div class="ttdeci">bool forceTunnel</div><div class="ttdoc">whether to forward via TunnelStateData (instead of FwdState)</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00120">RequestFlags.h:120</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a26c4900e600bc57c506766fcbdf3c0e3"><div class="ttname"><a href="classRequestFlags.html#a26c4900e600bc57c506766fcbdf3c0e3">RequestFlags::internal</a></div><div class="ttdeci">bool internal</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00080">RequestFlags.h:80</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a452db2a617d946222557c73d97888918"><div class="ttname"><a href="classRequestFlags.html#a452db2a617d946222557c73d97888918">RequestFlags::noCache</a></div><div class="ttdeci">bool noCache</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00026">RequestFlags.h:26</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a58d2a443729b565caed5fa174a975fbc"><div class="ttname"><a href="classRequestFlags.html#a58d2a443729b565caed5fa174a975fbc">RequestFlags::connectionProxyAuth</a></div><div class="ttdeci">bool connectionProxyAuth</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00090">RequestFlags.h:90</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a70ad8dd58ad2ad4d515f11c74c085472"><div class="ttname"><a href="classRequestFlags.html#a70ad8dd58ad2ad4d515f11c74c085472">RequestFlags::hostVerified</a></div><div class="ttdeci">bool hostVerified</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00068">RequestFlags.h:68</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a71595a4670414eec0b1aa2cd8b205590"><div class="ttname"><a href="classRequestFlags.html#a71595a4670414eec0b1aa2cd8b205590">RequestFlags::done_follow_x_forwarded_for</a></div><div class="ttdeci">bool done_follow_x_forwarded_for</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00108">RequestFlags.h:108</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a7a87d1bd6000a6ce88eae02e6edf9f4c"><div class="ttname"><a href="classRequestFlags.html#a7a87d1bd6000a6ce88eae02e6edf9f4c">RequestFlags::disableCacheUse</a></div><div class="ttdeci">void disableCacheUse(const char *reason)</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8cc_source.html#l00030">RequestFlags.cc:30</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a7feb14e42e2a35fb38fb744e98b8af7b"><div class="ttname"><a href="classRequestFlags.html#a7feb14e42e2a35fb38fb744e98b8af7b">RequestFlags::intercepted</a></div><div class="ttdeci">bool intercepted</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00066">RequestFlags.h:66</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_a900c1d5ec957547f3f15a76d5b4ca854"><div class="ttname"><a href="classRequestFlags.html#a900c1d5ec957547f3f15a76d5b4ca854">RequestFlags::nocacheHack</a></div><div class="ttdeci">bool nocacheHack</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00060">RequestFlags.h:60</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_abbde600374891ccc540eea4812414b69"><div class="ttname"><a href="classRequestFlags.html#abbde600374891ccc540eea4812414b69">RequestFlags::sslBumped</a></div><div class="ttdeci">bool sslBumped</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00110">RequestFlags.h:110</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_abccdcdee48ee6281933ecff24d265b0e"><div class="ttname"><a href="classRequestFlags.html#abccdcdee48ee6281933ecff24d265b0e">RequestFlags::auth</a></div><div class="ttdeci">bool auth</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00030">RequestFlags.h:30</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_acbd8e449ba6d3cc3b181d714a4539f00"><div class="ttname"><a href="classRequestFlags.html#acbd8e449ba6d3cc3b181d714a4539f00">RequestFlags::redirected</a></div><div class="ttdeci">bool redirected</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00046">RequestFlags.h:46</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_ace4ab3e57a3fa9e3197ce200ecdf653a"><div class="ttname"><a href="classRequestFlags.html#ace4ab3e57a3fa9e3197ce200ecdf653a">RequestFlags::loopDetected</a></div><div class="ttdeci">bool loopDetected</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00040">RequestFlags.h:40</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_acf71a0fdc5234b31ec50cc2d53142377"><div class="ttname"><a href="classRequestFlags.html#acf71a0fdc5234b31ec50cc2d53142377">RequestFlags::ignoreCc</a></div><div class="ttdeci">bool ignoreCc</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00064">RequestFlags.h:64</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_ad71e99859e4130efc5ef12af8aaefe98"><div class="ttname"><a href="classRequestFlags.html#ad71e99859e4130efc5ef12af8aaefe98">RequestFlags::connectionAuthDisabled</a></div><div class="ttdeci">bool connectionAuthDisabled</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00087">RequestFlags.h:87</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_af33cb0e80d9996c532479ef942d1eb91"><div class="ttname"><a href="classRequestFlags.html#af33cb0e80d9996c532479ef942d1eb91">RequestFlags::cachable</a></div><div class="ttdeci">SupportOrVeto cachable</div><div class="ttdoc">whether the response may be stored in the cache</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00035">RequestFlags.h:35</a></div></div>
<div class="ttc" id="aclassRequestFlags_html_af8a2c52a07a38ceb366a512eab1d854b"><div class="ttname"><a href="classRequestFlags.html#af8a2c52a07a38ceb366a512eab1d854b">RequestFlags::hierarchical</a></div><div class="ttdeci">bool hierarchical</div><div class="ttdef"><b>Definition</b> <a href="RequestFlags_8h_source.html#l00038">RequestFlags.h:38</a></div></div>
<div class="ttc" id="aclassSBuf_html"><div class="ttname"><a href="classSBuf.html">SBuf</a></div><div class="ttdef"><b>Definition</b> <a href="SBuf_8h_source.html#l00093">SBuf.h:94</a></div></div>
<div class="ttc" id="aclassSBuf_html_a2a7fda503e54cb36b023dcaaab633f65"><div class="ttname"><a href="classSBuf.html#a2a7fda503e54cb36b023dcaaab633f65">SBuf::c_str</a></div><div class="ttdeci">const char * c_str()</div><div class="ttdef"><b>Definition</b> <a href="SBuf_8cc_source.html#l00516">SBuf.cc:516</a></div></div>
<div class="ttc" id="aclassSecurity_1_1LockingPointer_html_a761bee3ceb5853c9098117f6d3f657eb"><div class="ttname"><a href="classSecurity_1_1LockingPointer.html#a761bee3ceb5853c9098117f6d3f657eb">Security::LockingPointer::resetWithoutLocking</a></div><div class="ttdeci">void resetWithoutLocking(T *t)</div><div class="ttdoc">Reset raw pointer - unlock any previous one and save new one without locking.</div><div class="ttdef"><b>Definition</b> <a href="LockingPointer_8h_source.html#l00106">LockingPointer.h:106</a></div></div>
<div class="ttc" id="aclassServer_html_a58c3313bde9ea0c6e23f047d203187dc"><div class="ttname"><a href="classServer.html#a58c3313bde9ea0c6e23f047d203187dc">Server::clientConnection</a></div><div class="ttdeci">Comm::ConnectionPointer clientConnection</div><div class="ttdef"><b>Definition</b> <a href="Server_8h_source.html#l00100">Server.h:100</a></div></div>
<div class="ttc" id="aclassServer_html_a8ca89bbc00095c4706eb2131889fb26d"><div class="ttname"><a href="classServer.html#a8ca89bbc00095c4706eb2131889fb26d">Server::stopReading</a></div><div class="ttdeci">void stopReading()</div><div class="ttdoc">cancels Comm::Read() if it is scheduled</div><div class="ttdef"><b>Definition</b> <a href="Server_8cc_source.html#l00060">Server.cc:60</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a10bc53b0e5cbf3ad43465d61e912f438"><div class="ttname"><a href="classSquidConfig.html#a10bc53b0e5cbf3ad43465d61e912f438">SquidConfig::adapted_http</a></div><div class="ttdeci">acl_access * adapted_http</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00360">SquidConfig.h:360</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a180efe1001cab8c4b64aed677cd2b9c0"><div class="ttname"><a href="classSquidConfig.html#a180efe1001cab8c4b64aed677cd2b9c0">SquidConfig::log_uses_indirect_client</a></div><div class="ttdeci">int log_uses_indirect_client</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00328">SquidConfig.h:328</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a192f4e4ee92d4a55bda1111f6388988f"><div class="ttname"><a href="classSquidConfig.html#a192f4e4ee92d4a55bda1111f6388988f">SquidConfig::acl_uses_indirect_client</a></div><div class="ttdeci">int acl_uses_indirect_client</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00326">SquidConfig.h:326</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a200f7109251db7e9719d331381aa8b2c"><div class="ttname"><a href="classSquidConfig.html#a200f7109251db7e9719d331381aa8b2c">SquidConfig::store_id</a></div><div class="ttdeci">wordlist * store_id</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00202">SquidConfig.h:202</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a29f05f66b8ce06a5465e7a6d70499db1"><div class="ttname"><a href="classSquidConfig.html#a29f05f66b8ce06a5465e7a6d70499db1">SquidConfig::followXFF</a></div><div class="ttdeci">acl_access * followXFF</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00391">SquidConfig.h:391</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a30a3d4912be2414f5f5075fc696d7c6d"><div class="ttname"><a href="classSquidConfig.html#a30a3d4912be2414f5f5075fc696d7c6d">SquidConfig::redirector</a></div><div class="ttdeci">acl_access * redirector</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00377">SquidConfig.h:377</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a430c99a1ac73f36a587a63bf2b91eb66"><div class="ttname"><a href="classSquidConfig.html#a430c99a1ac73f36a587a63bf2b91eb66">SquidConfig::hostStrictVerify</a></div><div class="ttdeci">int hostStrictVerify</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00337">SquidConfig.h:337</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a4b49febd900d168bbb6f89af1a331b33"><div class="ttname"><a href="classSquidConfig.html#a4b49febd900d168bbb6f89af1a331b33">SquidConfig::reload_into_ims</a></div><div class="ttdeci">int reload_into_ims</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00293">SquidConfig.h:293</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a4f8434f02e4ddaf8a7397a902b250be5"><div class="ttname"><a href="classSquidConfig.html#a4f8434f02e4ddaf8a7397a902b250be5">SquidConfig::http</a></div><div class="ttdeci">acl_access * http</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00359">SquidConfig.h:359</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a51a38078dc00ab41305e3439e0be5160"><div class="ttname"><a href="classSquidConfig.html#a51a38078dc00ab41305e3439e0be5160">SquidConfig::Program</a></div><div class="ttdeci">struct SquidConfig::@83 Program</div></div>
<div class="ttc" id="aclassSquidConfig_html_a5a30792b1b32673c91bbf76ff503a087"><div class="ttname"><a href="classSquidConfig.html#a5a30792b1b32673c91bbf76ff503a087">SquidConfig::redirect</a></div><div class="ttdeci">wordlist * redirect</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00201">SquidConfig.h:201</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a7f8f0c2909a291f930e687d36f10106e"><div class="ttname"><a href="classSquidConfig.html#a7f8f0c2909a291f930e687d36f10106e">SquidConfig::surrogate_id</a></div><div class="ttdeci">char * surrogate_id</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00220">SquidConfig.h:220</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_a89bec7bc02d66eb2ab65c74c3f6b13ac"><div class="ttname"><a href="classSquidConfig.html#a89bec7bc02d66eb2ab65c74c3f6b13ac">SquidConfig::onoff</a></div><div class="ttdeci">struct SquidConfig::@90 onoff</div></div>
<div class="ttc" id="aclassSquidConfig_html_aa11776521bdbbd1348221ea9d7237907"><div class="ttname"><a href="classSquidConfig.html#aa11776521bdbbd1348221ea9d7237907">SquidConfig::icp</a></div><div class="ttdeci">unsigned short icp</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00141">SquidConfig.h:141</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_aa5cb356a718ae133f8c58f5d43cec405"><div class="ttname"><a href="classSquidConfig.html#aa5cb356a718ae133f8c58f5d43cec405">SquidConfig::onUrlRewriteTimeout</a></div><div class="ttdeci">struct SquidConfig::UrlHelperTimeout onUrlRewriteTimeout</div></div>
<div class="ttc" id="aclassSquidConfig_html_aa6bcbad5359c0b290dffff6716171c55"><div class="ttname"><a href="classSquidConfig.html#aa6bcbad5359c0b290dffff6716171c55">SquidConfig::ssl_bump</a></div><div class="ttdeci">acl_access * ssl_bump</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00388">SquidConfig.h:388</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_ac7f1138fffbdda4a9a888100e3187691"><div class="ttname"><a href="classSquidConfig.html#ac7f1138fffbdda4a9a888100e3187691">SquidConfig::accessList</a></div><div class="ttdeci">struct SquidConfig::@91 accessList</div></div>
<div class="ttc" id="aclassSquidConfig_html_ac7f4e2240c8dc2d56abe34caef997beb"><div class="ttname"><a href="classSquidConfig.html#ac7f4e2240c8dc2d56abe34caef997beb">SquidConfig::Port</a></div><div class="ttdeci">struct SquidConfig::@78 Port</div></div>
<div class="ttc" id="aclassSquidConfig_html_acf3a5393cee89bdde86ce50e0d15bbbd"><div class="ttname"><a href="classSquidConfig.html#acf3a5393cee89bdde86ce50e0d15bbbd">SquidConfig::Accel</a></div><div class="ttdeci">struct SquidConfig::@84 Accel</div></div>
<div class="ttc" id="aclassSquidConfig_html_ad0eb1efb330448abf65a159417f31f8e"><div class="ttname"><a href="classSquidConfig.html#ad0eb1efb330448abf65a159417f31f8e">SquidConfig::noCache</a></div><div class="ttdeci">acl_access * noCache</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00366">SquidConfig.h:366</a></div></div>
<div class="ttc" id="aclassSquidConfig_html_af176cee9d6decb267d306c6a0c2f5035"><div class="ttname"><a href="classSquidConfig.html#af176cee9d6decb267d306c6a0c2f5035">SquidConfig::global_internal_static</a></div><div class="ttdeci">int global_internal_static</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00322">SquidConfig.h:322</a></div></div>
<div class="ttc" id="aclassSsl_1_1ServerBump_html"><div class="ttname"><a href="classSsl_1_1ServerBump.html">Ssl::ServerBump</a></div><div class="ttdef"><b>Definition</b> <a href="ServerBump_8h_source.html#l00033">ServerBump.h:34</a></div></div>
<div class="ttc" id="aclassStoreEntry_html"><div class="ttname"><a href="classStoreEntry.html">StoreEntry</a></div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00037">Store.h:38</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a028aa7eef91cf47c704d42ab5ab58a42"><div class="ttname"><a href="classStoreEntry.html#a028aa7eef91cf47c704d42ab5ab58a42">StoreEntry::completeSuccessfully</a></div><div class="ttdeci">void completeSuccessfully(const char *whyWeAreSureWeStoredTheWholeReply)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01017">store.cc:1017</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a03097a677184f0c65ad08f031e30fa21"><div class="ttname"><a href="classStoreEntry.html#a03097a677184f0c65ad08f031e30fa21">StoreEntry::bytesWanted</a></div><div class="ttdeci">size_t bytesWanted(Range&lt; size_t &gt; const aRange, bool ignoreDelayPool=false) const</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00213">store.cc:213</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a32b9d771a1b58fd4ae471fcda46cd4c4"><div class="ttname"><a href="classStoreEntry.html#a32b9d771a1b58fd4ae471fcda46cd4c4">StoreEntry::completeTruncated</a></div><div class="ttdeci">void completeTruncated(const char *whyWeConsiderTheReplyTruncated)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01024">store.cc:1024</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a35618603cff249c1cc64abf8127f3b7d"><div class="ttname"><a href="classStoreEntry.html#a35618603cff249c1cc64abf8127f3b7d">StoreEntry::unlock</a></div><div class="ttdeci">int unlock(const char *context)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00469">store.cc:469</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a3ae4c0876a20686e558e7183b67805f4"><div class="ttname"><a href="classStoreEntry.html#a3ae4c0876a20686e558e7183b67805f4">StoreEntry::complete</a></div><div class="ttdeci">void complete()</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01031">store.cc:1031</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a4fddeabe874c22dc83799d0f69a95fd2"><div class="ttname"><a href="classStoreEntry.html#a4fddeabe874c22dc83799d0f69a95fd2">StoreEntry::write</a></div><div class="ttdeci">void write(StoreIOBuffer)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00780">store.cc:780</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a53a607cfbdb22fde40edd2c72bfb6dd3"><div class="ttname"><a href="classStoreEntry.html#a53a607cfbdb22fde40edd2c72bfb6dd3">StoreEntry::lock</a></div><div class="ttdeci">void lock(const char *context)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00445">store.cc:445</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_a5bc295d1b8532fe259f903a6e9128d66"><div class="ttname"><a href="classStoreEntry.html#a5bc295d1b8532fe259f903a6e9128d66">StoreEntry::timestampsSet</a></div><div class="ttdeci">bool timestampsSet()</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01387">store.cc:1387</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_aae28c5e9a323d60ac8fe8ce98f6eb7c5"><div class="ttname"><a href="classStoreEntry.html#aae28c5e9a323d60ac8fe8ce98f6eb7c5">StoreEntry::replaceHttpReply</a></div><div class="ttdeci">void replaceHttpReply(const HttpReplyPointer &amp;, const bool andStartWriting=true)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l01705">store.cc:1705</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_ae4dc05b6c5ca398130c0a155156592d2"><div class="ttname"><a href="classStoreEntry.html#ae4dc05b6c5ca398130c0a155156592d2">StoreEntry::isEmpty</a></div><div class="ttdeci">bool isEmpty() const</div><div class="ttdef"><b>Definition</b> <a href="Store_8h_source.html#l00065">Store.h:65</a></div></div>
<div class="ttc" id="aclassStoreEntry_html_af097b6c50d55016f786ca506cff868d6"><div class="ttname"><a href="classStoreEntry.html#af097b6c50d55016f786ca506cff868d6">StoreEntry::deferProducer</a></div><div class="ttdeci">void deferProducer(const AsyncCall::Pointer &amp;producer)</div><div class="ttdoc">call back producer when more buffer space is available</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00366">store.cc:366</a></div></div>
<div class="ttc" id="aclassStoreIOBuffer_html"><div class="ttname"><a href="classStoreIOBuffer.html">StoreIOBuffer</a></div><div class="ttdef"><b>Definition</b> <a href="StoreIOBuffer_8h_source.html#l00015">StoreIOBuffer.h:16</a></div></div>
<div class="ttc" id="aclassStoreIOBuffer_html_a97772bf328fe745e1d1fc23ee91cec39"><div class="ttname"><a href="classStoreIOBuffer.html#a97772bf328fe745e1d1fc23ee91cec39">StoreIOBuffer::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition</b> <a href="StoreIOBuffer_8h_source.html#l00057">StoreIOBuffer.h:57</a></div></div>
<div class="ttc" id="aclassString_html"><div class="ttname"><a href="classString.html">String</a></div><div class="ttdef"><b>Definition</b> <a href="SquidString_8h_source.html#l00026">SquidString.h:27</a></div></div>
<div class="ttc" id="aclassString_html_a60a0fdff84d3470d812b2adbcb2cbf38"><div class="ttname"><a href="classString.html#a60a0fdff84d3470d812b2adbcb2cbf38">String::clean</a></div><div class="ttdeci">void clean()</div><div class="ttdef"><b>Definition</b> <a href="String_8cc_source.html#l00104">String.cc:104</a></div></div>
<div class="ttc" id="aclassString_html_a77a7c8c6845f33722735772524b8034d"><div class="ttname"><a href="classString.html#a77a7c8c6845f33722735772524b8034d">String::rawBuf</a></div><div class="ttdeci">char const * rawBuf() const</div><div class="ttdef"><b>Definition</b> <a href="SquidString_8h_source.html#l00087">SquidString.h:87</a></div></div>
<div class="ttc" id="aclassString_html_a81bb18e2351263a07da5ee354034abc4"><div class="ttname"><a href="classString.html#a81bb18e2351263a07da5ee354034abc4">String::cut</a></div><div class="ttdeci">void cut(size_type newLength)</div><div class="ttdef"><b>Definition</b> <a href="String_8cc_source.html#l00210">String.cc:210</a></div></div>
<div class="ttc" id="aclassString_html_aba5551ee62c6e82730c0cb1856238c14"><div class="ttname"><a href="classString.html#aba5551ee62c6e82730c0cb1856238c14">String::termedBuf</a></div><div class="ttdeci">char const * termedBuf() const</div><div class="ttdef"><b>Definition</b> <a href="SquidString_8h_source.html#l00093">SquidString.h:93</a></div></div>
<div class="ttc" id="aclassString_html_aff70196bf32e527af1116bb4eb93f353"><div class="ttname"><a href="classString.html#aff70196bf32e527af1116bb4eb93f353">String::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition</b> <a href="SquidString_8h_source.html#l00074">SquidString.h:74</a></div></div>
<div class="ttc" id="aclassSupportOrVeto_html_a89cd12f04613edb8f17087b2ae1e2a3a"><div class="ttname"><a href="classSupportOrVeto.html#a89cd12f04613edb8f17087b2ae1e2a3a">SupportOrVeto::support</a></div><div class="ttdeci">void support()</div><div class="ttdef"><b>Definition</b> <a href="SupportOrVeto_8h_source.html#l00026">SupportOrVeto.h:26</a></div></div>
<div class="ttc" id="aclassSupportOrVeto_html_aa34618d1c0303ab67ec91663d046faea"><div class="ttname"><a href="classSupportOrVeto.html#aa34618d1c0303ab67ec91663d046faea">SupportOrVeto::veto</a></div><div class="ttdeci">void veto()</div><div class="ttdoc">makes decision() false regardless of past or future support() calls</div><div class="ttdef"><b>Definition</b> <a href="SupportOrVeto_8h_source.html#l00029">SupportOrVeto.h:29</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html"><div class="ttname"><a href="classclientReplyContext.html">clientReplyContext</a></div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8h_source.html#l00022">client_side_reply.h:23</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a52e1f683492128736519f7389c712b6c"><div class="ttname"><a href="classclientReplyContext.html#a52e1f683492128736519f7389c712b6c">clientReplyContext::createStoreEntry</a></div><div class="ttdeci">void createStoreEntry(const HttpRequestMethod &amp;m, RequestFlags flags)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l02065">client_side_reply.cc:2065</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_a54642fc1f8d38e1860d4e945d820889d"><div class="ttname"><a href="classclientReplyContext.html#a54642fc1f8d38e1860d4e945d820889d">clientReplyContext::setReplyToStoreEntry</a></div><div class="ttdeci">void setReplyToStoreEntry(StoreEntry *e, const char *reason)</div><div class="ttdoc">replaces current response store entry with the given one</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00152">client_side_reply.cc:152</a></div></div>
<div class="ttc" id="aclassclientReplyContext_html_aefdedf444de122be303a2c56dc7ef1a9"><div class="ttname"><a href="classclientReplyContext.html#aefdedf444de122be303a2c56dc7ef1a9">clientReplyContext::setReplyToError</a></div><div class="ttdeci">void setReplyToError(err_type, Http::StatusCode, char const *, const ConnStateData *, HttpRequest *, const char *, Auth::UserRequest::Pointer)</div><div class="ttdoc">builds error using clientBuildError() and calls setReplyToError() below</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l00094">client_side_reply.cc:94</a></div></div>
<div class="ttc" id="aclassclientStreamNode_html"><div class="ttname"><a href="classclientStreamNode.html">clientStreamNode</a></div><div class="ttdef"><b>Definition</b> <a href="clientStream_8h_source.html#l00075">clientStream.h:76</a></div></div>
<div class="ttc" id="aclassdlink__list_html_a532f15958755b4d0d6356f7a52291d4e"><div class="ttname"><a href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">dlink_list::tail</a></div><div class="ttdeci">dlink_node * tail</div><div class="ttdef"><b>Definition</b> <a href="dlink_8h_source.html#l00027">dlink.h:27</a></div></div>
<div class="ttc" id="aclassdlink__node_html_a06bd2bfe93cc751ab5b29b033e6ac65e"><div class="ttname"><a href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">dlink_node::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition</b> <a href="dlink_8h_source.html#l00018">dlink.h:18</a></div></div>
<div class="ttc" id="aclassdlink__node_html_a4660c70e36112cd329b84f7152a671fa"><div class="ttname"><a href="classdlink__node.html#a4660c70e36112cd329b84f7152a671fa">dlink_node::prev</a></div><div class="ttdeci">dlink_node * prev</div><div class="ttdef"><b>Definition</b> <a href="dlink_8h_source.html#l00019">dlink.h:19</a></div></div>
<div class="ttc" id="aclientStreamForward_8h_html_ad7a8fcb0c65e986028978be921f80b4f"><div class="ttname"><a href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a></div><div class="ttdeci">void CSD(clientStreamNode *, ClientHttpRequest *)</div><div class="ttdoc">client stream detach</div><div class="ttdef"><b>Definition</b> <a href="clientStreamForward_8h_source.html#l00033">clientStreamForward.h:33</a></div></div>
<div class="ttc" id="aclientStreamForward_8h_html_adfeb9a20de88d7ad3433ca3c7f50a364"><div class="ttname"><a href="clientStreamForward_8h.html#adfeb9a20de88d7ad3433ca3c7f50a364">CSR</a></div><div class="ttdeci">void CSR(clientStreamNode *, ClientHttpRequest *)</div><div class="ttdoc">client stream read</div><div class="ttdef"><b>Definition</b> <a href="clientStreamForward_8h_source.html#l00030">clientStreamForward.h:30</a></div></div>
<div class="ttc" id="aclientStreamForward_8h_html_afe231eb7220220dab4804637c286f6e0"><div class="ttname"><a href="clientStreamForward_8h.html#afe231eb7220220dab4804637c286f6e0">CSS</a></div><div class="ttdeci">clientStream_status_t CSS(clientStreamNode *, ClientHttpRequest *)</div><div class="ttdef"><b>Definition</b> <a href="clientStreamForward_8h_source.html#l00035">clientStreamForward.h:35</a></div></div>
<div class="ttc" id="aclientStream_8h_html"><div class="ttname"><a href="clientStream_8h.html">clientStream.h</a></div></div>
<div class="ttc" id="aclient__side_8cc_html_aa43c942879dd80b024c465afa58f85aa"><div class="ttname"><a href="client__side_8cc.html#aa43c942879dd80b024c465afa58f85aa">clientAclChecklistCreate</a></div><div class="ttdeci">ACLFilledChecklist::MakingPointer clientAclChecklistCreate(const acl_access *acl, ClientHttpRequest *http)</div><div class="ttdef"><b>Definition</b> <a href="client__side_8cc_source.html#l03457">client_side.cc:3457</a></div></div>
<div class="ttc" id="aclient__side_8h_html"><div class="ttname"><a href="client__side_8h.html">client_side.h</a></div></div>
<div class="ttc" id="aclient__side_8h_html_ae73f7b10b6c2bd55c5f96c9d62839e8d"><div class="ttname"><a href="client__side_8h.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">clientGetMoreData</a></div><div class="ttdeci">CSR clientGetMoreData</div><div class="ttdef"><b>Definition</b> <a href="client__side_8h_source.html#l00529">client_side.h:529</a></div></div>
<div class="ttc" id="aclient__side__reply_8cc_html_a5e20e5ac82c3458028aa12cee83c7b39"><div class="ttname"><a href="client__side__reply_8cc.html#a5e20e5ac82c3458028aa12cee83c7b39">clientBuildError</a></div><div class="ttdeci">ErrorState * clientBuildError(err_type, Http::StatusCode, char const *, const ConnStateData *, HttpRequest *, const AccessLogEntry::Pointer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l02118">client_side_reply.cc:2118</a></div></div>
<div class="ttc" id="aclient__side__reply_8h_html"><div class="ttname"><a href="client__side__reply_8h.html">client_side_reply.h</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a22bce20949eaf9c5562098a53cb6fee0"><div class="ttname"><a href="client__side__request_8cc.html#a22bce20949eaf9c5562098a53cb6fee0">clientInterpretRequestHeaders</a></div><div class="ttdeci">static void clientInterpretRequestHeaders(ClientHttpRequest *http)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00887">client_side_request.cc:887</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a28ea36632dc8aa2f6dfd2f254bc6cc2f"><div class="ttname"><a href="client__side__request_8cc.html#a28ea36632dc8aa2f6dfd2f254bc6cc2f">clientRedirectAccessCheckDone</a></div><div class="ttdeci">static void clientRedirectAccessCheckDone(Acl::Answer answer, void *data)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00724">client_side_request.cc:724</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a3d42a7ece901f14e6ec973a0feb096e1"><div class="ttname"><a href="client__side__request_8cc.html#a3d42a7ece901f14e6ec973a0feb096e1">clientReplyStatus</a></div><div class="ttdeci">CSS clientReplyStatus</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00103">client_side_request.cc:103</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a3d74ef57ca7a73b9afcf11b39b232ca7"><div class="ttname"><a href="client__side__request_8cc.html#a3d74ef57ca7a73b9afcf11b39b232ca7">clientFollowXForwardedForCheck</a></div><div class="ttdeci">static void clientFollowXForwardedForCheck(Acl::Answer answer, void *data)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00302">client_side_request.cc:302</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a3e1608b9b7fdf0bb62db15dcd7ca0bc9"><div class="ttname"><a href="client__side__request_8cc.html#a3e1608b9b7fdf0bb62db15dcd7ca0bc9">FAILURE_MODE_TIME</a></div><div class="ttdeci">#define FAILURE_MODE_TIME</div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a4823e00c3c632f760a59b35b624145b5"><div class="ttname"><a href="client__side__request_8cc.html#a4823e00c3c632f760a59b35b624145b5">checkNoCacheDoneWrapper</a></div><div class="ttdeci">static void checkNoCacheDoneWrapper(Acl::Answer, void *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01225">client_side_request.cc:1225</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a4dfa5d0ca935688bbe22c2385d753b1e"><div class="ttname"><a href="client__side__request_8cc.html#a4dfa5d0ca935688bbe22c2385d753b1e">sslBumpAccessCheckDoneWrapper</a></div><div class="ttdeci">static void sslBumpAccessCheckDoneWrapper(Acl::Answer, void *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01321">client_side_request.cc:1321</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a5060082d1706884b9f28609a295f7e5a"><div class="ttname"><a href="client__side__request_8cc.html#a5060082d1706884b9f28609a295f7e5a">clientBuildError</a></div><div class="ttdeci">ErrorState * clientBuildError(err_type, Http::StatusCode, char const *url, const ConnStateData *, HttpRequest *, const AccessLogEntry::Pointer &amp;)</div><div class="ttdef"><b>Definition</b> <a href="client__side__reply_8cc_source.html#l02118">client_side_reply.cc:2118</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a656ae23809551213625e54ef0febc910"><div class="ttname"><a href="client__side__request_8cc.html#a656ae23809551213625e54ef0febc910">hostHeaderIpVerifyWrapper</a></div><div class="ttdeci">static void hostHeaderIpVerifyWrapper(const ipcache_addrs *ia, const Dns::LookupDetails &amp;dns, void *data)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00387">client_side_request.cc:387</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a6fab94b46ff30d5e7f3164db7b456870"><div class="ttname"><a href="client__side__request_8cc.html#a6fab94b46ff30d5e7f3164db7b456870">clientCheckPinning</a></div><div class="ttdeci">static void clientCheckPinning(ClientHttpRequest *http)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00826">client_side_request.cc:826</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a735a532956f51fa77e73d03064f13424"><div class="ttname"><a href="client__side__request_8cc.html#a735a532956f51fa77e73d03064f13424">clientHierarchical</a></div><div class="ttdeci">static int clientHierarchical(ClientHttpRequest *http)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00786">client_side_request.cc:786</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a80f5c9d940e83a142afa6e7591f27f52"><div class="ttname"><a href="client__side__request_8cc.html#a80f5c9d940e83a142afa6e7591f27f52">clientStoreIdDoneWrapper</a></div><div class="ttdeci">static HLPCB clientStoreIdDoneWrapper</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00100">client_side_request.cc:100</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a8d7a17ceeb383ec58b528870cbc69d16"><div class="ttname"><a href="client__side__request_8cc.html#a8d7a17ceeb383ec58b528870cbc69d16">clientStoreIdAccessCheckDone</a></div><div class="ttdeci">static void clientStoreIdAccessCheckDone(Acl::Answer answer, void *data)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00754">client_side_request.cc:754</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a985be8c59ea695cbaa2c1953ea90b5f7"><div class="ttname"><a href="client__side__request_8cc.html#a985be8c59ea695cbaa2c1953ea90b5f7">checkFailureRatio</a></div><div class="ttdeci">static void checkFailureRatio(err_type, hier_code)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00179">client_side_request.cc:179</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_a998efc2ba7574e34f7266f22bdb6b5ea"><div class="ttname"><a href="client__side__request_8cc.html#a998efc2ba7574e34f7266f22bdb6b5ea">clientRedirectDoneWrapper</a></div><div class="ttdeci">static HLPCB clientRedirectDoneWrapper</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00099">client_side_request.cc:99</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_ab806362f706a7b39732957bb45e3c2df"><div class="ttname"><a href="client__side__request_8cc.html#ab806362f706a7b39732957bb45e3c2df">clientReplyDetach</a></div><div class="ttdeci">CSD clientReplyDetach</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00104">client_side_request.cc:104</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_ac83479871c875bdb5f7245fa03b9fdb1"><div class="ttname"><a href="client__side__request_8cc.html#ac83479871c875bdb5f7245fa03b9fdb1">clientAccessCheckDoneWrapper</a></div><div class="ttdeci">static void clientAccessCheckDoneWrapper(Acl::Answer, void *)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00607">client_side_request.cc:607</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_ae73f7b10b6c2bd55c5f96c9d62839e8d"><div class="ttname"><a href="client__side__request_8cc.html#ae73f7b10b6c2bd55c5f96c9d62839e8d">clientGetMoreData</a></div><div class="ttdeci">CSR clientGetMoreData</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00102">client_side_request.cc:102</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_ae8bc52b96ef80d3fb21368626967ac1e"><div class="ttname"><a href="client__side__request_8cc.html#ae8bc52b96ef80d3fb21368626967ac1e">SslBumpEstablish</a></div><div class="ttdeci">static void SslBumpEstablish(const Comm::ConnectionPointer &amp;, char *, size_t, Comm::Flag errflag, int, void *data)</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l01408">client_side_request.cc:1408</a></div></div>
<div class="ttc" id="aclient__side__request_8cc_html_afbc1de07ad7aca7bdbfd47333a41ecfa"><div class="ttname"><a href="client__side__request_8cc.html#afbc1de07ad7aca7bdbfd47333a41ecfa">SQUID_X_FORWARDED_FOR_HOP_MAX</a></div><div class="ttdeci">#define SQUID_X_FORWARDED_FOR_HOP_MAX</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8cc_source.html#l00081">client_side_request.cc:81</a></div></div>
<div class="ttc" id="aclient__side__request_8h_html"><div class="ttname"><a href="client__side__request_8h.html">client_side_request.h</a></div></div>
<div class="ttc" id="aclient__side__request_8h_html_a463df90046fef514df797f43c881f0af"><div class="ttname"><a href="client__side__request_8h.html#a463df90046fef514df797f43c881f0af">tunnelStart</a></div><div class="ttdeci">void tunnelStart(ClientHttpRequest *)</div><div class="ttdef"><b>Definition</b> <a href="tunnel_8cc_source.html#l01182">tunnel.cc:1182</a></div></div>
<div class="ttc" id="adebug_2Messages_8h_html"><div class="ttname"><a href="debug_2Messages_8h.html">Messages.h</a></div></div>
<div class="ttc" id="adebug_2Messages_8h_html_a3627f132658efd674ba366496239d303"><div class="ttname"><a href="debug_2Messages_8h.html#a3627f132658efd674ba366496239d303">Important</a></div><div class="ttdeci">#define Important(id)</div><div class="ttdef"><b>Definition</b> <a href="debug_2Messages_8h_source.html#l00093">Messages.h:93</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_ad1f6f001d275799243ee96d0b1519d3a"><div class="ttname"><a href="debug_2Stream_8h.html#ad1f6f001d275799243ee96d0b1519d3a">DBG_IMPORTANT</a></div><div class="ttdeci">#define DBG_IMPORTANT</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00038">Stream.h:38</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_ad8cd33a7d75c0efd4d3fd369dc6a8f13"><div class="ttname"><a href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a></div><div class="ttdeci">#define debugs(SECTION, LEVEL, CONTENT)</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00192">Stream.h:192</a></div></div>
<div class="ttc" id="adebug_2Stream_8h_html_af0ecf487aee4d8ff164c0f40e71c5150"><div class="ttname"><a href="debug_2Stream_8h.html#af0ecf487aee4d8ff164c0f40e71c5150">DBG_CRITICAL</a></div><div class="ttdeci">#define DBG_CRITICAL</div><div class="ttdef"><b>Definition</b> <a href="debug_2Stream_8h_source.html#l00037">Stream.h:37</a></div></div>
<div class="ttc" id="adefines_8h_html_a30ba86da30acfd14e4a38c95aded3065"><div class="ttname"><a href="defines_8h.html#a30ba86da30acfd14e4a38c95aded3065">REDIRECT_DONE</a></div><div class="ttdeci">#define REDIRECT_DONE</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00055">defines.h:55</a></div></div>
<div class="ttc" id="adefines_8h_html_a35197769b18b837100d0576e84f8a63f"><div class="ttname"><a href="defines_8h.html#a35197769b18b837100d0576e84f8a63f">REDIRECT_PENDING</a></div><div class="ttdeci">#define REDIRECT_PENDING</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00054">defines.h:54</a></div></div>
<div class="ttc" id="adefines_8h_html_afcbf7727d6416354930cd43f1c1e480c"><div class="ttname"><a href="defines_8h.html#afcbf7727d6416354930cd43f1c1e480c">MAX_URL</a></div><div class="ttdeci">#define MAX_URL</div><div class="ttdef"><b>Definition</b> <a href="defines_8h_source.html#l00076">defines.h:76</a></div></div>
<div class="ttc" id="adlink_8cc_html_a26c24944a77583bb90a7efb1455a269b"><div class="ttname"><a href="dlink_8cc.html#a26c24944a77583bb90a7efb1455a269b">dlinkDelete</a></div><div class="ttdeci">void dlinkDelete(dlink_node *m, dlink_list *list)</div><div class="ttdef"><b>Definition</b> <a href="dlink_8cc_source.html#l00064">dlink.cc:64</a></div></div>
<div class="ttc" id="adlink_8cc_html_a6653213a8433b9e40b94980846e0634a"><div class="ttname"><a href="dlink_8cc.html#a6653213a8433b9e40b94980846e0634a">dlinkAdd</a></div><div class="ttdeci">void dlinkAdd(void *data, dlink_node *m, dlink_list *list)</div><div class="ttdef"><b>Definition</b> <a href="dlink_8cc_source.html#l00015">dlink.cc:15</a></div></div>
<div class="ttc" id="adlink_8cc_html_a9c55f8c6c000159340141e62253dc26f"><div class="ttname"><a href="dlink_8cc.html#a9c55f8c6c000159340141e62253dc26f">ClientActiveRequests</a></div><div class="ttdeci">dlink_list ClientActiveRequests</div><div class="ttdef"><b>Definition</b> <a href="dlink_8cc_source.html#l00012">dlink.cc:12</a></div></div>
<div class="ttc" id="aeDirectory_2ldap__backend_8cc_html_a63c89c04d1feae07ca35558055155ffb"><div class="ttname"><a href="eDirectory_2ldap__backend_8cc.html#a63c89c04d1feae07ca35558055155ffb">port</a></div><div class="ttdeci">static int port</div><div class="ttdef"><b>Definition</b> <a href="eDirectory_2ldap__backend_8cc_source.html#l00070">ldap_backend.cc:70</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1a"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1a">err_type</a></div><div class="ttdeci">err_type</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00014">forward.h:14</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa16e7157079ceea3394a7a000af25c013">ERR_ACCESS_DENIED</a></div><div class="ttdeci">@ ERR_ACCESS_DENIED</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00018">forward.h:18</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa25c9d005a130c3356ea3fb07785405ca"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa25c9d005a130c3356ea3fb07785405ca">ERR_CONNECT_FAIL</a></div><div class="ttdeci">@ ERR_CONNECT_FAIL</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00030">forward.h:30</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa298ac2b8812fe165e53492b830384bc5"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa298ac2b8812fe165e53492b830384bc5">ERR_SECURE_CONNECT_FAIL</a></div><div class="ttdeci">@ ERR_SECURE_CONNECT_FAIL</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00031">forward.h:31</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa3160dbf875ae8dc585f2ef9f5050b31e"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa3160dbf875ae8dc585f2ef9f5050b31e">ERR_DNS_FAIL</a></div><div class="ttdeci">@ ERR_DNS_FAIL</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00035">forward.h:35</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa484c5a83c6dddc445cad0243e75d88e1"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa484c5a83c6dddc445cad0243e75d88e1">ERR_GATEWAY_FAILURE</a></div><div class="ttdeci">@ ERR_GATEWAY_FAILURE</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00067">forward.h:67</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d">ERR_NONE</a></div><div class="ttdeci">@ ERR_NONE</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00015">forward.h:15</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aa684fdd96d3d0db7469e3826589467fe8"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa684fdd96d3d0db7469e3826589467fe8">ERR_ICAP_FAILURE</a></div><div class="ttdeci">@ ERR_ICAP_FAILURE</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00064">forward.h:64</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aab293f6e5c8060c0b9aab28a2a98b4b4c"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aab293f6e5c8060c0b9aab28a2a98b4b4c">ERR_CONFLICT_HOST</a></div><div class="ttdeci">@ ERR_CONFLICT_HOST</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00048">forward.h:48</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aacd0129ea7567a99caef7ab86ed500d9a"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aacd0129ea7567a99caef7ab86ed500d9a">ERR_READ_ERROR</a></div><div class="ttdeci">@ ERR_READ_ERROR</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00028">forward.h:28</a></div></div>
<div class="ttc" id="aerror_2forward_8h_html_a0c0ad09d74260ddc16d72bc291116e1aae0318cd74e59bed6f39622164c68bf4d"><div class="ttname"><a href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aae0318cd74e59bed6f39622164c68bf4d">ERR_CACHE_ACCESS_DENIED</a></div><div class="ttdeci">@ ERR_CACHE_ACCESS_DENIED</div><div class="ttdef"><b>Definition</b> <a href="error_2forward_8h_source.html#l00019">forward.h:19</a></div></div>
<div class="ttc" id="aerrorpage_8h_html"><div class="ttname"><a href="errorpage_8h.html">errorpage.h</a></div></div>
<div class="ttc" id="afd_8cc_html_a397dc4e5e5cf728d8f1a48b32cb4e60d"><div class="ttname"><a href="fd_8cc.html#a397dc4e5e5cf728d8f1a48b32cb4e60d">fd_note</a></div><div class="ttdeci">void fd_note(int fd, const char *s)</div><div class="ttdef"><b>Definition</b> <a href="fd_8cc_source.html#l00211">fd.cc:211</a></div></div>
<div class="ttc" id="afd_8h_html"><div class="ttname"><a href="fd_8h.html">fd.h</a></div></div>
<div class="ttc" id="afde_8h_html"><div class="ttname"><a href="fde_8h.html">fde.h</a></div></div>
<div class="ttc" id="afde_8h_html_a0f820c6a388ea0380a19a97713736a35"><div class="ttname"><a href="fde_8h.html#a0f820c6a388ea0380a19a97713736a35">fd_table</a></div><div class="ttdeci">#define fd_table</div><div class="ttdef"><b>Definition</b> <a href="fde_8h_source.html#l00189">fde.h:189</a></div></div>
<div class="ttc" id="aglobals_8h_html_a0eb6526f36d953cd406ec15754b5f4af"><div class="ttname"><a href="globals_8h.html#a0eb6526f36d953cd406ec15754b5f4af">refresh_nocache_hack</a></div><div class="ttdeci">int refresh_nocache_hack</div></div>
<div class="ttc" id="aglobals_8h_html_a14324d58b24c52ebef1fad97e595249d"><div class="ttname"><a href="globals_8h.html#a14324d58b24c52ebef1fad97e595249d">ThisCache2</a></div><div class="ttdeci">char ThisCache2[RFC2181_MAXHOSTNAMELEN&lt;&lt; 1]</div></div>
<div class="ttc" id="aglobals_8h_html_a861395382bde6d6cab9fb54fade35809"><div class="ttname"><a href="globals_8h.html#a861395382bde6d6cab9fb54fade35809">neighbors_do_private_keys</a></div><div class="ttdeci">int neighbors_do_private_keys</div></div>
<div class="ttc" id="aglobals_8h_html_adc11e3edf1986aba8ef7f5bc87ad5cc9"><div class="ttname"><a href="globals_8h.html#adc11e3edf1986aba8ef7f5bc87ad5cc9">request_failure_ratio</a></div><div class="ttdeci">double request_failure_ratio</div></div>
<div class="ttc" id="aglobals_8h_html_ae9785ae5ad141155f0d192ef337afaf1"><div class="ttname"><a href="globals_8h.html#ae9785ae5ad141155f0d192ef337afaf1">hit_only_mode_until</a></div><div class="ttdeci">time_t hit_only_mode_until</div></div>
<div class="ttc" id="agroup__ACLAPI_html_gga449cde9b9fa7a3ddb6d83d61080c1df5a859fbb6f0f22ef6a93c61d193077a33f"><div class="ttname"><a href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5a859fbb6f0f22ef6a93c61d193077a33f">ACCESS_AUTH_REQUIRED</a></div><div class="ttdeci">@ ACCESS_AUTH_REQUIRED</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00046">Acl.h:46</a></div></div>
<div class="ttc" id="agroup__ACLAPI_html_gga449cde9b9fa7a3ddb6d83d61080c1df5a9c57583ad491217a69a63fdabf336c8e"><div class="ttname"><a href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5a9c57583ad491217a69a63fdabf336c8e">ACCESS_DENIED</a></div><div class="ttdeci">@ ACCESS_DENIED</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00041">Acl.h:41</a></div></div>
<div class="ttc" id="agroup__ACLAPI_html_gga449cde9b9fa7a3ddb6d83d61080c1df5aa3d37d87d9b3887abc5466afb368cb8a"><div class="ttname"><a href="group__ACLAPI.html#gga449cde9b9fa7a3ddb6d83d61080c1df5aa3d37d87d9b3887abc5466afb368cb8a">ACCESS_ALLOWED</a></div><div class="ttdeci">@ ACCESS_ALLOWED</div><div class="ttdef"><b>Definition</b> <a href="acl_2Acl_8h_source.html#l00042">Acl.h:42</a></div></div>
<div class="ttc" id="agroup__ClientStreamInternal_html_ga54ab73d51a7454c7ccafed27b3f87011"><div class="ttname"><a href="group__ClientStreamInternal.html#ga54ab73d51a7454c7ccafed27b3f87011">clientStreamRead</a></div><div class="ttdeci">void clientStreamRead(clientStreamNode *thisObject, ClientHttpRequest *http, StoreIOBuffer readBuffer)</div><div class="ttdef"><b>Definition</b> <a href="clientStream_8cc_source.html#l00170">clientStream.cc:170</a></div></div>
<div class="ttc" id="agroup__ErrorPageAPI_html_gae984c9bcabfcfb5f0f732a501169a388"><div class="ttname"><a href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry</a></div><div class="ttdeci">void errorAppendEntry(StoreEntry *entry, ErrorState *err)</div><div class="ttdef"><b>Definition</b> <a href="errorpage_8cc_source.html#l00738">errorpage.cc:738</a></div></div>
<div class="ttc" id="agroup__IPCacheAPI_html_gae327ee2f13a395e7caeff7cbd783c765"><div class="ttname"><a href="group__IPCacheAPI.html#gae327ee2f13a395e7caeff7cbd783c765">ipcache_nbgethostbyname</a></div><div class="ttdeci">void ipcache_nbgethostbyname(const char *name, IPH *handler, void *handlerData)</div><div class="ttdef"><b>Definition</b> <a href="ipcache_8cc_source.html#l00609">ipcache.cc:609</a></div></div>
<div class="ttc" id="agroup__ServerProtocolSSLAPI_html_ga326212e49d2774b730d08ae598a11e30"><div class="ttname"><a href="group__ServerProtocolSSLAPI.html#ga326212e49d2774b730d08ae598a11e30">Ssl::bumpMode</a></div><div class="ttdeci">const char * bumpMode(int bm)</div><div class="ttdef"><b>Definition</b> <a href="ssl_2support_8h_source.html#l00144">support.h:144</a></div></div>
<div class="ttc" id="agroup__ServerProtocolSSLAPI_html_gadf059a1837d13958f66199a0b0676aa1"><div class="ttname"><a href="group__ServerProtocolSSLAPI.html#gadf059a1837d13958f66199a0b0676aa1">sslGetUserEmail</a></div><div class="ttdeci">const char * sslGetUserEmail(SSL *ssl)</div><div class="ttdef"><b>Definition</b> <a href="support_8cc_source.html#l00981">support.cc:981</a></div></div>
<div class="ttc" id="agroup__ServerProtocolSSLAPI_html_gae6b7865118af149a83cc4569060c1af9"><div class="ttname"><a href="group__ServerProtocolSSLAPI.html#gae6b7865118af149a83cc4569060c1af9">Ssl::BumpMode</a></div><div class="ttdeci">BumpMode</div><div class="ttdef"><b>Definition</b> <a href="ssl_2support_8h_source.html#l00132">support.h:132</a></div></div>
<div class="ttc" id="agroup__ServerProtocolSSLAPI_html_ggae6b7865118af149a83cc4569060c1af9a0048f5b977ec8cb08f3afa8f9554876a"><div class="ttname"><a href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a0048f5b977ec8cb08f3afa8f9554876a">Ssl::bumpTerminate</a></div><div class="ttdeci">@ bumpTerminate</div><div class="ttdef"><b>Definition</b> <a href="ssl_2support_8h_source.html#l00132">support.h:132</a></div></div>
<div class="ttc" id="agroup__ServerProtocolSSLAPI_html_ggae6b7865118af149a83cc4569060c1af9a06ff25b96e1b9974bda38b9fb3f8bd80"><div class="ttname"><a href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a06ff25b96e1b9974bda38b9fb3f8bd80">Ssl::bumpEnd</a></div><div class="ttdeci">@ bumpEnd</div><div class="ttdef"><b>Definition</b> <a href="ssl_2support_8h_source.html#l00132">support.h:132</a></div></div>
<div class="ttc" id="agroup__ServerProtocolSSLAPI_html_ggae6b7865118af149a83cc4569060c1af9a63dd03e830a0746569e5635a3dfa28dc"><div class="ttname"><a href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9a63dd03e830a0746569e5635a3dfa28dc">Ssl::bumpClientFirst</a></div><div class="ttdeci">@ bumpClientFirst</div><div class="ttdef"><b>Definition</b> <a href="ssl_2support_8h_source.html#l00132">support.h:132</a></div></div>
<div class="ttc" id="agroup__ServerProtocolSSLAPI_html_ggae6b7865118af149a83cc4569060c1af9aaa41037e8896833d425589e945cbb064"><div class="ttname"><a href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9aaa41037e8896833d425589e945cbb064">Ssl::bumpSplice</a></div><div class="ttdeci">@ bumpSplice</div><div class="ttdef"><b>Definition</b> <a href="ssl_2support_8h_source.html#l00132">support.h:132</a></div></div>
<div class="ttc" id="agroup__ServerProtocolSSLAPI_html_ggae6b7865118af149a83cc4569060c1af9ab474c808e5ea2e0c4a475c73bef1d399"><div class="ttname"><a href="group__ServerProtocolSSLAPI.html#ggae6b7865118af149a83cc4569060c1af9ab474c808e5ea2e0c4a475c73bef1d399">Ssl::bumpBump</a></div><div class="ttdeci">@ bumpBump</div><div class="ttdef"><b>Definition</b> <a href="ssl_2support_8h_source.html#l00132">support.h:132</a></div></div>
<div class="ttc" id="ahelper_2forward_8h_html_a25fa139de778b4cf256ada984da2be85"><div class="ttname"><a href="helper_2forward_8h.html#a25fa139de778b4cf256ada984da2be85">HLPCB</a></div><div class="ttdeci">void HLPCB(void *, const Helper::Reply &amp;)</div><div class="ttdef"><b>Definition</b> <a href="helper_2forward_8h_source.html#l00033">forward.h:33</a></div></div>
<div class="ttc" id="ahier__code_8h_html_a8836a137c62397b51ab64e564c94177d"><div class="ttname"><a href="hier__code_8h.html#a8836a137c62397b51ab64e564c94177d">hier_code</a></div><div class="ttdeci">hier_code</div><div class="ttdef"><b>Definition</b> <a href="hier__code_8h_source.html#l00012">hier_code.h:12</a></div></div>
<div class="ttc" id="ahier__code_8h_html_a8836a137c62397b51ab64e564c94177da3dd14aff7318d1e1ec693b032a493706"><div class="ttname"><a href="hier__code_8h.html#a8836a137c62397b51ab64e564c94177da3dd14aff7318d1e1ec693b032a493706">HIER_NONE</a></div><div class="ttdeci">@ HIER_NONE</div><div class="ttdef"><b>Definition</b> <a href="hier__code_8h_source.html#l00013">hier_code.h:13</a></div></div>
<div class="ttc" id="ahttp_2Message_8h_html_adc5c03415efc511e2b62e809310969b6"><div class="ttname"><a href="http_2Message_8h.html#adc5c03415efc511e2b62e809310969b6">HTTPMSGUNLOCK</a></div><div class="ttdeci">void HTTPMSGUNLOCK(M *&amp;a)</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00150">Message.h:150</a></div></div>
<div class="ttc" id="ahttp_2Message_8h_html_afbf13ecd1cc5c007367ae094c1aa19a9"><div class="ttname"><a href="http_2Message_8h.html#afbf13ecd1cc5c007367ae094c1aa19a9">HTTPMSGLOCK</a></div><div class="ttdeci">void HTTPMSGLOCK(Http::Message *a)</div><div class="ttdef"><b>Definition</b> <a href="http_2Message_8h_source.html#l00161">Message.h:161</a></div></div>
<div class="ttc" id="ahttp_2Stream_8h_html"><div class="ttname"><a href="http_2Stream_8h.html">Stream.h</a></div></div>
<div class="ttc" id="ahttp_8h_html"><div class="ttname"><a href="http_8h.html">http.h</a></div></div>
<div class="ttc" id="aicap_2History_8h_html"><div class="ttname"><a href="icap_2History_8h.html">History.h</a></div></div>
<div class="ttc" id="ainternal_8cc_html_a0e2d2f23938169a0f1b55c147645bf8f"><div class="ttname"><a href="internal_8cc.html#a0e2d2f23938169a0f1b55c147645bf8f">ForSomeCacheManager</a></div><div class="ttdeci">bool ForSomeCacheManager(const SBuf &amp;urlPath)</div><div class="ttdef"><b>Definition</b> <a href="internal_8cc_source.html#l00086">internal.cc:86</a></div></div>
<div class="ttc" id="ainternal_8cc_html_a3c8ef76cbf49bd431ba514e72de34978"><div class="ttname"><a href="internal_8cc.html#a3c8ef76cbf49bd431ba514e72de34978">internalStaticCheck</a></div><div class="ttdeci">bool internalStaticCheck(const SBuf &amp;urlPath)</div><div class="ttdef"><b>Definition</b> <a href="internal_8cc_source.html#l00079">internal.cc:79</a></div></div>
<div class="ttc" id="ainternal_8cc_html_a76eaf4388b308548216736a932f7ec44"><div class="ttname"><a href="internal_8cc.html#a76eaf4388b308548216736a932f7ec44">internalCheck</a></div><div class="ttdeci">bool internalCheck(const SBuf &amp;urlPath)</div><div class="ttdef"><b>Definition</b> <a href="internal_8cc_source.html#l00072">internal.cc:72</a></div></div>
<div class="ttc" id="ainternal_8cc_html_aa48847e699b786df1b9591aa0bedcb6b"><div class="ttname"><a href="internal_8cc.html#aa48847e699b786df1b9591aa0bedcb6b">internalHostname</a></div><div class="ttdeci">const char * internalHostname(void)</div><div class="ttdef"><b>Definition</b> <a href="internal_8cc_source.html#l00149">internal.cc:149</a></div></div>
<div class="ttc" id="ainternal_8cc_html_adb34130666d96a221011e9ee78d4ebdc"><div class="ttname"><a href="internal_8cc.html#adb34130666d96a221011e9ee78d4ebdc">internalHostnameIs</a></div><div class="ttdeci">bool internalHostnameIs(const SBuf &amp;arg)</div><div class="ttdef"><b>Definition</b> <a href="internal_8cc_source.html#l00165">internal.cc:165</a></div></div>
<div class="ttc" id="ainternal_8h_html"><div class="ttname"><a href="internal_8h.html">internal.h</a></div></div>
<div class="ttc" id="aip_2forward_8h_html_a6bd5fd9a27e152eb6dd4faa68729f310"><div class="ttname"><a href="ip_2forward_8h.html#a6bd5fd9a27e152eb6dd4faa68729f310">tos_t</a></div><div class="ttdeci">unsigned char tos_t</div><div class="ttdef"><b>Definition</b> <a href="ip_2forward_8h_source.html#l00027">forward.h:27</a></div></div>
<div class="ttc" id="aipcache_8h_html"><div class="ttname"><a href="ipcache_8h.html">ipcache.h</a></div></div>
<div class="ttc" id="anamespaceAdaptation_html_a04386cc017d5ec2d7e60fc3f4921fc02addd2e5a513e9b4f5a398a793315f85a5"><div class="ttname"><a href="namespaceAdaptation.html#a04386cc017d5ec2d7e60fc3f4921fc02addd2e5a513e9b4f5a398a793315f85a5">Adaptation::methodReqmod</a></div><div class="ttdeci">@ methodReqmod</div><div class="ttdef"><b>Definition</b> <a href="adaptation_2Elements_8h_source.html#l00017">Elements.h:17</a></div></div>
<div class="ttc" id="anamespaceAdaptation_html_a6510d03a11ef873d96df015109b82585a6b588df0b78a7515e2848893fbbd2088"><div class="ttname"><a href="namespaceAdaptation.html#a6510d03a11ef873d96df015109b82585a6b588df0b78a7515e2848893fbbd2088">Adaptation::pointPreCache</a></div><div class="ttdeci">@ pointPreCache</div><div class="ttdef"><b>Definition</b> <a href="adaptation_2Elements_8h_source.html#l00018">Elements.h:18</a></div></div>
<div class="ttc" id="anamespaceAnyP_html_af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d"><div class="ttname"><a href="namespaceAnyP.html#af0ba7042d4344a04b758836b3e6e7acca62d94ce7433f7892fb4541f72ac4ac7d">AnyP::PROTO_HTTP</a></div><div class="ttdeci">@ PROTO_HTTP</div><div class="ttdef"><b>Definition</b> <a href="ProtocolType_8h_source.html#l00025">ProtocolType.h:25</a></div></div>
<div class="ttc" id="anamespaceComm_html_a91f0a0e22e74a7ad6f7c44c137c6f005"><div class="ttname"><a href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen</a></div><div class="ttdeci">bool IsConnOpen(const Comm::ConnectionPointer &amp;conn)</div><div class="ttdef"><b>Definition</b> <a href="Connection_8cc_source.html#l00027">Connection.cc:27</a></div></div>
<div class="ttc" id="anamespaceComm_html_a96a9518a6c2c77d282a79f406e0252a9"><div class="ttname"><a href="namespaceComm.html#a96a9518a6c2c77d282a79f406e0252a9">Comm::Write</a></div><div class="ttdeci">void Write(const Comm::ConnectionPointer &amp;conn, const char *buf, int size, AsyncCall::Pointer &amp;callback, FREE *free_func)</div><div class="ttdef"><b>Definition</b> <a href="Write_8cc_source.html#l00033">Write.cc:33</a></div></div>
<div class="ttc" id="anamespaceComm_html_a9d8d4f4a5745b975c5785998e4246050"><div class="ttname"><a href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050">Comm::Flag</a></div><div class="ttdeci">Flag</div><div class="ttdef"><b>Definition</b> <a href="Flag_8h_source.html#l00015">Flag.h:15</a></div></div>
<div class="ttc" id="anamespaceComm_html_a9d8d4f4a5745b975c5785998e4246050a2d02cf4ed31f765e18f4d8474ede4e24"><div class="ttname"><a href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050a2d02cf4ed31f765e18f4d8474ede4e24">Comm::OK</a></div><div class="ttdeci">@ OK</div><div class="ttdef"><b>Definition</b> <a href="Flag_8h_source.html#l00016">Flag.h:16</a></div></div>
<div class="ttc" id="anamespaceComm_html_a9d8d4f4a5745b975c5785998e4246050a884f9d58f0f131131497fa9ceefb3b3c"><div class="ttname"><a href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050a884f9d58f0f131131497fa9ceefb3b3c">Comm::ERR_CLOSING</a></div><div class="ttdeci">@ ERR_CLOSING</div><div class="ttdef"><b>Definition</b> <a href="Flag_8h_source.html#l00024">Flag.h:24</a></div></div>
<div class="ttc" id="anamespaceHelper_html_a35b330f6ec77649f82ba735d7b19a984a4d7334de216e58ff6aa5163293149757"><div class="ttname"><a href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a4d7334de216e58ff6aa5163293149757">Helper::Unknown</a></div><div class="ttdeci">@ Unknown</div><div class="ttdef"><b>Definition</b> <a href="ResultCode_8h_source.html#l00017">ResultCode.h:17</a></div></div>
<div class="ttc" id="anamespaceHelper_html_a35b330f6ec77649f82ba735d7b19a984a69cdbb4d469ada5a0f13681d9ab8940e"><div class="ttname"><a href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a69cdbb4d469ada5a0f13681d9ab8940e">Helper::BrokenHelper</a></div><div class="ttdeci">@ BrokenHelper</div><div class="ttdef"><b>Definition</b> <a href="ResultCode_8h_source.html#l00020">ResultCode.h:20</a></div></div>
<div class="ttc" id="anamespaceHelper_html_a35b330f6ec77649f82ba735d7b19a984a986818311528872aa99b8b360922c0fb"><div class="ttname"><a href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984a986818311528872aa99b8b360922c0fb">Helper::Error</a></div><div class="ttdeci">@ Error</div><div class="ttdef"><b>Definition</b> <a href="ResultCode_8h_source.html#l00019">ResultCode.h:19</a></div></div>
<div class="ttc" id="anamespaceHelper_html_a35b330f6ec77649f82ba735d7b19a984abb8efc132f13782d623b85c84e887abd"><div class="ttname"><a href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984abb8efc132f13782d623b85c84e887abd">Helper::TT</a></div><div class="ttdeci">@ TT</div><div class="ttdef"><b>Definition</b> <a href="ResultCode_8h_source.html#l00026">ResultCode.h:25</a></div></div>
<div class="ttc" id="anamespaceHelper_html_a35b330f6ec77649f82ba735d7b19a984ae46c05751453143f5b34ea94881ad858"><div class="ttname"><a href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984ae46c05751453143f5b34ea94881ad858">Helper::TimedOut</a></div><div class="ttdeci">@ TimedOut</div><div class="ttdef"><b>Definition</b> <a href="ResultCode_8h_source.html#l00021">ResultCode.h:21</a></div></div>
<div class="ttc" id="anamespaceHelper_html_a35b330f6ec77649f82ba735d7b19a984af5ab78a4aaa17e6dbcf76c28a2f6d198"><div class="ttname"><a href="namespaceHelper.html#a35b330f6ec77649f82ba735d7b19a984af5ab78a4aaa17e6dbcf76c28a2f6d198">Helper::Okay</a></div><div class="ttdeci">@ Okay</div><div class="ttdef"><b>Definition</b> <a href="ResultCode_8h_source.html#l00018">ResultCode.h:18</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722">Http::StatusCode</a></div><div class="ttdeci">StatusCode</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00020">StatusCode.h:20</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a376263fdf0fd460648dfb800898bd2c4">Http::scForbidden</a></div><div class="ttdeci">@ scForbidden</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00048">StatusCode.h:48</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a3868c9f40f16676c17393a2e5565a83a"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a3868c9f40f16676c17393a2e5565a83a">Http::scUnauthorized</a></div><div class="ttdeci">@ scUnauthorized</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00046">StatusCode.h:46</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a66a8af2fba9c318bac7a183c39c05c7c"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a66a8af2fba9c318bac7a183c39c05c7c">Http::scFound</a></div><div class="ttdeci">@ scFound</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00039">StatusCode.h:39</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a6f94589e93c5e1111f2b2ccfc538d9cc"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a6f94589e93c5e1111f2b2ccfc538d9cc">Http::scInternalServerError</a></div><div class="ttdeci">@ scInternalServerError</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00073">StatusCode.h:73</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a8a648efec58a8f2a280fbe512237d3dd"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a8a648efec58a8f2a280fbe512237d3dd">Http::scConflict</a></div><div class="ttdeci">@ scConflict</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00054">StatusCode.h:54</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a985ea76ef28026e5fd8850cda608e6b0"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a985ea76ef28026e5fd8850cda608e6b0">Http::scPermanentRedirect</a></div><div class="ttdeci">@ scPermanentRedirect</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00044">StatusCode.h:44</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722a9c26c2970d7403177ef4d25ca149aedb"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722a9c26c2970d7403177ef4d25ca149aedb">Http::scSeeOther</a></div><div class="ttdeci">@ scSeeOther</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00040">StatusCode.h:40</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722aa140c4f7dc1624466a96d42cc209f155"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722aa140c4f7dc1624466a96d42cc209f155">Http::scProxyAuthenticationRequired</a></div><div class="ttdeci">@ scProxyAuthenticationRequired</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00052">StatusCode.h:52</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722ab481404a40aad5708b07ceb1ec5e27d3"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722ab481404a40aad5708b07ceb1ec5e27d3">Http::scTemporaryRedirect</a></div><div class="ttdeci">@ scTemporaryRedirect</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00043">StatusCode.h:43</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a432f881deb187c726161d6435daec722ace80322983d749adccb645d37e5972bd"><div class="ttname"><a href="namespaceHttp.html#a432f881deb187c726161d6435daec722ace80322983d749adccb645d37e5972bd">Http::scMovedPermanently</a></div><div class="ttdeci">@ scMovedPermanently</div><div class="ttdef"><b>Definition</b> <a href="StatusCode_8h_source.html#l00038">StatusCode.h:38</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787a048d612501964b8d3f0d41ede55395f3"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a048d612501964b8d3f0d41ede55395f3">Http::METHOD_TRACE</a></div><div class="ttdeci">@ METHOD_TRACE</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00030">MethodType.h:30</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787a1fa639d2eb3bfb92c2b42d4703450ba9"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a1fa639d2eb3bfb92c2b42d4703450ba9">Http::METHOD_OTHER</a></div><div class="ttdeci">@ METHOD_OTHER</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00093">MethodType.h:93</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787a8ecea905b7d7b048a979e590cb11b9d7">Http::METHOD_CONNECT</a></div><div class="ttdeci">@ METHOD_CONNECT</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00029">MethodType.h:29</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787abf0f2b96078c49aefdf7ab3ef183a5de">Http::METHOD_GET</a></div><div class="ttdeci">@ METHOD_GET</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00025">MethodType.h:25</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b"><div class="ttname"><a href="namespaceHttp.html#a84eb275fbe86f9dcc2a0ce9164a60787ae59da8aa7332b02b6e84725be140028b">Http::METHOD_HEAD</a></div><div class="ttdeci">@ METHOD_HEAD</div><div class="ttdef"><b>Definition</b> <a href="MethodType_8h_source.html#l00028">MethodType.h:28</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a304355a5f731e2a76ba795ebe1ffd247"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a304355a5f731e2a76ba795ebe1ffd247">Http::HOST</a></div><div class="ttdeci">@ HOST</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00059">RegisteredHeaders.h:59</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a3a0ece368a9661b52a9b5942f46fc24e"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a3a0ece368a9661b52a9b5942f46fc24e">Http::REQUEST_RANGE</a></div><div class="ttdeci">@ REQUEST_RANGE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00088">RegisteredHeaders.h:88</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a4095e0e8a4ed5b5639c6c51330d062a0"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a4095e0e8a4ed5b5639c6c51330d062a0">Http::AUTHORIZATION</a></div><div class="ttdeci">@ AUTHORIZATION</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00033">RegisteredHeaders.h:33</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a51d3bc271c12fd9b48b247fa1d1f8de0"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a51d3bc271c12fd9b48b247fa1d1f8de0">Http::X_FORWARDED_FOR</a></div><div class="ttdeci">@ X_FORWARDED_FOR</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00108">RegisteredHeaders.h:108</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a5cbe8a0c0649160f4bcceed89927afb6"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a5cbe8a0c0649160f4bcceed89927afb6">Http::PROXY_AUTHORIZATION</a></div><div class="ttdeci">@ PROXY_AUTHORIZATION</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00082">RegisteredHeaders.h:82</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a70cbaa89da5d5c5b1adb98835b3cdb88"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a70cbaa89da5d5c5b1adb98835b3cdb88">Http::USER_AGENT</a></div><div class="ttdeci">@ USER_AGENT</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00103">RegisteredHeaders.h:103</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4a870efb6e1f983cee349ae492ff7a7da3"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4a870efb6e1f983cee349ae492ff7a7da3">Http::RANGE</a></div><div class="ttdeci">@ RANGE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00086">RegisteredHeaders.h:86</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4ab72dfe4a5620a1e4d7b096afe4aca653"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4ab72dfe4a5620a1e4d7b096afe4aca653">Http::IF_MODIFIED_SINCE</a></div><div class="ttdeci">@ IF_MODIFIED_SINCE</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00063">RegisteredHeaders.h:63</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4abf700acafa97eb2e7ebf04496aa2b4fa"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4abf700acafa97eb2e7ebf04496aa2b4fa">Http::VIA</a></div><div class="ttdeci">@ VIA</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00106">RegisteredHeaders.h:106</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4ae3cc2208ffc4bf683859c9418631b762"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4ae3cc2208ffc4bf683859c9418631b762">Http::CDN_LOOP</a></div><div class="ttdeci">@ CDN_LOOP</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00036">RegisteredHeaders.h:36</a></div></div>
<div class="ttc" id="anamespaceHttp_html_a92faa3c60e0b457c167759389ae061a4af68e3494f1d9555cc09a10784bc2d89e"><div class="ttname"><a href="namespaceHttp.html#a92faa3c60e0b457c167759389ae061a4af68e3494f1d9555cc09a10784bc2d89e">Http::PRAGMA</a></div><div class="ttdeci">@ PRAGMA</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8h_source.html#l00078">RegisteredHeaders.h:78</a></div></div>
<div class="ttc" id="anamespaceHttp_html_aaf4bcdea88a47c87334b1a4edb064b02"><div class="ttname"><a href="namespaceHttp.html#aaf4bcdea88a47c87334b1a4edb064b02">Http::HeaderLookupTable</a></div><div class="ttdeci">const HeaderLookupTable_t HeaderLookupTable</div><div class="ttdef"><b>Definition</b> <a href="RegisteredHeaders_8cc_source.html#l00060">RegisteredHeaders.cc:60</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_a2243acee556f7a7ec0041da16459d0f9"><div class="ttname"><a href="namespaceIp_1_1Qos.html#a2243acee556f7a7ec0041da16459d0f9">Ip::Qos::setNfConnmark</a></div><div class="ttdeci">bool setNfConnmark(Comm::ConnectionPointer &amp;conn, const ConnectionDirection connDir, const NfMarkConfig &amp;cm)</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00186">QosConfig.cc:186</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_a4e05130943d49767946ade3e7e50d5ecac94474857ae419ca1d01cd7539c7830f"><div class="ttname"><a href="namespaceIp_1_1Qos.html#a4e05130943d49767946ade3e7e50d5ecac94474857ae419ca1d01cd7539c7830f">Ip::Qos::dirAccepted</a></div><div class="ttdeci">@ dirAccepted</div><div class="ttdoc">accepted (from a client by Squid)</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8h_source.html#l00071">QosConfig.h:71</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_a82d2b4c8d940bbb4853ccafbb33da971"><div class="ttname"><a href="namespaceIp_1_1Qos.html#a82d2b4c8d940bbb4853ccafbb33da971">Ip::Qos::TheConfig</a></div><div class="ttdeci">Config TheConfig</div><div class="ttdoc">Globally available instance of Qos::Config.</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00288">QosConfig.cc:288</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_aaa320dc24fac9b1952edaea803a3dd9a"><div class="ttname"><a href="namespaceIp_1_1Qos.html#aaa320dc24fac9b1952edaea803a3dd9a">Ip::Qos::setSockTos</a></div><div class="ttdeci">int setSockTos(const Comm::ConnectionPointer &amp;conn, tos_t tos)</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00558">QosConfig.cc:558</a></div></div>
<div class="ttc" id="anamespaceIp_1_1Qos_html_aebe4081962f547bada77396ee0d56b00"><div class="ttname"><a href="namespaceIp_1_1Qos.html#aebe4081962f547bada77396ee0d56b00">Ip::Qos::setSockNfmark</a></div><div class="ttdeci">int setSockNfmark(const Comm::ConnectionPointer &amp;conn, nfmark_t mark)</div><div class="ttdef"><b>Definition</b> <a href="QosConfig_8cc_source.html#l00590">QosConfig.cc:590</a></div></div>
<div class="ttc" id="anegotiate__wrapper_8cc_html_a2c3897f7c46ca54a2e0dd7b24a40c7cb"><div class="ttname"><a href="negotiate__wrapper_8cc.html#a2c3897f7c46ca54a2e0dd7b24a40c7cb">xfree</a></div><div class="ttdeci">#define xfree</div><div class="ttdef"><b>Definition</b> <a href="negotiate__wrapper_8cc_source.html#l00050">negotiate_wrapper.cc:50</a></div></div>
<div class="ttc" id="anegotiate__wrapper_8cc_html_a5eb055ca3b42205cc134b4a438cd9a72"><div class="ttname"><a href="negotiate__wrapper_8cc.html#a5eb055ca3b42205cc134b4a438cd9a72">xstrdup</a></div><div class="ttdeci">#define xstrdup</div><div class="ttdef"><b>Definition</b> <a href="negotiate__wrapper_8cc_source.html#l00047">negotiate_wrapper.cc:47</a></div></div>
<div class="ttc" id="aredirect_8cc_html_a7d5d0e17dcebbd0fc8ca8d1cf11f4a95"><div class="ttname"><a href="redirect_8cc.html#a7d5d0e17dcebbd0fc8ca8d1cf11f4a95">storeIdStart</a></div><div class="ttdeci">void storeIdStart(ClientHttpRequest *http, HLPCB *handler, void *data)</div><div class="ttdef"><b>Definition</b> <a href="redirect_8cc_source.html#l00312">redirect.cc:312</a></div></div>
<div class="ttc" id="aredirect_8cc_html_ac9db978c5757b982596418dd15cb6ba9"><div class="ttname"><a href="redirect_8cc.html#ac9db978c5757b982596418dd15cb6ba9">redirectStart</a></div><div class="ttdeci">void redirectStart(ClientHttpRequest *http, HLPCB *handler, void *data)</div><div class="ttdef"><b>Definition</b> <a href="redirect_8cc_source.html#l00286">redirect.cc:286</a></div></div>
<div class="ttc" id="aredirect_8h_html"><div class="ttname"><a href="redirect_8h.html">redirect.h</a></div></div>
<div class="ttc" id="aredirect_8h_html_ac64a89dc3c9f926c5f32c791274b5133aed7a9fc0ecd761fd05cfb7a5329dbf3f"><div class="ttname"><a href="redirect_8h.html#ac64a89dc3c9f926c5f32c791274b5133aed7a9fc0ecd761fd05cfb7a5329dbf3f">toutActBypass</a></div><div class="ttdeci">@ toutActBypass</div><div class="ttdef"><b>Definition</b> <a href="redirect_8h_source.html#l00016">redirect.h:16</a></div></div>
<div class="ttc" id="arfc1738_8h_html"><div class="ttname"><a href="rfc1738_8h.html">rfc1738.h</a></div></div>
<div class="ttc" id="asquid_8h_html"><div class="ttname"><a href="squid_8h.html">squid.h</a></div></div>
<div class="ttc" id="assl_2helper_8h_html"><div class="ttname"><a href="ssl_2helper_8h.html">helper.h</a></div></div>
<div class="ttc" id="assl_2support_8h_html"><div class="ttname"><a href="ssl_2support_8h.html">support.h</a></div></div>
<div class="ttc" id="astore_8cc_html_a872157d7a8c43bb5facb072ce03c4d48"><div class="ttname"><a href="store_8cc.html#a872157d7a8c43bb5facb072ce03c4d48">storeCreateEntry</a></div><div class="ttdeci">StoreEntry * storeCreateEntry(const char *url, const char *logUrl, const RequestFlags &amp;flags, const HttpRequestMethod &amp;method)</div><div class="ttdef"><b>Definition</b> <a href="store_8cc_source.html#l00759">store.cc:759</a></div></div>
<div class="ttc" id="astrtoll_8c_html_a6d7fad4b09dcc36131cf70e8ec8bb77b"><div class="ttname"><a href="strtoll_8c.html#a6d7fad4b09dcc36131cf70e8ec8bb77b">strtoll</a></div><div class="ttdeci">int64_t strtoll(const char *nptr, char **endptr, int base)</div><div class="ttdef"><b>Definition</b> <a href="strtoll_8c_source.html#l00061">strtoll.c:61</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Flags_html_a409fd4d5e3b72f06df2921bd417e0a5c"><div class="ttname"><a href="structClientHttpRequest_1_1Flags.html#a409fd4d5e3b72f06df2921bd417e0a5c">ClientHttpRequest::Flags::accel</a></div><div class="ttdeci">bool accel</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00164">client_side_request.h:164</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Out_html_a4d7061fef2fd2cd55f1cc534cb43f040"><div class="ttname"><a href="structClientHttpRequest_1_1Out.html#a4d7061fef2fd2cd55f1cc534cb43f040">ClientHttpRequest::Out::offset</a></div><div class="ttdeci">int64_t offset</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00151">client_side_request.h:151</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Redirect_html_a51a61e18a57f2018c331c346b4a75816"><div class="ttname"><a href="structClientHttpRequest_1_1Redirect.html#a51a61e18a57f2018c331c346b4a75816">ClientHttpRequest::Redirect::status</a></div><div class="ttdeci">Http::StatusCode status</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00169">client_side_request.h:169</a></div></div>
<div class="ttc" id="astructClientHttpRequest_1_1Redirect_html_a98ac56cf94b890c981797389fba6b520"><div class="ttname"><a href="structClientHttpRequest_1_1Redirect.html#a98ac56cf94b890c981797389fba6b520">ClientHttpRequest::Redirect::location</a></div><div class="ttdeci">char * location</div><div class="ttdef"><b>Definition</b> <a href="client__side__request_8h_source.html#l00170">client_side_request.h:170</a></div></div>
<div class="ttc" id="astructSquidConfig_1_1UrlHelperTimeout_html_aa7efe6f51b2f99da05607bcaee1feac0"><div class="ttname"><a href="structSquidConfig_1_1UrlHelperTimeout.html#aa7efe6f51b2f99da05607bcaee1feac0">SquidConfig::UrlHelperTimeout::action</a></div><div class="ttdeci">int action</div><div class="ttdef"><b>Definition</b> <a href="SquidConfig_8h_source.html#l00533">SquidConfig.h:533</a></div></div>
<div class="ttc" id="astructnode_html"><div class="ttname"><a href="structnode.html">node</a></div><div class="ttdef"><b>Definition</b> <a href="parse_8c_source.html#l00104">parse.c:104</a></div></div>
<div class="ttc" id="atime_2gadgets_8cc_html_a502612b4a32c5902726b120d713d7952"><div class="ttname"><a href="time_2gadgets_8cc.html#a502612b4a32c5902726b120d713d7952">current_time</a></div><div class="ttdeci">struct timeval current_time</div><div class="ttdoc">the current UNIX time in timeval {seconds, microseconds} format</div><div class="ttdef"><b>Definition</b> <a href="time_2gadgets_8cc_source.html#l00018">gadgets.cc:18</a></div></div>
<div class="ttc" id="atools_8cc_html_a8905d1b1ed6354e381bb48fc5ce505de"><div class="ttname"><a href="tools_8cc.html#a8905d1b1ed6354e381bb48fc5ce505de">getMyPort</a></div><div class="ttdeci">int getMyPort(void)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l01042">tools.cc:1042</a></div></div>
<div class="ttc" id="atools_8cc_html_aa3f5a1d3a4bc67144cc318637612ddf1"><div class="ttname"><a href="tools_8cc.html#aa3f5a1d3a4bc67144cc318637612ddf1">debugObj</a></div><div class="ttdeci">void debugObj(int section, int level, const char *label, void *obj, ObjPackMethod pm)</div><div class="ttdef"><b>Definition</b> <a href="tools_8cc_source.html#l00939">tools.cc:939</a></div></div>
<div class="ttc" id="atools_8h_html"><div class="ttname"><a href="tools_8h.html">tools.h</a></div></div>
<div class="ttc" id="atools_8h_html_adfbde7d952e179f88f0768705a009c4b"><div class="ttname"><a href="tools_8h.html#adfbde7d952e179f88f0768705a009c4b">ObjPackMethod</a></div><div class="ttdeci">void(* ObjPackMethod)(void *obj, Packable *p)</div><div class="ttdef"><b>Definition</b> <a href="tools_8h_source.html#l00033">tools.h:33</a></div></div>
<div class="ttc" id="awordlist_8h_html"><div class="ttname"><a href="wordlist_8h.html">wordlist.h</a></div></div>
<div class="ttc" id="axalloc_8h_html_a74ad4c3c3aa58c8fea96eb0dc090fd67"><div class="ttname"><a href="xalloc_8h.html#a74ad4c3c3aa58c8fea96eb0dc090fd67">safe_free</a></div><div class="ttdeci">#define safe_free(x)</div><div class="ttdef"><b>Definition</b> <a href="xalloc_8h_source.html#l00073">xalloc.h:73</a></div></div>
<div class="ttc" id="axis_8h_html_a1ddc35653ddbcf46386d5c824a83a150"><div class="ttname"><a href="xis_8h.html#a1ddc35653ddbcf46386d5c824a83a150">xisspace</a></div><div class="ttdeci">#define xisspace(x)</div><div class="ttdef"><b>Definition</b> <a href="xis_8h_source.html#l00015">xis.h:15</a></div></div>
<div class="ttc" id="axstring_8cc_html_a4282f37eaa4a260c714ac6d1bf6a200f"><div class="ttname"><a href="xstring_8cc.html#a4282f37eaa4a260c714ac6d1bf6a200f">xstrndup</a></div><div class="ttdeci">char * xstrndup(const char *s, size_t n)</div><div class="ttdef"><b>Definition</b> <a href="xstring_8cc_source.html#l00056">xstring.cc:56</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3c69fff7f634b97773a4d39d4565ffb4.html">squid</a></li><li class="navelem"><a class="el" href="dir_27a06220d184fcc3bd2c56b7794ae45b.html">src</a></li><li class="navelem"><a class="el" href="client__side__request_8cc.html">client_side_request.cc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
