<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squid Web Cache: Error Pages API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Squid Web Cache<span id="projectnumber">&#160;v8/master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__ErrorPageAPI.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Error Pages API<div class="ingroups"><a class="el" href="group__Components.html">Squid Components</a></div></div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Error Pages API:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__ErrorPageAPI.svg" width="520" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__ErrorPageInternal" id="r_group__ErrorPageInternal"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ErrorPageInternal.html">Error Page Internals</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classErrorState.html">ErrorState</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTemplateFile.html">TemplateFile</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga2928b843c4baa029c38ff0b49dc5aa13" id="r_ga2928b843c4baa029c38ff0b49dc5aa13"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ErrorPageAPI.html#ga2928b843c4baa029c38ff0b49dc5aa13">errorSendComplete</a> (const <a class="el" href="namespaceComm.html#a2256a253c0fa350403f151d712286d9e">Comm::ConnectionPointer</a> &amp;conn, char *, <a class="el" href="stub__liblog_8cc.html#a95f7889ed17fb3324addbb3d5dacc9bc">size_t</a> <a class="el" href="ModDevPoll_8cc.html#a439227feff9d7f55384e8780cfc2eb82">size</a>, <a class="el" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050">Comm::Flag</a> errflag, <a class="el" href="stub__fd_8cc.html#a35fed7109d24712d6b86b6134537c7bd">int</a>, void *data)</td></tr>
<tr class="separator:ga2928b843c4baa029c38ff0b49dc5aa13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28cbd329201cc43e045633d0d29d914f" id="r_ga28cbd329201cc43e045633d0d29d914f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ErrorPageAPI.html#ga28cbd329201cc43e045633d0d29d914f">errorInitialize</a> (void)</td></tr>
<tr class="separator:ga28cbd329201cc43e045633d0d29d914f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab802f42d9d69d4f2c26a8e480436e29b" id="r_gab802f42d9d69d4f2c26a8e480436e29b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ErrorPageAPI.html#gab802f42d9d69d4f2c26a8e480436e29b">errorClean</a> (void)</td></tr>
<tr class="separator:gab802f42d9d69d4f2c26a8e480436e29b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93c0b2c819144a16aca4e28526857b24" id="r_ga93c0b2c819144a16aca4e28526857b24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ErrorPageAPI.html#ga93c0b2c819144a16aca4e28526857b24">errorSend</a> (const <a class="el" href="namespaceComm.html#a2256a253c0fa350403f151d712286d9e">Comm::ConnectionPointer</a> &amp;conn, <a class="el" href="classErrorState.html">ErrorState</a> *err)</td></tr>
<tr class="separator:ga93c0b2c819144a16aca4e28526857b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae984c9bcabfcfb5f0f732a501169a388" id="r_gae984c9bcabfcfb5f0f732a501169a388"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry</a> (<a class="el" href="classStoreEntry.html">StoreEntry</a> *entry, <a class="el" href="classErrorState.html">ErrorState</a> *err)</td></tr>
<tr class="separator:gae984c9bcabfcfb5f0f732a501169a388"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h1><a class="anchor" id="ErrorPageStringCodes"></a>
Error Page % codes for text insertion.</h1>
<pre class="fragment">  a - User identity                            x
  A - Local listening IP address               x
  B - URL with FTP %2f hack                    x
  c - Squid error code                         x
  d - seconds elapsed since request received   x
  D - Error details                            x
  e - errno                                    x
  E - strerror()                               x
  f - FTP request line                         x
  F - FTP reply line                           x
  g - FTP server message                       x
  h - cache hostname                           x
  H - server host name                         x
  i - client IP address                        x
  I - server IP address                        x
  l - HREF link for CSS stylesheet inclusion   x
  L - HREF link for more info/contact          x
  M - Request Method                           x
  m - Error message returned by auth helper    x
  o - Message returned external acl helper     x
  p - URL port #                               x
  P - Protocol                                 x
  R - Full HTTP Request                        x
  S - squid signature from ERR_SIGNATURE       x
  s - caching proxy software with version      x
  t - local time                               x
  T - UTC                                      x
  U - URL without password                     x
  u - URL with password                        x
  w - cachemgr email address                   x
  W - error data (to be included in the mailto links)
  x - error name                               x
  z - dns server error message                 x
  Z - Preformatted error message               x
</pre><p>Plus logformat codes embedded using @Squid{logformat_code} syntax. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gae984c9bcabfcfb5f0f732a501169a388" name="gae984c9bcabfcfb5f0f732a501169a388"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae984c9bcabfcfb5f0f732a501169a388">&#9670;&#160;</a></span>errorAppendEntry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void errorAppendEntry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classStoreEntry.html">StoreEntry</a> *&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classErrorState.html">ErrorState</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function generates a error page from the info contained by err and then stores the text in the specified store entry. This function should only be called by "server
  side routines" which need to communicate errors to the client side. It should also be called from client_side.c because we now support persistent connections, and cannot assume that we can immediately write to the socket for an error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>?? </td></tr>
    <tr><td class="paramname">err</td><td>This object is destroyed after use in this function. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="errorpage_8cc_source.html#l00738">738</a> of file <a class="el" href="errorpage_8cc_source.html">errorpage.cc</a>.</p>

<p class="reference">References <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="classErrorState.html#acd83d0f3e887b952e707a0b83e1630ca">ErrorState::BuildHttpReply()</a>, <a class="el" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>, <a class="el" href="defines_8h.html#ac1f8e975d5c9f901f8ec9f29db1aca92">EBIT_TEST</a>, <a class="el" href="enums_8h.html#a16685eea158879e41b101ca3634de462af1d0ae16fcfb269505ed3e22bc2e3fe5">ENTRY_ABORTED</a>, <a class="el" href="classHttpRequest.html#a76422841293a4230a1a76479e6964c04">HttpRequest::flags</a>, <a class="el" href="classStoreEntry.html#a15b61bc1167a3670130a81bc5eca9f16">StoreEntry::flags</a>, <a class="el" href="classStoreEntry.html#ae4dc05b6c5ca398130c0a155156592d2">StoreEntry::isEmpty()</a>, <a class="el" href="classStoreEntry.html#ab79c9d3fba14d5c997bae61161d9992f">StoreEntry::mem_obj</a>, <a class="el" href="classMemObject.html#a22a8d4ac1fda1545f0f2dc78e80aebdd">MemObject::nclients</a>, <a class="el" href="classErrorState.html#a97e239933d8305f308cdbc027841d06b">ErrorState::page_id</a>, <a class="el" href="classErrorState.html#ac20438d9cd9b574a731b31bb5bff60b3">ErrorState::request</a>, <a class="el" href="classRequestFlags.html#abb9e233ddb38e78e34478b9222f0d849">RequestFlags::resetTcp</a>, <a class="el" href="enums_8h.html#af7404120c842ff6e605306823971959ea024b35d6b8662a132fc5a0480a7933ee">STORE_PENDING</a>, <a class="el" href="classStoreEntry.html#adb1aad18212d6a162cfb59b3f23b5cf4">StoreEntry::store_status</a>, <a class="el" href="classStoreEntry.html#a84c7380e766ff75a4275c2778df8f068">StoreEntry::storeErrorResponse()</a>, and <a class="el" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa256ed8d6e6cbd8a98e809eca62620e19">TCP_RESET</a>.</p>

<p class="reference">Referenced by <a class="el" href="classFwdState.html#a2bc3fb073aee437617e93fbef3c5154f">FwdState::completed()</a>, <a class="el" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">ClientHttpRequest::doCallouts()</a>, <a class="el" href="internal_8cc.html#aae93b8fb90634f32e4b0a9ceaa019d9c">internalStart()</a>, <a class="el" href="classclientReplyContext.html#ac41ac51681bbc8c3db9bdf0b2a26f724">clientReplyContext::processMiss()</a>, <a class="el" href="classFwdState.html#ac7e9d742721daa3e491cf549ad100fb9">FwdState::retryOrBail()</a>, <a class="el" href="classclientReplyContext.html#a8ef4c7c830f5529a8a21efd4a8414914">clientReplyContext::setReplyToError()</a>, <a class="el" href="classUrnState.html#a2cf9f7e54cb1a68817dbdebf32c77314">UrnState::setUriResFromRequest()</a>, <a class="el" href="classCacheManager.html#ae4df629f0874df13d1fa3bc961fe028b">CacheManager::start()</a>, <a class="el" href="classFwdState.html#a391d66921577e62e543723f978062e97">FwdState::Start()</a>, <a class="el" href="classclientReplyContext.html#a4c65a525bd9fc6c042e060c434822948">clientReplyContext::startError()</a>, and <a class="el" href="urn_8cc.html#a43a3315a4dad7bf3b0a1bd0ffe2713c9">urnHandleReply()</a>.</p>

</div>
</div>
<a id="gab802f42d9d69d4f2c26a8e480436e29b" name="gab802f42d9d69d4f2c26a8e480436e29b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab802f42d9d69d4f2c26a8e480436e29b">&#9670;&#160;</a></span>errorClean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void errorClean </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="errorpage_8cc_source.html#l00323">323</a> of file <a class="el" href="errorpage_8cc_source.html">errorpage.cc</a>.</p>

<p class="reference">References <a class="el" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d">ERR_NONE</a>, <a class="el" href="group__ErrorPageInternal.html#gae5ec62664200e68d9acaad3dd25194a6">error_page_count</a>, <a class="el" href="group__ErrorPageInternal.html#ga61aebe7c43376ba256b23ce9b26f0390">error_text</a>, <a class="el" href="namespaceSsl.html#a0c27110d517a4eee8b56b0cc455a92ae">Ssl::errorDetailClean()</a>, <a class="el" href="group__ErrorPageInternal.html#gaa6a91b8fea79c7a657053b2672e99f2f">ErrorDynamicPages</a>, and <a class="el" href="xalloc_8h.html#a74ad4c3c3aa58c8fea96eb0dc090fd67">safe_free</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cc.html#a98bc6a7edc4cba3d69919e84bb20cedd">mainReconfigureFinish()</a>.</p>

</div>
</div>
<a id="ga28cbd329201cc43e045633d0d29d914f" name="ga28cbd329201cc43e045633d0d29d914f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga28cbd329201cc43e045633d0d29d914f">&#9670;&#160;</a></span>errorInitialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void errorInitialize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function finds the error messages formats, and stores them in error_text[]</p>
<dl class="section user"><dt>Global effects:</dt><dd>error_text[] - is modified </dd></dl>
<dl class="section user"><dt></dt><dd>Index any hard-coded error text into defaults.</dd></dl>
<dl class="section user"><dt></dt><dd>Index precompiled fixed template files from one of two sources: (a) default language translation directory (error_default_language) (b) admin specified custom directory (error_directory)</dd></dl>
<dl class="section user"><dt></dt><dd>Index any unknown file names used by deny_info.</dd></dl>
<p>But only if they are not redirection URL.</p>

<p class="definition">Definition at line <a class="el" href="errorpage_8cc_source.html#l00261">261</a> of file <a class="el" href="errorpage_8cc_source.html">errorpage.cc</a>.</p>

<p class="reference">References <a class="el" href="classPackable.html#ab3147943b218d2943726aeaf135dd776">Packable::appendf()</a>, <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="classErrorDynamicPageInfo.html#ac44051cfaac32572429deba2a1f393ba">ErrorDynamicPageInfo::cfgLocation</a>, <a class="el" href="SquidConfig_8cc.html#a75b136e6a1eef61424d84596a404aafe">Config</a>, <a class="el" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa51a80ce92f9392669de4e57f0f8f915e">ERR_MAX</a>, <a class="el" href="error_2forward_8h.html#a0c0ad09d74260ddc16d72bc291116e1aa5203071ca85e00df6bf2526855b6df0d">ERR_NONE</a>, <a class="el" href="Error_8h.html#a990500e7cb37800698c00de693f7e7d4">err_type_str</a>, <a class="el" href="group__ErrorPageInternal.html#gae5ec62664200e68d9acaad3dd25194a6">error_page_count</a>, <a class="el" href="group__ErrorPageInternal.html#gaedf4a5edc8f320f6f6866ba30f2d8eea">error_stylesheet</a>, <a class="el" href="group__ErrorPageInternal.html#ga61aebe7c43376ba256b23ce9b26f0390">error_text</a>, <a class="el" href="namespaceSsl.html#aa731267aeaa729ba93ca520bd94b2dd3">Ssl::errorDetailInitialize()</a>, <a class="el" href="group__ErrorPageInternal.html#gaa6a91b8fea79c7a657053b2672e99f2f">ErrorDynamicPages</a>, <a class="el" href="group__ErrorPageInternal.html#ga979e850ba219b709164f6c127fcd83c6">errorFindHardText()</a>, <a class="el" href="classSquidConfig.html#a0847496a6c899c3aed5a48b9977a597f">SquidConfig::errorStylesheet</a>, <a class="el" href="classErrorDynamicPageInfo.html#af71c15049127fde79627a01d2348badd">ErrorDynamicPageInfo::filename</a>, <a class="el" href="classTemplateFile.html#a33812f521840ef34ef3c73a0b8b711c6">TemplateFile::filename</a>, <a class="el" href="classErrorDynamicPageInfo.html#adeeeb71b8ee5cc50d34e7954bc419b4d">ErrorDynamicPageInfo::id</a>, <a class="el" href="namespaceErrorPage.html#a5be6db78582511e4b04dee1a850a12ba">ErrorPage::ImportStaticErrorText()</a>, <a class="el" href="classTemplateFile.html#a98436fe7dd7459c6a9acb4f776a3ac7c">TemplateFile::loadDefault()</a>, <a class="el" href="classTemplateFile.html#a14a50d0967685dee660458f5c437ce7c">TemplateFile::loadFromFile()</a>, <a class="el" href="classErrorDynamicPageInfo.html#a2f67f4c64309f25849f93ad2aee2cf67">ErrorDynamicPageInfo::page_name</a>, <a class="el" href="classMemBuf.html#ac0eda16694c0752050a1da95db2be3e6">MemBuf::reset()</a>, <a class="el" href="xalloc_8h.html#a74ad4c3c3aa58c8fea96eb0dc090fd67">safe_free</a>, <a class="el" href="testTokenizer_8cc.html#a48015ae2d71c5aa62349328a91200405">text</a>, <a class="el" href="classErrorPageFile.html#aca6369c501bfb7f67bfec9533aec97e3">ErrorPageFile::text()</a>, <a class="el" href="classErrorDynamicPageInfo.html#a45e2abc16fe491c31a5c9f3878c04286">ErrorDynamicPageInfo::uri</a>, <a class="el" href="namespaceErrorPage.html#a5cdfc34b0c03e7e8633526830442863a">ErrorPage::ValidateStaticError()</a>, and <a class="el" href="xalloc_8cc.html#ad10c7ad81edd7cbbdfd8b6502aa88d65">xcalloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cc.html#afa78696c5a9a5eb1f32a47d8b87cb9a0">mainInitialize()</a>, and <a class="el" href="main_8cc.html#a98bc6a7edc4cba3d69919e84bb20cedd">mainReconfigureFinish()</a>.</p>

</div>
</div>
<a id="ga93c0b2c819144a16aca4e28526857b24" name="ga93c0b2c819144a16aca4e28526857b24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga93c0b2c819144a16aca4e28526857b24">&#9670;&#160;</a></span>errorSend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void errorSend </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceComm.html#a2256a253c0fa350403f151d712286d9e">Comm::ConnectionPointer</a> &amp;&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classErrorState.html">ErrorState</a> *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function generates a error page from the info contained by err and then sends it to the client. The callback function <a class="el" href="errorpage_8cc.html#a81e3f6b9d5c0e317719709ff76fd8090">errorSendComplete()</a> is called after the page has been written to the client (clientConn). <a class="el" href="errorpage_8cc.html#a81e3f6b9d5c0e317719709ff76fd8090">errorSendComplete()</a> deallocates err. We need to add err to the cbdata because comm_write() requires it for all callback data pointers.</p>
<dl class="section note"><dt>Note</dt><dd>normally <a class="el" href="group__ErrorPageAPI.html#ga93c0b2c819144a16aca4e28526857b24">errorSend()</a> should only be called from routines in ssl.c and pass.c, where we don't have any <a class="el" href="classStoreEntry.html">StoreEntry</a>'s. In client_side.c we must allocate a <a class="el" href="classStoreEntry.html">StoreEntry</a> for errors and use <a class="el" href="group__ErrorPageAPI.html#gae984c9bcabfcfb5f0f732a501169a388">errorAppendEntry()</a> to account for persistent/pipeline connections.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clientConn</td><td>socket where page object is to be written </td></tr>
    <tr><td class="paramname">err</td><td>This object is destroyed after use in this function. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="errorpage_8cc_source.html#l00792">792</a> of file <a class="el" href="errorpage_8cc_source.html">errorpage.cc</a>.</p>

<p class="reference">References <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="classErrorState.html#acd83d0f3e887b952e707a0b83e1630ca">ErrorState::BuildHttpReply()</a>, <a class="el" href="CommCalls_8h.html#a7e143fa246c3e54c90fa8d20b390b88d">commCbCall()</a>, <a class="el" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>, <a class="el" href="errorpage_8cc.html#a81e3f6b9d5c0e317719709ff76fd8090">errorSendComplete</a>, <a class="el" href="namespaceComm.html#a91f0a0e22e74a7ad6f7c44c137c6f005">Comm::IsConnOpen()</a>, <a class="el" href="classHttpReply.html#a0e8069f4331ea7989365cc8a9b2c8aa3">HttpReply::pack()</a>, and <a class="el" href="namespaceComm.html#a96a9518a6c2c77d282a79f406e0252a9">Comm::Write()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classTunnelStateData.html#a11402e262e525f385e1e8b669995e0c0">TunnelStateData::sendError()</a>, and <a class="el" href="client__side__request_8h.html#a463df90046fef514df797f43c881f0af">tunnelStart()</a>.</p>

</div>
</div>
<a id="ga2928b843c4baa029c38ff0b49dc5aa13" name="ga2928b843c4baa029c38ff0b49dc5aa13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2928b843c4baa029c38ff0b49dc5aa13">&#9670;&#160;</a></span>errorSendComplete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void errorSendComplete </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceComm.html#a2256a253c0fa350403f151d712286d9e">Comm::ConnectionPointer</a> &amp;&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stub__liblog_8cc.html#a95f7889ed17fb3324addbb3d5dacc9bc">size_t</a>&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050">Comm::Flag</a>&#160;</td>
          <td class="paramname"><em>errflag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="stub__fd_8cc.html#a35fed7109d24712d6b86b6134537c7bd">int</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Called by commHandleWrite() after data has been written to the client socket.</p>
<dl class="section note"><dt>Note</dt><dd>If there is a callback, the callback is responsible for closing the FD, otherwise we do it ourselves. </dd></dl>

<p class="definition">Definition at line <a class="el" href="errorpage_8cc_source.html#l00816">816</a> of file <a class="el" href="errorpage_8cc_source.html">errorpage.cc</a>.</p>

<p class="reference">References <a class="el" href="classErrorState.html#a791da3db0d8bf5eecf92cb380074fd27">ErrorState::callback</a>, <a class="el" href="classErrorState.html#ada325088568d82f3396fb20e592596bc">ErrorState::callback_data</a>, <a class="el" href="classComm_1_1Connection.html#a32253e90999f679dc032e19ad50d03ab">Comm::Connection::close()</a>, <a class="el" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>, <a class="el" href="namespaceComm.html#a9d8d4f4a5745b975c5785998e4246050a884f9d58f0f131131497fa9ceefb3b3c">Comm::ERR_CLOSING</a>, <a class="el" href="classComm_1_1Connection.html#a8e53f4d6fd38545947a5aac6efb98fca">Comm::Connection::fd</a>, and <a class="el" href="ModDevPoll_8cc.html#a439227feff9d7f55384e8780cfc2eb82">size</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
