<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Squid Web Cache: Client Streams API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Squid Web Cache<span id="projectnumber">&#160;v8/master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__ClientStreamAPI.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Client Streams API<div class="ingroups"><a class="el" href="group__Components.html">Squid Components</a></div></div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Client Streams API:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__ClientStreamAPI.svg" width="572" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__ClientStreamInternal" id="r_group__ClientStreamInternal"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ClientStreamInternal.html">Client Streams Internals</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad8f0399e37cf83c7f603c264f7294933" id="r_gad8f0399e37cf83c7f603c264f7294933"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ClientStreamAPI.html#gad8f0399e37cf83c7f603c264f7294933">clientStreamInit</a> (<a class="el" href="classdlink__list.html">dlink_list</a> *, <a class="el" href="clientStreamForward_8h.html#adfeb9a20de88d7ad3433ca3c7f50a364">CSR</a> *, <a class="el" href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a> *, <a class="el" href="clientStreamForward_8h.html#afe231eb7220220dab4804637c286f6e0">CSS</a> *, const <a class="el" href="clientStreamForward_8h.html#aa938180dd79b9c1e95ce557ae06e4275">ClientStreamData</a> &amp;, <a class="el" href="clientStreamForward_8h.html#aee8d23e0037951ad7ac2e9f506b1ac05">CSCB</a> *, <a class="el" href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a> *, const <a class="el" href="clientStreamForward_8h.html#aa938180dd79b9c1e95ce557ae06e4275">ClientStreamData</a> &amp;, <a class="el" href="classStoreIOBuffer.html">StoreIOBuffer</a> tailBuffer)</td></tr>
<tr class="separator:gad8f0399e37cf83c7f603c264f7294933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef9410daba7d756e78b0b78f89a30792" id="r_gaef9410daba7d756e78b0b78f89a30792"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ClientStreamAPI.html#gaef9410daba7d756e78b0b78f89a30792">clientStreamInsertHead</a> (<a class="el" href="classdlink__list.html">dlink_list</a> *, <a class="el" href="clientStreamForward_8h.html#adfeb9a20de88d7ad3433ca3c7f50a364">CSR</a> *, <a class="el" href="clientStreamForward_8h.html#aee8d23e0037951ad7ac2e9f506b1ac05">CSCB</a> *, <a class="el" href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a> *, <a class="el" href="clientStreamForward_8h.html#afe231eb7220220dab4804637c286f6e0">CSS</a> *, <a class="el" href="clientStreamForward_8h.html#aa938180dd79b9c1e95ce557ae06e4275">ClientStreamData</a>)</td></tr>
<tr class="separator:gaef9410daba7d756e78b0b78f89a30792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga99b0c67ea123ea13bd712b3ffd77509b" id="r_ga99b0c67ea123ea13bd712b3ffd77509b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ClientStreamAPI.html#ga99b0c67ea123ea13bd712b3ffd77509b">clientStreamCallback</a> (<a class="el" href="classclientStreamNode.html">clientStreamNode</a> *thisObject, <a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *http, <a class="el" href="classHttpReply.html">HttpReply</a> *rep, <a class="el" href="classStoreIOBuffer.html">StoreIOBuffer</a> replyBuffer)</td></tr>
<tr class="separator:ga99b0c67ea123ea13bd712b3ffd77509b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54ab73d51a7454c7ccafed27b3f87011" id="r_ga54ab73d51a7454c7ccafed27b3f87011"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ClientStreamAPI.html#ga54ab73d51a7454c7ccafed27b3f87011">clientStreamRead</a> (<a class="el" href="classclientStreamNode.html">clientStreamNode</a> *thisObject, <a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *http, <a class="el" href="classStoreIOBuffer.html">StoreIOBuffer</a> readBuffer)</td></tr>
<tr class="separator:ga54ab73d51a7454c7ccafed27b3f87011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae62c467856741b9fdc6c8b919ea65462" id="r_gae62c467856741b9fdc6c8b919ea65462"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ClientStreamAPI.html#gae62c467856741b9fdc6c8b919ea65462">clientStreamDetach</a> (<a class="el" href="classclientStreamNode.html">clientStreamNode</a> *thisObject, <a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *http)</td></tr>
<tr class="separator:gae62c467856741b9fdc6c8b919ea65462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20d6859b35ca5de01819e32d92ec775d" id="r_ga20d6859b35ca5de01819e32d92ec775d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ClientStreamAPI.html#ga20d6859b35ca5de01819e32d92ec775d">clientStreamAbort</a> (<a class="el" href="classclientStreamNode.html">clientStreamNode</a> *thisObject, <a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *http)</td></tr>
<tr class="separator:ga20d6859b35ca5de01819e32d92ec775d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga401a3844d9b1b7daa93a3e3c71500291" id="r_ga401a3844d9b1b7daa93a3e3c71500291"><td class="memItemLeft" align="right" valign="top"><a class="el" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876b">clientStream_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ClientStreamAPI.html#ga401a3844d9b1b7daa93a3e3c71500291">clientStreamStatus</a> (<a class="el" href="classclientStreamNode.html">clientStreamNode</a> *thisObject, <a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *http)</td></tr>
<tr class="separator:ga401a3844d9b1b7daa93a3e3c71500291"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h1><a class="anchor" id="ClientStreamIntroduction"></a>
Introduction</h1>
<dl class="section user"><dt></dt><dd>A ClientStream implements a unidirectional, non-blocking, pull pipeline. They allow code to be inserted into the reply logic on an as-needed basis. For instance, transfer-encoding logic is only needed when sending a HTTP/1.1 reply.</dd></dl>
<dl class="section user"><dt></dt><dd>Each node consists of four methods - read, callback, detach, and status, along with the stream housekeeping variables (a dlink node and pointer to the head of the list), context data for the node, and read request parameters - readbuf, readlen and readoff (in the body).</dd></dl>
<dl class="section user"><dt></dt><dd>clientStream is the basic unit for scheduling, and the <a class="el" href="group__ClientStreamAPI.html#ga54ab73d51a7454c7ccafed27b3f87011">clientStreamRead()</a> and <a class="el" href="group__ClientStreamAPI.html#ga99b0c67ea123ea13bd712b3ffd77509b">clientStreamCallback()</a> calls allow for deferred scheduled activity if desired.</dd></dl>
<h1><a class="anchor" id="OperationTheory"></a>
Theory on stream operation</h1>
<dl class="section user"><dt></dt><dd><ul>
<li>Something creates a pipeline. At a minimum it needs a head with a status method and a read method, and a tail with a callback method and a valid initial read request. </li>
<li>Other nodes may be added into the pipeline. </li>
<li>The tail-1th node's read method is called.</li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>For each node going up the pipeline, the node either: <ul>
<li>satisfies the read request, or </li>
<li>inserts a new node above it and calls <a class="el" href="group__ClientStreamAPI.html#ga54ab73d51a7454c7ccafed27b3f87011">clientStreamRead()</a>, or </li>
<li>calls <a class="el" href="group__ClientStreamAPI.html#ga54ab73d51a7454c7ccafed27b3f87011">clientStreamRead()</a></li>
</ul>
</dd></dl>
<dl class="section user"><dt></dt><dd>There is no requirement for the Read parameters from different nodes to have any correspondence, as long as the callbacks provided are correct.</dd></dl>
<h1><a class="anchor" id="WhatsInANode"></a>
Whats in a node</h1>
<p>TODO: ClientStreams: These details should really be codified as a class which all ClientStream nodes inherit from.</p>
<dl class="section user"><dt>Each node must have:</dt><dd><ul>
<li>read method - to allow loose coupling in the pipeline. (The reader may therefore change if the pipeline is altered, even mid-flow). </li>
<li>callback method - likewise. </li>
<li>status method - likewise. </li>
<li>detach method - used to ensure all resources are cleaned up properly. </li>
<li>dlink head pointer - to allow list inserts and deletes from within a node. </li>
<li>context data - to allow the called back nodes to maintain their private information. </li>
<li>read request parameters - For two reasons: </li>
<li>To allow a node to determine the requested data offset, length and target buffer dynamically. Again, this is to promote loose coupling. </li>
<li>Because of the callback nature of squid, every node would have to keep these parameters in their context anyway, so this reduces programmer overhead. </li>
</ul>
</dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga20d6859b35ca5de01819e32d92ec775d" name="ga20d6859b35ca5de01819e32d92ec775d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga20d6859b35ca5de01819e32d92ec775d">&#9670;&#160;</a></span>clientStreamAbort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clientStreamAbort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classclientStreamNode.html">clientStreamNode</a> *&#160;</td>
          <td class="paramname"><em>thisObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *&#160;</td>
          <td class="paramname"><em>http</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Detaches the tail of the stream. CURRENTLY DOES NOT clean up the tail node data - this must be done separately. Thus Abort may ONLY be called by the tail node.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>'this' reference for the client stream </td></tr>
    <tr><td class="paramname">http</td><td>MUST NOT be NULL.</td></tr>
  </table>
  </dd>
</dl>
<p>Abort the stream - detach every node in the pipeline.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>?? </td></tr>
    <tr><td class="paramname">http</td><td>?? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="clientStream_8cc_source.html#l00235">235</a> of file <a class="el" href="clientStream_8cc_source.html">clientStream.cc</a>.</p>

<p class="reference">References <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="group__ClientStreamInternal.html#gae62c467856741b9fdc6c8b919ea65462">clientStreamDetach()</a>, <a class="el" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">dlink_node::data</a>, <a class="el" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>, <a class="el" href="classclientStreamNode.html#adf1abf171a3dd102e6bd7fcd3a468e0c">clientStreamNode::head</a>, and <a class="el" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">dlink_list::tail</a>.</p>

<p class="reference">Referenced by <a class="el" href="classClientHttpRequest.html#a52f95c3b38b4cacf5fa0e4d157b6eac6">ClientHttpRequest::freeResources()</a>.</p>

</div>
</div>
<a id="ga99b0c67ea123ea13bd712b3ffd77509b" name="ga99b0c67ea123ea13bd712b3ffd77509b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga99b0c67ea123ea13bd712b3ffd77509b">&#9670;&#160;</a></span>clientStreamCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clientStreamCallback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classclientStreamNode.html">clientStreamNode</a> *&#160;</td>
          <td class="paramname"><em>thisObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *&#160;</td>
          <td class="paramname"><em>http</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classHttpReply.html">HttpReply</a> *&#160;</td>
          <td class="paramname"><em>rep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStoreIOBuffer.html">StoreIOBuffer</a>&#160;</td>
          <td class="paramname"><em>replyBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call back the next node the in chain with it's requested data. Return data to the next node in the stream. The data may be returned immediately, or may be delayed for a later scheduling cycle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>'this' reference for the client stream </td></tr>
    <tr><td class="paramname">http</td><td>Superset of request data, being winnowed down over time. MUST NOT be NULL. </td></tr>
    <tr><td class="paramname">rep</td><td>Not NULL on the first call back only. Ownership is passed down the pipeline. Each node may alter the reply if appropriate. </td></tr>
    <tr><td class="paramname">replyBuffer</td><td>- buffer, length - where and how much. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="clientStream_8cc_source.html#l00150">150</a> of file <a class="el" href="clientStream_8cc_source.html">clientStream.cc</a>.</p>

<p class="reference">References <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="classclientStreamNode.html#a3b1e30c8923aa80c23cb2553dbf43925">clientStreamNode::callback</a>, <a class="el" href="classclientStreamNode.html#a3ffd025e7396d93b36a80c2048915ac8">clientStreamNode::data</a>, <a class="el" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>, <a class="el" href="classclientStreamNode.html#aa79f6a43eda25ea156cbf0c479d45bc6">clientStreamNode::next()</a>, <a class="el" href="classdlink__node.html#ad1228295f9f83f14e0c58966479cfbd7">dlink_node::next</a>, and <a class="el" href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">clientStreamNode::node</a>.</p>

<p class="reference">Referenced by <a class="el" href="classclientReplyContext.html#a9708b6cfee00c7274a16db7a5600c91e">clientReplyContext::processReplyAccessResult()</a>, <a class="el" href="classclientReplyContext.html#a48c73104bca1be8ee82a1dfe6abdc8bc">clientReplyContext::pushStreamData()</a>, and <a class="el" href="classclientReplyContext.html#a468308db7244b1439db0c4cde60acc39">clientReplyContext::sendStreamError()</a>.</p>

</div>
</div>
<a id="gae62c467856741b9fdc6c8b919ea65462" name="gae62c467856741b9fdc6c8b919ea65462"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae62c467856741b9fdc6c8b919ea65462">&#9670;&#160;</a></span>clientStreamDetach()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clientStreamDetach </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classclientStreamNode.html">clientStreamNode</a> *&#160;</td>
          <td class="paramname"><em>thisObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *&#160;</td>
          <td class="paramname"><em>http</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes this node from a clientStream. The stream infrastructure handles the removal. This node MUST have cleaned up all context data, UNLESS scheduled callbacks will take care of that. Informs the prev node in the list of this nodes detachment.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>'this' reference for the client stream </td></tr>
    <tr><td class="paramname">http</td><td>MUST NOT be NULL.</td></tr>
  </table>
  </dd>
</dl>
<p>Detach from the stream - only allowed for terminal members</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>?? </td></tr>
    <tr><td class="paramname">http</td><td>?? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="clientStream_8cc_source.html#l00192">192</a> of file <a class="el" href="clientStream_8cc_source.html">clientStream.cc</a>.</p>

<p class="reference">References <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a>, <a class="el" href="cbdata_8h.html#a178af3acec8011dd955016f69e307037">cbdataReferenceDone</a>, <a class="el" href="cbdata_8cc.html#aa6ed5c53b844c6f8f3e7c39daa051835">cbdataReferenceValid()</a>, <a class="el" href="classclientStreamNode.html#a3ffd025e7396d93b36a80c2048915ac8">clientStreamNode::data</a>, <a class="el" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>, <a class="el" href="classclientStreamNode.html#a1d40fd6621f8fec9e84501d1e424cc04">clientStreamNode::detach</a>, <a class="el" href="classRefCount.html#a9f2168c1df4a4ab6b7931425d85c37f0">RefCount&lt; C &gt;::getRaw()</a>, <a class="el" href="classdlink__node.html#ad1228295f9f83f14e0c58966479cfbd7">dlink_node::next</a>, <a class="el" href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">clientStreamNode::node</a>, <a class="el" href="classclientStreamNode.html#ad4f6d8f7e768136d99f02728aa79b0ee">clientStreamNode::prev()</a>, and <a class="el" href="classclientStreamNode.html#a40e4b9b354114dcdb880780dbe95d183">clientStreamNode::removeFromStream()</a>.</p>

<p class="reference">Referenced by <a class="el" href="client__side__reply_8cc.html#a882f672982c92a2dd9c2238b261cf17f">clientReplyDetach()</a>, <a class="el" href="client__side_8cc.html#a998bd392d486f1385446bc7dca27bd08">clientSocketDetach()</a>, <a class="el" href="group__ClientStreamInternal.html#ga20d6859b35ca5de01819e32d92ec775d">clientStreamAbort()</a>, <a class="el" href="Downloader_8cc.html#a3c856591f9467365cf62058768127ac3">downloaderDetach()</a>, and <a class="el" href="classHttp_1_1Stream.html#adb2031c99ca0e161ff9b7b1d304e7ef0">Http::Stream::finished()</a>.</p>

</div>
</div>
<a id="gad8f0399e37cf83c7f603c264f7294933" name="gad8f0399e37cf83c7f603c264f7294933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad8f0399e37cf83c7f603c264f7294933">&#9670;&#160;</a></span>clientStreamInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clientStreamInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdlink__list.html">dlink_list</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#adfeb9a20de88d7ad3433ca3c7f50a364">CSR</a> *&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a> *&#160;</td>
          <td class="paramname"><em>rdetach</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#afe231eb7220220dab4804637c286f6e0">CSS</a> *&#160;</td>
          <td class="paramname"><em>readstatus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="clientStreamForward_8h.html#aa938180dd79b9c1e95ce557ae06e4275">ClientStreamData</a> &amp;&#160;</td>
          <td class="paramname"><em>readdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#aee8d23e0037951ad7ac2e9f506b1ac05">CSCB</a> *&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a> *&#160;</td>
          <td class="paramname"><em>cdetach</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="clientStreamForward_8h.html#aa938180dd79b9c1e95ce557ae06e4275">ClientStreamData</a> &amp;&#160;</td>
          <td class="paramname"><em>callbackdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStoreIOBuffer.html">StoreIOBuffer</a>&#160;</td>
          <td class="paramname"><em>tailBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialise a client Stream. list is the stream func is the read function for the head callback is the callback for the tail tailbuf and taillen are the initial buffer and length for the tail. </p>

<p class="definition">Definition at line <a class="el" href="clientStream_8cc_source.html#l00112">112</a> of file <a class="el" href="clientStream_8cc_source.html">clientStream.cc</a>.</p>

<p class="reference">References <a class="el" href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a>, <a class="el" href="group__ClientStreamInternal.html#ga9733a6768c621af38fdb82990ff398eb">clientStreamInsertHead()</a>, <a class="el" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">dlink_node::data</a>, <a class="el" href="dlink_8cc.html#a6653213a8433b9e40b94980846e0634a">dlinkAdd()</a>, <a class="el" href="classclientStreamNode.html#adf1abf171a3dd102e6bd7fcd3a468e0c">clientStreamNode::head</a>, <a class="el" href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">clientStreamNode::node</a>, <a class="el" href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">clientStreamNode::readBuffer</a>, and <a class="el" href="classdlink__list.html#a532f15958755b4d0d6356f7a52291d4e">dlink_list::tail</a>.</p>

<p class="reference">Referenced by <a class="el" href="classConnStateData.html#a59583be538fbda5cdf2c6637142d71b8">ConnStateData::abortRequestParsing()</a>, <a class="el" href="classConnStateData.html#a3282e887b7304282cd1cc35f37844df9">ConnStateData::buildFakeRequest()</a>, <a class="el" href="classDownloader.html#acedb5012a5acc2ee72dbd995e56ba100">Downloader::buildRequest()</a>, <a class="el" href="classConnStateData.html#a25dda3837772dfe4efcec4c88865265c">ConnStateData::parseHttpRequest()</a>, and <a class="el" href="classFtp_1_1Server.html#a91c96fb1d958ac2c8232bec4138a40d8">Ftp::Server::parseOneRequest()</a>.</p>

</div>
</div>
<a id="gaef9410daba7d756e78b0b78f89a30792" name="gaef9410daba7d756e78b0b78f89a30792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef9410daba7d756e78b0b78f89a30792">&#9670;&#160;</a></span>clientStreamInsertHead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clientStreamInsertHead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdlink__list.html">dlink_list</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#adfeb9a20de88d7ad3433ca3c7f50a364">CSR</a> *&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#aee8d23e0037951ad7ac2e9f506b1ac05">CSCB</a> *&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#ad7a8fcb0c65e986028978be921f80b4f">CSD</a> *&#160;</td>
          <td class="paramname"><em>detach</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#afe231eb7220220dab4804637c286f6e0">CSS</a> *&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="clientStreamForward_8h.html#aa938180dd79b9c1e95ce557ae06e4275">ClientStreamData</a>&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Doesn't actually insert at head. Instead it inserts one <em>after</em> head. This is because HEAD is a special node, as is tail This function is not suitable for inserting the real HEAD. </p>

<p class="definition">Definition at line <a class="el" href="clientStream_8cc_source.html#l00131">131</a> of file <a class="el" href="clientStream_8cc_source.html">clientStream.cc</a>.</p>

<p class="reference">References <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="cbdata_8h.html#a23338dbb451f460facd39a8a249bab46">cbdataReference</a>, <a class="el" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">dlink_node::data</a>, <a class="el" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>, <a class="el" href="dlink_8cc.html#afd145ee08c9d27d6d8498fb3b166921b">dlinkAddAfter()</a>, <a class="el" href="classRefCount.html#a9f2168c1df4a4ab6b7931425d85c37f0">RefCount&lt; C &gt;::getRaw()</a>, <a class="el" href="classclientStreamNode.html#adf1abf171a3dd102e6bd7fcd3a468e0c">clientStreamNode::head</a>, <a class="el" href="classdlink__list.html#a60d7fc0293487a5b5914f10acae1e120">dlink_list::head</a>, <a class="el" href="classdlink__node.html#ad1228295f9f83f14e0c58966479cfbd7">dlink_node::next</a>, <a class="el" href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">clientStreamNode::node</a>, and <a class="el" href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">clientStreamNode::readBuffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__ClientStreamInternal.html#ga73019262f28c27affc3937cac3441a43">clientStreamInit()</a>.</p>

</div>
</div>
<a id="ga54ab73d51a7454c7ccafed27b3f87011" name="ga54ab73d51a7454c7ccafed27b3f87011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga54ab73d51a7454c7ccafed27b3f87011">&#9670;&#160;</a></span>clientStreamRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clientStreamRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classclientStreamNode.html">clientStreamNode</a> *&#160;</td>
          <td class="paramname"><em>thisObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *&#160;</td>
          <td class="paramname"><em>http</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStoreIOBuffer.html">StoreIOBuffer</a>&#160;</td>
          <td class="paramname"><em>readBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Triggers a read of data that satisfies the httpClientRequest metainformation and (if appropriate) the offset,length and buffer parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>'this' reference for the client stream </td></tr>
    <tr><td class="paramname">http</td><td>Superset of request data, being winnowed down over time. MUST NOT be NULL. </td></tr>
    <tr><td class="paramname">readBuffer</td><td>- offset, length, buffer - what, how much and where.</td></tr>
  </table>
  </dd>
</dl>
<p>Call the previous node in the chain to read some data</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>?? </td></tr>
    <tr><td class="paramname">http</td><td>?? </td></tr>
    <tr><td class="paramname">readBuffer</td><td>?? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="clientStream_8cc_source.html#l00170">170</a> of file <a class="el" href="clientStream_8cc_source.html">clientStream.cc</a>.</p>

<p class="reference">References <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="classclientStreamNode.html#a3ffd025e7396d93b36a80c2048915ac8">clientStreamNode::data</a>, <a class="el" href="debug_2Stream_8h.html#ad8cd33a7d75c0efd4d3fd369dc6a8f13">debugs</a>, <a class="el" href="classRefCount.html#a9f2168c1df4a4ab6b7931425d85c37f0">RefCount&lt; C &gt;::getRaw()</a>, <a class="el" href="classclientStreamNode.html#ad4f6d8f7e768136d99f02728aa79b0ee">clientStreamNode::prev()</a>, <a class="el" href="classclientStreamNode.html#a0610ee06cfe7e3208cfffe67437dad9a">clientStreamNode::readBuffer</a>, and <a class="el" href="classclientStreamNode.html#ae46fc392418c197a7a61647a4a33c0d8">clientStreamNode::readfunc</a>.</p>

<p class="reference">Referenced by <a class="el" href="redirect_8cc.html#a0a274ae532ee54b5744544e8ad40e2c6">constructHelperQuery()</a>, <a class="el" href="classClientHttpRequest.html#ab992ab634582a805bf248e2e311403e1">ClientHttpRequest::doCallouts()</a>, <a class="el" href="classDownloader.html#af5780956ccb4051a0a77ddc363a584b9">Downloader::handleReply()</a>, <a class="el" href="classClientRequestContext.html#acf179694d4dcf1b64dc448c1284c5190">ClientRequestContext::hostHeaderVerifyFailed()</a>, <a class="el" href="classClientHttpRequest.html#aebb8148d406c65e3890ccb0ba88b8bf4">ClientHttpRequest::httpStart()</a>, and <a class="el" href="classHttp_1_1Stream.html#afcc7ea64a46ddbdddcfb3d58529499ea">Http::Stream::pullData()</a>.</p>

</div>
</div>
<a id="ga401a3844d9b1b7daa93a3e3c71500291" name="ga401a3844d9b1b7daa93a3e3c71500291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga401a3844d9b1b7daa93a3e3c71500291">&#9670;&#160;</a></span>clientStreamStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="enums_8h.html#ad7d12a8ac0392194bda3900e7f4f876b">clientStream_status_t</a> clientStreamStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classclientStreamNode.html">clientStreamNode</a> *&#160;</td>
          <td class="paramname"><em>thisObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classClientHttpRequest.html">ClientHttpRequest</a> *&#160;</td>
          <td class="paramname"><em>http</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allows nodes to query the upstream nodes for : </p><ul>
<li>stream ABORTS - request cancelled for some reason. upstream will not accept further reads(). </li>
<li>stream COMPLETION - upstream has completed and will not accept further reads(). </li>
<li>stream UNPLANNED COMPLETION - upstream has completed, but not at a pre-planned location (used for keepalive checking), and will not accept further reads(). </li>
<li>stream NONE - no special status, further reads permitted.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>'this' reference for the client stream </td></tr>
    <tr><td class="paramname">http</td><td>MUST NOT be NULL.</td></tr>
  </table>
  </dd>
</dl>
<p>Call the upstream node to find it's status</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thisObject</td><td>?? </td></tr>
    <tr><td class="paramname">http</td><td>?? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="clientStream_8cc_source.html#l00257">257</a> of file <a class="el" href="clientStream_8cc_source.html">clientStream.cc</a>.</p>

<p class="reference">References <a class="el" href="assert_8h.html#a33fa45e42155e69ce8d0da0fd978b351">assert</a>, <a class="el" href="classdlink__node.html#a06bd2bfe93cc751ab5b29b033e6ac65e">dlink_node::data</a>, <a class="el" href="classclientStreamNode.html#acd24e5a54ccd28b8c5ef2e9d4c0269e5">clientStreamNode::node</a>, <a class="el" href="classdlink__node.html#a4660c70e36112cd329b84f7152a671fa">dlink_node::prev</a>, and <a class="el" href="classclientStreamNode.html#a5df526749bd9e76abb7b30468a0b5ebf">clientStreamNode::status</a>.</p>

<p class="reference">Referenced by <a class="el" href="classDownloader.html#af5780956ccb4051a0a77ddc363a584b9">Downloader::handleReply()</a>, and <a class="el" href="classHttp_1_1Stream.html#a89e6bfbdebf900f3d003f93b0fddf5c3">Http::Stream::socketState()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
